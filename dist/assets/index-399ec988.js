var AR=Object.defineProperty;var vR=(n,e,t)=>e in n?AR(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ue=(n,e,t)=>(vR(n,typeof e!="symbol"?e+"":e,t),t),MA=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var u=(n,e,t)=>(MA(n,e,"read from private field"),t?t.call(n):e.get(n)),E=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},S=(n,e,t,i)=>(MA(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t);var Tn=(n,e,t,i)=>({set _(r){S(n,e,r,t)},get _(){return u(n,e,i)}}),P=(n,e,t)=>(MA(n,e,"access private method"),t);function bR(n,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in n)){const o=Object.getOwnPropertyDescriptor(i,r);o&&Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();var R0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function YE(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var V_={exports:{}},Hy={},W_={exports:{}},Ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sm=Symbol.for("react.element"),ER=Symbol.for("react.portal"),CR=Symbol.for("react.fragment"),SR=Symbol.for("react.strict_mode"),_R=Symbol.for("react.profiler"),TR=Symbol.for("react.provider"),IR=Symbol.for("react.context"),NR=Symbol.for("react.forward_ref"),RR=Symbol.for("react.suspense"),kR=Symbol.for("react.memo"),PR=Symbol.for("react.lazy"),NS=Symbol.iterator;function DR(n){return n===null||typeof n!="object"?null:(n=NS&&n[NS]||n["@@iterator"],typeof n=="function"?n:null)}var G_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},X_=Object.assign,Y_={};function m0(n,e,t){this.props=n,this.context=e,this.refs=Y_,this.updater=t||G_}m0.prototype.isReactComponent={};m0.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};m0.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function $_(){}$_.prototype=m0.prototype;function $E(n,e,t){this.props=n,this.context=e,this.refs=Y_,this.updater=t||G_}var KE=$E.prototype=new $_;KE.constructor=$E;X_(KE,m0.prototype);KE.isPureReactComponent=!0;var RS=Array.isArray,K_=Object.prototype.hasOwnProperty,qE={current:null},q_={key:!0,ref:!0,__self:!0,__source:!0};function Z_(n,e,t){var i,r={},o=null,l=null;if(e!=null)for(i in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(o=""+e.key),e)K_.call(e,i)&&!q_.hasOwnProperty(i)&&(r[i]=e[i]);var h=arguments.length-2;if(h===1)r.children=t;else if(1<h){for(var g=Array(h),p=0;p<h;p++)g[p]=arguments[p+2];r.children=g}if(n&&n.defaultProps)for(i in h=n.defaultProps,h)r[i]===void 0&&(r[i]=h[i]);return{$$typeof:Sm,type:n,key:o,ref:l,props:r,_owner:qE.current}}function MR(n,e){return{$$typeof:Sm,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function ZE(n){return typeof n=="object"&&n!==null&&n.$$typeof===Sm}function OR(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var kS=/\/+/g;function OA(n,e){return typeof n=="object"&&n!==null&&n.key!=null?OR(""+n.key):e.toString(36)}function Ex(n,e,t,i,r){var o=typeof n;(o==="undefined"||o==="boolean")&&(n=null);var l=!1;if(n===null)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(n.$$typeof){case Sm:case ER:l=!0}}if(l)return l=n,r=r(l),n=i===""?"."+OA(l,0):i,RS(r)?(t="",n!=null&&(t=n.replace(kS,"$&/")+"/"),Ex(r,e,t,"",function(p){return p})):r!=null&&(ZE(r)&&(r=MR(r,t+(!r.key||l&&l.key===r.key?"":(""+r.key).replace(kS,"$&/")+"/")+n)),e.push(r)),1;if(l=0,i=i===""?".":i+":",RS(n))for(var h=0;h<n.length;h++){o=n[h];var g=i+OA(o,h);l+=Ex(o,e,t,g,r)}else if(g=DR(n),typeof g=="function")for(n=g.call(n),h=0;!(o=n.next()).done;)o=o.value,g=i+OA(o,h++),l+=Ex(o,e,t,g,r);else if(o==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function $m(n,e,t){if(n==null)return n;var i=[],r=0;return Ex(n,i,"","",function(o){return e.call(t,o,r++)}),i}function LR(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var ki={current:null},Cx={transition:null},BR={ReactCurrentDispatcher:ki,ReactCurrentBatchConfig:Cx,ReactCurrentOwner:qE};function Q_(){throw Error("act(...) is not supported in production builds of React.")}Ke.Children={map:$m,forEach:function(n,e,t){$m(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return $m(n,function(){e++}),e},toArray:function(n){return $m(n,function(e){return e})||[]},only:function(n){if(!ZE(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Ke.Component=m0;Ke.Fragment=CR;Ke.Profiler=_R;Ke.PureComponent=$E;Ke.StrictMode=SR;Ke.Suspense=RR;Ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BR;Ke.act=Q_;Ke.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=X_({},n.props),r=n.key,o=n.ref,l=n._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,l=qE.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var h=n.type.defaultProps;for(g in e)K_.call(e,g)&&!q_.hasOwnProperty(g)&&(i[g]=e[g]===void 0&&h!==void 0?h[g]:e[g])}var g=arguments.length-2;if(g===1)i.children=t;else if(1<g){h=Array(g);for(var p=0;p<g;p++)h[p]=arguments[p+2];i.children=h}return{$$typeof:Sm,type:n.type,key:r,ref:o,props:i,_owner:l}};Ke.createContext=function(n){return n={$$typeof:IR,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:TR,_context:n},n.Consumer=n};Ke.createElement=Z_;Ke.createFactory=function(n){var e=Z_.bind(null,n);return e.type=n,e};Ke.createRef=function(){return{current:null}};Ke.forwardRef=function(n){return{$$typeof:NR,render:n}};Ke.isValidElement=ZE;Ke.lazy=function(n){return{$$typeof:PR,_payload:{_status:-1,_result:n},_init:LR}};Ke.memo=function(n,e){return{$$typeof:kR,type:n,compare:e===void 0?null:e}};Ke.startTransition=function(n){var e=Cx.transition;Cx.transition={};try{n()}finally{Cx.transition=e}};Ke.unstable_act=Q_;Ke.useCallback=function(n,e){return ki.current.useCallback(n,e)};Ke.useContext=function(n){return ki.current.useContext(n)};Ke.useDebugValue=function(){};Ke.useDeferredValue=function(n){return ki.current.useDeferredValue(n)};Ke.useEffect=function(n,e){return ki.current.useEffect(n,e)};Ke.useId=function(){return ki.current.useId()};Ke.useImperativeHandle=function(n,e,t){return ki.current.useImperativeHandle(n,e,t)};Ke.useInsertionEffect=function(n,e){return ki.current.useInsertionEffect(n,e)};Ke.useLayoutEffect=function(n,e){return ki.current.useLayoutEffect(n,e)};Ke.useMemo=function(n,e){return ki.current.useMemo(n,e)};Ke.useReducer=function(n,e,t){return ki.current.useReducer(n,e,t)};Ke.useRef=function(n){return ki.current.useRef(n)};Ke.useState=function(n){return ki.current.useState(n)};Ke.useSyncExternalStore=function(n,e,t){return ki.current.useSyncExternalStore(n,e,t)};Ke.useTransition=function(){return ki.current.useTransition()};Ke.version="18.3.1";W_.exports=Ke;var re=W_.exports;const ma=YE(re);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FR=re,UR=Symbol.for("react.element"),jR=Symbol.for("react.fragment"),zR=Object.prototype.hasOwnProperty,HR=FR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,VR={key:!0,ref:!0,__self:!0,__source:!0};function J_(n,e,t){var i,r={},o=null,l=null;t!==void 0&&(o=""+t),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(l=e.ref);for(i in e)zR.call(e,i)&&!VR.hasOwnProperty(i)&&(r[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:UR,type:n,key:o,ref:l,props:r,_owner:HR.current}}Hy.Fragment=jR;Hy.jsx=J_;Hy.jsxs=J_;V_.exports=Hy;var U=V_.exports,vv={},eT={exports:{}},kr={},tT={exports:{}},nT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(ie,ge){var ye=ie.length;ie.push(ge);e:for(;0<ye;){var Me=ye-1>>>1,we=ie[Me];if(0<r(we,ge))ie[Me]=ge,ie[ye]=we,ye=Me;else break e}}function t(ie){return ie.length===0?null:ie[0]}function i(ie){if(ie.length===0)return null;var ge=ie[0],ye=ie.pop();if(ye!==ge){ie[0]=ye;e:for(var Me=0,we=ie.length,me=we>>>1;Me<me;){var Le=2*(Me+1)-1,dt=ie[Le],xe=Le+1,He=ie[xe];if(0>r(dt,ye))xe<we&&0>r(He,dt)?(ie[Me]=He,ie[xe]=ye,Me=xe):(ie[Me]=dt,ie[Le]=ye,Me=Le);else if(xe<we&&0>r(He,ye))ie[Me]=He,ie[xe]=ye,Me=xe;else break e}}return ge}function r(ie,ge){var ye=ie.sortIndex-ge.sortIndex;return ye!==0?ye:ie.id-ge.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var l=Date,h=l.now();n.unstable_now=function(){return l.now()-h}}var g=[],p=[],x=1,y=null,v=3,C=!1,R=!1,I=!1,O=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(ie){for(var ge=t(p);ge!==null;){if(ge.callback===null)i(p);else if(ge.startTime<=ie)i(p),ge.sortIndex=ge.expirationTime,e(g,ge);else break;ge=t(p)}}function B(ie){if(I=!1,k(ie),!R)if(t(g)!==null)R=!0,oe(z);else{var ge=t(p);ge!==null&&ne(B,ge.startTime-ie)}}function z(ie,ge){R=!1,I&&(I=!1,_(Y),Y=-1),C=!0;var ye=v;try{for(k(ge),y=t(g);y!==null&&(!(y.expirationTime>ge)||ie&&!te());){var Me=y.callback;if(typeof Me=="function"){y.callback=null,v=y.priorityLevel;var we=Me(y.expirationTime<=ge);ge=n.unstable_now(),typeof we=="function"?y.callback=we:y===t(g)&&i(g),k(ge)}else i(g);y=t(g)}if(y!==null)var me=!0;else{var Le=t(p);Le!==null&&ne(B,Le.startTime-ge),me=!1}return me}finally{y=null,v=ye,C=!1}}var H=!1,F=null,Y=-1,W=5,Z=-1;function te(){return!(n.unstable_now()-Z<W)}function ee(){if(F!==null){var ie=n.unstable_now();Z=ie;var ge=!0;try{ge=F(!0,ie)}finally{ge?le():(H=!1,F=null)}}else H=!1}var le;if(typeof N=="function")le=function(){N(ee)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,$=ce.port2;ce.port1.onmessage=ee,le=function(){$.postMessage(null)}}else le=function(){O(ee,0)};function oe(ie){F=ie,H||(H=!0,le())}function ne(ie,ge){Y=O(function(){ie(n.unstable_now())},ge)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ie){ie.callback=null},n.unstable_continueExecution=function(){R||C||(R=!0,oe(z))},n.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<ie?Math.floor(1e3/ie):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_getFirstCallbackNode=function(){return t(g)},n.unstable_next=function(ie){switch(v){case 1:case 2:case 3:var ge=3;break;default:ge=v}var ye=v;v=ge;try{return ie()}finally{v=ye}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ie,ge){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var ye=v;v=ie;try{return ge()}finally{v=ye}},n.unstable_scheduleCallback=function(ie,ge,ye){var Me=n.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?Me+ye:Me):ye=Me,ie){case 1:var we=-1;break;case 2:we=250;break;case 5:we=1073741823;break;case 4:we=1e4;break;default:we=5e3}return we=ye+we,ie={id:x++,callback:ge,priorityLevel:ie,startTime:ye,expirationTime:we,sortIndex:-1},ye>Me?(ie.sortIndex=ye,e(p,ie),t(g)===null&&ie===t(p)&&(I?(_(Y),Y=-1):I=!0,ne(B,ye-Me))):(ie.sortIndex=we,e(g,ie),R||C||(R=!0,oe(z))),ie},n.unstable_shouldYield=te,n.unstable_wrapCallback=function(ie){var ge=v;return function(){var ye=v;v=ge;try{return ie.apply(this,arguments)}finally{v=ye}}}})(nT);tT.exports=nT;var WR=tT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GR=re,Nr=WR;function he(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var iT=new Set,S1={};function oh(n,e){o0(n,e),o0(n+"Capture",e)}function o0(n,e){for(S1[n]=e,n=0;n<e.length;n++)iT.add(e[n])}var xa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bv=Object.prototype.hasOwnProperty,XR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,PS={},DS={};function YR(n){return bv.call(DS,n)?!0:bv.call(PS,n)?!1:XR.test(n)?DS[n]=!0:(PS[n]=!0,!1)}function $R(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function KR(n,e,t,i){if(e===null||typeof e>"u"||$R(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Pi(n,e,t,i,r,o,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=o,this.removeEmptyString=l}var si={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){si[n]=new Pi(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];si[e]=new Pi(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){si[n]=new Pi(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){si[n]=new Pi(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){si[n]=new Pi(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){si[n]=new Pi(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){si[n]=new Pi(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){si[n]=new Pi(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){si[n]=new Pi(n,5,!1,n.toLowerCase(),null,!1,!1)});var QE=/[\-:]([a-z])/g;function JE(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(QE,JE);si[e]=new Pi(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(QE,JE);si[e]=new Pi(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(QE,JE);si[e]=new Pi(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){si[n]=new Pi(n,1,!1,n.toLowerCase(),null,!1,!1)});si.xlinkHref=new Pi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){si[n]=new Pi(n,1,!1,n.toLowerCase(),null,!0,!0)});function eC(n,e,t,i){var r=si.hasOwnProperty(e)?si[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(KR(e,t,r,i)&&(t=null),i||r===null?YR(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,i=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var Ea=GR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Km=Symbol.for("react.element"),Ph=Symbol.for("react.portal"),Dh=Symbol.for("react.fragment"),tC=Symbol.for("react.strict_mode"),Ev=Symbol.for("react.profiler"),rT=Symbol.for("react.provider"),sT=Symbol.for("react.context"),nC=Symbol.for("react.forward_ref"),Cv=Symbol.for("react.suspense"),Sv=Symbol.for("react.suspense_list"),iC=Symbol.for("react.memo"),Da=Symbol.for("react.lazy"),oT=Symbol.for("react.offscreen"),MS=Symbol.iterator;function k0(n){return n===null||typeof n!="object"?null:(n=MS&&n[MS]||n["@@iterator"],typeof n=="function"?n:null)}var en=Object.assign,LA;function W0(n){if(LA===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);LA=e&&e[1]||""}return`
`+LA+n}var BA=!1;function FA(n,e){if(!n||BA)return"";BA=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(p){var i=p}Reflect.construct(n,[],e)}else{try{e.call()}catch(p){i=p}n.call(e.prototype)}else{try{throw Error()}catch(p){i=p}n()}}catch(p){if(p&&i&&typeof p.stack=="string"){for(var r=p.stack.split(`
`),o=i.stack.split(`
`),l=r.length-1,h=o.length-1;1<=l&&0<=h&&r[l]!==o[h];)h--;for(;1<=l&&0<=h;l--,h--)if(r[l]!==o[h]){if(l!==1||h!==1)do if(l--,h--,0>h||r[l]!==o[h]){var g=`
`+r[l].replace(" at new "," at ");return n.displayName&&g.includes("<anonymous>")&&(g=g.replace("<anonymous>",n.displayName)),g}while(1<=l&&0<=h);break}}}finally{BA=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?W0(n):""}function qR(n){switch(n.tag){case 5:return W0(n.type);case 16:return W0("Lazy");case 13:return W0("Suspense");case 19:return W0("SuspenseList");case 0:case 2:case 15:return n=FA(n.type,!1),n;case 11:return n=FA(n.type.render,!1),n;case 1:return n=FA(n.type,!0),n;default:return""}}function _v(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Dh:return"Fragment";case Ph:return"Portal";case Ev:return"Profiler";case tC:return"StrictMode";case Cv:return"Suspense";case Sv:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case sT:return(n.displayName||"Context")+".Consumer";case rT:return(n._context.displayName||"Context")+".Provider";case nC:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case iC:return e=n.displayName||null,e!==null?e:_v(n.type)||"Memo";case Da:e=n._payload,n=n._init;try{return _v(n(e))}catch{}}return null}function ZR(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _v(e);case 8:return e===tC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function $l(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function aT(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function QR(n){var e=aT(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,o=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(l){i=""+l,o.call(this,l)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(l){i=""+l},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function qm(n){n._valueTracker||(n._valueTracker=QR(n))}function lT(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=aT(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function f2(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Tv(n,e){var t=e.checked;return en({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function OS(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=$l(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function cT(n,e){e=e.checked,e!=null&&eC(n,"checked",e,!1)}function Iv(n,e){cT(n,e);var t=$l(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Nv(n,e.type,t):e.hasOwnProperty("defaultValue")&&Nv(n,e.type,$l(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function LS(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Nv(n,e,t){(e!=="number"||f2(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var G0=Array.isArray;function Zh(n,e,t,i){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&i&&(n[t].defaultSelected=!0)}else{for(t=""+$l(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,i&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function Rv(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(he(91));return en({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function BS(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(he(92));if(G0(t)){if(1<t.length)throw Error(he(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:$l(t)}}function uT(n,e){var t=$l(e.value),i=$l(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function FS(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function hT(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kv(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?hT(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Zm,dT=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Zm=Zm||document.createElement("div"),Zm.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Zm.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function _1(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var p1={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},JR=["Webkit","ms","Moz","O"];Object.keys(p1).forEach(function(n){JR.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),p1[e]=p1[n]})});function fT(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||p1.hasOwnProperty(n)&&p1[n]?(""+e).trim():e+"px"}function gT(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,r=fT(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,r):n[t]=r}}var ek=en({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Pv(n,e){if(e){if(ek[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(he(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(he(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(he(61))}if(e.style!=null&&typeof e.style!="object")throw Error(he(62))}}function Dv(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mv=null;function rC(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Ov=null,Qh=null,Jh=null;function US(n){if(n=Im(n)){if(typeof Ov!="function")throw Error(he(280));var e=n.stateNode;e&&(e=Yy(e),Ov(n.stateNode,n.type,e))}}function pT(n){Qh?Jh?Jh.push(n):Jh=[n]:Qh=n}function mT(){if(Qh){var n=Qh,e=Jh;if(Jh=Qh=null,US(n),e)for(n=0;n<e.length;n++)US(e[n])}}function xT(n,e){return n(e)}function wT(){}var UA=!1;function yT(n,e,t){if(UA)return n(e,t);UA=!0;try{return xT(n,e,t)}finally{UA=!1,(Qh!==null||Jh!==null)&&(wT(),mT())}}function T1(n,e){var t=n.stateNode;if(t===null)return null;var i=Yy(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(he(231,e,typeof t));return t}var Lv=!1;if(xa)try{var P0={};Object.defineProperty(P0,"passive",{get:function(){Lv=!0}}),window.addEventListener("test",P0,P0),window.removeEventListener("test",P0,P0)}catch{Lv=!1}function tk(n,e,t,i,r,o,l,h,g){var p=Array.prototype.slice.call(arguments,3);try{e.apply(t,p)}catch(x){this.onError(x)}}var m1=!1,g2=null,p2=!1,Bv=null,nk={onError:function(n){m1=!0,g2=n}};function ik(n,e,t,i,r,o,l,h,g){m1=!1,g2=null,tk.apply(nk,arguments)}function rk(n,e,t,i,r,o,l,h,g){if(ik.apply(this,arguments),m1){if(m1){var p=g2;m1=!1,g2=null}else throw Error(he(198));p2||(p2=!0,Bv=p)}}function ah(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function AT(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function jS(n){if(ah(n)!==n)throw Error(he(188))}function sk(n){var e=n.alternate;if(!e){if(e=ah(n),e===null)throw Error(he(188));return e!==n?null:n}for(var t=n,i=e;;){var r=t.return;if(r===null)break;var o=r.alternate;if(o===null){if(i=r.return,i!==null){t=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===t)return jS(r),n;if(o===i)return jS(r),e;o=o.sibling}throw Error(he(188))}if(t.return!==i.return)t=r,i=o;else{for(var l=!1,h=r.child;h;){if(h===t){l=!0,t=r,i=o;break}if(h===i){l=!0,i=r,t=o;break}h=h.sibling}if(!l){for(h=o.child;h;){if(h===t){l=!0,t=o,i=r;break}if(h===i){l=!0,i=o,t=r;break}h=h.sibling}if(!l)throw Error(he(189))}}if(t.alternate!==i)throw Error(he(190))}if(t.tag!==3)throw Error(he(188));return t.stateNode.current===t?n:e}function vT(n){return n=sk(n),n!==null?bT(n):null}function bT(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=bT(n);if(e!==null)return e;n=n.sibling}return null}var ET=Nr.unstable_scheduleCallback,zS=Nr.unstable_cancelCallback,ok=Nr.unstable_shouldYield,ak=Nr.unstable_requestPaint,wn=Nr.unstable_now,lk=Nr.unstable_getCurrentPriorityLevel,sC=Nr.unstable_ImmediatePriority,CT=Nr.unstable_UserBlockingPriority,m2=Nr.unstable_NormalPriority,ck=Nr.unstable_LowPriority,ST=Nr.unstable_IdlePriority,Vy=null,Ao=null;function uk(n){if(Ao&&typeof Ao.onCommitFiberRoot=="function")try{Ao.onCommitFiberRoot(Vy,n,void 0,(n.current.flags&128)===128)}catch{}}var ks=Math.clz32?Math.clz32:fk,hk=Math.log,dk=Math.LN2;function fk(n){return n>>>=0,n===0?32:31-(hk(n)/dk|0)|0}var Qm=64,Jm=4194304;function X0(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function x2(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,r=n.suspendedLanes,o=n.pingedLanes,l=t&268435455;if(l!==0){var h=l&~r;h!==0?i=X0(h):(o&=l,o!==0&&(i=X0(o)))}else l=t&~r,l!==0?i=X0(l):o!==0&&(i=X0(o));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,o=e&-e,r>=o||r===16&&(o&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-ks(e),r=1<<t,i|=n[t],e&=~r;return i}function gk(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pk(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,r=n.expirationTimes,o=n.pendingLanes;0<o;){var l=31-ks(o),h=1<<l,g=r[l];g===-1?(!(h&t)||h&i)&&(r[l]=gk(h,e)):g<=e&&(n.expiredLanes|=h),o&=~h}}function Fv(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function _T(){var n=Qm;return Qm<<=1,!(Qm&4194240)&&(Qm=64),n}function jA(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function _m(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-ks(e),n[e]=t}function mk(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-ks(t),o=1<<r;e[r]=0,i[r]=-1,n[r]=-1,t&=~o}}function oC(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-ks(t),r=1<<i;r&e|n[i]&e&&(n[i]|=e),t&=~r}}var mt=0;function TT(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var IT,aC,NT,RT,kT,Uv=!1,ex=[],Ul=null,jl=null,zl=null,I1=new Map,N1=new Map,Oa=[],xk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function HS(n,e){switch(n){case"focusin":case"focusout":Ul=null;break;case"dragenter":case"dragleave":jl=null;break;case"mouseover":case"mouseout":zl=null;break;case"pointerover":case"pointerout":I1.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":N1.delete(e.pointerId)}}function D0(n,e,t,i,r,o){return n===null||n.nativeEvent!==o?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:o,targetContainers:[r]},e!==null&&(e=Im(e),e!==null&&aC(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function wk(n,e,t,i,r){switch(e){case"focusin":return Ul=D0(Ul,n,e,t,i,r),!0;case"dragenter":return jl=D0(jl,n,e,t,i,r),!0;case"mouseover":return zl=D0(zl,n,e,t,i,r),!0;case"pointerover":var o=r.pointerId;return I1.set(o,D0(I1.get(o)||null,n,e,t,i,r)),!0;case"gotpointercapture":return o=r.pointerId,N1.set(o,D0(N1.get(o)||null,n,e,t,i,r)),!0}return!1}function PT(n){var e=yc(n.target);if(e!==null){var t=ah(e);if(t!==null){if(e=t.tag,e===13){if(e=AT(t),e!==null){n.blockedOn=e,kT(n.priority,function(){NT(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Sx(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=jv(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);Mv=i,t.target.dispatchEvent(i),Mv=null}else return e=Im(t),e!==null&&aC(e),n.blockedOn=t,!1;e.shift()}return!0}function VS(n,e,t){Sx(n)&&t.delete(e)}function yk(){Uv=!1,Ul!==null&&Sx(Ul)&&(Ul=null),jl!==null&&Sx(jl)&&(jl=null),zl!==null&&Sx(zl)&&(zl=null),I1.forEach(VS),N1.forEach(VS)}function M0(n,e){n.blockedOn===e&&(n.blockedOn=null,Uv||(Uv=!0,Nr.unstable_scheduleCallback(Nr.unstable_NormalPriority,yk)))}function R1(n){function e(r){return M0(r,n)}if(0<ex.length){M0(ex[0],n);for(var t=1;t<ex.length;t++){var i=ex[t];i.blockedOn===n&&(i.blockedOn=null)}}for(Ul!==null&&M0(Ul,n),jl!==null&&M0(jl,n),zl!==null&&M0(zl,n),I1.forEach(e),N1.forEach(e),t=0;t<Oa.length;t++)i=Oa[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<Oa.length&&(t=Oa[0],t.blockedOn===null);)PT(t),t.blockedOn===null&&Oa.shift()}var ed=Ea.ReactCurrentBatchConfig,w2=!0;function Ak(n,e,t,i){var r=mt,o=ed.transition;ed.transition=null;try{mt=1,lC(n,e,t,i)}finally{mt=r,ed.transition=o}}function vk(n,e,t,i){var r=mt,o=ed.transition;ed.transition=null;try{mt=4,lC(n,e,t,i)}finally{mt=r,ed.transition=o}}function lC(n,e,t,i){if(w2){var r=jv(n,e,t,i);if(r===null)qA(n,e,i,y2,t),HS(n,i);else if(wk(r,n,e,t,i))i.stopPropagation();else if(HS(n,i),e&4&&-1<xk.indexOf(n)){for(;r!==null;){var o=Im(r);if(o!==null&&IT(o),o=jv(n,e,t,i),o===null&&qA(n,e,i,y2,t),o===r)break;r=o}r!==null&&i.stopPropagation()}else qA(n,e,i,null,t)}}var y2=null;function jv(n,e,t,i){if(y2=null,n=rC(i),n=yc(n),n!==null)if(e=ah(n),e===null)n=null;else if(t=e.tag,t===13){if(n=AT(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return y2=n,null}function DT(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lk()){case sC:return 1;case CT:return 4;case m2:case ck:return 16;case ST:return 536870912;default:return 16}default:return 16}}var Bl=null,cC=null,_x=null;function MT(){if(_x)return _x;var n,e=cC,t=e.length,i,r="value"in Bl?Bl.value:Bl.textContent,o=r.length;for(n=0;n<t&&e[n]===r[n];n++);var l=t-n;for(i=1;i<=l&&e[t-i]===r[o-i];i++);return _x=r.slice(n,1<i?1-i:void 0)}function Tx(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function tx(){return!0}function WS(){return!1}function Pr(n){function e(t,i,r,o,l){this._reactName=t,this._targetInst=r,this.type=i,this.nativeEvent=o,this.target=l,this.currentTarget=null;for(var h in n)n.hasOwnProperty(h)&&(t=n[h],this[h]=t?t(o):o[h]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?tx:WS,this.isPropagationStopped=WS,this}return en(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=tx)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=tx)},persist:function(){},isPersistent:tx}),e}var x0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},uC=Pr(x0),Tm=en({},x0,{view:0,detail:0}),bk=Pr(Tm),zA,HA,O0,Wy=en({},Tm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hC,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==O0&&(O0&&n.type==="mousemove"?(zA=n.screenX-O0.screenX,HA=n.screenY-O0.screenY):HA=zA=0,O0=n),zA)},movementY:function(n){return"movementY"in n?n.movementY:HA}}),GS=Pr(Wy),Ek=en({},Wy,{dataTransfer:0}),Ck=Pr(Ek),Sk=en({},Tm,{relatedTarget:0}),VA=Pr(Sk),_k=en({},x0,{animationName:0,elapsedTime:0,pseudoElement:0}),Tk=Pr(_k),Ik=en({},x0,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Nk=Pr(Ik),Rk=en({},x0,{data:0}),XS=Pr(Rk),kk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Pk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Dk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Mk(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=Dk[n])?!!e[n]:!1}function hC(){return Mk}var Ok=en({},Tm,{key:function(n){if(n.key){var e=kk[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Tx(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Pk[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hC,charCode:function(n){return n.type==="keypress"?Tx(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Tx(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Lk=Pr(Ok),Bk=en({},Wy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),YS=Pr(Bk),Fk=en({},Tm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hC}),Uk=Pr(Fk),jk=en({},x0,{propertyName:0,elapsedTime:0,pseudoElement:0}),zk=Pr(jk),Hk=en({},Wy,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Vk=Pr(Hk),Wk=[9,13,27,32],dC=xa&&"CompositionEvent"in window,x1=null;xa&&"documentMode"in document&&(x1=document.documentMode);var Gk=xa&&"TextEvent"in window&&!x1,OT=xa&&(!dC||x1&&8<x1&&11>=x1),$S=String.fromCharCode(32),KS=!1;function LT(n,e){switch(n){case"keyup":return Wk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function BT(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Mh=!1;function Xk(n,e){switch(n){case"compositionend":return BT(e);case"keypress":return e.which!==32?null:(KS=!0,$S);case"textInput":return n=e.data,n===$S&&KS?null:n;default:return null}}function Yk(n,e){if(Mh)return n==="compositionend"||!dC&&LT(n,e)?(n=MT(),_x=cC=Bl=null,Mh=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return OT&&e.locale!=="ko"?null:e.data;default:return null}}var $k={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qS(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!$k[n.type]:e==="textarea"}function FT(n,e,t,i){pT(i),e=A2(e,"onChange"),0<e.length&&(t=new uC("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var w1=null,k1=null;function Kk(n){KT(n,0)}function Gy(n){var e=Bh(n);if(lT(e))return n}function qk(n,e){if(n==="change")return e}var UT=!1;if(xa){var WA;if(xa){var GA="oninput"in document;if(!GA){var ZS=document.createElement("div");ZS.setAttribute("oninput","return;"),GA=typeof ZS.oninput=="function"}WA=GA}else WA=!1;UT=WA&&(!document.documentMode||9<document.documentMode)}function QS(){w1&&(w1.detachEvent("onpropertychange",jT),k1=w1=null)}function jT(n){if(n.propertyName==="value"&&Gy(k1)){var e=[];FT(e,k1,n,rC(n)),yT(Kk,e)}}function Zk(n,e,t){n==="focusin"?(QS(),w1=e,k1=t,w1.attachEvent("onpropertychange",jT)):n==="focusout"&&QS()}function Qk(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Gy(k1)}function Jk(n,e){if(n==="click")return Gy(e)}function eP(n,e){if(n==="input"||n==="change")return Gy(e)}function tP(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Ds=typeof Object.is=="function"?Object.is:tP;function P1(n,e){if(Ds(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var r=t[i];if(!bv.call(e,r)||!Ds(n[r],e[r]))return!1}return!0}function JS(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function e3(n,e){var t=JS(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=JS(t)}}function zT(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?zT(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function HT(){for(var n=window,e=f2();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=f2(n.document)}return e}function fC(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function nP(n){var e=HT(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&zT(t.ownerDocument.documentElement,t)){if(i!==null&&fC(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,o=Math.min(i.start,r);i=i.end===void 0?o:Math.min(i.end,r),!n.extend&&o>i&&(r=i,i=o,o=r),r=e3(t,o);var l=e3(t,i);r&&l&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==l.node||n.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),o>i?(n.addRange(e),n.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var iP=xa&&"documentMode"in document&&11>=document.documentMode,Oh=null,zv=null,y1=null,Hv=!1;function t3(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Hv||Oh==null||Oh!==f2(i)||(i=Oh,"selectionStart"in i&&fC(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),y1&&P1(y1,i)||(y1=i,i=A2(zv,"onSelect"),0<i.length&&(e=new uC("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=Oh)))}function nx(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Lh={animationend:nx("Animation","AnimationEnd"),animationiteration:nx("Animation","AnimationIteration"),animationstart:nx("Animation","AnimationStart"),transitionend:nx("Transition","TransitionEnd")},XA={},VT={};xa&&(VT=document.createElement("div").style,"AnimationEvent"in window||(delete Lh.animationend.animation,delete Lh.animationiteration.animation,delete Lh.animationstart.animation),"TransitionEvent"in window||delete Lh.transitionend.transition);function Xy(n){if(XA[n])return XA[n];if(!Lh[n])return n;var e=Lh[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in VT)return XA[n]=e[t];return n}var WT=Xy("animationend"),GT=Xy("animationiteration"),XT=Xy("animationstart"),YT=Xy("transitionend"),$T=new Map,n3="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Jl(n,e){$T.set(n,e),oh(e,[n])}for(var YA=0;YA<n3.length;YA++){var $A=n3[YA],rP=$A.toLowerCase(),sP=$A[0].toUpperCase()+$A.slice(1);Jl(rP,"on"+sP)}Jl(WT,"onAnimationEnd");Jl(GT,"onAnimationIteration");Jl(XT,"onAnimationStart");Jl("dblclick","onDoubleClick");Jl("focusin","onFocus");Jl("focusout","onBlur");Jl(YT,"onTransitionEnd");o0("onMouseEnter",["mouseout","mouseover"]);o0("onMouseLeave",["mouseout","mouseover"]);o0("onPointerEnter",["pointerout","pointerover"]);o0("onPointerLeave",["pointerout","pointerover"]);oh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));oh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));oh("onBeforeInput",["compositionend","keypress","textInput","paste"]);oh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));oh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));oh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Y0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),oP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Y0));function i3(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,rk(i,e,void 0,n),n.currentTarget=null}function KT(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],r=i.event;i=i.listeners;e:{var o=void 0;if(e)for(var l=i.length-1;0<=l;l--){var h=i[l],g=h.instance,p=h.currentTarget;if(h=h.listener,g!==o&&r.isPropagationStopped())break e;i3(r,h,p),o=g}else for(l=0;l<i.length;l++){if(h=i[l],g=h.instance,p=h.currentTarget,h=h.listener,g!==o&&r.isPropagationStopped())break e;i3(r,h,p),o=g}}}if(p2)throw n=Bv,p2=!1,Bv=null,n}function Lt(n,e){var t=e[Yv];t===void 0&&(t=e[Yv]=new Set);var i=n+"__bubble";t.has(i)||(qT(e,n,2,!1),t.add(i))}function KA(n,e,t){var i=0;e&&(i|=4),qT(t,n,i,e)}var ix="_reactListening"+Math.random().toString(36).slice(2);function D1(n){if(!n[ix]){n[ix]=!0,iT.forEach(function(t){t!=="selectionchange"&&(oP.has(t)||KA(t,!1,n),KA(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[ix]||(e[ix]=!0,KA("selectionchange",!1,e))}}function qT(n,e,t,i){switch(DT(e)){case 1:var r=Ak;break;case 4:r=vk;break;default:r=lC}t=r.bind(null,e,t,n),r=void 0,!Lv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function qA(n,e,t,i,r){var o=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var l=i.tag;if(l===3||l===4){var h=i.stateNode.containerInfo;if(h===r||h.nodeType===8&&h.parentNode===r)break;if(l===4)for(l=i.return;l!==null;){var g=l.tag;if((g===3||g===4)&&(g=l.stateNode.containerInfo,g===r||g.nodeType===8&&g.parentNode===r))return;l=l.return}for(;h!==null;){if(l=yc(h),l===null)return;if(g=l.tag,g===5||g===6){i=o=l;continue e}h=h.parentNode}}i=i.return}yT(function(){var p=o,x=rC(t),y=[];e:{var v=$T.get(n);if(v!==void 0){var C=uC,R=n;switch(n){case"keypress":if(Tx(t)===0)break e;case"keydown":case"keyup":C=Lk;break;case"focusin":R="focus",C=VA;break;case"focusout":R="blur",C=VA;break;case"beforeblur":case"afterblur":C=VA;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=GS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=Ck;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=Uk;break;case WT:case GT:case XT:C=Tk;break;case YT:C=zk;break;case"scroll":C=bk;break;case"wheel":C=Vk;break;case"copy":case"cut":case"paste":C=Nk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=YS}var I=(e&4)!==0,O=!I&&n==="scroll",_=I?v!==null?v+"Capture":null:v;I=[];for(var N=p,k;N!==null;){k=N;var B=k.stateNode;if(k.tag===5&&B!==null&&(k=B,_!==null&&(B=T1(N,_),B!=null&&I.push(M1(N,B,k)))),O)break;N=N.return}0<I.length&&(v=new C(v,R,null,t,x),y.push({event:v,listeners:I}))}}if(!(e&7)){e:{if(v=n==="mouseover"||n==="pointerover",C=n==="mouseout"||n==="pointerout",v&&t!==Mv&&(R=t.relatedTarget||t.fromElement)&&(yc(R)||R[wa]))break e;if((C||v)&&(v=x.window===x?x:(v=x.ownerDocument)?v.defaultView||v.parentWindow:window,C?(R=t.relatedTarget||t.toElement,C=p,R=R?yc(R):null,R!==null&&(O=ah(R),R!==O||R.tag!==5&&R.tag!==6)&&(R=null)):(C=null,R=p),C!==R)){if(I=GS,B="onMouseLeave",_="onMouseEnter",N="mouse",(n==="pointerout"||n==="pointerover")&&(I=YS,B="onPointerLeave",_="onPointerEnter",N="pointer"),O=C==null?v:Bh(C),k=R==null?v:Bh(R),v=new I(B,N+"leave",C,t,x),v.target=O,v.relatedTarget=k,B=null,yc(x)===p&&(I=new I(_,N+"enter",R,t,x),I.target=k,I.relatedTarget=O,B=I),O=B,C&&R)t:{for(I=C,_=R,N=0,k=I;k;k=bh(k))N++;for(k=0,B=_;B;B=bh(B))k++;for(;0<N-k;)I=bh(I),N--;for(;0<k-N;)_=bh(_),k--;for(;N--;){if(I===_||_!==null&&I===_.alternate)break t;I=bh(I),_=bh(_)}I=null}else I=null;C!==null&&r3(y,v,C,I,!1),R!==null&&O!==null&&r3(y,O,R,I,!0)}}e:{if(v=p?Bh(p):window,C=v.nodeName&&v.nodeName.toLowerCase(),C==="select"||C==="input"&&v.type==="file")var z=qk;else if(qS(v))if(UT)z=eP;else{z=Qk;var H=Zk}else(C=v.nodeName)&&C.toLowerCase()==="input"&&(v.type==="checkbox"||v.type==="radio")&&(z=Jk);if(z&&(z=z(n,p))){FT(y,z,t,x);break e}H&&H(n,v,p),n==="focusout"&&(H=v._wrapperState)&&H.controlled&&v.type==="number"&&Nv(v,"number",v.value)}switch(H=p?Bh(p):window,n){case"focusin":(qS(H)||H.contentEditable==="true")&&(Oh=H,zv=p,y1=null);break;case"focusout":y1=zv=Oh=null;break;case"mousedown":Hv=!0;break;case"contextmenu":case"mouseup":case"dragend":Hv=!1,t3(y,t,x);break;case"selectionchange":if(iP)break;case"keydown":case"keyup":t3(y,t,x)}var F;if(dC)e:{switch(n){case"compositionstart":var Y="onCompositionStart";break e;case"compositionend":Y="onCompositionEnd";break e;case"compositionupdate":Y="onCompositionUpdate";break e}Y=void 0}else Mh?LT(n,t)&&(Y="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(Y="onCompositionStart");Y&&(OT&&t.locale!=="ko"&&(Mh||Y!=="onCompositionStart"?Y==="onCompositionEnd"&&Mh&&(F=MT()):(Bl=x,cC="value"in Bl?Bl.value:Bl.textContent,Mh=!0)),H=A2(p,Y),0<H.length&&(Y=new XS(Y,n,null,t,x),y.push({event:Y,listeners:H}),F?Y.data=F:(F=BT(t),F!==null&&(Y.data=F)))),(F=Gk?Xk(n,t):Yk(n,t))&&(p=A2(p,"onBeforeInput"),0<p.length&&(x=new XS("onBeforeInput","beforeinput",null,t,x),y.push({event:x,listeners:p}),x.data=F))}KT(y,e)})}function M1(n,e,t){return{instance:n,listener:e,currentTarget:t}}function A2(n,e){for(var t=e+"Capture",i=[];n!==null;){var r=n,o=r.stateNode;r.tag===5&&o!==null&&(r=o,o=T1(n,t),o!=null&&i.unshift(M1(n,o,r)),o=T1(n,e),o!=null&&i.push(M1(n,o,r))),n=n.return}return i}function bh(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function r3(n,e,t,i,r){for(var o=e._reactName,l=[];t!==null&&t!==i;){var h=t,g=h.alternate,p=h.stateNode;if(g!==null&&g===i)break;h.tag===5&&p!==null&&(h=p,r?(g=T1(t,o),g!=null&&l.unshift(M1(t,g,h))):r||(g=T1(t,o),g!=null&&l.push(M1(t,g,h)))),t=t.return}l.length!==0&&n.push({event:e,listeners:l})}var aP=/\r\n?/g,lP=/\u0000|\uFFFD/g;function s3(n){return(typeof n=="string"?n:""+n).replace(aP,`
`).replace(lP,"")}function rx(n,e,t){if(e=s3(e),s3(n)!==e&&t)throw Error(he(425))}function v2(){}var Vv=null,Wv=null;function Gv(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Xv=typeof setTimeout=="function"?setTimeout:void 0,cP=typeof clearTimeout=="function"?clearTimeout:void 0,o3=typeof Promise=="function"?Promise:void 0,uP=typeof queueMicrotask=="function"?queueMicrotask:typeof o3<"u"?function(n){return o3.resolve(null).then(n).catch(hP)}:Xv;function hP(n){setTimeout(function(){throw n})}function ZA(n,e){var t=e,i=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(i===0){n.removeChild(r),R1(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=r}while(t);R1(e)}function Hl(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function a3(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var w0=Math.random().toString(36).slice(2),wo="__reactFiber$"+w0,O1="__reactProps$"+w0,wa="__reactContainer$"+w0,Yv="__reactEvents$"+w0,dP="__reactListeners$"+w0,fP="__reactHandles$"+w0;function yc(n){var e=n[wo];if(e)return e;for(var t=n.parentNode;t;){if(e=t[wa]||t[wo]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=a3(n);n!==null;){if(t=n[wo])return t;n=a3(n)}return e}n=t,t=n.parentNode}return null}function Im(n){return n=n[wo]||n[wa],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Bh(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(he(33))}function Yy(n){return n[O1]||null}var $v=[],Fh=-1;function ec(n){return{current:n}}function Ft(n){0>Fh||(n.current=$v[Fh],$v[Fh]=null,Fh--)}function Dt(n,e){Fh++,$v[Fh]=n.current,n.current=e}var Kl={},Ai=ec(Kl),Ji=ec(!1),Ju=Kl;function a0(n,e){var t=n.type.contextTypes;if(!t)return Kl;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},o;for(o in t)r[o]=e[o];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function er(n){return n=n.childContextTypes,n!=null}function b2(){Ft(Ji),Ft(Ai)}function l3(n,e,t){if(Ai.current!==Kl)throw Error(he(168));Dt(Ai,e),Dt(Ji,t)}function ZT(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(he(108,ZR(n)||"Unknown",r));return en({},t,i)}function E2(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Kl,Ju=Ai.current,Dt(Ai,n),Dt(Ji,Ji.current),!0}function c3(n,e,t){var i=n.stateNode;if(!i)throw Error(he(169));t?(n=ZT(n,e,Ju),i.__reactInternalMemoizedMergedChildContext=n,Ft(Ji),Ft(Ai),Dt(Ai,n)):Ft(Ji),Dt(Ji,t)}var No=null,$y=!1,QA=!1;function QT(n){No===null?No=[n]:No.push(n)}function gP(n){$y=!0,QT(n)}function tc(){if(!QA&&No!==null){QA=!0;var n=0,e=mt;try{var t=No;for(mt=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}No=null,$y=!1}catch(r){throw No!==null&&(No=No.slice(n+1)),ET(sC,tc),r}finally{mt=e,QA=!1}}return null}var Uh=[],jh=0,C2=null,S2=0,Qr=[],Jr=0,eh=null,fa=1,ga="";function hc(n,e){Uh[jh++]=S2,Uh[jh++]=C2,C2=n,S2=e}function JT(n,e,t){Qr[Jr++]=fa,Qr[Jr++]=ga,Qr[Jr++]=eh,eh=n;var i=fa;n=ga;var r=32-ks(i)-1;i&=~(1<<r),t+=1;var o=32-ks(e)+r;if(30<o){var l=r-r%5;o=(i&(1<<l)-1).toString(32),i>>=l,r-=l,fa=1<<32-ks(e)+r|t<<r|i,ga=o+n}else fa=1<<o|t<<r|i,ga=n}function gC(n){n.return!==null&&(hc(n,1),JT(n,1,0))}function pC(n){for(;n===C2;)C2=Uh[--jh],Uh[jh]=null,S2=Uh[--jh],Uh[jh]=null;for(;n===eh;)eh=Qr[--Jr],Qr[Jr]=null,ga=Qr[--Jr],Qr[Jr]=null,fa=Qr[--Jr],Qr[Jr]=null}var Ir=null,Tr=null,Xt=!1,Ns=null;function eI(n,e){var t=ts(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function u3(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Ir=n,Tr=Hl(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Ir=n,Tr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=eh!==null?{id:fa,overflow:ga}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=ts(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Ir=n,Tr=null,!0):!1;default:return!1}}function Kv(n){return(n.mode&1)!==0&&(n.flags&128)===0}function qv(n){if(Xt){var e=Tr;if(e){var t=e;if(!u3(n,e)){if(Kv(n))throw Error(he(418));e=Hl(t.nextSibling);var i=Ir;e&&u3(n,e)?eI(i,t):(n.flags=n.flags&-4097|2,Xt=!1,Ir=n)}}else{if(Kv(n))throw Error(he(418));n.flags=n.flags&-4097|2,Xt=!1,Ir=n}}}function h3(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ir=n}function sx(n){if(n!==Ir)return!1;if(!Xt)return h3(n),Xt=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Gv(n.type,n.memoizedProps)),e&&(e=Tr)){if(Kv(n))throw tI(),Error(he(418));for(;e;)eI(n,e),e=Hl(e.nextSibling)}if(h3(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(he(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Tr=Hl(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Tr=null}}else Tr=Ir?Hl(n.stateNode.nextSibling):null;return!0}function tI(){for(var n=Tr;n;)n=Hl(n.nextSibling)}function l0(){Tr=Ir=null,Xt=!1}function mC(n){Ns===null?Ns=[n]:Ns.push(n)}var pP=Ea.ReactCurrentBatchConfig;function L0(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(he(309));var i=t.stateNode}if(!i)throw Error(he(147,n));var r=i,o=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(l){var h=r.refs;l===null?delete h[o]:h[o]=l},e._stringRef=o,e)}if(typeof n!="string")throw Error(he(284));if(!t._owner)throw Error(he(290,n))}return n}function ox(n,e){throw n=Object.prototype.toString.call(e),Error(he(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function d3(n){var e=n._init;return e(n._payload)}function nI(n){function e(_,N){if(n){var k=_.deletions;k===null?(_.deletions=[N],_.flags|=16):k.push(N)}}function t(_,N){if(!n)return null;for(;N!==null;)e(_,N),N=N.sibling;return null}function i(_,N){for(_=new Map;N!==null;)N.key!==null?_.set(N.key,N):_.set(N.index,N),N=N.sibling;return _}function r(_,N){return _=Xl(_,N),_.index=0,_.sibling=null,_}function o(_,N,k){return _.index=k,n?(k=_.alternate,k!==null?(k=k.index,k<N?(_.flags|=2,N):k):(_.flags|=2,N)):(_.flags|=1048576,N)}function l(_){return n&&_.alternate===null&&(_.flags|=2),_}function h(_,N,k,B){return N===null||N.tag!==6?(N=sv(k,_.mode,B),N.return=_,N):(N=r(N,k),N.return=_,N)}function g(_,N,k,B){var z=k.type;return z===Dh?x(_,N,k.props.children,B,k.key):N!==null&&(N.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===Da&&d3(z)===N.type)?(B=r(N,k.props),B.ref=L0(_,N,k),B.return=_,B):(B=Mx(k.type,k.key,k.props,null,_.mode,B),B.ref=L0(_,N,k),B.return=_,B)}function p(_,N,k,B){return N===null||N.tag!==4||N.stateNode.containerInfo!==k.containerInfo||N.stateNode.implementation!==k.implementation?(N=ov(k,_.mode,B),N.return=_,N):(N=r(N,k.children||[]),N.return=_,N)}function x(_,N,k,B,z){return N===null||N.tag!==7?(N=Zu(k,_.mode,B,z),N.return=_,N):(N=r(N,k),N.return=_,N)}function y(_,N,k){if(typeof N=="string"&&N!==""||typeof N=="number")return N=sv(""+N,_.mode,k),N.return=_,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Km:return k=Mx(N.type,N.key,N.props,null,_.mode,k),k.ref=L0(_,null,N),k.return=_,k;case Ph:return N=ov(N,_.mode,k),N.return=_,N;case Da:var B=N._init;return y(_,B(N._payload),k)}if(G0(N)||k0(N))return N=Zu(N,_.mode,k,null),N.return=_,N;ox(_,N)}return null}function v(_,N,k,B){var z=N!==null?N.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return z!==null?null:h(_,N,""+k,B);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Km:return k.key===z?g(_,N,k,B):null;case Ph:return k.key===z?p(_,N,k,B):null;case Da:return z=k._init,v(_,N,z(k._payload),B)}if(G0(k)||k0(k))return z!==null?null:x(_,N,k,B,null);ox(_,k)}return null}function C(_,N,k,B,z){if(typeof B=="string"&&B!==""||typeof B=="number")return _=_.get(k)||null,h(N,_,""+B,z);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case Km:return _=_.get(B.key===null?k:B.key)||null,g(N,_,B,z);case Ph:return _=_.get(B.key===null?k:B.key)||null,p(N,_,B,z);case Da:var H=B._init;return C(_,N,k,H(B._payload),z)}if(G0(B)||k0(B))return _=_.get(k)||null,x(N,_,B,z,null);ox(N,B)}return null}function R(_,N,k,B){for(var z=null,H=null,F=N,Y=N=0,W=null;F!==null&&Y<k.length;Y++){F.index>Y?(W=F,F=null):W=F.sibling;var Z=v(_,F,k[Y],B);if(Z===null){F===null&&(F=W);break}n&&F&&Z.alternate===null&&e(_,F),N=o(Z,N,Y),H===null?z=Z:H.sibling=Z,H=Z,F=W}if(Y===k.length)return t(_,F),Xt&&hc(_,Y),z;if(F===null){for(;Y<k.length;Y++)F=y(_,k[Y],B),F!==null&&(N=o(F,N,Y),H===null?z=F:H.sibling=F,H=F);return Xt&&hc(_,Y),z}for(F=i(_,F);Y<k.length;Y++)W=C(F,_,Y,k[Y],B),W!==null&&(n&&W.alternate!==null&&F.delete(W.key===null?Y:W.key),N=o(W,N,Y),H===null?z=W:H.sibling=W,H=W);return n&&F.forEach(function(te){return e(_,te)}),Xt&&hc(_,Y),z}function I(_,N,k,B){var z=k0(k);if(typeof z!="function")throw Error(he(150));if(k=z.call(k),k==null)throw Error(he(151));for(var H=z=null,F=N,Y=N=0,W=null,Z=k.next();F!==null&&!Z.done;Y++,Z=k.next()){F.index>Y?(W=F,F=null):W=F.sibling;var te=v(_,F,Z.value,B);if(te===null){F===null&&(F=W);break}n&&F&&te.alternate===null&&e(_,F),N=o(te,N,Y),H===null?z=te:H.sibling=te,H=te,F=W}if(Z.done)return t(_,F),Xt&&hc(_,Y),z;if(F===null){for(;!Z.done;Y++,Z=k.next())Z=y(_,Z.value,B),Z!==null&&(N=o(Z,N,Y),H===null?z=Z:H.sibling=Z,H=Z);return Xt&&hc(_,Y),z}for(F=i(_,F);!Z.done;Y++,Z=k.next())Z=C(F,_,Y,Z.value,B),Z!==null&&(n&&Z.alternate!==null&&F.delete(Z.key===null?Y:Z.key),N=o(Z,N,Y),H===null?z=Z:H.sibling=Z,H=Z);return n&&F.forEach(function(ee){return e(_,ee)}),Xt&&hc(_,Y),z}function O(_,N,k,B){if(typeof k=="object"&&k!==null&&k.type===Dh&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case Km:e:{for(var z=k.key,H=N;H!==null;){if(H.key===z){if(z=k.type,z===Dh){if(H.tag===7){t(_,H.sibling),N=r(H,k.props.children),N.return=_,_=N;break e}}else if(H.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===Da&&d3(z)===H.type){t(_,H.sibling),N=r(H,k.props),N.ref=L0(_,H,k),N.return=_,_=N;break e}t(_,H);break}else e(_,H);H=H.sibling}k.type===Dh?(N=Zu(k.props.children,_.mode,B,k.key),N.return=_,_=N):(B=Mx(k.type,k.key,k.props,null,_.mode,B),B.ref=L0(_,N,k),B.return=_,_=B)}return l(_);case Ph:e:{for(H=k.key;N!==null;){if(N.key===H)if(N.tag===4&&N.stateNode.containerInfo===k.containerInfo&&N.stateNode.implementation===k.implementation){t(_,N.sibling),N=r(N,k.children||[]),N.return=_,_=N;break e}else{t(_,N);break}else e(_,N);N=N.sibling}N=ov(k,_.mode,B),N.return=_,_=N}return l(_);case Da:return H=k._init,O(_,N,H(k._payload),B)}if(G0(k))return R(_,N,k,B);if(k0(k))return I(_,N,k,B);ox(_,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,N!==null&&N.tag===6?(t(_,N.sibling),N=r(N,k),N.return=_,_=N):(t(_,N),N=sv(k,_.mode,B),N.return=_,_=N),l(_)):t(_,N)}return O}var c0=nI(!0),iI=nI(!1),_2=ec(null),T2=null,zh=null,xC=null;function wC(){xC=zh=T2=null}function yC(n){var e=_2.current;Ft(_2),n._currentValue=e}function Zv(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function td(n,e){T2=n,xC=zh=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Qi=!0),n.firstContext=null)}function rs(n){var e=n._currentValue;if(xC!==n)if(n={context:n,memoizedValue:e,next:null},zh===null){if(T2===null)throw Error(he(308));zh=n,T2.dependencies={lanes:0,firstContext:n}}else zh=zh.next=n;return e}var Ac=null;function AC(n){Ac===null?Ac=[n]:Ac.push(n)}function rI(n,e,t,i){var r=e.interleaved;return r===null?(t.next=t,AC(e)):(t.next=r.next,r.next=t),e.interleaved=t,ya(n,i)}function ya(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Ma=!1;function vC(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sI(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function pa(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Vl(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,lt&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,ya(n,t)}return r=i.interleaved,r===null?(e.next=e,AC(i)):(e.next=r.next,r.next=e),i.interleaved=e,ya(n,t)}function Ix(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,oC(n,t)}}function f3(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var r=null,o=null;if(t=t.firstBaseUpdate,t!==null){do{var l={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};o===null?r=o=l:o=o.next=l,t=t.next}while(t!==null);o===null?r=o=e:o=o.next=e}else r=o=e;t={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function I2(n,e,t,i){var r=n.updateQueue;Ma=!1;var o=r.firstBaseUpdate,l=r.lastBaseUpdate,h=r.shared.pending;if(h!==null){r.shared.pending=null;var g=h,p=g.next;g.next=null,l===null?o=p:l.next=p,l=g;var x=n.alternate;x!==null&&(x=x.updateQueue,h=x.lastBaseUpdate,h!==l&&(h===null?x.firstBaseUpdate=p:h.next=p,x.lastBaseUpdate=g))}if(o!==null){var y=r.baseState;l=0,x=p=g=null,h=o;do{var v=h.lane,C=h.eventTime;if((i&v)===v){x!==null&&(x=x.next={eventTime:C,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,next:null});e:{var R=n,I=h;switch(v=e,C=t,I.tag){case 1:if(R=I.payload,typeof R=="function"){y=R.call(C,y,v);break e}y=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=I.payload,v=typeof R=="function"?R.call(C,y,v):R,v==null)break e;y=en({},y,v);break e;case 2:Ma=!0}}h.callback!==null&&h.lane!==0&&(n.flags|=64,v=r.effects,v===null?r.effects=[h]:v.push(h))}else C={eventTime:C,lane:v,tag:h.tag,payload:h.payload,callback:h.callback,next:null},x===null?(p=x=C,g=y):x=x.next=C,l|=v;if(h=h.next,h===null){if(h=r.shared.pending,h===null)break;v=h,h=v.next,v.next=null,r.lastBaseUpdate=v,r.shared.pending=null}}while(1);if(x===null&&(g=y),r.baseState=g,r.firstBaseUpdate=p,r.lastBaseUpdate=x,e=r.shared.interleaved,e!==null){r=e;do l|=r.lane,r=r.next;while(r!==e)}else o===null&&(r.shared.lanes=0);nh|=l,n.lanes=l,n.memoizedState=y}}function g3(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],r=i.callback;if(r!==null){if(i.callback=null,i=t,typeof r!="function")throw Error(he(191,r));r.call(i)}}}var Nm={},vo=ec(Nm),L1=ec(Nm),B1=ec(Nm);function vc(n){if(n===Nm)throw Error(he(174));return n}function bC(n,e){switch(Dt(B1,e),Dt(L1,n),Dt(vo,Nm),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:kv(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=kv(e,n)}Ft(vo),Dt(vo,e)}function u0(){Ft(vo),Ft(L1),Ft(B1)}function oI(n){vc(B1.current);var e=vc(vo.current),t=kv(e,n.type);e!==t&&(Dt(L1,n),Dt(vo,t))}function EC(n){L1.current===n&&(Ft(vo),Ft(L1))}var qt=ec(0);function N2(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var JA=[];function CC(){for(var n=0;n<JA.length;n++)JA[n]._workInProgressVersionPrimary=null;JA.length=0}var Nx=Ea.ReactCurrentDispatcher,ev=Ea.ReactCurrentBatchConfig,th=0,Qt=null,kn=null,Vn=null,R2=!1,A1=!1,F1=0,mP=0;function li(){throw Error(he(321))}function SC(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Ds(n[t],e[t]))return!1;return!0}function _C(n,e,t,i,r,o){if(th=o,Qt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Nx.current=n===null||n.memoizedState===null?AP:vP,n=t(i,r),A1){o=0;do{if(A1=!1,F1=0,25<=o)throw Error(he(301));o+=1,Vn=kn=null,e.updateQueue=null,Nx.current=bP,n=t(i,r)}while(A1)}if(Nx.current=k2,e=kn!==null&&kn.next!==null,th=0,Vn=kn=Qt=null,R2=!1,e)throw Error(he(300));return n}function TC(){var n=F1!==0;return F1=0,n}function Xs(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vn===null?Qt.memoizedState=Vn=n:Vn=Vn.next=n,Vn}function ss(){if(kn===null){var n=Qt.alternate;n=n!==null?n.memoizedState:null}else n=kn.next;var e=Vn===null?Qt.memoizedState:Vn.next;if(e!==null)Vn=e,kn=n;else{if(n===null)throw Error(he(310));kn=n,n={memoizedState:kn.memoizedState,baseState:kn.baseState,baseQueue:kn.baseQueue,queue:kn.queue,next:null},Vn===null?Qt.memoizedState=Vn=n:Vn=Vn.next=n}return Vn}function U1(n,e){return typeof e=="function"?e(n):e}function tv(n){var e=ss(),t=e.queue;if(t===null)throw Error(he(311));t.lastRenderedReducer=n;var i=kn,r=i.baseQueue,o=t.pending;if(o!==null){if(r!==null){var l=r.next;r.next=o.next,o.next=l}i.baseQueue=r=o,t.pending=null}if(r!==null){o=r.next,i=i.baseState;var h=l=null,g=null,p=o;do{var x=p.lane;if((th&x)===x)g!==null&&(g=g.next={lane:0,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null}),i=p.hasEagerState?p.eagerState:n(i,p.action);else{var y={lane:x,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null};g===null?(h=g=y,l=i):g=g.next=y,Qt.lanes|=x,nh|=x}p=p.next}while(p!==null&&p!==o);g===null?l=i:g.next=h,Ds(i,e.memoizedState)||(Qi=!0),e.memoizedState=i,e.baseState=l,e.baseQueue=g,t.lastRenderedState=i}if(n=t.interleaved,n!==null){r=n;do o=r.lane,Qt.lanes|=o,nh|=o,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function nv(n){var e=ss(),t=e.queue;if(t===null)throw Error(he(311));t.lastRenderedReducer=n;var i=t.dispatch,r=t.pending,o=e.memoizedState;if(r!==null){t.pending=null;var l=r=r.next;do o=n(o,l.action),l=l.next;while(l!==r);Ds(o,e.memoizedState)||(Qi=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),t.lastRenderedState=o}return[o,i]}function aI(){}function lI(n,e){var t=Qt,i=ss(),r=e(),o=!Ds(i.memoizedState,r);if(o&&(i.memoizedState=r,Qi=!0),i=i.queue,IC(hI.bind(null,t,i,n),[n]),i.getSnapshot!==e||o||Vn!==null&&Vn.memoizedState.tag&1){if(t.flags|=2048,j1(9,uI.bind(null,t,i,r,e),void 0,null),Wn===null)throw Error(he(349));th&30||cI(t,e,r)}return r}function cI(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Qt.updateQueue,e===null?(e={lastEffect:null,stores:null},Qt.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function uI(n,e,t,i){e.value=t,e.getSnapshot=i,dI(e)&&fI(n)}function hI(n,e,t){return t(function(){dI(e)&&fI(n)})}function dI(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Ds(n,t)}catch{return!0}}function fI(n){var e=ya(n,1);e!==null&&Ps(e,n,1,-1)}function p3(n){var e=Xs();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:U1,lastRenderedState:n},e.queue=n,n=n.dispatch=yP.bind(null,Qt,n),[e.memoizedState,n]}function j1(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=Qt.updateQueue,e===null?(e={lastEffect:null,stores:null},Qt.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function gI(){return ss().memoizedState}function Rx(n,e,t,i){var r=Xs();Qt.flags|=n,r.memoizedState=j1(1|e,t,void 0,i===void 0?null:i)}function Ky(n,e,t,i){var r=ss();i=i===void 0?null:i;var o=void 0;if(kn!==null){var l=kn.memoizedState;if(o=l.destroy,i!==null&&SC(i,l.deps)){r.memoizedState=j1(e,t,o,i);return}}Qt.flags|=n,r.memoizedState=j1(1|e,t,o,i)}function m3(n,e){return Rx(8390656,8,n,e)}function IC(n,e){return Ky(2048,8,n,e)}function pI(n,e){return Ky(4,2,n,e)}function mI(n,e){return Ky(4,4,n,e)}function xI(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function wI(n,e,t){return t=t!=null?t.concat([n]):null,Ky(4,4,xI.bind(null,e,n),t)}function NC(){}function yI(n,e){var t=ss();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&SC(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function AI(n,e){var t=ss();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&SC(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function vI(n,e,t){return th&21?(Ds(t,e)||(t=_T(),Qt.lanes|=t,nh|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Qi=!0),n.memoizedState=t)}function xP(n,e){var t=mt;mt=t!==0&&4>t?t:4,n(!0);var i=ev.transition;ev.transition={};try{n(!1),e()}finally{mt=t,ev.transition=i}}function bI(){return ss().memoizedState}function wP(n,e,t){var i=Gl(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},EI(n))CI(e,t);else if(t=rI(n,e,t,i),t!==null){var r=Ri();Ps(t,n,i,r),SI(t,e,i)}}function yP(n,e,t){var i=Gl(n),r={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(EI(n))CI(e,r);else{var o=n.alternate;if(n.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var l=e.lastRenderedState,h=o(l,t);if(r.hasEagerState=!0,r.eagerState=h,Ds(h,l)){var g=e.interleaved;g===null?(r.next=r,AC(e)):(r.next=g.next,g.next=r),e.interleaved=r;return}}catch{}finally{}t=rI(n,e,r,i),t!==null&&(r=Ri(),Ps(t,n,i,r),SI(t,e,i))}}function EI(n){var e=n.alternate;return n===Qt||e!==null&&e===Qt}function CI(n,e){A1=R2=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function SI(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,oC(n,t)}}var k2={readContext:rs,useCallback:li,useContext:li,useEffect:li,useImperativeHandle:li,useInsertionEffect:li,useLayoutEffect:li,useMemo:li,useReducer:li,useRef:li,useState:li,useDebugValue:li,useDeferredValue:li,useTransition:li,useMutableSource:li,useSyncExternalStore:li,useId:li,unstable_isNewReconciler:!1},AP={readContext:rs,useCallback:function(n,e){return Xs().memoizedState=[n,e===void 0?null:e],n},useContext:rs,useEffect:m3,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Rx(4194308,4,xI.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Rx(4194308,4,n,e)},useInsertionEffect:function(n,e){return Rx(4,2,n,e)},useMemo:function(n,e){var t=Xs();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=Xs();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=wP.bind(null,Qt,n),[i.memoizedState,n]},useRef:function(n){var e=Xs();return n={current:n},e.memoizedState=n},useState:p3,useDebugValue:NC,useDeferredValue:function(n){return Xs().memoizedState=n},useTransition:function(){var n=p3(!1),e=n[0];return n=xP.bind(null,n[1]),Xs().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=Qt,r=Xs();if(Xt){if(t===void 0)throw Error(he(407));t=t()}else{if(t=e(),Wn===null)throw Error(he(349));th&30||cI(i,e,t)}r.memoizedState=t;var o={value:t,getSnapshot:e};return r.queue=o,m3(hI.bind(null,i,o,n),[n]),i.flags|=2048,j1(9,uI.bind(null,i,o,t,e),void 0,null),t},useId:function(){var n=Xs(),e=Wn.identifierPrefix;if(Xt){var t=ga,i=fa;t=(i&~(1<<32-ks(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=F1++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=mP++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},vP={readContext:rs,useCallback:yI,useContext:rs,useEffect:IC,useImperativeHandle:wI,useInsertionEffect:pI,useLayoutEffect:mI,useMemo:AI,useReducer:tv,useRef:gI,useState:function(){return tv(U1)},useDebugValue:NC,useDeferredValue:function(n){var e=ss();return vI(e,kn.memoizedState,n)},useTransition:function(){var n=tv(U1)[0],e=ss().memoizedState;return[n,e]},useMutableSource:aI,useSyncExternalStore:lI,useId:bI,unstable_isNewReconciler:!1},bP={readContext:rs,useCallback:yI,useContext:rs,useEffect:IC,useImperativeHandle:wI,useInsertionEffect:pI,useLayoutEffect:mI,useMemo:AI,useReducer:nv,useRef:gI,useState:function(){return nv(U1)},useDebugValue:NC,useDeferredValue:function(n){var e=ss();return kn===null?e.memoizedState=n:vI(e,kn.memoizedState,n)},useTransition:function(){var n=nv(U1)[0],e=ss().memoizedState;return[n,e]},useMutableSource:aI,useSyncExternalStore:lI,useId:bI,unstable_isNewReconciler:!1};function fs(n,e){if(n&&n.defaultProps){e=en({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Qv(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:en({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var qy={isMounted:function(n){return(n=n._reactInternals)?ah(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=Ri(),r=Gl(n),o=pa(i,r);o.payload=e,t!=null&&(o.callback=t),e=Vl(n,o,r),e!==null&&(Ps(e,n,r,i),Ix(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=Ri(),r=Gl(n),o=pa(i,r);o.tag=1,o.payload=e,t!=null&&(o.callback=t),e=Vl(n,o,r),e!==null&&(Ps(e,n,r,i),Ix(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Ri(),i=Gl(n),r=pa(t,i);r.tag=2,e!=null&&(r.callback=e),e=Vl(n,r,i),e!==null&&(Ps(e,n,i,t),Ix(e,n,i))}};function x3(n,e,t,i,r,o,l){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,o,l):e.prototype&&e.prototype.isPureReactComponent?!P1(t,i)||!P1(r,o):!0}function _I(n,e,t){var i=!1,r=Kl,o=e.contextType;return typeof o=="object"&&o!==null?o=rs(o):(r=er(e)?Ju:Ai.current,i=e.contextTypes,o=(i=i!=null)?a0(n,r):Kl),e=new e(t,o),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=qy,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=o),e}function w3(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&qy.enqueueReplaceState(e,e.state,null)}function Jv(n,e,t,i){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs={},vC(n);var o=e.contextType;typeof o=="object"&&o!==null?r.context=rs(o):(o=er(e)?Ju:Ai.current,r.context=a0(n,o)),r.state=n.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Qv(n,e,o,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&qy.enqueueReplaceState(r,r.state,null),I2(n,t,r,i),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function h0(n,e){try{var t="",i=e;do t+=qR(i),i=i.return;while(i);var r=t}catch(o){r=`
Error generating stack: `+o.message+`
`+o.stack}return{value:n,source:e,stack:r,digest:null}}function iv(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function eb(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var EP=typeof WeakMap=="function"?WeakMap:Map;function TI(n,e,t){t=pa(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){D2||(D2=!0,ub=i),eb(n,e)},t}function II(n,e,t){t=pa(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;t.payload=function(){return i(r)},t.callback=function(){eb(n,e)}}var o=n.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(t.callback=function(){eb(n,e),typeof i!="function"&&(Wl===null?Wl=new Set([this]):Wl.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),t}function y3(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new EP;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(t)||(r.add(t),n=BP.bind(null,n,e,t),e.then(n,n))}function A3(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function v3(n,e,t,i,r){return n.mode&1?(n.flags|=65536,n.lanes=r,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=pa(-1,1),e.tag=2,Vl(t,e,1))),t.lanes|=1),n)}var CP=Ea.ReactCurrentOwner,Qi=!1;function Ni(n,e,t,i){e.child=n===null?iI(e,null,t,i):c0(e,n.child,t,i)}function b3(n,e,t,i,r){t=t.render;var o=e.ref;return td(e,r),i=_C(n,e,t,i,o,r),t=TC(),n!==null&&!Qi?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Aa(n,e,r)):(Xt&&t&&gC(e),e.flags|=1,Ni(n,e,i,r),e.child)}function E3(n,e,t,i,r){if(n===null){var o=t.type;return typeof o=="function"&&!BC(o)&&o.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=o,NI(n,e,o,i,r)):(n=Mx(t.type,null,i,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(o=n.child,!(n.lanes&r)){var l=o.memoizedProps;if(t=t.compare,t=t!==null?t:P1,t(l,i)&&n.ref===e.ref)return Aa(n,e,r)}return e.flags|=1,n=Xl(o,i),n.ref=e.ref,n.return=e,e.child=n}function NI(n,e,t,i,r){if(n!==null){var o=n.memoizedProps;if(P1(o,i)&&n.ref===e.ref)if(Qi=!1,e.pendingProps=i=o,(n.lanes&r)!==0)n.flags&131072&&(Qi=!0);else return e.lanes=n.lanes,Aa(n,e,r)}return tb(n,e,t,i,r)}function RI(n,e,t){var i=e.pendingProps,r=i.children,o=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Dt(Vh,Sr),Sr|=t;else{if(!(t&1073741824))return n=o!==null?o.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Dt(Vh,Sr),Sr|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=o!==null?o.baseLanes:t,Dt(Vh,Sr),Sr|=i}else o!==null?(i=o.baseLanes|t,e.memoizedState=null):i=t,Dt(Vh,Sr),Sr|=i;return Ni(n,e,r,t),e.child}function kI(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function tb(n,e,t,i,r){var o=er(t)?Ju:Ai.current;return o=a0(e,o),td(e,r),t=_C(n,e,t,i,o,r),i=TC(),n!==null&&!Qi?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Aa(n,e,r)):(Xt&&i&&gC(e),e.flags|=1,Ni(n,e,t,r),e.child)}function C3(n,e,t,i,r){if(er(t)){var o=!0;E2(e)}else o=!1;if(td(e,r),e.stateNode===null)kx(n,e),_I(e,t,i),Jv(e,t,i,r),i=!0;else if(n===null){var l=e.stateNode,h=e.memoizedProps;l.props=h;var g=l.context,p=t.contextType;typeof p=="object"&&p!==null?p=rs(p):(p=er(t)?Ju:Ai.current,p=a0(e,p));var x=t.getDerivedStateFromProps,y=typeof x=="function"||typeof l.getSnapshotBeforeUpdate=="function";y||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(h!==i||g!==p)&&w3(e,l,i,p),Ma=!1;var v=e.memoizedState;l.state=v,I2(e,i,l,r),g=e.memoizedState,h!==i||v!==g||Ji.current||Ma?(typeof x=="function"&&(Qv(e,t,x,i),g=e.memoizedState),(h=Ma||x3(e,t,h,i,v,g,p))?(y||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=g),l.props=i,l.state=g,l.context=p,i=h):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{l=e.stateNode,sI(n,e),h=e.memoizedProps,p=e.type===e.elementType?h:fs(e.type,h),l.props=p,y=e.pendingProps,v=l.context,g=t.contextType,typeof g=="object"&&g!==null?g=rs(g):(g=er(t)?Ju:Ai.current,g=a0(e,g));var C=t.getDerivedStateFromProps;(x=typeof C=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(h!==y||v!==g)&&w3(e,l,i,g),Ma=!1,v=e.memoizedState,l.state=v,I2(e,i,l,r);var R=e.memoizedState;h!==y||v!==R||Ji.current||Ma?(typeof C=="function"&&(Qv(e,t,C,i),R=e.memoizedState),(p=Ma||x3(e,t,p,i,v,R,g)||!1)?(x||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(i,R,g),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(i,R,g)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||h===n.memoizedProps&&v===n.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||h===n.memoizedProps&&v===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=R),l.props=i,l.state=R,l.context=g,i=p):(typeof l.componentDidUpdate!="function"||h===n.memoizedProps&&v===n.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||h===n.memoizedProps&&v===n.memoizedState||(e.flags|=1024),i=!1)}return nb(n,e,t,i,o,r)}function nb(n,e,t,i,r,o){kI(n,e);var l=(e.flags&128)!==0;if(!i&&!l)return r&&c3(e,t,!1),Aa(n,e,o);i=e.stateNode,CP.current=e;var h=l&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&l?(e.child=c0(e,n.child,null,o),e.child=c0(e,null,h,o)):Ni(n,e,h,o),e.memoizedState=i.state,r&&c3(e,t,!0),e.child}function PI(n){var e=n.stateNode;e.pendingContext?l3(n,e.pendingContext,e.pendingContext!==e.context):e.context&&l3(n,e.context,!1),bC(n,e.containerInfo)}function S3(n,e,t,i,r){return l0(),mC(r),e.flags|=256,Ni(n,e,t,i),e.child}var ib={dehydrated:null,treeContext:null,retryLane:0};function rb(n){return{baseLanes:n,cachePool:null,transitions:null}}function DI(n,e,t){var i=e.pendingProps,r=qt.current,o=!1,l=(e.flags&128)!==0,h;if((h=l)||(h=n!==null&&n.memoizedState===null?!1:(r&2)!==0),h?(o=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),Dt(qt,r&1),n===null)return qv(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=i.children,n=i.fallback,o?(i=e.mode,o=e.child,l={mode:"hidden",children:l},!(i&1)&&o!==null?(o.childLanes=0,o.pendingProps=l):o=Jy(l,i,0,null),n=Zu(n,i,t,null),o.return=e,n.return=e,o.sibling=n,e.child=o,e.child.memoizedState=rb(t),e.memoizedState=ib,n):RC(e,l));if(r=n.memoizedState,r!==null&&(h=r.dehydrated,h!==null))return SP(n,e,l,i,h,r,t);if(o){o=i.fallback,l=e.mode,r=n.child,h=r.sibling;var g={mode:"hidden",children:i.children};return!(l&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=g,e.deletions=null):(i=Xl(r,g),i.subtreeFlags=r.subtreeFlags&14680064),h!==null?o=Xl(h,o):(o=Zu(o,l,t,null),o.flags|=2),o.return=e,i.return=e,i.sibling=o,e.child=i,i=o,o=e.child,l=n.child.memoizedState,l=l===null?rb(t):{baseLanes:l.baseLanes|t,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=n.childLanes&~t,e.memoizedState=ib,i}return o=n.child,n=o.sibling,i=Xl(o,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function RC(n,e){return e=Jy({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function ax(n,e,t,i){return i!==null&&mC(i),c0(e,n.child,null,t),n=RC(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function SP(n,e,t,i,r,o,l){if(t)return e.flags&256?(e.flags&=-257,i=iv(Error(he(422))),ax(n,e,l,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(o=i.fallback,r=e.mode,i=Jy({mode:"visible",children:i.children},r,0,null),o=Zu(o,r,l,null),o.flags|=2,i.return=e,o.return=e,i.sibling=o,e.child=i,e.mode&1&&c0(e,n.child,null,l),e.child.memoizedState=rb(l),e.memoizedState=ib,o);if(!(e.mode&1))return ax(n,e,l,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var h=i.dgst;return i=h,o=Error(he(419)),i=iv(o,i,void 0),ax(n,e,l,i)}if(h=(l&n.childLanes)!==0,Qi||h){if(i=Wn,i!==null){switch(l&-l){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|l)?0:r,r!==0&&r!==o.retryLane&&(o.retryLane=r,ya(n,r),Ps(i,n,r,-1))}return LC(),i=iv(Error(he(421))),ax(n,e,l,i)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=FP.bind(null,n),r._reactRetry=e,null):(n=o.treeContext,Tr=Hl(r.nextSibling),Ir=e,Xt=!0,Ns=null,n!==null&&(Qr[Jr++]=fa,Qr[Jr++]=ga,Qr[Jr++]=eh,fa=n.id,ga=n.overflow,eh=e),e=RC(e,i.children),e.flags|=4096,e)}function _3(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),Zv(n.return,e,t)}function rv(n,e,t,i,r){var o=n.memoizedState;o===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:r}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=t,o.tailMode=r)}function MI(n,e,t){var i=e.pendingProps,r=i.revealOrder,o=i.tail;if(Ni(n,e,i.children,t),i=qt.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&_3(n,t,e);else if(n.tag===19)_3(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(Dt(qt,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&N2(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),rv(e,!1,r,t,o);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&N2(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}rv(e,!0,t,null,o);break;case"together":rv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function kx(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Aa(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),nh|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(he(153));if(e.child!==null){for(n=e.child,t=Xl(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Xl(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function _P(n,e,t){switch(e.tag){case 3:PI(e),l0();break;case 5:oI(e);break;case 1:er(e.type)&&E2(e);break;case 4:bC(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Dt(_2,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Dt(qt,qt.current&1),e.flags|=128,null):t&e.child.childLanes?DI(n,e,t):(Dt(qt,qt.current&1),n=Aa(n,e,t),n!==null?n.sibling:null);Dt(qt,qt.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return MI(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Dt(qt,qt.current),i)break;return null;case 22:case 23:return e.lanes=0,RI(n,e,t)}return Aa(n,e,t)}var OI,sb,LI,BI;OI=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};sb=function(){};LI=function(n,e,t,i){var r=n.memoizedProps;if(r!==i){n=e.stateNode,vc(vo.current);var o=null;switch(t){case"input":r=Tv(n,r),i=Tv(n,i),o=[];break;case"select":r=en({},r,{value:void 0}),i=en({},i,{value:void 0}),o=[];break;case"textarea":r=Rv(n,r),i=Rv(n,i),o=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=v2)}Pv(t,i);var l;t=null;for(p in r)if(!i.hasOwnProperty(p)&&r.hasOwnProperty(p)&&r[p]!=null)if(p==="style"){var h=r[p];for(l in h)h.hasOwnProperty(l)&&(t||(t={}),t[l]="")}else p!=="dangerouslySetInnerHTML"&&p!=="children"&&p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(S1.hasOwnProperty(p)?o||(o=[]):(o=o||[]).push(p,null));for(p in i){var g=i[p];if(h=r!=null?r[p]:void 0,i.hasOwnProperty(p)&&g!==h&&(g!=null||h!=null))if(p==="style")if(h){for(l in h)!h.hasOwnProperty(l)||g&&g.hasOwnProperty(l)||(t||(t={}),t[l]="");for(l in g)g.hasOwnProperty(l)&&h[l]!==g[l]&&(t||(t={}),t[l]=g[l])}else t||(o||(o=[]),o.push(p,t)),t=g;else p==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,h=h?h.__html:void 0,g!=null&&h!==g&&(o=o||[]).push(p,g)):p==="children"?typeof g!="string"&&typeof g!="number"||(o=o||[]).push(p,""+g):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&(S1.hasOwnProperty(p)?(g!=null&&p==="onScroll"&&Lt("scroll",n),o||h===g||(o=[])):(o=o||[]).push(p,g))}t&&(o=o||[]).push("style",t);var p=o;(e.updateQueue=p)&&(e.flags|=4)}};BI=function(n,e,t,i){t!==i&&(e.flags|=4)};function B0(n,e){if(!Xt)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function ci(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function TP(n,e,t){var i=e.pendingProps;switch(pC(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ci(e),null;case 1:return er(e.type)&&b2(),ci(e),null;case 3:return i=e.stateNode,u0(),Ft(Ji),Ft(Ai),CC(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(sx(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ns!==null&&(fb(Ns),Ns=null))),sb(n,e),ci(e),null;case 5:EC(e);var r=vc(B1.current);if(t=e.type,n!==null&&e.stateNode!=null)LI(n,e,t,i,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(he(166));return ci(e),null}if(n=vc(vo.current),sx(e)){i=e.stateNode,t=e.type;var o=e.memoizedProps;switch(i[wo]=e,i[O1]=o,n=(e.mode&1)!==0,t){case"dialog":Lt("cancel",i),Lt("close",i);break;case"iframe":case"object":case"embed":Lt("load",i);break;case"video":case"audio":for(r=0;r<Y0.length;r++)Lt(Y0[r],i);break;case"source":Lt("error",i);break;case"img":case"image":case"link":Lt("error",i),Lt("load",i);break;case"details":Lt("toggle",i);break;case"input":OS(i,o),Lt("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},Lt("invalid",i);break;case"textarea":BS(i,o),Lt("invalid",i)}Pv(t,o),r=null;for(var l in o)if(o.hasOwnProperty(l)){var h=o[l];l==="children"?typeof h=="string"?i.textContent!==h&&(o.suppressHydrationWarning!==!0&&rx(i.textContent,h,n),r=["children",h]):typeof h=="number"&&i.textContent!==""+h&&(o.suppressHydrationWarning!==!0&&rx(i.textContent,h,n),r=["children",""+h]):S1.hasOwnProperty(l)&&h!=null&&l==="onScroll"&&Lt("scroll",i)}switch(t){case"input":qm(i),LS(i,o,!0);break;case"textarea":qm(i),FS(i);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(i.onclick=v2)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{l=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=hT(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=l.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=l.createElement(t,{is:i.is}):(n=l.createElement(t),t==="select"&&(l=n,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):n=l.createElementNS(n,t),n[wo]=e,n[O1]=i,OI(n,e,!1,!1),e.stateNode=n;e:{switch(l=Dv(t,i),t){case"dialog":Lt("cancel",n),Lt("close",n),r=i;break;case"iframe":case"object":case"embed":Lt("load",n),r=i;break;case"video":case"audio":for(r=0;r<Y0.length;r++)Lt(Y0[r],n);r=i;break;case"source":Lt("error",n),r=i;break;case"img":case"image":case"link":Lt("error",n),Lt("load",n),r=i;break;case"details":Lt("toggle",n),r=i;break;case"input":OS(n,i),r=Tv(n,i),Lt("invalid",n);break;case"option":r=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},r=en({},i,{value:void 0}),Lt("invalid",n);break;case"textarea":BS(n,i),r=Rv(n,i),Lt("invalid",n);break;default:r=i}Pv(t,r),h=r;for(o in h)if(h.hasOwnProperty(o)){var g=h[o];o==="style"?gT(n,g):o==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,g!=null&&dT(n,g)):o==="children"?typeof g=="string"?(t!=="textarea"||g!=="")&&_1(n,g):typeof g=="number"&&_1(n,""+g):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(S1.hasOwnProperty(o)?g!=null&&o==="onScroll"&&Lt("scroll",n):g!=null&&eC(n,o,g,l))}switch(t){case"input":qm(n),LS(n,i,!1);break;case"textarea":qm(n),FS(n);break;case"option":i.value!=null&&n.setAttribute("value",""+$l(i.value));break;case"select":n.multiple=!!i.multiple,o=i.value,o!=null?Zh(n,!!i.multiple,o,!1):i.defaultValue!=null&&Zh(n,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=v2)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ci(e),null;case 6:if(n&&e.stateNode!=null)BI(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(he(166));if(t=vc(B1.current),vc(vo.current),sx(e)){if(i=e.stateNode,t=e.memoizedProps,i[wo]=e,(o=i.nodeValue!==t)&&(n=Ir,n!==null))switch(n.tag){case 3:rx(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&rx(i.nodeValue,t,(n.mode&1)!==0)}o&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[wo]=e,e.stateNode=i}return ci(e),null;case 13:if(Ft(qt),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Xt&&Tr!==null&&e.mode&1&&!(e.flags&128))tI(),l0(),e.flags|=98560,o=!1;else if(o=sx(e),i!==null&&i.dehydrated!==null){if(n===null){if(!o)throw Error(he(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(he(317));o[wo]=e}else l0(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ci(e),o=!1}else Ns!==null&&(fb(Ns),Ns=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||qt.current&1?Pn===0&&(Pn=3):LC())),e.updateQueue!==null&&(e.flags|=4),ci(e),null);case 4:return u0(),sb(n,e),n===null&&D1(e.stateNode.containerInfo),ci(e),null;case 10:return yC(e.type._context),ci(e),null;case 17:return er(e.type)&&b2(),ci(e),null;case 19:if(Ft(qt),o=e.memoizedState,o===null)return ci(e),null;if(i=(e.flags&128)!==0,l=o.rendering,l===null)if(i)B0(o,!1);else{if(Pn!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(l=N2(n),l!==null){for(e.flags|=128,B0(o,!1),i=l.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)o=t,n=i,o.flags&=14680066,l=o.alternate,l===null?(o.childLanes=0,o.lanes=n,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,n=l.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Dt(qt,qt.current&1|2),e.child}n=n.sibling}o.tail!==null&&wn()>d0&&(e.flags|=128,i=!0,B0(o,!1),e.lanes=4194304)}else{if(!i)if(n=N2(l),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),B0(o,!0),o.tail===null&&o.tailMode==="hidden"&&!l.alternate&&!Xt)return ci(e),null}else 2*wn()-o.renderingStartTime>d0&&t!==1073741824&&(e.flags|=128,i=!0,B0(o,!1),e.lanes=4194304);o.isBackwards?(l.sibling=e.child,e.child=l):(t=o.last,t!==null?t.sibling=l:e.child=l,o.last=l)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=wn(),e.sibling=null,t=qt.current,Dt(qt,i?t&1|2:t&1),e):(ci(e),null);case 22:case 23:return OC(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Sr&1073741824&&(ci(e),e.subtreeFlags&6&&(e.flags|=8192)):ci(e),null;case 24:return null;case 25:return null}throw Error(he(156,e.tag))}function IP(n,e){switch(pC(e),e.tag){case 1:return er(e.type)&&b2(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return u0(),Ft(Ji),Ft(Ai),CC(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return EC(e),null;case 13:if(Ft(qt),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(he(340));l0()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Ft(qt),null;case 4:return u0(),null;case 10:return yC(e.type._context),null;case 22:case 23:return OC(),null;case 24:return null;default:return null}}var lx=!1,wi=!1,NP=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function Hh(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){un(n,e,i)}else t.current=null}function ob(n,e,t){try{t()}catch(i){un(n,e,i)}}var T3=!1;function RP(n,e){if(Vv=w2,n=HT(),fC(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{t.nodeType,o.nodeType}catch{t=null;break e}var l=0,h=-1,g=-1,p=0,x=0,y=n,v=null;t:for(;;){for(var C;y!==t||r!==0&&y.nodeType!==3||(h=l+r),y!==o||i!==0&&y.nodeType!==3||(g=l+i),y.nodeType===3&&(l+=y.nodeValue.length),(C=y.firstChild)!==null;)v=y,y=C;for(;;){if(y===n)break t;if(v===t&&++p===r&&(h=l),v===o&&++x===i&&(g=l),(C=y.nextSibling)!==null)break;y=v,v=y.parentNode}y=C}t=h===-1||g===-1?null:{start:h,end:g}}else t=null}t=t||{start:0,end:0}}else t=null;for(Wv={focusedElem:n,selectionRange:t},w2=!1,Ce=e;Ce!==null;)if(e=Ce,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Ce=n;else for(;Ce!==null;){e=Ce;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var I=R.memoizedProps,O=R.memoizedState,_=e.stateNode,N=_.getSnapshotBeforeUpdate(e.elementType===e.type?I:fs(e.type,I),O);_.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var k=e.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(he(163))}}catch(B){un(e,e.return,B)}if(n=e.sibling,n!==null){n.return=e.return,Ce=n;break}Ce=e.return}return R=T3,T3=!1,R}function v1(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&n)===n){var o=r.destroy;r.destroy=void 0,o!==void 0&&ob(e,t,o)}r=r.next}while(r!==i)}}function Zy(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function ab(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function FI(n){var e=n.alternate;e!==null&&(n.alternate=null,FI(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[wo],delete e[O1],delete e[Yv],delete e[dP],delete e[fP])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function UI(n){return n.tag===5||n.tag===3||n.tag===4}function I3(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||UI(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function lb(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=v2));else if(i!==4&&(n=n.child,n!==null))for(lb(n,e,t),n=n.sibling;n!==null;)lb(n,e,t),n=n.sibling}function cb(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(cb(n,e,t),n=n.sibling;n!==null;)cb(n,e,t),n=n.sibling}var ni=null,Is=!1;function ka(n,e,t){for(t=t.child;t!==null;)jI(n,e,t),t=t.sibling}function jI(n,e,t){if(Ao&&typeof Ao.onCommitFiberUnmount=="function")try{Ao.onCommitFiberUnmount(Vy,t)}catch{}switch(t.tag){case 5:wi||Hh(t,e);case 6:var i=ni,r=Is;ni=null,ka(n,e,t),ni=i,Is=r,ni!==null&&(Is?(n=ni,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):ni.removeChild(t.stateNode));break;case 18:ni!==null&&(Is?(n=ni,t=t.stateNode,n.nodeType===8?ZA(n.parentNode,t):n.nodeType===1&&ZA(n,t),R1(n)):ZA(ni,t.stateNode));break;case 4:i=ni,r=Is,ni=t.stateNode.containerInfo,Is=!0,ka(n,e,t),ni=i,Is=r;break;case 0:case 11:case 14:case 15:if(!wi&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var o=r,l=o.destroy;o=o.tag,l!==void 0&&(o&2||o&4)&&ob(t,e,l),r=r.next}while(r!==i)}ka(n,e,t);break;case 1:if(!wi&&(Hh(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(h){un(t,e,h)}ka(n,e,t);break;case 21:ka(n,e,t);break;case 22:t.mode&1?(wi=(i=wi)||t.memoizedState!==null,ka(n,e,t),wi=i):ka(n,e,t);break;default:ka(n,e,t)}}function N3(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new NP),e.forEach(function(i){var r=UP.bind(null,n,i);t.has(i)||(t.add(i),i.then(r,r))})}}function us(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var r=t[i];try{var o=n,l=e,h=l;e:for(;h!==null;){switch(h.tag){case 5:ni=h.stateNode,Is=!1;break e;case 3:ni=h.stateNode.containerInfo,Is=!0;break e;case 4:ni=h.stateNode.containerInfo,Is=!0;break e}h=h.return}if(ni===null)throw Error(he(160));jI(o,l,r),ni=null,Is=!1;var g=r.alternate;g!==null&&(g.return=null),r.return=null}catch(p){un(r,e,p)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)zI(e,n),e=e.sibling}function zI(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(us(e,n),Hs(n),i&4){try{v1(3,n,n.return),Zy(3,n)}catch(I){un(n,n.return,I)}try{v1(5,n,n.return)}catch(I){un(n,n.return,I)}}break;case 1:us(e,n),Hs(n),i&512&&t!==null&&Hh(t,t.return);break;case 5:if(us(e,n),Hs(n),i&512&&t!==null&&Hh(t,t.return),n.flags&32){var r=n.stateNode;try{_1(r,"")}catch(I){un(n,n.return,I)}}if(i&4&&(r=n.stateNode,r!=null)){var o=n.memoizedProps,l=t!==null?t.memoizedProps:o,h=n.type,g=n.updateQueue;if(n.updateQueue=null,g!==null)try{h==="input"&&o.type==="radio"&&o.name!=null&&cT(r,o),Dv(h,l);var p=Dv(h,o);for(l=0;l<g.length;l+=2){var x=g[l],y=g[l+1];x==="style"?gT(r,y):x==="dangerouslySetInnerHTML"?dT(r,y):x==="children"?_1(r,y):eC(r,x,y,p)}switch(h){case"input":Iv(r,o);break;case"textarea":uT(r,o);break;case"select":var v=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var C=o.value;C!=null?Zh(r,!!o.multiple,C,!1):v!==!!o.multiple&&(o.defaultValue!=null?Zh(r,!!o.multiple,o.defaultValue,!0):Zh(r,!!o.multiple,o.multiple?[]:"",!1))}r[O1]=o}catch(I){un(n,n.return,I)}}break;case 6:if(us(e,n),Hs(n),i&4){if(n.stateNode===null)throw Error(he(162));r=n.stateNode,o=n.memoizedProps;try{r.nodeValue=o}catch(I){un(n,n.return,I)}}break;case 3:if(us(e,n),Hs(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{R1(e.containerInfo)}catch(I){un(n,n.return,I)}break;case 4:us(e,n),Hs(n);break;case 13:us(e,n),Hs(n),r=n.child,r.flags&8192&&(o=r.memoizedState!==null,r.stateNode.isHidden=o,!o||r.alternate!==null&&r.alternate.memoizedState!==null||(DC=wn())),i&4&&N3(n);break;case 22:if(x=t!==null&&t.memoizedState!==null,n.mode&1?(wi=(p=wi)||x,us(e,n),wi=p):us(e,n),Hs(n),i&8192){if(p=n.memoizedState!==null,(n.stateNode.isHidden=p)&&!x&&n.mode&1)for(Ce=n,x=n.child;x!==null;){for(y=Ce=x;Ce!==null;){switch(v=Ce,C=v.child,v.tag){case 0:case 11:case 14:case 15:v1(4,v,v.return);break;case 1:Hh(v,v.return);var R=v.stateNode;if(typeof R.componentWillUnmount=="function"){i=v,t=v.return;try{e=i,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(I){un(i,t,I)}}break;case 5:Hh(v,v.return);break;case 22:if(v.memoizedState!==null){k3(y);continue}}C!==null?(C.return=v,Ce=C):k3(y)}x=x.sibling}e:for(x=null,y=n;;){if(y.tag===5){if(x===null){x=y;try{r=y.stateNode,p?(o=r.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(h=y.stateNode,g=y.memoizedProps.style,l=g!=null&&g.hasOwnProperty("display")?g.display:null,h.style.display=fT("display",l))}catch(I){un(n,n.return,I)}}}else if(y.tag===6){if(x===null)try{y.stateNode.nodeValue=p?"":y.memoizedProps}catch(I){un(n,n.return,I)}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===n)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===n)break e;for(;y.sibling===null;){if(y.return===null||y.return===n)break e;x===y&&(x=null),y=y.return}x===y&&(x=null),y.sibling.return=y.return,y=y.sibling}}break;case 19:us(e,n),Hs(n),i&4&&N3(n);break;case 21:break;default:us(e,n),Hs(n)}}function Hs(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(UI(t)){var i=t;break e}t=t.return}throw Error(he(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(_1(r,""),i.flags&=-33);var o=I3(n);cb(n,o,r);break;case 3:case 4:var l=i.stateNode.containerInfo,h=I3(n);lb(n,h,l);break;default:throw Error(he(161))}}catch(g){un(n,n.return,g)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function kP(n,e,t){Ce=n,HI(n)}function HI(n,e,t){for(var i=(n.mode&1)!==0;Ce!==null;){var r=Ce,o=r.child;if(r.tag===22&&i){var l=r.memoizedState!==null||lx;if(!l){var h=r.alternate,g=h!==null&&h.memoizedState!==null||wi;h=lx;var p=wi;if(lx=l,(wi=g)&&!p)for(Ce=r;Ce!==null;)l=Ce,g=l.child,l.tag===22&&l.memoizedState!==null?P3(r):g!==null?(g.return=l,Ce=g):P3(r);for(;o!==null;)Ce=o,HI(o),o=o.sibling;Ce=r,lx=h,wi=p}R3(n)}else r.subtreeFlags&8772&&o!==null?(o.return=r,Ce=o):R3(n)}}function R3(n){for(;Ce!==null;){var e=Ce;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:wi||Zy(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!wi)if(t===null)i.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:fs(e.type,t.memoizedProps);i.componentDidUpdate(r,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&g3(e,o,i);break;case 3:var l=e.updateQueue;if(l!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}g3(e,l,t)}break;case 5:var h=e.stateNode;if(t===null&&e.flags&4){t=h;var g=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":g.autoFocus&&t.focus();break;case"img":g.src&&(t.src=g.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var p=e.alternate;if(p!==null){var x=p.memoizedState;if(x!==null){var y=x.dehydrated;y!==null&&R1(y)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(he(163))}wi||e.flags&512&&ab(e)}catch(v){un(e,e.return,v)}}if(e===n){Ce=null;break}if(t=e.sibling,t!==null){t.return=e.return,Ce=t;break}Ce=e.return}}function k3(n){for(;Ce!==null;){var e=Ce;if(e===n){Ce=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Ce=t;break}Ce=e.return}}function P3(n){for(;Ce!==null;){var e=Ce;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Zy(4,e)}catch(g){un(e,t,g)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(g){un(e,r,g)}}var o=e.return;try{ab(e)}catch(g){un(e,o,g)}break;case 5:var l=e.return;try{ab(e)}catch(g){un(e,l,g)}}}catch(g){un(e,e.return,g)}if(e===n){Ce=null;break}var h=e.sibling;if(h!==null){h.return=e.return,Ce=h;break}Ce=e.return}}var PP=Math.ceil,P2=Ea.ReactCurrentDispatcher,kC=Ea.ReactCurrentOwner,is=Ea.ReactCurrentBatchConfig,lt=0,Wn=null,En=null,ri=0,Sr=0,Vh=ec(0),Pn=0,z1=null,nh=0,Qy=0,PC=0,b1=null,Zi=null,DC=0,d0=1/0,_o=null,D2=!1,ub=null,Wl=null,cx=!1,Fl=null,M2=0,E1=0,hb=null,Px=-1,Dx=0;function Ri(){return lt&6?wn():Px!==-1?Px:Px=wn()}function Gl(n){return n.mode&1?lt&2&&ri!==0?ri&-ri:pP.transition!==null?(Dx===0&&(Dx=_T()),Dx):(n=mt,n!==0||(n=window.event,n=n===void 0?16:DT(n.type)),n):1}function Ps(n,e,t,i){if(50<E1)throw E1=0,hb=null,Error(he(185));_m(n,t,i),(!(lt&2)||n!==Wn)&&(n===Wn&&(!(lt&2)&&(Qy|=t),Pn===4&&La(n,ri)),tr(n,i),t===1&&lt===0&&!(e.mode&1)&&(d0=wn()+500,$y&&tc()))}function tr(n,e){var t=n.callbackNode;pk(n,e);var i=x2(n,n===Wn?ri:0);if(i===0)t!==null&&zS(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&zS(t),e===1)n.tag===0?gP(D3.bind(null,n)):QT(D3.bind(null,n)),uP(function(){!(lt&6)&&tc()}),t=null;else{switch(TT(i)){case 1:t=sC;break;case 4:t=CT;break;case 16:t=m2;break;case 536870912:t=ST;break;default:t=m2}t=qI(t,VI.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function VI(n,e){if(Px=-1,Dx=0,lt&6)throw Error(he(327));var t=n.callbackNode;if(nd()&&n.callbackNode!==t)return null;var i=x2(n,n===Wn?ri:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=O2(n,i);else{e=i;var r=lt;lt|=2;var o=GI();(Wn!==n||ri!==e)&&(_o=null,d0=wn()+500,qu(n,e));do try{OP();break}catch(h){WI(n,h)}while(1);wC(),P2.current=o,lt=r,En!==null?e=0:(Wn=null,ri=0,e=Pn)}if(e!==0){if(e===2&&(r=Fv(n),r!==0&&(i=r,e=db(n,r))),e===1)throw t=z1,qu(n,0),La(n,i),tr(n,wn()),t;if(e===6)La(n,i);else{if(r=n.current.alternate,!(i&30)&&!DP(r)&&(e=O2(n,i),e===2&&(o=Fv(n),o!==0&&(i=o,e=db(n,o))),e===1))throw t=z1,qu(n,0),La(n,i),tr(n,wn()),t;switch(n.finishedWork=r,n.finishedLanes=i,e){case 0:case 1:throw Error(he(345));case 2:dc(n,Zi,_o);break;case 3:if(La(n,i),(i&130023424)===i&&(e=DC+500-wn(),10<e)){if(x2(n,0)!==0)break;if(r=n.suspendedLanes,(r&i)!==i){Ri(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=Xv(dc.bind(null,n,Zi,_o),e);break}dc(n,Zi,_o);break;case 4:if(La(n,i),(i&4194240)===i)break;for(e=n.eventTimes,r=-1;0<i;){var l=31-ks(i);o=1<<l,l=e[l],l>r&&(r=l),i&=~o}if(i=r,i=wn()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*PP(i/1960))-i,10<i){n.timeoutHandle=Xv(dc.bind(null,n,Zi,_o),i);break}dc(n,Zi,_o);break;case 5:dc(n,Zi,_o);break;default:throw Error(he(329))}}}return tr(n,wn()),n.callbackNode===t?VI.bind(null,n):null}function db(n,e){var t=b1;return n.current.memoizedState.isDehydrated&&(qu(n,e).flags|=256),n=O2(n,e),n!==2&&(e=Zi,Zi=t,e!==null&&fb(e)),n}function fb(n){Zi===null?Zi=n:Zi.push.apply(Zi,n)}function DP(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var r=t[i],o=r.getSnapshot;r=r.value;try{if(!Ds(o(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function La(n,e){for(e&=~PC,e&=~Qy,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-ks(e),i=1<<t;n[t]=-1,e&=~i}}function D3(n){if(lt&6)throw Error(he(327));nd();var e=x2(n,0);if(!(e&1))return tr(n,wn()),null;var t=O2(n,e);if(n.tag!==0&&t===2){var i=Fv(n);i!==0&&(e=i,t=db(n,i))}if(t===1)throw t=z1,qu(n,0),La(n,e),tr(n,wn()),t;if(t===6)throw Error(he(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,dc(n,Zi,_o),tr(n,wn()),null}function MC(n,e){var t=lt;lt|=1;try{return n(e)}finally{lt=t,lt===0&&(d0=wn()+500,$y&&tc())}}function ih(n){Fl!==null&&Fl.tag===0&&!(lt&6)&&nd();var e=lt;lt|=1;var t=is.transition,i=mt;try{if(is.transition=null,mt=1,n)return n()}finally{mt=i,is.transition=t,lt=e,!(lt&6)&&tc()}}function OC(){Sr=Vh.current,Ft(Vh)}function qu(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,cP(t)),En!==null)for(t=En.return;t!==null;){var i=t;switch(pC(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&b2();break;case 3:u0(),Ft(Ji),Ft(Ai),CC();break;case 5:EC(i);break;case 4:u0();break;case 13:Ft(qt);break;case 19:Ft(qt);break;case 10:yC(i.type._context);break;case 22:case 23:OC()}t=t.return}if(Wn=n,En=n=Xl(n.current,null),ri=Sr=e,Pn=0,z1=null,PC=Qy=nh=0,Zi=b1=null,Ac!==null){for(e=0;e<Ac.length;e++)if(t=Ac[e],i=t.interleaved,i!==null){t.interleaved=null;var r=i.next,o=t.pending;if(o!==null){var l=o.next;o.next=r,i.next=l}t.pending=i}Ac=null}return n}function WI(n,e){do{var t=En;try{if(wC(),Nx.current=k2,R2){for(var i=Qt.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}R2=!1}if(th=0,Vn=kn=Qt=null,A1=!1,F1=0,kC.current=null,t===null||t.return===null){Pn=1,z1=e,En=null;break}e:{var o=n,l=t.return,h=t,g=e;if(e=ri,h.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){var p=g,x=h,y=x.tag;if(!(x.mode&1)&&(y===0||y===11||y===15)){var v=x.alternate;v?(x.updateQueue=v.updateQueue,x.memoizedState=v.memoizedState,x.lanes=v.lanes):(x.updateQueue=null,x.memoizedState=null)}var C=A3(l);if(C!==null){C.flags&=-257,v3(C,l,h,o,e),C.mode&1&&y3(o,p,e),e=C,g=p;var R=e.updateQueue;if(R===null){var I=new Set;I.add(g),e.updateQueue=I}else R.add(g);break e}else{if(!(e&1)){y3(o,p,e),LC();break e}g=Error(he(426))}}else if(Xt&&h.mode&1){var O=A3(l);if(O!==null){!(O.flags&65536)&&(O.flags|=256),v3(O,l,h,o,e),mC(h0(g,h));break e}}o=g=h0(g,h),Pn!==4&&(Pn=2),b1===null?b1=[o]:b1.push(o),o=l;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var _=TI(o,g,e);f3(o,_);break e;case 1:h=g;var N=o.type,k=o.stateNode;if(!(o.flags&128)&&(typeof N.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Wl===null||!Wl.has(k)))){o.flags|=65536,e&=-e,o.lanes|=e;var B=II(o,h,e);f3(o,B);break e}}o=o.return}while(o!==null)}YI(t)}catch(z){e=z,En===t&&t!==null&&(En=t=t.return);continue}break}while(1)}function GI(){var n=P2.current;return P2.current=k2,n===null?k2:n}function LC(){(Pn===0||Pn===3||Pn===2)&&(Pn=4),Wn===null||!(nh&268435455)&&!(Qy&268435455)||La(Wn,ri)}function O2(n,e){var t=lt;lt|=2;var i=GI();(Wn!==n||ri!==e)&&(_o=null,qu(n,e));do try{MP();break}catch(r){WI(n,r)}while(1);if(wC(),lt=t,P2.current=i,En!==null)throw Error(he(261));return Wn=null,ri=0,Pn}function MP(){for(;En!==null;)XI(En)}function OP(){for(;En!==null&&!ok();)XI(En)}function XI(n){var e=KI(n.alternate,n,Sr);n.memoizedProps=n.pendingProps,e===null?YI(n):En=e,kC.current=null}function YI(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=IP(t,e),t!==null){t.flags&=32767,En=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Pn=6,En=null;return}}else if(t=TP(t,e,Sr),t!==null){En=t;return}if(e=e.sibling,e!==null){En=e;return}En=e=n}while(e!==null);Pn===0&&(Pn=5)}function dc(n,e,t){var i=mt,r=is.transition;try{is.transition=null,mt=1,LP(n,e,t,i)}finally{is.transition=r,mt=i}return null}function LP(n,e,t,i){do nd();while(Fl!==null);if(lt&6)throw Error(he(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(he(177));n.callbackNode=null,n.callbackPriority=0;var o=t.lanes|t.childLanes;if(mk(n,o),n===Wn&&(En=Wn=null,ri=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||cx||(cx=!0,qI(m2,function(){return nd(),null})),o=(t.flags&15990)!==0,t.subtreeFlags&15990||o){o=is.transition,is.transition=null;var l=mt;mt=1;var h=lt;lt|=4,kC.current=null,RP(n,t),zI(t,n),nP(Wv),w2=!!Vv,Wv=Vv=null,n.current=t,kP(t),ak(),lt=h,mt=l,is.transition=o}else n.current=t;if(cx&&(cx=!1,Fl=n,M2=r),o=n.pendingLanes,o===0&&(Wl=null),uk(t.stateNode),tr(n,wn()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],i(r.value,{componentStack:r.stack,digest:r.digest});if(D2)throw D2=!1,n=ub,ub=null,n;return M2&1&&n.tag!==0&&nd(),o=n.pendingLanes,o&1?n===hb?E1++:(E1=0,hb=n):E1=0,tc(),null}function nd(){if(Fl!==null){var n=TT(M2),e=is.transition,t=mt;try{if(is.transition=null,mt=16>n?16:n,Fl===null)var i=!1;else{if(n=Fl,Fl=null,M2=0,lt&6)throw Error(he(331));var r=lt;for(lt|=4,Ce=n.current;Ce!==null;){var o=Ce,l=o.child;if(Ce.flags&16){var h=o.deletions;if(h!==null){for(var g=0;g<h.length;g++){var p=h[g];for(Ce=p;Ce!==null;){var x=Ce;switch(x.tag){case 0:case 11:case 15:v1(8,x,o)}var y=x.child;if(y!==null)y.return=x,Ce=y;else for(;Ce!==null;){x=Ce;var v=x.sibling,C=x.return;if(FI(x),x===p){Ce=null;break}if(v!==null){v.return=C,Ce=v;break}Ce=C}}}var R=o.alternate;if(R!==null){var I=R.child;if(I!==null){R.child=null;do{var O=I.sibling;I.sibling=null,I=O}while(I!==null)}}Ce=o}}if(o.subtreeFlags&2064&&l!==null)l.return=o,Ce=l;else e:for(;Ce!==null;){if(o=Ce,o.flags&2048)switch(o.tag){case 0:case 11:case 15:v1(9,o,o.return)}var _=o.sibling;if(_!==null){_.return=o.return,Ce=_;break e}Ce=o.return}}var N=n.current;for(Ce=N;Ce!==null;){l=Ce;var k=l.child;if(l.subtreeFlags&2064&&k!==null)k.return=l,Ce=k;else e:for(l=N;Ce!==null;){if(h=Ce,h.flags&2048)try{switch(h.tag){case 0:case 11:case 15:Zy(9,h)}}catch(z){un(h,h.return,z)}if(h===l){Ce=null;break e}var B=h.sibling;if(B!==null){B.return=h.return,Ce=B;break e}Ce=h.return}}if(lt=r,tc(),Ao&&typeof Ao.onPostCommitFiberRoot=="function")try{Ao.onPostCommitFiberRoot(Vy,n)}catch{}i=!0}return i}finally{mt=t,is.transition=e}}return!1}function M3(n,e,t){e=h0(t,e),e=TI(n,e,1),n=Vl(n,e,1),e=Ri(),n!==null&&(_m(n,1,e),tr(n,e))}function un(n,e,t){if(n.tag===3)M3(n,n,t);else for(;e!==null;){if(e.tag===3){M3(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Wl===null||!Wl.has(i))){n=h0(t,n),n=II(e,n,1),e=Vl(e,n,1),n=Ri(),e!==null&&(_m(e,1,n),tr(e,n));break}}e=e.return}}function BP(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=Ri(),n.pingedLanes|=n.suspendedLanes&t,Wn===n&&(ri&t)===t&&(Pn===4||Pn===3&&(ri&130023424)===ri&&500>wn()-DC?qu(n,0):PC|=t),tr(n,e)}function $I(n,e){e===0&&(n.mode&1?(e=Jm,Jm<<=1,!(Jm&130023424)&&(Jm=4194304)):e=1);var t=Ri();n=ya(n,e),n!==null&&(_m(n,e,t),tr(n,t))}function FP(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),$I(n,t)}function UP(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(he(314))}i!==null&&i.delete(e),$I(n,t)}var KI;KI=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Ji.current)Qi=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Qi=!1,_P(n,e,t);Qi=!!(n.flags&131072)}else Qi=!1,Xt&&e.flags&1048576&&JT(e,S2,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;kx(n,e),n=e.pendingProps;var r=a0(e,Ai.current);td(e,t),r=_C(null,e,i,n,r,t);var o=TC();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,er(i)?(o=!0,E2(e)):o=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,vC(e),r.updater=qy,e.stateNode=r,r._reactInternals=e,Jv(e,i,n,t),e=nb(null,e,i,!0,o,t)):(e.tag=0,Xt&&o&&gC(e),Ni(null,e,r,t),e=e.child),e;case 16:i=e.elementType;e:{switch(kx(n,e),n=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=zP(i),n=fs(i,n),r){case 0:e=tb(null,e,i,n,t);break e;case 1:e=C3(null,e,i,n,t);break e;case 11:e=b3(null,e,i,n,t);break e;case 14:e=E3(null,e,i,fs(i.type,n),t);break e}throw Error(he(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:fs(i,r),tb(n,e,i,r,t);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:fs(i,r),C3(n,e,i,r,t);case 3:e:{if(PI(e),n===null)throw Error(he(387));i=e.pendingProps,o=e.memoizedState,r=o.element,sI(n,e),I2(e,i,null,t);var l=e.memoizedState;if(i=l.element,o.isDehydrated)if(o={element:i,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){r=h0(Error(he(423)),e),e=S3(n,e,i,t,r);break e}else if(i!==r){r=h0(Error(he(424)),e),e=S3(n,e,i,t,r);break e}else for(Tr=Hl(e.stateNode.containerInfo.firstChild),Ir=e,Xt=!0,Ns=null,t=iI(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(l0(),i===r){e=Aa(n,e,t);break e}Ni(n,e,i,t)}e=e.child}return e;case 5:return oI(e),n===null&&qv(e),i=e.type,r=e.pendingProps,o=n!==null?n.memoizedProps:null,l=r.children,Gv(i,r)?l=null:o!==null&&Gv(i,o)&&(e.flags|=32),kI(n,e),Ni(n,e,l,t),e.child;case 6:return n===null&&qv(e),null;case 13:return DI(n,e,t);case 4:return bC(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=c0(e,null,i,t):Ni(n,e,i,t),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:fs(i,r),b3(n,e,i,r,t);case 7:return Ni(n,e,e.pendingProps,t),e.child;case 8:return Ni(n,e,e.pendingProps.children,t),e.child;case 12:return Ni(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,o=e.memoizedProps,l=r.value,Dt(_2,i._currentValue),i._currentValue=l,o!==null)if(Ds(o.value,l)){if(o.children===r.children&&!Ji.current){e=Aa(n,e,t);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var h=o.dependencies;if(h!==null){l=o.child;for(var g=h.firstContext;g!==null;){if(g.context===i){if(o.tag===1){g=pa(-1,t&-t),g.tag=2;var p=o.updateQueue;if(p!==null){p=p.shared;var x=p.pending;x===null?g.next=g:(g.next=x.next,x.next=g),p.pending=g}}o.lanes|=t,g=o.alternate,g!==null&&(g.lanes|=t),Zv(o.return,t,e),h.lanes|=t;break}g=g.next}}else if(o.tag===10)l=o.type===e.type?null:o.child;else if(o.tag===18){if(l=o.return,l===null)throw Error(he(341));l.lanes|=t,h=l.alternate,h!==null&&(h.lanes|=t),Zv(l,t,e),l=o.sibling}else l=o.child;if(l!==null)l.return=o;else for(l=o;l!==null;){if(l===e){l=null;break}if(o=l.sibling,o!==null){o.return=l.return,l=o;break}l=l.return}o=l}Ni(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,td(e,t),r=rs(r),i=i(r),e.flags|=1,Ni(n,e,i,t),e.child;case 14:return i=e.type,r=fs(i,e.pendingProps),r=fs(i.type,r),E3(n,e,i,r,t);case 15:return NI(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:fs(i,r),kx(n,e),e.tag=1,er(i)?(n=!0,E2(e)):n=!1,td(e,t),_I(e,i,r),Jv(e,i,r,t),nb(null,e,i,!0,n,t);case 19:return MI(n,e,t);case 22:return RI(n,e,t)}throw Error(he(156,e.tag))};function qI(n,e){return ET(n,e)}function jP(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ts(n,e,t,i){return new jP(n,e,t,i)}function BC(n){return n=n.prototype,!(!n||!n.isReactComponent)}function zP(n){if(typeof n=="function")return BC(n)?1:0;if(n!=null){if(n=n.$$typeof,n===nC)return 11;if(n===iC)return 14}return 2}function Xl(n,e){var t=n.alternate;return t===null?(t=ts(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Mx(n,e,t,i,r,o){var l=2;if(i=n,typeof n=="function")BC(n)&&(l=1);else if(typeof n=="string")l=5;else e:switch(n){case Dh:return Zu(t.children,r,o,e);case tC:l=8,r|=8;break;case Ev:return n=ts(12,t,e,r|2),n.elementType=Ev,n.lanes=o,n;case Cv:return n=ts(13,t,e,r),n.elementType=Cv,n.lanes=o,n;case Sv:return n=ts(19,t,e,r),n.elementType=Sv,n.lanes=o,n;case oT:return Jy(t,r,o,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case rT:l=10;break e;case sT:l=9;break e;case nC:l=11;break e;case iC:l=14;break e;case Da:l=16,i=null;break e}throw Error(he(130,n==null?n:typeof n,""))}return e=ts(l,t,e,r),e.elementType=n,e.type=i,e.lanes=o,e}function Zu(n,e,t,i){return n=ts(7,n,i,e),n.lanes=t,n}function Jy(n,e,t,i){return n=ts(22,n,i,e),n.elementType=oT,n.lanes=t,n.stateNode={isHidden:!1},n}function sv(n,e,t){return n=ts(6,n,null,e),n.lanes=t,n}function ov(n,e,t){return e=ts(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function HP(n,e,t,i,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jA(0),this.expirationTimes=jA(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jA(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function FC(n,e,t,i,r,o,l,h,g){return n=new HP(n,e,t,h,g),e===1?(e=1,o===!0&&(e|=8)):e=0,o=ts(3,null,null,e),n.current=o,o.stateNode=n,o.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},vC(o),n}function VP(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ph,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function ZI(n){if(!n)return Kl;n=n._reactInternals;e:{if(ah(n)!==n||n.tag!==1)throw Error(he(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(er(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(he(171))}if(n.tag===1){var t=n.type;if(er(t))return ZT(n,t,e)}return e}function QI(n,e,t,i,r,o,l,h,g){return n=FC(t,i,!0,n,r,o,l,h,g),n.context=ZI(null),t=n.current,i=Ri(),r=Gl(t),o=pa(i,r),o.callback=e??null,Vl(t,o,r),n.current.lanes=r,_m(n,r,i),tr(n,i),n}function eA(n,e,t,i){var r=e.current,o=Ri(),l=Gl(r);return t=ZI(t),e.context===null?e.context=t:e.pendingContext=t,e=pa(o,l),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=Vl(r,e,l),n!==null&&(Ps(n,r,l,o),Ix(n,r,l)),l}function L2(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function O3(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function UC(n,e){O3(n,e),(n=n.alternate)&&O3(n,e)}function WP(){return null}var JI=typeof reportError=="function"?reportError:function(n){console.error(n)};function jC(n){this._internalRoot=n}tA.prototype.render=jC.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(he(409));eA(n,e,null,null)};tA.prototype.unmount=jC.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;ih(function(){eA(null,n,null,null)}),e[wa]=null}};function tA(n){this._internalRoot=n}tA.prototype.unstable_scheduleHydration=function(n){if(n){var e=RT();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Oa.length&&e!==0&&e<Oa[t].priority;t++);Oa.splice(t,0,n),t===0&&PT(n)}};function zC(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function nA(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function L3(){}function GP(n,e,t,i,r){if(r){if(typeof i=="function"){var o=i;i=function(){var p=L2(l);o.call(p)}}var l=QI(e,i,n,0,null,!1,!1,"",L3);return n._reactRootContainer=l,n[wa]=l.current,D1(n.nodeType===8?n.parentNode:n),ih(),l}for(;r=n.lastChild;)n.removeChild(r);if(typeof i=="function"){var h=i;i=function(){var p=L2(g);h.call(p)}}var g=FC(n,0,!1,null,null,!1,!1,"",L3);return n._reactRootContainer=g,n[wa]=g.current,D1(n.nodeType===8?n.parentNode:n),ih(function(){eA(e,g,t,i)}),g}function iA(n,e,t,i,r){var o=t._reactRootContainer;if(o){var l=o;if(typeof r=="function"){var h=r;r=function(){var g=L2(l);h.call(g)}}eA(e,l,n,r)}else l=GP(t,e,n,r,i);return L2(l)}IT=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=X0(e.pendingLanes);t!==0&&(oC(e,t|1),tr(e,wn()),!(lt&6)&&(d0=wn()+500,tc()))}break;case 13:ih(function(){var i=ya(n,1);if(i!==null){var r=Ri();Ps(i,n,1,r)}}),UC(n,1)}};aC=function(n){if(n.tag===13){var e=ya(n,134217728);if(e!==null){var t=Ri();Ps(e,n,134217728,t)}UC(n,134217728)}};NT=function(n){if(n.tag===13){var e=Gl(n),t=ya(n,e);if(t!==null){var i=Ri();Ps(t,n,e,i)}UC(n,e)}};RT=function(){return mt};kT=function(n,e){var t=mt;try{return mt=n,e()}finally{mt=t}};Ov=function(n,e,t){switch(e){case"input":if(Iv(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var r=Yy(i);if(!r)throw Error(he(90));lT(i),Iv(i,r)}}}break;case"textarea":uT(n,t);break;case"select":e=t.value,e!=null&&Zh(n,!!t.multiple,e,!1)}};xT=MC;wT=ih;var XP={usingClientEntryPoint:!1,Events:[Im,Bh,Yy,pT,mT,MC]},F0={findFiberByHostInstance:yc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},YP={bundleType:F0.bundleType,version:F0.version,rendererPackageName:F0.rendererPackageName,rendererConfig:F0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ea.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=vT(n),n===null?null:n.stateNode},findFiberByHostInstance:F0.findFiberByHostInstance||WP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ux=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ux.isDisabled&&ux.supportsFiber)try{Vy=ux.inject(YP),Ao=ux}catch{}}kr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XP;kr.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zC(e))throw Error(he(200));return VP(n,e,null,t)};kr.createRoot=function(n,e){if(!zC(n))throw Error(he(299));var t=!1,i="",r=JI;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=FC(n,1,!1,null,null,t,!1,i,r),n[wa]=e.current,D1(n.nodeType===8?n.parentNode:n),new jC(e)};kr.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(he(188)):(n=Object.keys(n).join(","),Error(he(268,n)));return n=vT(e),n=n===null?null:n.stateNode,n};kr.flushSync=function(n){return ih(n)};kr.hydrate=function(n,e,t){if(!nA(e))throw Error(he(200));return iA(null,n,e,!0,t)};kr.hydrateRoot=function(n,e,t){if(!zC(n))throw Error(he(405));var i=t!=null&&t.hydratedSources||null,r=!1,o="",l=JI;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onRecoverableError!==void 0&&(l=t.onRecoverableError)),e=QI(e,null,n,1,t??null,r,!1,o,l),n[wa]=e.current,D1(n),i)for(n=0;n<i.length;n++)t=i[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new tA(e)};kr.render=function(n,e,t){if(!nA(e))throw Error(he(200));return iA(null,n,e,!1,t)};kr.unmountComponentAtNode=function(n){if(!nA(n))throw Error(he(40));return n._reactRootContainer?(ih(function(){iA(null,null,n,!1,function(){n._reactRootContainer=null,n[wa]=null})}),!0):!1};kr.unstable_batchedUpdates=MC;kr.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!nA(t))throw Error(he(200));if(n==null||n._reactInternals===void 0)throw Error(he(38));return iA(n,e,t,!1,i)};kr.version="18.3.1-next-f1338f8080-20240426";function e4(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e4)}catch(n){console.error(n)}}e4(),eT.exports=kr;var $P=eT.exports,B3=$P;vv.createRoot=B3.createRoot,vv.hydrateRoot=B3.hydrateRoot;var KP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const qP=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ZP=(n,e)=>{const t=re.forwardRef(({color:i="currentColor",size:r=24,strokeWidth:o=2,absoluteStrokeWidth:l,children:h,...g},p)=>re.createElement("svg",{ref:p,...KP,width:r,height:r,stroke:i,strokeWidth:l?Number(o)*24/Number(r):o,className:`lucide lucide-${qP(n)}`,...g},[...e.map(([x,y])=>re.createElement(x,y)),...(Array.isArray(h)?h:[h])||[]]));return t.displayName=`${n}`,t};var lh=ZP;const F3=lh("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),QP=lh("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),av=lh("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),lv=lh("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),cv=lh("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]),t4=lh("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Wh=lh("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),JP="modulepreload",e6=function(n){return"/"+n},U3={},t6=function(e,t,i){if(!t||t.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(t.map(o=>{if(o=e6(o),o in U3)return;U3[o]=!0;const l=o.endsWith(".css"),h=l?'[rel="stylesheet"]':"";if(!!i)for(let x=r.length-1;x>=0;x--){const y=r[x];if(y.href===o&&(!l||y.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${h}`))return;const p=document.createElement("link");if(p.rel=l?"stylesheet":JP,l||(p.as="script",p.crossOrigin=""),p.href=o,document.head.appendChild(p),l)return new Promise((x,y)=>{p.addEventListener("load",x),p.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>e()).catch(o=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o})},Ii=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),gb=[.001,0,0,.001,0,0],uv=1.35,Cr={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},yo={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},H1="pdfjs_internal_editor_",Be={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Ze={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},n4={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Kn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},C1={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},pn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Ch={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Rm={ERRORS:0,WARNINGS:1,INFOS:5},f0={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},hx={moveTo:0,lineTo:1,curveTo:2,closePath:3},i4={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let rA=Rm.WARNINGS;function n6(n){Number.isInteger(n)&&(rA=n)}function i6(){return rA}function sA(n){rA>=Rm.INFOS&&console.info(`Info: ${n}`)}function Fe(n){rA>=Rm.WARNINGS&&console.warn(`Warning: ${n}`)}function It(n){throw new Error(n)}function it(n,e){n||It(e)}function r6(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function HC(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const r=n.match(/\./g);(r==null?void 0:r.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=c6(n)}catch{}}const i=e?URL.parse(n,e):URL.parse(n);return r6(i)?i:null}function VC(n,e,t=!1){const i=URL.parse(n);return i?(i.hash=e,i.href):t&&HC(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Ve(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const ch=function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e}();class j3 extends ch{constructor(e,t){super(e,"PasswordException"),this.code=t}}class hv extends ch{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class B2 extends ch{constructor(e){super(e,"InvalidPDFException")}}class V1 extends ch{constructor(e,t,i){super(e,"ResponseException"),this.status=t,this.missing=i}}class s6 extends ch{constructor(e){super(e,"FormatError")}}class va extends ch{constructor(e){super(e,"AbortException")}}function r4(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&It("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let r=0;r<e;r+=t){const o=Math.min(r+t,e),l=n.subarray(r,o);i.push(String.fromCharCode.apply(null,l))}return i.join("")}function km(n){typeof n!="string"&&It("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function o6(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function a6(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function l6(){try{return new Function(""),!0}catch{return!1}}class Gn{static get isLittleEndian(){return Ve(this,"isLittleEndian",a6())}static get isEvalSupported(){return Ve(this,"isEvalSupported",l6())}static get isOffscreenCanvasSupported(){return Ve(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ve(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Ve(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return Ve(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const dv=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var od,Ox,q1,pb;class Ae{static makeHexColor(e,t,i){return`#${dv[e]}${dv[t]}${dv[i]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,i=0){const r=e[i],o=e[i+1];e[i]=r*t[0]+o*t[2]+t[4],e[i+1]=r*t[1]+o*t[3]+t[5]}static applyTransformToBezier(e,t,i=0){const r=t[0],o=t[1],l=t[2],h=t[3],g=t[4],p=t[5];for(let x=0;x<6;x+=2){const y=e[i+x],v=e[i+x+1];e[i+x]=y*r+v*l+g,e[i+x+1]=y*o+v*h+p}}static applyInverseTransform(e,t){const i=e[0],r=e[1],o=t[0]*t[3]-t[1]*t[2];e[0]=(i*t[3]-r*t[2]+t[2]*t[5]-t[4]*t[3])/o,e[1]=(-i*t[1]+r*t[0]+t[4]*t[1]-t[5]*t[0])/o}static axialAlignedBoundingBox(e,t,i){const r=t[0],o=t[1],l=t[2],h=t[3],g=t[4],p=t[5],x=e[0],y=e[1],v=e[2],C=e[3];let R=r*x+g,I=R,O=r*v+g,_=O,N=h*y+p,k=N,B=h*C+p,z=B;if(o!==0||l!==0){const H=o*x,F=o*v,Y=l*y,W=l*C;R+=Y,_+=Y,O+=W,I+=W,N+=H,z+=H,B+=F,k+=F}i[0]=Math.min(i[0],R,O,I,_),i[1]=Math.min(i[1],N,B,k,z),i[2]=Math.max(i[2],R,O,I,_),i[3]=Math.max(i[3],N,B,k,z)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const i=e[0],r=e[1],o=e[2],l=e[3],h=i**2+r**2,g=i*o+r*l,p=o**2+l**2,x=(h+p)/2,y=Math.sqrt(x**2-(h*p-g**2));t[0]=Math.sqrt(x+y||1),t[1]=Math.sqrt(x-y||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>r)return null;const o=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),l=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return o>l?null:[i,o,r,l]}static pointBoundingBox(e,t,i){i[0]=Math.min(i[0],e),i[1]=Math.min(i[1],t),i[2]=Math.max(i[2],e),i[3]=Math.max(i[3],t)}static rectBoundingBox(e,t,i,r,o){o[0]=Math.min(o[0],e,i),o[1]=Math.min(o[1],t,r),o[2]=Math.max(o[2],e,i),o[3]=Math.max(o[3],t,r)}static bezierBoundingBox(e,t,i,r,o,l,h,g,p){p[0]=Math.min(p[0],e,h),p[1]=Math.min(p[1],t,g),p[2]=Math.max(p[2],e,h),p[3]=Math.max(p[3],t,g),P(this,q1,pb).call(this,e,i,o,h,t,r,l,g,3*(-e+3*(i-o)+h),6*(e-2*i+o),3*(i-e),p),P(this,q1,pb).call(this,e,i,o,h,t,r,l,g,3*(-t+3*(r-l)+g),6*(t-2*r+l),3*(r-t),p)}}od=new WeakSet,Ox=function(e,t,i,r,o,l,h,g,p,x){if(p<=0||p>=1)return;const y=1-p,v=p*p,C=v*p,R=y*(y*(y*e+3*p*t)+3*v*i)+C*r,I=y*(y*(y*o+3*p*l)+3*v*h)+C*g;x[0]=Math.min(x[0],R),x[1]=Math.min(x[1],I),x[2]=Math.max(x[2],R),x[3]=Math.max(x[3],I)},q1=new WeakSet,pb=function(e,t,i,r,o,l,h,g,p,x,y,v){if(Math.abs(p)<1e-12){Math.abs(x)>=1e-12&&P(this,od,Ox).call(this,e,t,i,r,o,l,h,g,-y/x,v);return}const C=x**2-4*y*p;if(C<0)return;const R=Math.sqrt(C),I=2*p;P(this,od,Ox).call(this,e,t,i,r,o,l,h,g,(-x+R)/I,v),P(this,od,Ox).call(this,e,t,i,r,o,l,h,g,(-x-R)/I,v)},E(Ae,od),E(Ae,q1);function c6(n){return decodeURIComponent(escape(n))}let fv=null,z3=null;function s4(n){return fv||(fv=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,z3=new Map([["","t"]])),n.replaceAll(fv,(e,t,i)=>t?t.normalize("NFKC"):z3.get(i))}function WC(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),r4(n)}const GC="pdfjs_internal_id_";function u6(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[i,r,...o]=t;if(!n(i)&&!Number.isInteger(i)||!e(r))return!1;const l=o.length;let h=!0;switch(r.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;h=!1;break;default:return!1}for(const g of o)if(!(typeof g=="number"||h&&g===null))return!1;return!0}function xi(n,e,t){return Math.min(Math.max(n,e),t)}function o4(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(r4(n))}function h6(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):km(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});class W1{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};function r(o){var g;if(!o)return;let l=null;const h=o.name;if(h==="#text")l=o.value;else if(W1.shouldBuildText(h))(g=o==null?void 0:o.attributes)!=null&&g.textContent?l=o.attributes.textContent:o.value&&(l=o.value);else return;if(l!==null&&t.push({str:l}),!!o.children)for(const p of o.children)r(p)}return r(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class XC{static setupStorage(e,t,i,r,o){const l=r.getValue(t,{value:null});switch(i.name){case"textarea":if(l.value!==null&&(e.textContent=l.value),o==="print")break;e.addEventListener("input",h=>{r.setValue(t,{value:h.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(l.value===i.attributes.xfaOn?e.setAttribute("checked",!0):l.value===i.attributes.xfaOff&&e.removeAttribute("checked"),o==="print")break;e.addEventListener("change",h=>{r.setValue(t,{value:h.target.checked?h.target.getAttribute("xfaOn"):h.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&e.setAttribute("value",l.value),o==="print")break;e.addEventListener("input",h=>{r.setValue(t,{value:h.target.value})})}break;case"select":if(l.value!==null){e.setAttribute("value",l.value);for(const h of i.children)h.attributes.value===l.value?h.attributes.selected=!0:h.attributes.hasOwnProperty("selected")&&delete h.attributes.selected}e.addEventListener("input",h=>{const g=h.target.options,p=g.selectedIndex===-1?"":g[g.selectedIndex].value;r.setValue(t,{value:p})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:r,linkService:o}){const{attributes:l}=t,h=e instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${r}`);for(const[g,p]of Object.entries(l))if(p!=null)switch(g){case"class":p.length&&e.setAttribute(g,p.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",p);break;case"style":Object.assign(e.style,p);break;case"textContent":e.textContent=p;break;default:(!h||g!=="href"&&g!=="newWindow")&&e.setAttribute(g,p)}h&&o.addLinkAttributes(e,l.href,l.newWindow),i&&l.dataId&&this.setupStorage(e,l.dataId,t,i)}static render(e){var y,v;const t=e.annotationStorage,i=e.linkService,r=e.xfaHtml,o=e.intent||"display",l=document.createElement(r.name);r.attributes&&this.setAttributes({html:l,element:r,intent:o,linkService:i});const h=o!=="richText",g=e.div;if(g.append(l),e.viewport){const C=`matrix(${e.viewport.transform.join(",")})`;g.style.transform=C}h&&g.setAttribute("class","xfaLayer xfaFont");const p=[];if(r.children.length===0){if(r.value){const C=document.createTextNode(r.value);l.append(C),h&&W1.shouldBuildText(r.name)&&p.push(C)}return{textDivs:p}}const x=[[r,-1,l]];for(;x.length>0;){const[C,R,I]=x.at(-1);if(R+1===C.children.length){x.pop();continue}const O=C.children[++x.at(-1)[1]];if(O===null)continue;const{name:_}=O;if(_==="#text"){const k=document.createTextNode(O.value);p.push(k),I.append(k);continue}const N=(y=O==null?void 0:O.attributes)!=null&&y.xmlns?document.createElementNS(O.attributes.xmlns,_):document.createElement(_);if(I.append(N),O.attributes&&this.setAttributes({html:N,element:O,storage:t,intent:o,linkService:i}),((v=O.children)==null?void 0:v.length)>0)x.push([O,-1,N]);else if(O.value){const k=document.createTextNode(O.value);h&&W1.shouldBuildText(_)&&p.push(k),N.append(k)}}for(const C of g.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))C.setAttribute("readOnly",!0);return{textDivs:p}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const bo="http://www.w3.org/2000/svg",mc=class mc{};ue(mc,"CSS",96),ue(mc,"PDF",72),ue(mc,"PDF_TO_CSS_UNITS",mc.CSS/mc.PDF);let ba=mc;async function y0(n,e="text"){if($0(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{const r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(r.response);return}t(r.responseText);return}i(new Error(r.statusText))}},r.send(null)})}class Pm{constructor({viewBox:e,userUnit:t,scale:i,rotation:r,offsetX:o=0,offsetY:l=0,dontFlip:h=!1}){this.viewBox=e,this.userUnit=t,this.scale=i,this.rotation=r,this.offsetX=o,this.offsetY=l,i*=t;const g=(e[2]+e[0])/2,p=(e[3]+e[1])/2;let x,y,v,C;switch(r%=360,r<0&&(r+=360),r){case 180:x=-1,y=0,v=0,C=1;break;case 90:x=0,y=1,v=1,C=0;break;case 270:x=0,y=-1,v=-1,C=0;break;case 0:x=1,y=0,v=0,C=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}h&&(v=-v,C=-C);let R,I,O,_;x===0?(R=Math.abs(p-e[1])*i+o,I=Math.abs(g-e[0])*i+l,O=(e[3]-e[1])*i,_=(e[2]-e[0])*i):(R=Math.abs(g-e[0])*i+o,I=Math.abs(p-e[1])*i+l,O=(e[2]-e[0])*i,_=(e[3]-e[1])*i),this.transform=[x*i,y*i,v*i,C*i,R-x*i*g-v*i*p,I-y*i*g-C*i*p],this.width=O,this.height=_}get rawDims(){const e=this.viewBox;return Ve(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:r=this.offsetY,dontFlip:o=!1}={}){return new Pm({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:r,dontFlip:o})}convertToViewportPoint(e,t){const i=[e,t];return Ae.applyTransform(i,this.transform),i}convertToViewportRectangle(e){const t=[e[0],e[1]];Ae.applyTransform(t,this.transform);const i=[e[2],e[3]];return Ae.applyTransform(i,this.transform),[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){const i=[e,t];return Ae.applyInverseTransform(i,this.transform),i}}class oA extends ch{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Dm(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function aA(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function a4(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function l4(n,e="document.pdf"){if(typeof n!="string")return e;if(Dm(n))return Fe('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const i=(h=>{try{return new URL(h)}catch{try{return new URL(decodeURIComponent(h))}catch{try{return new URL(h,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(h),"https://foo.bar")}catch{return null}}}}})(n);if(!i)return e;const r=h=>{try{let g=decodeURIComponent(h);return g.includes("/")?(g=g.split("/").at(-1),g.test(/^\.pdf$/i)?g:h):g}catch{return h}},o=/\.pdf$/i,l=i.pathname.split("/").at(-1);if(o.test(l))return r(l);if(i.searchParams.size>0){const h=Array.from(i.searchParams.values()).reverse();for(const p of h)if(o.test(p))return r(p);const g=Array.from(i.searchParams.keys()).reverse();for(const p of g)if(o.test(p))return r(p)}if(i.hash){const g=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(g)return r(g[0])}return e}class H3{constructor(){ue(this,"started",Object.create(null));ue(this,"times",[])}time(e){e in this.started&&Fe(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Fe(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:i}of this.times)t=Math.max(i.length,t);for(const{name:i,start:r,end:o}of this.times)e.push(`${i.padEnd(t)} ${o-r}ms
`);return e.join("")}}function $0(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function Rr(n){n.preventDefault()}function Zt(n){n.preventDefault(),n.stopPropagation()}function d6(n){console.log("Deprecated API usage: "+n)}var Z1;class G1{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;u(this,Z1)||S(this,Z1,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=u(this,Z1).exec(e);if(!t)return null;const i=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let o=parseInt(t[3],10);o=o>=1&&o<=31?o:1;let l=parseInt(t[4],10);l=l>=0&&l<=23?l:0;let h=parseInt(t[5],10);h=h>=0&&h<=59?h:0;let g=parseInt(t[6],10);g=g>=0&&g<=59?g:0;const p=t[7]||"Z";let x=parseInt(t[8],10);x=x>=0&&x<=23?x:0;let y=parseInt(t[9],10)||0;return y=y>=0&&y<=59?y:0,p==="-"?(l+=x,h+=y):p==="+"&&(l-=x,h-=y),new Date(Date.UTC(i,r,o,l,h,g))}}Z1=new WeakMap,E(G1,Z1,void 0);function c4(n,{scale:e=1,rotation:t=0}){const{width:i,height:r}=n.attributes.style,o=[0,0,parseInt(i),parseInt(r)];return new Pm({viewBox:o,userUnit:1,scale:e,rotation:t})}function A0(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Fe(`Not a valid color format: "${n}"`),[0,0,0])}function f6(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const i=window.getComputedStyle(e).color;n.set(t,A0(i))}e.remove()}function Kt(n){const{a:e,b:t,c:i,d:r,e:o,f:l}=n.getTransform();return[e,t,i,r,o,l]}function Vs(n){const{a:e,b:t,c:i,d:r,e:o,f:l}=n.getTransform().invertSelf();return[e,t,i,r,o,l]}function ql(n,e,t=!1,i=!0){if(e instanceof Pm){const{pageWidth:r,pageHeight:o}=e.rawDims,{style:l}=n,h=Gn.isCSSRoundSupported,g=`var(--total-scale-factor) * ${r}px`,p=`var(--total-scale-factor) * ${o}px`,x=h?`round(down, ${g}, var(--scale-round-x))`:`calc(${g})`,y=h?`round(down, ${p}, var(--scale-round-y))`:`calc(${p})`;!t||e.rotation%180===0?(l.width=x,l.height=y):(l.width=y,l.height=x)}i&&n.setAttribute("data-main-rotation",e.rotation)}class Ms{constructor(){const{pixelRatio:e}=Ms;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,i,r,o=-1){let l=1/0,h=1/0,g=1/0;i=Ms.capPixels(i,o),i>0&&(l=Math.sqrt(i/(e*t))),r!==-1&&(h=r/e,g=r/t);const p=Math.min(l,h,g);return this.sx>p||this.sy>p?(this.sx=p,this.sy=p,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,i):i}return e}}const F2=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class g6{static get isDarkMode(){var e;return Ve(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class u4{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:i}=window.getComputedStyle(e);return e.remove(),Ve(this,"commentForegroundColor",A0(i))}}function h4(n,e,t,i){i=Math.min(Math.max(i??1,0),1);const r=255*(1-i);return n=Math.round(n*i+r),e=Math.round(e*i+r),t=Math.round(t*i+r),[n,e,t]}function V3(n,e){const t=n[0]/255,i=n[1]/255,r=n[2]/255,o=Math.max(t,i,r),l=Math.min(t,i,r),h=(o+l)/2;if(o===l)e[0]=e[1]=0;else{const g=o-l;switch(e[1]=h<.5?g/(o+l):g/(2-o-l),o){case t:e[0]=((i-r)/g+(i<r?6:0))*60;break;case i:e[0]=((r-t)/g+2)*60;break;case r:e[0]=((t-i)/g+4)*60;break}}e[2]=h}function mb(n,e){const t=n[0],i=n[1],r=n[2],o=(1-Math.abs(2*r-1))*i,l=o*(1-Math.abs(t/60%2-1)),h=r-o/2;switch(Math.floor(t/60)){case 0:e[0]=o+h,e[1]=l+h,e[2]=h;break;case 1:e[0]=l+h,e[1]=o+h,e[2]=h;break;case 2:e[0]=h,e[1]=o+h,e[2]=l+h;break;case 3:e[0]=h,e[1]=l+h,e[2]=o+h;break;case 4:e[0]=l+h,e[1]=h,e[2]=o+h;break;case 5:case 6:e[0]=o+h,e[1]=h,e[2]=l+h;break}}function W3(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function G3(n,e,t){mb(n,t),t.map(W3);const i=.2126*t[0]+.7152*t[1]+.0722*t[2];mb(e,t),t.map(W3);const r=.2126*t[0]+.7152*t[1]+.0722*t[2];return i>r?(i+.05)/(r+.05):(r+.05)/(i+.05)}const X3=new Map;function d4(n,e){const t=n[0]+n[1]*256+n[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let i=X3.get(t);if(i)return i;const r=new Float32Array(9),o=r.subarray(0,3),l=r.subarray(3,6);V3(n,l);const h=r.subarray(6,9);V3(e,h);const g=h[2]<.5,p=g?12:4.5;if(l[2]=g?Math.sqrt(l[2]):1-Math.sqrt(1-l[2]),G3(l,h,o)<p){let x,y;g?(x=l[2],y=1):(x=0,y=l[2]);const v=.005;for(;y-x>v;){const C=l[2]=(x+y)/2;g===G3(l,h,o)<p?x=C:y=C}l[2]=g?y:x}return mb(l,o),i=Ae.makeHexColor(Math.round(o[0]*255),Math.round(o[1]*255),Math.round(o[2]*255)),X3.set(t,i),i}function YC({html:n,dir:e,className:t},i){const r=document.createDocumentFragment();if(typeof n=="string"){const o=document.createElement("p");o.dir=e||"auto";const l=n.split(/(?:\r\n?|\n)/);for(let h=0,g=l.length;h<g;++h){const p=l[h];o.append(document.createTextNode(p)),h<g-1&&o.append(document.createElement("br"))}r.append(o)}else XC.render({xfaHtml:n,div:r,intent:"richText"});r.firstChild.classList.add("richText",t),i.append(r)}var Ba,Fa,jr,zr,Q1,Ua,ad,ld,J1,Q2,f4,J2,g4,ew,p4,ja,Sh,bc,K0;const To=class To{constructor(e){E(this,J2);E(this,ew);E(this,ja);E(this,bc);E(this,Ba,null);E(this,Fa,null);E(this,jr,void 0);E(this,zr,null);E(this,Q1,null);E(this,Ua,null);E(this,ad,null);E(this,ld,null);S(this,jr,e),u(To,J1)||S(To,J1,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=S(this,Ba,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=u(this,jr)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",Rr,{signal:t}),e.addEventListener("pointerdown",P(To,Q2,f4),{signal:t}));const i=S(this,zr,document.createElement("div"));i.className="buttons",e.append(i);const r=u(this,jr).toolbarPosition;if(r){const{style:o}=e,l=u(this,jr)._uiManager.direction==="ltr"?1-r[0]:r[0];o.insetInlineEnd=`${100*l}%`,o.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return u(this,Ba)}hide(){var e;u(this,Ba).classList.add("hidden"),(e=u(this,Fa))==null||e.hideDropdown()}show(){var e,t;u(this,Ba).classList.remove("hidden"),(e=u(this,Q1))==null||e.shown(),(t=u(this,Ua))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=u(this,jr),i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",u(To,J1)[e]),P(this,ja,Sh).call(this,i)&&i.addEventListener("click",r=>{t.delete()},{signal:t._signal}),u(this,zr).append(i)}async addAltText(e){const t=await e.render();P(this,ja,Sh).call(this,t),u(this,zr).append(t,u(this,bc,K0)),S(this,Q1,e)}addComment(e,t=null){if(u(this,Ua))return;const i=e.renderForToolbar();if(!i)return;P(this,ja,Sh).call(this,i);const r=S(this,ad,u(this,bc,K0));t?(u(this,zr).insertBefore(i,t),u(this,zr).insertBefore(r,t)):u(this,zr).append(i,r),S(this,Ua,e),e.toolbar=this}addColorPicker(e){if(u(this,Fa))return;S(this,Fa,e);const t=e.renderButton();P(this,ja,Sh).call(this,t),u(this,zr).append(t,u(this,bc,K0))}async addEditSignatureButton(e){const t=S(this,ld,await e.renderEditButton(u(this,jr)));P(this,ja,Sh).call(this,t),u(this,zr).append(t,u(this,bc,K0))}removeButton(e){var t,i;switch(e){case"comment":(t=u(this,Ua))==null||t.removeToolbarCommentButton(),S(this,Ua,null),(i=u(this,ad))==null||i.remove(),S(this,ad,null);break}}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(t);break}}async addButtonBefore(e,t,i){const r=u(this,zr).querySelector(i);r&&e==="comment"&&this.addComment(t,r)}updateEditSignatureButton(e){u(this,ld)&&(u(this,ld).title=e)}remove(){var e;u(this,Ba).remove(),(e=u(this,Fa))==null||e.destroy(),S(this,Fa,null)}};Ba=new WeakMap,Fa=new WeakMap,jr=new WeakMap,zr=new WeakMap,Q1=new WeakMap,Ua=new WeakMap,ad=new WeakMap,ld=new WeakMap,J1=new WeakMap,Q2=new WeakSet,f4=function(e){e.stopPropagation()},J2=new WeakSet,g4=function(e){u(this,jr)._focusEventsAllowed=!1,Zt(e)},ew=new WeakSet,p4=function(e){u(this,jr)._focusEventsAllowed=!0,Zt(e)},ja=new WeakSet,Sh=function(e){const t=u(this,jr)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",P(this,J2,g4).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",P(this,ew,p4).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Rr,{signal:t}),!0)},bc=new WeakSet,K0=function(){const e=document.createElement("div");return e.className="divider",e},E(To,Q2),E(To,J1,null);let xb=To;var eg,Ec,Ro,tw,m4,nw,x4,tg,wb;class p6{constructor(e){E(this,tw);E(this,nw);E(this,tg);E(this,eg,null);E(this,Ec,null);E(this,Ro,void 0);S(this,Ro,e)}show(e,t,i){const[r,o]=P(this,nw,x4).call(this,t,i),{style:l}=u(this,Ec)||S(this,Ec,P(this,tw,m4).call(this));e.append(u(this,Ec)),l.insetInlineEnd=`${100*r}%`,l.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){u(this,Ec).remove()}}eg=new WeakMap,Ec=new WeakMap,Ro=new WeakMap,tw=new WeakSet,m4=function(){const e=S(this,Ec,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=u(this,Ro)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",Rr,{signal:t});const i=S(this,eg,document.createElement("div"));return i.className="buttons",e.append(i),u(this,Ro).hasCommentManager()&&P(this,tg,wb).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{u(this,Ro).commentSelection("floating_button")}),P(this,tg,wb).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{u(this,Ro).highlightSelection("floating_button")}),e},nw=new WeakSet,x4=function(e,t){let i=0,r=0;for(const o of e){const l=o.y+o.height;if(l<i)continue;const h=o.x+(t?o.width:0);if(l>i){r=h,i=l;continue}t?h>r&&(r=h):h<r&&(r=h)}return[t?1-r:r,i]},tg=new WeakSet,wb=function(e,t,i,r){const o=document.createElement("button");o.classList.add("basic",e),o.tabIndex=0,o.setAttribute("data-l10n-id",t);const l=document.createElement("span");o.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",i);const h=u(this,Ro)._signal;h instanceof AbortSignal&&!h.aborted&&(o.addEventListener("contextmenu",Rr,{signal:h}),o.addEventListener("click",r,{signal:h})),u(this,eg).append(o)};function w4(n,e,t){for(const i of t)e.addEventListener(i,n[i].bind(n))}var iw;class m6{constructor(){E(this,iw,0)}get id(){return`${H1}${Tn(this,iw)._++}`}}iw=new WeakMap;var cd,ng,hi,ud,Lx;const uS=class uS{constructor(){E(this,ud);E(this,cd,WC());E(this,ng,0);E(this,hi,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=e;const o=r.decode().then(()=>(i.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return Ve(this,"_isSVGFittingCanvas",o)}async getFromFile(e){const{lastModified:t,name:i,size:r,type:o}=e;return P(this,ud,Lx).call(this,`${t}_${i}_${r}_${o}`,e)}async getFromUrl(e){return P(this,ud,Lx).call(this,e,e)}async getFromBlob(e,t){const i=await t;return P(this,ud,Lx).call(this,e,i)}async getFromId(e){u(this,hi)||S(this,hi,new Map);const t=u(this,hi).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)}getFromCanvas(e,t){u(this,hi)||S(this,hi,new Map);let i=u(this,hi).get(e);if(i!=null&&i.bitmap)return i.refCounter+=1,i;const r=new OffscreenCanvas(t.width,t.height);return r.getContext("2d").drawImage(t,0,0),i={bitmap:r.transferToImageBitmap(),id:`image_${u(this,cd)}_${Tn(this,ng)._++}`,refCounter:1,isSvg:!1},u(this,hi).set(e,i),u(this,hi).set(i.id,i),i}getSvgUrl(e){const t=u(this,hi).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var r;u(this,hi)||S(this,hi,new Map);const t=u(this,hi).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:i}=t;if(!t.url&&!t.file){const o=new OffscreenCanvas(i.width,i.height);o.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=o.convertToBlob()}(r=i.close)==null||r.call(i),t.bitmap=null}isValidId(e){return e.startsWith(`image_${u(this,cd)}_`)}};cd=new WeakMap,ng=new WeakMap,hi=new WeakMap,ud=new WeakSet,Lx=async function(e,t){u(this,hi)||S(this,hi,new Map);let i=u(this,hi).get(e);if(i===null)return null;if(i!=null&&i.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${u(this,cd)}_${Tn(this,ng)._++}`,refCounter:0,isSvg:!1});let r;if(typeof t=="string"?(i.url=t,r=await y0(t,"blob")):t instanceof File?r=i.file=t:t instanceof Blob&&(r=t),r.type==="image/svg+xml"){const o=uS._isSVGFittingCanvas,l=new FileReader,h=new Image,g=new Promise((p,x)=>{h.onload=()=>{i.bitmap=h,i.isSvg=!0,p()},l.onload=async()=>{const y=i.svgUrl=l.result;h.src=await o?`${y}#svgView(preserveAspectRatio(none))`:y},h.onerror=l.onerror=x});l.readAsDataURL(r),await g}else i.bitmap=await createImageBitmap(r);i.refCounter=1}catch(r){Fe(r),i=null}return u(this,hi).set(e,i),i&&u(this,hi).set(i.id,i),i};let yb=uS;var mn,za,ig,$t;class x6{constructor(e=128){E(this,mn,[]);E(this,za,!1);E(this,ig,void 0);E(this,$t,-1);S(this,ig,e)}add({cmd:e,undo:t,post:i,mustExec:r,type:o=NaN,overwriteIfSameType:l=!1,keepUndo:h=!1}){if(r&&e(),u(this,za))return;const g={cmd:e,undo:t,post:i,type:o};if(u(this,$t)===-1){u(this,mn).length>0&&(u(this,mn).length=0),S(this,$t,0),u(this,mn).push(g);return}if(l&&u(this,mn)[u(this,$t)].type===o){h&&(g.undo=u(this,mn)[u(this,$t)].undo),u(this,mn)[u(this,$t)]=g;return}const p=u(this,$t)+1;p===u(this,ig)?u(this,mn).splice(0,1):(S(this,$t,p),p<u(this,mn).length&&u(this,mn).splice(p)),u(this,mn).push(g)}undo(){if(u(this,$t)===-1)return;S(this,za,!0);const{undo:e,post:t}=u(this,mn)[u(this,$t)];e(),t==null||t(),S(this,za,!1),S(this,$t,u(this,$t)-1)}redo(){if(u(this,$t)<u(this,mn).length-1){S(this,$t,u(this,$t)+1),S(this,za,!0);const{cmd:e,post:t}=u(this,mn)[u(this,$t)];e(),t==null||t(),S(this,za,!1)}}hasSomethingToUndo(){return u(this,$t)!==-1}hasSomethingToRedo(){return u(this,$t)<u(this,mn).length-1}cleanType(e){if(u(this,$t)!==-1){for(let t=u(this,$t);t>=0;t--)if(u(this,mn)[t].type!==e){u(this,mn).splice(t+1,u(this,$t)-t),S(this,$t,t);return}u(this,mn).length=0,S(this,$t,-1)}}destroy(){S(this,mn,null)}}mn=new WeakMap,za=new WeakMap,ig=new WeakMap,$t=new WeakMap;var rw,y4;class Mm{constructor(e){E(this,rw);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Gn.platform;for(const[i,r,o={}]of e)for(const l of i){const h=l.startsWith("mac+");t&&h?(this.callbacks.set(l.slice(4),{callback:r,options:o}),this.allKeys.add(l.split("+").at(-1))):!t&&!h&&(this.callbacks.set(l,{callback:r,options:o}),this.allKeys.add(l.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const i=this.callbacks.get(P(this,rw,y4).call(this,t));if(!i)return;const{callback:r,options:{bubbles:o=!1,args:l=[],checker:h=null}}=i;h&&!h(e,t)||(r.bind(e,...l,t)(),o||Zt(t))}}rw=new WeakSet,y4=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const sw=class sw{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return f6(e),Ve(this,"_colors",e)}convert(e){const t=A0(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[i,r]of this._colors)if(r.every((o,l)=>o===t[l]))return sw._colorsMapping.get(i);return t}getHexCode(e){const t=this._colors.get(e);return t?Ae.makeHexColor(...t):e}};ue(sw,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Ab=sw;var hd,or,dd,on,Nn,fd,Hr,gd,Vr,di,Ha,Va,pd,Wa,Ys,Wr,Cc,rg,sg,md,og,$s,Ga,xd,Xa,Ks,ow,Ya,wd,ag,$a,Sc,yd,Ka,lg,vn,gt,ko,qa,Za,cg,Ad,ug,Qa,qs,Po,hg,dg,Gr,vd,Bx,fg,vb,aw,A4,lw,v4,_c,q0,cw,b4,uw,E4,hw,C4,gg,bb,dw,S4,pg,Eb,mg,Cb,fw,_4,qn,Ei,gs,Eo,gw,T4,pw,I4,xg,Sb,mw,N4,Tc,Z0,wg,_b;const Yh=class Yh{constructor(e,t,i,r,o,l,h,g,p,x,y,v,C,R,I,O){E(this,vd);E(this,fg);E(this,aw);E(this,lw);E(this,_c);E(this,cw);E(this,uw);E(this,hw);E(this,gg);E(this,dw);E(this,pg);E(this,mg);E(this,fw);E(this,qn);E(this,gs);E(this,gw);E(this,pw);E(this,xg);E(this,mw);E(this,Tc);E(this,wg);E(this,hd,new AbortController);E(this,or,null);E(this,dd,null);E(this,on,new Map);E(this,Nn,new Map);E(this,fd,null);E(this,Hr,null);E(this,gd,null);E(this,Vr,new x6);E(this,di,null);E(this,Ha,null);E(this,Va,null);E(this,pd,0);E(this,Wa,new Set);E(this,Ys,null);E(this,Wr,null);E(this,Cc,new Set);ue(this,"_editorUndoBar",null);E(this,rg,!1);E(this,sg,!1);E(this,md,!1);E(this,og,null);E(this,$s,null);E(this,Ga,null);E(this,xd,null);E(this,Xa,!1);E(this,Ks,null);E(this,ow,new m6);E(this,Ya,!1);E(this,wd,!1);E(this,ag,!1);E(this,$a,null);E(this,Sc,null);E(this,yd,null);E(this,Ka,null);E(this,lg,null);E(this,vn,Be.NONE);E(this,gt,new Set);E(this,ko,null);E(this,qa,null);E(this,Za,null);E(this,cg,null);E(this,Ad,null);E(this,ug,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});E(this,Qa,[0,0]);E(this,qs,null);E(this,Po,null);E(this,hg,null);E(this,dg,null);E(this,Gr,null);const _=this._signal=u(this,hd).signal;S(this,Po,e),S(this,hg,t),S(this,dg,i),S(this,fd,r),S(this,di,o),S(this,qa,l),S(this,Ad,g),this._eventBus=h,h._on("editingaction",this.onEditingAction.bind(this),{signal:_}),h._on("pagechanging",this.onPageChanging.bind(this),{signal:_}),h._on("scalechanging",this.onScaleChanging.bind(this),{signal:_}),h._on("rotationchanging",this.onRotationChanging.bind(this),{signal:_}),h._on("setpreference",this.onSetPreference.bind(this),{signal:_}),h._on("switchannotationeditorparams",N=>this.updateParams(N.type,N.value),{signal:_}),window.addEventListener("pointerdown",()=>{S(this,wd,!0)},{capture:!0,signal:_}),window.addEventListener("pointerup",()=>{S(this,wd,!1)},{capture:!0,signal:_}),P(this,cw,b4).call(this),P(this,fw,_4).call(this),P(this,gg,bb).call(this),S(this,Hr,g.annotationStorage),S(this,og,g.filterFactory),S(this,Za,p),S(this,xd,x||null),S(this,rg,y),S(this,sg,v),S(this,md,C),S(this,lg,R||null),this.viewParameters={realScale:ba.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=I||null,this._supportsPinchToZoom=O!==!1,o==null||o.setSidebarUiManager(this)}static get _keyboardManager(){const e=Yh.prototype,t=l=>u(l,Po).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),i=(l,{target:h})=>{if(h instanceof HTMLInputElement){const{type:g}=h;return g!=="text"&&g!=="number"}return!0},r=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return Ve(this,"_keyboardManager",new Mm([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(l,{target:h})=>!(h instanceof HTMLButtonElement)&&u(l,Po).contains(h)&&!l.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(l,{target:h})=>!(h instanceof HTMLButtonElement)&&u(l,Po).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-o,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[o,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-o],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,o],checker:t}]]))}destroy(){var e,t,i,r,o,l,h,g,p;(e=u(this,Gr))==null||e.resolve(),S(this,Gr,null),(t=u(this,hd))==null||t.abort(),S(this,hd,null),this._signal=null;for(const x of u(this,Nn).values())x.destroy();u(this,Nn).clear(),u(this,on).clear(),u(this,Cc).clear(),(i=u(this,Ka))==null||i.clear(),S(this,or,null),u(this,gt).clear(),u(this,Vr).destroy(),(r=u(this,fd))==null||r.destroy(),(o=u(this,di))==null||o.destroy(),(l=u(this,qa))==null||l.destroy(),(h=u(this,Ks))==null||h.hide(),S(this,Ks,null),(g=u(this,yd))==null||g.destroy(),S(this,yd,null),S(this,dd,null),u(this,$s)&&(clearTimeout(u(this,$s)),S(this,$s,null)),u(this,qs)&&(clearTimeout(u(this,qs)),S(this,qs,null)),(p=this._editorUndoBar)==null||p.destroy(),S(this,Ad,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return u(this,lg)}get useNewAltTextFlow(){return u(this,sg)}get useNewAltTextWhenAddingImage(){return u(this,md)}get hcmFilter(){return Ve(this,"hcmFilter",u(this,Za)?u(this,og).addHCMFilter(u(this,Za).foreground,u(this,Za).background):"none")}get direction(){return Ve(this,"direction",getComputedStyle(u(this,Po)).direction)}get _highlightColors(){return Ve(this,"_highlightColors",u(this,xd)?new Map(u(this,xd).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Ve(this,"highlightColors",null);const t=new Map,i=!!u(this,Za);for(const[r,o]of e){const l=r.endsWith("_HCM");if(i&&l){t.set(r.replace("_HCM",""),o);continue}!i&&!l&&t.set(r,o)}return Ve(this,"highlightColors",t)}get highlightColorNames(){return Ve(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),S(this,Va,e)}setMainHighlightColorPicker(e){S(this,yd,e)}editAltText(e,t=!1){var i;(i=u(this,fd))==null||i.editAltText(this,e,t)}hasCommentManager(){return!!u(this,di)}editComment(e,t,i,r){var o;(o=u(this,di))==null||o.showDialog(this,e,t,i,r)}selectComment(e,t){const i=u(this,Nn).get(e),r=i==null?void 0:i.getEditorByUID(t);r==null||r.toggleComment(!0,!0)}updateComment(e){var t;(t=u(this,di))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=u(this,di))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=u(this,di))==null||t.removeComments([e.uid])}toggleComment(e,t,i=void 0){var r;(r=u(this,di))==null||r.toggleCommentPopup(e,t,i)}makeCommentColor(e,t){var i;return e&&((i=u(this,di))==null?void 0:i.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=u(this,di))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(u(this,Nn).has(e-1))return;const{resolve:t,promise:i}=Promise.withResolvers(),r=o=>{o.pageNumber===e&&(this._eventBus._off("editorsrendered",r),t())};this._eventBus.on("editorsrendered",r),await i}getSignature(e){var t;(t=u(this,qa))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return u(this,qa)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":S(this,md,t);break}}onPageChanging({pageNumber:e}){S(this,pd,e-1)}focusMainContainer(){u(this,Po).focus()}findParent(e,t){for(const i of u(this,Nn).values()){const{x:r,y:o,width:l,height:h}=i.div.getBoundingClientRect();if(e>=r&&e<=r+l&&t>=o&&t<=o+h)return i}return null}disableUserSelect(e=!1){u(this,hg).classList.toggle("noUserSelect",e)}addShouldRescale(e){u(this,Cc).add(e)}removeShouldRescale(e){u(this,Cc).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*ba.PDF_TO_CSS_UNITS;for(const i of u(this,Cc))i.onScaleChanging();(t=u(this,Va))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:r,anchorOffset:o,focusNode:l,focusOffset:h}=i,g=i.toString(),x=P(this,vd,Bx).call(this,i).closest(".textLayer"),y=this.getSelectionBoxes(x);if(!y)return;i.empty();const v=P(this,fg,vb).call(this,x),C=u(this,vn)===Be.NONE,R=()=>{const I=v==null?void 0:v.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:y,anchorNode:r,anchorOffset:o,focusNode:l,focusOffset:h,text:g});C&&this.showAllEditors("highlight",!0,!0),t&&(I==null||I.editComment())};if(C){this.switchToMode(Be.HIGHLIGHT,R);return}R()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!u(this,Hr))return null;const t=`${H1}${e}`,i=u(this,Hr).getRawValue(t);return i&&u(this,Hr).remove(t),i}addToAnnotationStorage(e){!e.isEmpty()&&u(this,Hr)&&!u(this,Hr).has(e.id)&&u(this,Hr).setValue(e.id,e)}a11yAlert(e,t=null){const i=u(this,dg);i&&(i.setAttribute("data-l10n-id",e),t?i.setAttribute("data-l10n-args",JSON.stringify(t)):i.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,u(this,Xa)&&(S(this,Xa,!1),P(this,_c,q0).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of u(this,gt))if(t.div.contains(e)){S(this,Sc,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!u(this,Sc))return;const[e,t]=u(this,Sc);S(this,Sc,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){P(this,gg,bb).call(this),P(this,pg,Eb).call(this)}removeEditListeners(){P(this,dw,S4).call(this),P(this,mg,Cb).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const i of u(this,Wr))if(i.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const i of u(this,Wr))if(i.isHandlingMimeForPasting(t.type)){i.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var i;if(e.preventDefault(),(i=u(this,or))==null||i.commitOrRemove(),!this.hasSelection)return;const t=[];for(const r of u(this,gt)){const o=r.serialize(!0);o&&t.push(o)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const o of t.items)for(const l of u(this,Wr))if(l.isHandlingMimeForPasting(o.type)){l.paste(o,this.currentLayer);return}let i=t.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(o){Fe(`paste: "${o.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const r=this.currentLayer;try{const o=[];for(const g of i){const p=await r.deserialize(g);if(!p)return;o.push(p)}const l=()=>{for(const g of o)P(this,xg,Sb).call(this,g);P(this,wg,_b).call(this,o)},h=()=>{for(const g of o)g.remove()};this.addCommands({cmd:l,undo:h,mustExec:!0})}catch(o){Fe(`paste: "${o.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),u(this,vn)!==Be.NONE&&!this.isEditorHandlingKeyboard&&Yh._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,u(this,Xa)&&(S(this,Xa,!1),P(this,_c,q0).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(P(this,uw,E4).call(this),P(this,pg,Eb).call(this),P(this,qn,Ei).call(this,{isEditing:u(this,vn)!==Be.NONE,isEmpty:P(this,Tc,Z0).call(this),hasSomethingToUndo:u(this,Vr).hasSomethingToUndo(),hasSomethingToRedo:u(this,Vr).hasSomethingToRedo(),hasSelectedEditor:!1})):(P(this,hw,C4).call(this),P(this,mg,Cb).call(this),P(this,qn,Ei).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!u(this,Wr)){S(this,Wr,e);for(const t of u(this,Wr))P(this,gs,Eo).call(this,t.defaultPropertiesToUpdate)}}getId(){return u(this,ow).id}get currentLayer(){return u(this,Nn).get(u(this,pd))}getLayer(e){return u(this,Nn).get(e)}get currentPageIndex(){return u(this,pd)}addLayer(e){u(this,Nn).set(e.pageIndex,e),u(this,Ya)?e.enable():e.disable()}removeLayer(e){u(this,Nn).delete(e.pageIndex)}async updateMode(e,t=null,i=!1,r=!1,o=!1){var l,h,g,p,x,y;if(u(this,vn)!==e&&!(u(this,Gr)&&(await u(this,Gr).promise,!u(this,Gr)))){if(S(this,Gr,Promise.withResolvers()),(l=u(this,Va))==null||l.commitOrRemove(),u(this,vn)===Be.POPUP&&((h=u(this,di))==null||h.hideSidebar()),(g=u(this,di))==null||g.destroyPopup(),S(this,vn,e),e===Be.NONE){this.setEditingState(!1),P(this,pw,I4).call(this);for(const v of u(this,on).values())v.hideStandaloneCommentButton();(p=this._editorUndoBar)==null||p.hide(),this.toggleComment(null),u(this,Gr).resolve();return}for(const v of u(this,on).values())v.addStandaloneCommentButton();e===Be.SIGNATURE&&await((x=u(this,qa))==null?void 0:x.loadSignatures()),this.setEditingState(!0),await P(this,gw,T4).call(this),this.unselectAll();for(const v of u(this,Nn).values())v.updateMode(e);if(e===Be.POPUP){u(this,dd)||S(this,dd,await u(this,Ad).getAnnotationsByType(new Set(u(this,Wr).map(R=>R._editorType))));const v=new Set,C=[];for(const R of u(this,on).values()){const{annotationElementId:I,hasComment:O,deleted:_}=R;I&&v.add(I),O&&!_&&C.push(R.getData())}for(const R of u(this,dd)){const{id:I,popupRef:O,contentsObj:_}=R;O&&(_!=null&&_.str)&&!v.has(I)&&!u(this,Wa).has(I)&&C.push(R)}(y=u(this,di))==null||y.showSidebar(C)}if(!t){i&&this.addNewEditorFromKeyboard(),u(this,Gr).resolve();return}for(const v of u(this,on).values())v.uid===t?(this.setSelected(v),o?v.editComment():r?v.enterInEditMode():v.focus()):v.unselect();u(this,Gr).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==u(this,vn)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(u(this,Wr)){switch(e){case Ze.CREATE:this.currentLayer.addNewEditor(t);return;case Ze.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(u(this,cg)||S(this,cg,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const i of u(this,gt))i.updateParams(e,t);else for(const i of u(this,Wr))i.updateDefaultParams(e,t)}}showAllEditors(e,t,i=!1){var o;for(const l of u(this,on).values())l.editorType===e&&l.show(t);(((o=u(this,cg))==null?void 0:o.get(Ze.HIGHLIGHT_SHOW_ALL))??!0)!==t&&P(this,gs,Eo).call(this,[[Ze.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(u(this,ag)!==e){S(this,ag,e);for(const t of u(this,Nn).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of u(this,on).values())t.pageIndex===e&&(yield t)}getEditor(e){return u(this,on).get(e)}addEditor(e){u(this,on).set(e.id,e)}removeEditor(e){var t,i;e.div.contains(document.activeElement)&&(u(this,$s)&&clearTimeout(u(this,$s)),S(this,$s,setTimeout(()=>{this.focusMainContainer(),S(this,$s,null)},0))),u(this,on).delete(e.id),e.annotationElementId&&((t=u(this,Ka))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!u(this,Wa).has(e.annotationElementId))&&((i=u(this,Hr))==null||i.remove(e.id))}addDeletedAnnotationElement(e){u(this,Wa).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return u(this,Wa).has(e)}removeDeletedAnnotationElement(e){u(this,Wa).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){u(this,or)!==e&&(S(this,or,e),e&&P(this,gs,Eo).call(this,e.propertiesToUpdate))}updateUI(e){u(this,mw,N4)===e&&P(this,gs,Eo).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){P(this,gs,Eo).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(u(this,gt).has(e)){u(this,gt).delete(e),e.unselect(),P(this,qn,Ei).call(this,{hasSelectedEditor:this.hasSelection});return}u(this,gt).add(e),e.select(),P(this,gs,Eo).call(this,e.propertiesToUpdate),P(this,qn,Ei).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.id}),(t=u(this,Va))==null||t.commitOrRemove();for(const i of u(this,gt))i!==e&&i.unselect();u(this,gt).clear(),u(this,gt).add(e),e.select(),P(this,gs,Eo).call(this,e.propertiesToUpdate),P(this,qn,Ei).call(this,{hasSelectedEditor:!0})}isSelected(e){return u(this,gt).has(e)}get firstSelectedEditor(){return u(this,gt).values().next().value}unselect(e){e.unselect(),u(this,gt).delete(e),P(this,qn,Ei).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return u(this,gt).size!==0}get isEnterHandled(){return u(this,gt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;u(this,Vr).undo(),P(this,qn,Ei).call(this,{hasSomethingToUndo:u(this,Vr).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:P(this,Tc,Z0).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){u(this,Vr).redo(),P(this,qn,Ei).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:u(this,Vr).hasSomethingToRedo(),isEmpty:P(this,Tc,Z0).call(this)})}addCommands(e){u(this,Vr).add(e),P(this,qn,Ei).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:P(this,Tc,Z0).call(this)})}cleanUndoStack(e){u(this,Vr).cleanType(e)}delete(){var o;this.commitOrRemove();const e=(o=this.currentLayer)==null?void 0:o.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...u(this,gt)],i=()=>{var l;(l=this._editorUndoBar)==null||l.show(r,t.length===1?t[0].editorType:t.length);for(const h of t)h.remove()},r=()=>{for(const l of t)P(this,xg,Sb).call(this,l)};this.addCommands({cmd:i,undo:r,mustExec:!0})}commitOrRemove(){var e;(e=u(this,or))==null||e.commitOrRemove()}hasSomethingToControl(){return u(this,or)||this.hasSelection}selectAll(){for(const e of u(this,gt))e.commit();P(this,wg,_b).call(this,u(this,on).values())}unselectAll(){var e;if(!(u(this,or)&&(u(this,or).commitOrRemove(),u(this,vn)!==Be.NONE))&&!((e=u(this,Va))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of u(this,gt))t.unselect();u(this,gt).clear(),P(this,qn,Ei).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;u(this,Qa)[0]+=e,u(this,Qa)[1]+=t;const[r,o]=u(this,Qa),l=[...u(this,gt)],h=1e3;u(this,qs)&&clearTimeout(u(this,qs)),S(this,qs,setTimeout(()=>{S(this,qs,null),u(this,Qa)[0]=u(this,Qa)[1]=0,this.addCommands({cmd:()=>{for(const g of l)u(this,on).has(g.id)&&(g.translateInPage(r,o),g.translationDone())},undo:()=>{for(const g of l)u(this,on).has(g.id)&&(g.translateInPage(-r,-o),g.translationDone())},mustExec:!1})},h));for(const g of l)g.translateInPage(e,t),g.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),S(this,Ys,new Map);for(const e of u(this,gt))u(this,Ys).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!u(this,Ys))return!1;this.disableUserSelect(!1);const e=u(this,Ys);S(this,Ys,null);let t=!1;for(const[{x:r,y:o,pageIndex:l},h]of e)h.newX=r,h.newY=o,h.newPageIndex=l,t||(t=r!==h.savedX||o!==h.savedY||l!==h.savedPageIndex);if(!t)return!1;const i=(r,o,l,h)=>{if(u(this,on).has(r.id)){const g=u(this,Nn).get(h);g?r._setParentAndPosition(g,o,l):(r.pageIndex=h,r.x=o,r.y=l)}};return this.addCommands({cmd:()=>{for(const[r,{newX:o,newY:l,newPageIndex:h}]of e)i(r,o,l,h)},undo:()=>{for(const[r,{savedX:o,savedY:l,savedPageIndex:h}]of e)i(r,o,l,h)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(u(this,Ys))for(const i of u(this,Ys).keys())i.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||u(this,gt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return u(this,or)===e}getActive(){return u(this,or)}getMode(){return u(this,vn)}isEditingMode(){return u(this,vn)!==Be.NONE}get imageManager(){return Ve(this,"imageManager",new yb)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let p=0,x=t.rangeCount;p<x;p++)if(!e.contains(t.getRangeAt(p).commonAncestorContainer))return null;const{x:i,y:r,width:o,height:l}=e.getBoundingClientRect();let h;switch(e.getAttribute("data-main-rotation")){case"90":h=(p,x,y,v)=>({x:(x-r)/l,y:1-(p+y-i)/o,width:v/l,height:y/o});break;case"180":h=(p,x,y,v)=>({x:1-(p+y-i)/o,y:1-(x+v-r)/l,width:y/o,height:v/l});break;case"270":h=(p,x,y,v)=>({x:1-(x+v-r)/l,y:(p-i)/o,width:v/l,height:y/o});break;default:h=(p,x,y,v)=>({x:(p-i)/o,y:(x-r)/l,width:y/o,height:v/l});break}const g=[];for(let p=0,x=t.rangeCount;p<x;p++){const y=t.getRangeAt(p);if(!y.collapsed)for(const{x:v,y:C,width:R,height:I}of y.getClientRects())R===0||I===0||g.push(h(v,C,R,I))}return g.length===0?null:g}addChangedExistingAnnotation({annotationElementId:e,id:t}){(u(this,gd)||S(this,gd,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=u(this,gd))==null||t.delete(e)}renderAnnotationElement(e){var r;const t=(r=u(this,gd))==null?void 0:r.get(e.data.id);if(!t)return;const i=u(this,Hr).getRawValue(t);i&&(u(this,vn)===Be.NONE&&!i.hasBeenModified||i.renderAnnotationElement(e))}setMissingCanvas(e,t,i){var o;const r=(o=u(this,Ka))==null?void 0:o.get(e);r&&(r.setCanvas(t,i),u(this,Ka).delete(e))}addMissingCanvas(e,t){(u(this,Ka)||S(this,Ka,new Map)).set(e,t)}};hd=new WeakMap,or=new WeakMap,dd=new WeakMap,on=new WeakMap,Nn=new WeakMap,fd=new WeakMap,Hr=new WeakMap,gd=new WeakMap,Vr=new WeakMap,di=new WeakMap,Ha=new WeakMap,Va=new WeakMap,pd=new WeakMap,Wa=new WeakMap,Ys=new WeakMap,Wr=new WeakMap,Cc=new WeakMap,rg=new WeakMap,sg=new WeakMap,md=new WeakMap,og=new WeakMap,$s=new WeakMap,Ga=new WeakMap,xd=new WeakMap,Xa=new WeakMap,Ks=new WeakMap,ow=new WeakMap,Ya=new WeakMap,wd=new WeakMap,ag=new WeakMap,$a=new WeakMap,Sc=new WeakMap,yd=new WeakMap,Ka=new WeakMap,lg=new WeakMap,vn=new WeakMap,gt=new WeakMap,ko=new WeakMap,qa=new WeakMap,Za=new WeakMap,cg=new WeakMap,Ad=new WeakMap,ug=new WeakMap,Qa=new WeakMap,qs=new WeakMap,Po=new WeakMap,hg=new WeakMap,dg=new WeakMap,Gr=new WeakMap,vd=new WeakSet,Bx=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},fg=new WeakSet,vb=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const i of u(this,Nn).values())if(i.hasTextLayer(e))return i;return null},aw=new WeakSet,A4=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const i=P(this,vd,Bx).call(this,e).closest(".textLayer"),r=this.getSelectionBoxes(i);r&&(u(this,Ks)||S(this,Ks,new p6(this)),u(this,Ks).show(i,r,this.direction==="ltr"))},lw=new WeakSet,v4=function(){var o,l,h;const e=document.getSelection();if(!e||e.isCollapsed){u(this,ko)&&((o=u(this,Ks))==null||o.hide(),S(this,ko,null),P(this,qn,Ei).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===u(this,ko))return;const r=P(this,vd,Bx).call(this,e).closest(".textLayer");if(!r){u(this,ko)&&((l=u(this,Ks))==null||l.hide(),S(this,ko,null),P(this,qn,Ei).call(this,{hasSelectedText:!1}));return}if((h=u(this,Ks))==null||h.hide(),S(this,ko,t),P(this,qn,Ei).call(this,{hasSelectedText:!0}),!(u(this,vn)!==Be.HIGHLIGHT&&u(this,vn)!==Be.NONE)&&(u(this,vn)===Be.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),S(this,Xa,this.isShiftKeyDown),!this.isShiftKeyDown)){const g=u(this,vn)===Be.HIGHLIGHT?P(this,fg,vb).call(this,r):null;if(g==null||g.toggleDrawing(),u(this,wd)){const p=new AbortController,x=this.combinedSignal(p),y=v=>{v.type==="pointerup"&&v.button!==0||(p.abort(),g==null||g.toggleDrawing(!0),v.type==="pointerup"&&P(this,_c,q0).call(this,"main_toolbar"))};window.addEventListener("pointerup",y,{signal:x}),window.addEventListener("blur",y,{signal:x})}else g==null||g.toggleDrawing(!0),P(this,_c,q0).call(this,"main_toolbar")}},_c=new WeakSet,q0=function(e=""){u(this,vn)===Be.HIGHLIGHT?this.highlightSelection(e):u(this,rg)&&P(this,aw,A4).call(this)},cw=new WeakSet,b4=function(){document.addEventListener("selectionchange",P(this,lw,v4).bind(this),{signal:this._signal})},uw=new WeakSet,E4=function(){if(u(this,Ga))return;S(this,Ga,new AbortController);const e=this.combinedSignal(u(this,Ga));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},hw=new WeakSet,C4=function(){var e;(e=u(this,Ga))==null||e.abort(),S(this,Ga,null)},gg=new WeakSet,bb=function(){if(u(this,$a))return;S(this,$a,new AbortController);const e=this.combinedSignal(u(this,$a));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},dw=new WeakSet,S4=function(){var e;(e=u(this,$a))==null||e.abort(),S(this,$a,null)},pg=new WeakSet,Eb=function(){if(u(this,Ha))return;S(this,Ha,new AbortController);const e=this.combinedSignal(u(this,Ha));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},mg=new WeakSet,Cb=function(){var e;(e=u(this,Ha))==null||e.abort(),S(this,Ha,null)},fw=new WeakSet,_4=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},qn=new WeakSet,Ei=function(e){Object.entries(e).some(([i,r])=>u(this,ug)[i]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(u(this,ug),e)}),u(this,vn)===Be.HIGHLIGHT&&e.hasSelectedEditor===!1&&P(this,gs,Eo).call(this,[[Ze.HIGHLIGHT_FREE,!0]]))},gs=new WeakSet,Eo=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},gw=new WeakSet,T4=async function(){if(!u(this,Ya)){S(this,Ya,!0);const e=[];for(const t of u(this,Nn).values())e.push(t.enable());await Promise.all(e);for(const t of u(this,on).values())t.enable()}},pw=new WeakSet,I4=function(){if(this.unselectAll(),u(this,Ya)){S(this,Ya,!1);for(const e of u(this,Nn).values())e.disable();for(const e of u(this,on).values())e.disable()}},xg=new WeakSet,Sb=function(e){const t=u(this,Nn).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},mw=new WeakSet,N4=function(){let e=null;for(e of u(this,gt));return e},Tc=new WeakSet,Z0=function(){if(u(this,on).size===0)return!0;if(u(this,on).size===1)for(const e of u(this,on).values())return e.isEmpty();return!1},wg=new WeakSet,_b=function(e){for(const t of u(this,gt))t.unselect();u(this,gt).clear();for(const t of e)t.isEmpty()||(u(this,gt).add(t),t.select());P(this,qn,Ei).call(this,{hasSelectedEditor:this.hasSelection})},ue(Yh,"TRANSLATE_SMALL",1),ue(Yh,"TRANSLATE_BIG",10);let Zl=Yh;var On,Zs,ps,bd,Qs,ar,Ed,Js,Vi,Do,Ic,eo,Ja,Nc,Q0,Cd,Fx;const Ci=class Ci{constructor(e){E(this,Nc);E(this,Cd);E(this,On,null);E(this,Zs,!1);E(this,ps,null);E(this,bd,null);E(this,Qs,null);E(this,ar,null);E(this,Ed,!1);E(this,Js,null);E(this,Vi,null);E(this,Do,null);E(this,Ic,null);E(this,eo,!1);S(this,Vi,e),S(this,eo,e._uiManager.useNewAltTextFlow),u(Ci,Ja)||S(Ci,Ja,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Ci._l10n??(Ci._l10n=e)}async render(){const e=S(this,ps,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=S(this,bd,document.createElement("span"));e.append(t),u(this,eo)?(e.classList.add("new"),e.setAttribute("data-l10n-id",u(Ci,Ja).missing),t.setAttribute("data-l10n-id",u(Ci,Ja)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=u(this,Vi)._uiManager._signal;e.addEventListener("contextmenu",Rr,{signal:i}),e.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:i});const r=o=>{o.preventDefault(),u(this,Vi)._uiManager.editAltText(u(this,Vi)),u(this,eo)&&u(this,Vi)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:u(this,Nc,Q0)}})};return e.addEventListener("click",r,{capture:!0,signal:i}),e.addEventListener("keydown",o=>{o.target===e&&o.key==="Enter"&&(S(this,Ed,!0),r(o))},{signal:i}),await P(this,Cd,Fx).call(this),e}finish(){u(this,ps)&&(u(this,ps).focus({focusVisible:u(this,Ed)}),S(this,Ed,!1))}isEmpty(){return u(this,eo)?u(this,On)===null:!u(this,On)&&!u(this,Zs)}hasData(){return u(this,eo)?u(this,On)!==null||!!u(this,Do):this.isEmpty()}get guessedText(){return u(this,Do)}async setGuessedText(e){u(this,On)===null&&(S(this,Do,e),S(this,Ic,await Ci._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),P(this,Cd,Fx).call(this))}toggleAltTextBadge(e=!1){var t;if(!u(this,eo)||u(this,On)){(t=u(this,Js))==null||t.remove(),S(this,Js,null);return}if(!u(this,Js)){const i=S(this,Js,document.createElement("div"));i.className="noAltTextBadge",u(this,Vi).div.append(i)}u(this,Js).classList.toggle("hidden",!e)}serialize(e){let t=u(this,On);return!e&&u(this,Do)===t&&(t=u(this,Ic)),{altText:t,decorative:u(this,Zs),guessedText:u(this,Do),textWithDisclaimer:u(this,Ic)}}get data(){return{altText:u(this,On),decorative:u(this,Zs)}}set data({altText:e,decorative:t,guessedText:i,textWithDisclaimer:r,cancel:o=!1}){i&&(S(this,Do,i),S(this,Ic,r)),!(u(this,On)===e&&u(this,Zs)===t)&&(o||(S(this,On,e),S(this,Zs,t)),P(this,Cd,Fx).call(this))}toggle(e=!1){u(this,ps)&&(!e&&u(this,ar)&&(clearTimeout(u(this,ar)),S(this,ar,null)),u(this,ps).disabled=!e)}shown(){u(this,Vi)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:u(this,Nc,Q0)}})}destroy(){var e,t;(e=u(this,ps))==null||e.remove(),S(this,ps,null),S(this,bd,null),S(this,Qs,null),(t=u(this,Js))==null||t.remove(),S(this,Js,null)}};On=new WeakMap,Zs=new WeakMap,ps=new WeakMap,bd=new WeakMap,Qs=new WeakMap,ar=new WeakMap,Ed=new WeakMap,Js=new WeakMap,Vi=new WeakMap,Do=new WeakMap,Ic=new WeakMap,eo=new WeakMap,Ja=new WeakMap,Nc=new WeakSet,Q0=function(){return u(this,On)&&"added"||u(this,On)===null&&this.guessedText&&"review"||"missing"},Cd=new WeakSet,Fx=async function(){var r,o,l;const e=u(this,ps);if(!e)return;if(u(this,eo)){if(e.classList.toggle("done",!!u(this,On)),e.setAttribute("data-l10n-id",u(Ci,Ja)[u(this,Nc,Q0)]),(r=u(this,bd))==null||r.setAttribute("data-l10n-id",u(Ci,Ja)[`${u(this,Nc,Q0)}-label`]),!u(this,On)){(o=u(this,Qs))==null||o.remove();return}}else{if(!u(this,On)&&!u(this,Zs)){e.classList.remove("done"),(l=u(this,Qs))==null||l.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=u(this,Qs);if(!t){S(this,Qs,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${u(this,Vi).id}`;const h=100,g=u(this,Vi)._uiManager._signal;g.addEventListener("abort",()=>{clearTimeout(u(this,ar)),S(this,ar,null)},{once:!0}),e.addEventListener("mouseenter",()=>{S(this,ar,setTimeout(()=>{S(this,ar,null),u(this,Qs).classList.add("show"),u(this,Vi)._reportTelemetry({action:"alt_text_tooltip"})},h))},{signal:g}),e.addEventListener("mouseleave",()=>{var p;u(this,ar)&&(clearTimeout(u(this,ar)),S(this,ar,null)),(p=u(this,Qs))==null||p.classList.remove("show")},{signal:g})}u(this,Zs)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=u(this,On)),t.parentNode||e.append(t);const i=u(this,Vi).getElementForAltText();i==null||i.setAttribute("aria-describedby",t.id)},E(Ci,Ja,null),ue(Ci,"_l10n",null);let U2=Ci;var Zn,Xr,Rc,kt,yg,kc,ms,Pc,Dc,Mc,Ag,Tb;class dx{constructor(e){E(this,Ag);E(this,Zn,null);E(this,Xr,null);E(this,Rc,!1);E(this,kt,null);E(this,yg,null);E(this,kc,null);E(this,ms,null);E(this,Pc,null);E(this,Dc,!1);E(this,Mc,null);S(this,kt,e)}renderForToolbar(){const e=S(this,Xr,document.createElement("button"));return e.className="comment",P(this,Ag,Tb).call(this,e,!1)}renderForStandalone(){const e=S(this,Zn,document.createElement("button"));e.className="annotationCommentButton";const t=u(this,kt).commentButtonPosition;if(t){const{style:i}=e;i.insetInlineEnd=`calc(${100*(u(this,kt)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,i.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const r=u(this,kt).commentButtonColor;r&&(i.backgroundColor=r)}return P(this,Ag,Tb).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=u(this,Zn)??u(this,Xr))==null||e.focus()},0)}onUpdatedColor(){if(!u(this,Zn))return;const e=u(this,kt).commentButtonColor;e&&(u(this,Zn).style.backgroundColor=e),u(this,kt)._uiManager.updatePopupColor(u(this,kt))}get commentButtonWidth(){var e;return(((e=u(this,Zn))==null?void 0:e.getBoundingClientRect().width)??0)/u(this,kt).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(u(this,Mc))return u(this,Mc);if(!u(this,Zn))return null;const{x:e,y:t,height:i}=u(this,Zn).getBoundingClientRect(),{x:r,y:o,width:l,height:h}=u(this,kt).parent.boundingClientRect;return[(e-r)/l,(t+i-o)/h]}set commentPopupPositionInLayer(e){S(this,Mc,e)}hasDefaultPopupPosition(){return u(this,Mc)===null}removeStandaloneCommentButton(){var e;(e=u(this,Zn))==null||e.remove(),S(this,Zn,null)}removeToolbarCommentButton(){var e;(e=u(this,Xr))==null||e.remove(),S(this,Xr,null)}setCommentButtonStates({selected:e,hasPopup:t}){u(this,Zn)&&(u(this,Zn).classList.toggle("selected",e),u(this,Zn).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let i,r;if(t)[i,r]=t;else{[i,r]=u(this,kt).commentButtonPosition;const{width:x,height:y,x:v,y:C}=u(this,kt);i=v+i*x,r=C+r*y}const o=u(this,kt).parent.boundingClientRect,{x:l,y:h,width:g,height:p}=o;u(this,kt)._uiManager.editComment(u(this,kt),l+i*g,h+r*p,{...e,parentDimensions:o})}finish(){u(this,Xr)&&(u(this,Xr).focus({focusVisible:u(this,Rc)}),S(this,Rc,!1))}isDeleted(){return u(this,Dc)||u(this,ms)===""}isEmpty(){return u(this,ms)===null}hasBeenEdited(){return this.isDeleted()||u(this,ms)!==u(this,yg)}serialize(){return this.data}get data(){return{text:u(this,ms),richText:u(this,kc),date:u(this,Pc),deleted:this.isDeleted()}}set data(e){if(e!==u(this,ms)&&S(this,kc,null),e===null){S(this,ms,""),S(this,Dc,!0);return}S(this,ms,e),S(this,Pc,new Date),S(this,Dc,!1)}setInitialText(e,t=null){S(this,yg,e),this.data=e,S(this,Pc,null),S(this,kc,t)}shown(){}destroy(){var e,t;(e=u(this,Xr))==null||e.remove(),S(this,Xr,null),(t=u(this,Zn))==null||t.remove(),S(this,Zn,null),S(this,ms,""),S(this,kc,null),S(this,Pc,null),S(this,kt,null),S(this,Rc,!1),S(this,Dc,!1)}}Zn=new WeakMap,Xr=new WeakMap,Rc=new WeakMap,kt=new WeakMap,yg=new WeakMap,kc=new WeakMap,ms=new WeakMap,Pc=new WeakMap,Dc=new WeakMap,Mc=new WeakMap,Ag=new WeakSet,Tb=function(e,t){if(!u(this,kt)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[u(this,kt)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const i=u(this,kt)._uiManager._signal;if(!(i instanceof AbortSignal)||i.aborted)return e;e.addEventListener("contextmenu",Rr,{signal:i}),t&&(e.addEventListener("focusin",o=>{u(this,kt)._focusEventsAllowed=!1,Zt(o)},{capture:!0,signal:i}),e.addEventListener("focusout",o=>{u(this,kt)._focusEventsAllowed=!0,Zt(o)},{capture:!0,signal:i})),e.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:i});const r=o=>{o.preventDefault(),e===u(this,Xr)?this.edit():u(this,kt).toggleComment(!0)};return e.addEventListener("click",r,{capture:!0,signal:i}),e.addEventListener("keydown",o=>{o.target===e&&o.key==="Enter"&&(S(this,Rc,!0),r(o))},{signal:i}),e.addEventListener("pointerenter",()=>{u(this,kt).toggleComment(!1,!0)},{signal:i}),e.addEventListener("pointerleave",()=>{u(this,kt).toggleComment(!1,!1)},{signal:i}),e};var Sd,Oc,vg,bg,Eg,Cg,Sg,Mo,Lc,Oo,Bc,Lo,xw,R4,ww,k4,yw,P4;const hS=class hS{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:i=null,onPinchStart:r=null,onPinching:o=null,onPinchEnd:l=null,signal:h}){E(this,xw);E(this,ww);E(this,yw);E(this,Sd,void 0);E(this,Oc,!1);E(this,vg,null);E(this,bg,void 0);E(this,Eg,void 0);E(this,Cg,void 0);E(this,Sg,void 0);E(this,Mo,null);E(this,Lc,void 0);E(this,Oo,null);E(this,Bc,void 0);E(this,Lo,null);S(this,Sd,e),S(this,vg,i),S(this,bg,t),S(this,Eg,r),S(this,Cg,o),S(this,Sg,l),S(this,Bc,new AbortController),S(this,Lc,AbortSignal.any([h,u(this,Bc).signal])),e.addEventListener("touchstart",P(this,xw,R4).bind(this),{passive:!1,signal:u(this,Lc)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ms.pixelRatio}destroy(){var e,t;(e=u(this,Bc))==null||e.abort(),S(this,Bc,null),(t=u(this,Mo))==null||t.abort(),S(this,Mo,null)}};Sd=new WeakMap,Oc=new WeakMap,vg=new WeakMap,bg=new WeakMap,Eg=new WeakMap,Cg=new WeakMap,Sg=new WeakMap,Mo=new WeakMap,Lc=new WeakMap,Oo=new WeakMap,Bc=new WeakMap,Lo=new WeakMap,xw=new WeakSet,R4=function(e){var r,o,l;if((r=u(this,bg))!=null&&r.call(this))return;if(e.touches.length===1){if(u(this,Mo))return;const h=S(this,Mo,new AbortController),g=AbortSignal.any([u(this,Lc),h.signal]),p=u(this,Sd),x={capture:!0,signal:g,passive:!1},y=v=>{var C;v.pointerType==="touch"&&((C=u(this,Mo))==null||C.abort(),S(this,Mo,null))};p.addEventListener("pointerdown",v=>{v.pointerType==="touch"&&(Zt(v),y(v))},x),p.addEventListener("pointerup",y,x),p.addEventListener("pointercancel",y,x);return}if(!u(this,Lo)){S(this,Lo,new AbortController);const h=AbortSignal.any([u(this,Lc),u(this,Lo).signal]),g=u(this,Sd),p={signal:h,capture:!1,passive:!1};g.addEventListener("touchmove",P(this,ww,k4).bind(this),p);const x=P(this,yw,P4).bind(this);g.addEventListener("touchend",x,p),g.addEventListener("touchcancel",x,p),p.capture=!0,g.addEventListener("pointerdown",Zt,p),g.addEventListener("pointermove",Zt,p),g.addEventListener("pointercancel",Zt,p),g.addEventListener("pointerup",Zt,p),(o=u(this,Eg))==null||o.call(this)}if(Zt(e),e.touches.length!==2||(l=u(this,vg))!=null&&l.call(this)){S(this,Oo,null);return}let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]),S(this,Oo,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:i.screenX,touch1Y:i.screenY})},ww=new WeakSet,k4=function(e){var B;if(!u(this,Oo)||e.touches.length!==2)return;Zt(e);let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]);const{screenX:r,screenY:o}=t,{screenX:l,screenY:h}=i,g=u(this,Oo),{touch0X:p,touch0Y:x,touch1X:y,touch1Y:v}=g,C=y-p,R=v-x,I=l-r,O=h-o,_=Math.hypot(I,O)||1,N=Math.hypot(C,R)||1;if(!u(this,Oc)&&Math.abs(N-_)<=hS.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(g.touch0X=r,g.touch0Y=o,g.touch1X=l,g.touch1Y=h,!u(this,Oc)){S(this,Oc,!0);return}const k=[(r+l)/2,(o+h)/2];(B=u(this,Cg))==null||B.call(this,k,N,_)},yw=new WeakSet,P4=function(e){var t;e.touches.length>=2||(u(this,Lo)&&(u(this,Lo).abort(),S(this,Lo,null),(t=u(this,Sg))==null||t.call(this)),u(this,Oo)&&(Zt(e),S(this,Oo,null),S(this,Oc,!1)))};let X1=hS;var Fc,xs,Ht,St,Bo,_d,el,_g,Qn,Uc,Fo,to,tl,Tg,jc,lr,Ig,zc,Uo,no,Td,Id,Yr,Hc,Ng,Aw,Rg,Ib,kg,Nb,Nd,Ux,vw,D4,bw,M4,Pg,Rb,Rd,jx,Dg,kb,Ew,O4,Cw,L4,Sw,B4,Mg,Pb,_w,F4,Og,Db,Tw,U4,Iw,j4,Nw,z4,Lg,Mb,Vc,J0;const Ue=class Ue{constructor(e){E(this,Rg);E(this,Nd);E(this,vw);E(this,bw);E(this,Pg);E(this,Rd);E(this,Dg);E(this,Ew);E(this,Cw);E(this,Sw);E(this,Mg);E(this,_w);E(this,Og);E(this,Tw);E(this,Iw);E(this,Nw);E(this,Lg);E(this,Vc);E(this,Fc,null);E(this,xs,null);E(this,Ht,null);E(this,St,null);E(this,Bo,null);E(this,_d,!1);E(this,el,null);E(this,_g,"");E(this,Qn,null);E(this,Uc,null);E(this,Fo,null);E(this,to,null);E(this,tl,null);E(this,Tg,"");E(this,jc,!1);E(this,lr,null);E(this,Ig,!1);E(this,zc,!1);E(this,Uo,!1);E(this,no,null);E(this,Td,0);E(this,Id,0);E(this,Yr,null);E(this,Hc,null);ue(this,"isSelected",!1);ue(this,"_isCopy",!1);ue(this,"_editToolbar",null);ue(this,"_initialOptions",Object.create(null));ue(this,"_initialData",null);ue(this,"_isVisible",!0);ue(this,"_uiManager",null);ue(this,"_focusEventsAllowed",!0);E(this,Ng,!1);E(this,Aw,Ue._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null;const{rotation:t,rawDims:{pageWidth:i,pageHeight:r,pageX:o,pageY:l}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,r],this.pageTranslation=[o,l];const[h,g]=this.parentDimensions;this.x=e.x/h,this.y=e.y/g,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Ue.prototype._resizeWithKeyboard,t=Zl.TRANSLATE_SMALL,i=Zl.TRANSLATE_BIG;return Ve(this,"_resizerKeyboardManager",new Mm([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],Ue.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Ve(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new w6({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Ue._l10n??(Ue._l10n=e),Ue._l10nResizer||(Ue._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Ue._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Ue._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){It("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return u(this,Ng)}set _isDraggable(e){var t;S(this,Ng,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=u(this,Aw)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(P(this,Vc,J0).call(this),(t=u(this,to))==null||t.remove(),S(this,to,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(u(this,jc)?S(this,jc,!1):this.parent.setSelected(this))}focusout(e){var i;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(i=this.parent)!=null&&i.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,r){const[o,l]=this.parentDimensions;[i,r]=this.screenToPageTranslation(i,r),this.x=(e+i)/o,this.y=(t+r)/l,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[i,r]=this.parentDimensions;this.setAt(e*i,t*r,this.width*i,this.height*r),this._onTranslated()}translate(e,t){P(this,Rg,Ib).call(this,this.parentDimensions,e,t)}translateInPage(e,t){u(this,lr)||S(this,lr,[this.x,this.y,this.width,this.height]),P(this,Rg,Ib).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){u(this,lr)||S(this,lr,[this.x,this.y,this.width,this.height]);const{div:i,parentDimensions:[r,o]}=this;if(this.x+=e/r,this.y+=t/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:y,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,y,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:h}=this;const[g,p]=this.getBaseTranslation();l+=g,h+=p;const{style:x}=i;x.left=`${(100*l).toFixed(2)}%`,x.top=`${(100*h).toFixed(2)}%`,this._onTranslating(l,h),i.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!u(this,lr)&&(u(this,lr)[0]!==this.x||u(this,lr)[1]!==this.y)}get _hasBeenResized(){return!!u(this,lr)&&(u(this,lr)[2]!==this.width||u(this,lr)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:i}=Ue,r=i/e,o=i/t;switch(this.rotation){case 90:return[-r,o];case 180:return[r,o];case 270:return[r,-o];default:return[-r,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[i,r]}=this;let{x:o,y:l,width:h,height:g}=this;if(h*=i,g*=r,o*=i,l*=r,this._mustFixPosition)switch(e){case 0:o=xi(o,0,i-h),l=xi(l,0,r-g);break;case 90:o=xi(o,0,i-g),l=xi(l,h,r);break;case 180:o=xi(o,h,i),l=xi(l,g,r);break;case 270:o=xi(o,g,i),l=xi(l,0,r-h);break}this.x=o/=i,this.y=l/=r;const[p,x]=this.getBaseTranslation();o+=p,l+=x,t.left=`${(100*o).toFixed(2)}%`,t.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var i;return P(i=Ue,kg,Nb).call(i,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var i;return P(i=Ue,kg,Nb).call(i,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(){const{div:{style:e},width:t,height:i}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*i).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=u(this,Ht))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||u(this,zc))return this._editToolbar;this._editToolbar=new xb(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,i]of e)await this._editToolbar.addButton(t,i);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=u(this,Ht))==null||t.destroy()}addContainer(e){var i;const t=(i=this._editToolbar)==null?void 0:i.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return u(this,Ht)||(U2.initialize(Ue._l10n),S(this,Ht,new U2(this)),u(this,Fc)&&(u(this,Ht).data=u(this,Fc),S(this,Fc,null))),u(this,Ht)}get altTextData(){var e;return(e=u(this,Ht))==null?void 0:e.data}set altTextData(e){u(this,Ht)&&(u(this,Ht).data=e)}get guessedAltText(){var e;return(e=u(this,Ht))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=u(this,Ht))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=u(this,Ht))==null?void 0:t.serialize(e)}hasAltText(){return!!u(this,Ht)&&!u(this,Ht).isEmpty()}hasAltTextData(){var e;return((e=u(this,Ht))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=u(this,St))==null||e.focusButton()}addCommentButton(){return u(this,St)||S(this,St,new dx(this))}addStandaloneCommentButton(){if(u(this,Bo)){this._uiManager.isEditingMode()&&u(this,Bo).classList.remove("hidden");return}this.hasComment&&(S(this,Bo,u(this,St).renderForStandalone()),this.div.append(u(this,Bo)))}removeStandaloneCommentButton(){u(this,St).removeStandaloneCommentButton(),S(this,Bo,null)}hideStandaloneCommentButton(){var e;(e=u(this,Bo))==null||e.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:i,deleted:r}}=u(this,St);return{text:t,richText:e,date:i,deleted:r,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){u(this,St)||S(this,St,new dx(this)),u(this,St).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:i}){if(!t||(u(this,St)||S(this,St,new dx(this)),u(this,St).setInitialText(e,i),!this.annotationElementId))return;const r=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);r&&this.updateFromAnnotationLayer(r)}get hasEditedComment(){var e;return(e=u(this,St))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=u(this,St))==null?void 0:e.isDeleted()}get hasComment(){return!!u(this,St)&&!u(this,St).isEmpty()&&!u(this,St).isDeleted()}async editComment(e){u(this,St)||S(this,St,new dx(this)),u(this,St).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){u(this,St).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,r]=e.rect,[o]=this.pageDimensions,[l]=this.pageTranslation,h=l+o+1,g=r-100,p=h+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[h,g,p,r]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){u(this,St).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var l;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=u(this,_d)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),P(this,Og,Db).call(this);const[t,i]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*i/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/i).toFixed(2)}%`);const[r,o]=this.getInitialTranslation();return this.translate(r,o),w4(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(u(this,Hc)||S(this,Hc,new X1({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:P(this,Ew,O4).bind(this),onPinching:P(this,Cw,L4).bind(this),onPinchEnd:P(this,Sw,B4).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(l=this._uiManager._editorUndoBar)==null||l.hide(),e}pointerdown(e){const{isMac:t}=Gn.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(S(this,jc,!0),this._isDraggable){P(this,_w,F4).call(this,e);return}P(this,Mg,Pb).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){u(this,no)&&clearTimeout(u(this,no)),S(this,no,setTimeout(()=>{var e;S(this,no,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,i=this.rotation){const r=this.parentScale,[o,l]=this.pageDimensions,[h,g]=this.pageTranslation,p=e/r,x=t/r,y=this.x*o,v=this.y*l,C=this.width*o,R=this.height*l;switch(i){case 0:return[y+p+h,l-v-x-R+g,y+p+C+h,l-v-x+g];case 90:return[y+x+h,l-v+p+g,y+x+R+h,l-v+p+C+g];case 180:return[y-p-C+h,l-v+x+g,y-p+h,l-v+x+R+g];case 270:return[y-x-R+h,l-v-p-C+g,y-x+h,l-v-p+g];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[i,r,o,l]=e,h=o-i,g=l-r;switch(this.rotation){case 0:return[i,t-l,h,g];case 90:return[i,t-r,g,h];case 180:return[o,t-r,h,g];case 270:return[o,t-l,g,h];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Ue._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=u(this,St))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:i,opacity:r,deleted:o,richText:l},uid:h,pageIndex:g,creationDate:p,modificationDate:x}=this;return{id:h,pageIndex:g,rect:this.getPDFRect(),richText:l,contentsObj:{str:e},creationDate:p,modificationDate:i||x,popupRef:!o,color:t,opacity:r}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),S(this,zc,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),S(this,zc,!1),!0):!1}isInEditMode(){return u(this,zc)}shouldGetKeyboardEvents(){return u(this,Uo)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:i,right:r}=this.getClientDimensions(),{innerHeight:o,innerWidth:l}=window;return t<l&&r>0&&e<o&&i>0}rebuild(){P(this,Og,Db).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var i;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((i=this._initialData)==null?void 0:i.popupRef)||""}}static async deserialize(e,t,i){const r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});r.rotation=e.rotation,S(r,Fc,e.accessibilityData),r._isCopy=e.isCopy||!1;const[o,l]=r.pageDimensions,[h,g,p,x]=r.getRectInCurrentCoords(e.rect,l);return r.x=h/o,r.y=g/l,r.width=p/o,r.height=x/l,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=u(this,tl))==null||e.abort(),S(this,tl,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),u(this,no)&&(clearTimeout(u(this,no)),S(this,no,null)),P(this,Vc,J0).call(this),this.removeEditToolbar(),u(this,Yr)){for(const i of u(this,Yr).values())clearTimeout(i);S(this,Yr,null)}this.parent=null,(t=u(this,Hc))==null||t.destroy(),S(this,Hc,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(P(this,vw,D4).call(this),u(this,Qn).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[i,r,o,l]=this.getPDFRect();return[Ue._round(i+(o-i)*e),Ue._round(r+(l-r)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return u(this,St).commentPopupPositionInLayer}set commentPopupPosition(e){u(this,St).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return u(this,St).hasDefaultPopupPosition()}get commentButtonWidth(){return u(this,St).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){u(this,St).setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),S(this,Fo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=u(this,Qn).children;if(!u(this,xs)){S(this,xs,Array.from(t));const l=P(this,Tw,U4).bind(this),h=P(this,Iw,j4).bind(this),g=this._uiManager._signal;for(const p of u(this,xs)){const x=p.getAttribute("data-resizer-name");p.setAttribute("role","spinbutton"),p.addEventListener("keydown",l,{signal:g}),p.addEventListener("blur",h,{signal:g}),p.addEventListener("focus",P(this,Nw,z4).bind(this,x),{signal:g}),p.setAttribute("data-l10n-id",Ue._l10nResizer[x])}}const i=u(this,xs)[0];let r=0;for(const l of t){if(l===i)break;r++}const o=(360-this.rotation+this.parentRotation)%360/90*(u(this,xs).length/4);if(o!==r){if(o<r)for(let h=0;h<r-o;h++)u(this,Qn).append(u(this,Qn).firstChild);else if(o>r)for(let h=0;h<o-r;h++)u(this,Qn).firstChild.before(u(this,Qn).lastChild);let l=0;for(const h of t){const p=u(this,xs)[l++].getAttribute("data-resizer-name");h.setAttribute("data-l10n-id",Ue._l10nResizer[p])}}P(this,Lg,Mb).call(this,0),S(this,Uo,!0),u(this,Qn).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){u(this,Uo)&&P(this,Dg,kb).call(this,u(this,Tg),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){P(this,Vc,J0).call(this),this.div.focus()}select(){var e,t,i;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var r,o;(r=this.div)!=null&&r.classList.contains("selectedEditor")&&((o=this._editToolbar)==null||o.show())});return}(t=this._editToolbar)==null||t.show(),(i=u(this,Ht))==null||i.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,i,r,o;this.isSelected&&(this.isSelected=!1,(e=u(this,Qn))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(r=this._editToolbar)==null||r.hide(),(o=u(this,Ht))==null||o.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return u(this,Ig)}set isEditing(e){S(this,Ig,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){u(this,Yr)||S(this,Yr,new Map);const{action:i}=e;let r=u(this,Yr).get(i);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(e),u(this,Yr).delete(i),u(this,Yr).size===0&&S(this,Yr,null)},Ue._telemetryTimeout),u(this,Yr).set(i,r);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),S(this,_d,!1)}disable(){this.div&&(this.div.tabIndex=-1),S(this,_d,!0)}updateFakeAnnotationElement(e){if(!u(this,to)&&!this.deleted){S(this,to,e.addFakeAnnotation(this));return}if(this.deleted){u(this,to).remove(),S(this,to,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&u(this,to).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Fc=new WeakMap,xs=new WeakMap,Ht=new WeakMap,St=new WeakMap,Bo=new WeakMap,_d=new WeakMap,el=new WeakMap,_g=new WeakMap,Qn=new WeakMap,Uc=new WeakMap,Fo=new WeakMap,to=new WeakMap,tl=new WeakMap,Tg=new WeakMap,jc=new WeakMap,lr=new WeakMap,Ig=new WeakMap,zc=new WeakMap,Uo=new WeakMap,no=new WeakMap,Td=new WeakMap,Id=new WeakMap,Yr=new WeakMap,Hc=new WeakMap,Ng=new WeakMap,Aw=new WeakMap,Rg=new WeakSet,Ib=function([e,t],i,r){[i,r]=this.screenToPageTranslation(i,r),this.x+=i/e,this.y+=r/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},kg=new WeakSet,Nb=function(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Nd=new WeakSet,Ux=function(e){switch(e){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}},vw=new WeakSet,D4=function(){if(u(this,Qn))return;S(this,Qn,document.createElement("div")),u(this,Qn).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const i of e){const r=document.createElement("div");u(this,Qn).append(r),r.classList.add("resizer",i),r.setAttribute("data-resizer-name",i),r.addEventListener("pointerdown",P(this,bw,M4).bind(this,i),{signal:t}),r.addEventListener("contextmenu",Rr,{signal:t}),r.tabIndex=-1}this.div.prepend(u(this,Qn))},bw=new WeakSet,M4=function(e,t){var x;t.preventDefault();const{isMac:i}=Gn.platform;if(t.button!==0||t.ctrlKey&&i)return;(x=u(this,Ht))==null||x.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,S(this,Uc,[t.screenX,t.screenY]);const o=new AbortController,l=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",P(this,Dg,kb).bind(this,e),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",Zt,{passive:!1,signal:l}),window.addEventListener("contextmenu",Rr,{signal:l}),S(this,Fo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const h=this.parent.div.style.cursor,g=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const p=()=>{var y;o.abort(),this.parent.togglePointerEvents(!0),(y=u(this,Ht))==null||y.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=h,this.div.style.cursor=g,P(this,Rd,jx).call(this)};window.addEventListener("pointerup",p,{signal:l}),window.addEventListener("blur",p,{signal:l})},Pg=new WeakSet,Rb=function(e,t,i,r){this.width=i,this.height=r,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},Rd=new WeakSet,jx=function(){if(!u(this,Fo))return;const{savedX:e,savedY:t,savedWidth:i,savedHeight:r}=u(this,Fo);S(this,Fo,null);const o=this.x,l=this.y,h=this.width,g=this.height;o===e&&l===t&&h===i&&g===r||this.addCommands({cmd:P(this,Pg,Rb).bind(this,o,l,h,g),undo:P(this,Pg,Rb).bind(this,e,t,i,r),mustExec:!0})},Dg=new WeakSet,kb=function(e,t){const[i,r]=this.parentDimensions,o=this.x,l=this.y,h=this.width,g=this.height,p=Ue.MIN_SIZE/i,x=Ue.MIN_SIZE/r,y=P(this,Nd,Ux).call(this,this.rotation),v=(oe,ne)=>[y[0]*oe+y[2]*ne,y[1]*oe+y[3]*ne],C=P(this,Nd,Ux).call(this,360-this.rotation),R=(oe,ne)=>[C[0]*oe+C[2]*ne,C[1]*oe+C[3]*ne];let I,O,_=!1,N=!1;switch(e){case"topLeft":_=!0,I=(oe,ne)=>[0,0],O=(oe,ne)=>[oe,ne];break;case"topMiddle":I=(oe,ne)=>[oe/2,0],O=(oe,ne)=>[oe/2,ne];break;case"topRight":_=!0,I=(oe,ne)=>[oe,0],O=(oe,ne)=>[0,ne];break;case"middleRight":N=!0,I=(oe,ne)=>[oe,ne/2],O=(oe,ne)=>[0,ne/2];break;case"bottomRight":_=!0,I=(oe,ne)=>[oe,ne],O=(oe,ne)=>[0,0];break;case"bottomMiddle":I=(oe,ne)=>[oe/2,ne],O=(oe,ne)=>[oe/2,0];break;case"bottomLeft":_=!0,I=(oe,ne)=>[0,ne],O=(oe,ne)=>[oe,0];break;case"middleLeft":N=!0,I=(oe,ne)=>[0,ne/2],O=(oe,ne)=>[oe,ne/2];break}const k=I(h,g),B=O(h,g);let z=v(...B);const H=Ue._round(o+z[0]),F=Ue._round(l+z[1]);let Y=1,W=1,Z,te;if(t.fromKeyboard)({deltaX:Z,deltaY:te}=t);else{const{screenX:oe,screenY:ne}=t,[ie,ge]=u(this,Uc);[Z,te]=this.screenToPageTranslation(oe-ie,ne-ge),u(this,Uc)[0]=oe,u(this,Uc)[1]=ne}if([Z,te]=R(Z/i,te/r),_){const oe=Math.hypot(h,g);Y=W=Math.max(Math.min(Math.hypot(B[0]-k[0]-Z,B[1]-k[1]-te)/oe,1/h,1/g),p/h,x/g)}else N?Y=xi(Math.abs(B[0]-k[0]-Z),p,1)/h:W=xi(Math.abs(B[1]-k[1]-te),x,1)/g;const ee=Ue._round(h*Y),le=Ue._round(g*W);z=v(...O(ee,le));const ce=H-z[0],$=F-z[1];u(this,lr)||S(this,lr,[this.x,this.y,this.width,this.height]),this.width=ee,this.height=le,this.x=ce,this.y=$,this.setDims(),this.fixAndSetPosition(),this._onResizing()},Ew=new WeakSet,O4=function(){var e;S(this,Fo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=u(this,Ht))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},Cw=new WeakSet,L4=function(e,t,i){let o=.7*(i/t)+1-.7;if(o===1)return;const l=P(this,Nd,Ux).call(this,this.rotation),h=(H,F)=>[l[0]*H+l[2]*F,l[1]*H+l[3]*F],[g,p]=this.parentDimensions,x=this.x,y=this.y,v=this.width,C=this.height,R=Ue.MIN_SIZE/g,I=Ue.MIN_SIZE/p;o=Math.max(Math.min(o,1/v,1/C),R/v,I/C);const O=Ue._round(v*o),_=Ue._round(C*o);if(O===v&&_===C)return;u(this,lr)||S(this,lr,[x,y,v,C]);const N=h(v/2,C/2),k=Ue._round(x+N[0]),B=Ue._round(y+N[1]),z=h(O/2,_/2);this.x=k-z[0],this.y=B-z[1],this.width=O,this.height=_,this.setDims(),this.fixAndSetPosition(),this._onResizing()},Sw=new WeakSet,B4=function(){var e;(e=u(this,Ht))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),P(this,Rd,jx).call(this)},Mg=new WeakSet,Pb=function(e){const{isMac:t}=Gn.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},_w=new WeakSet,F4=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let i=!1;const r=new AbortController,o=this._uiManager.combinedSignal(r),l={capture:!0,passive:!1,signal:o},h=p=>{r.abort(),S(this,el,null),S(this,jc,!1),this._uiManager.endDragSession()||P(this,Mg,Pb).call(this,p),i&&this._onStopDragging()};t&&(S(this,Td,e.clientX),S(this,Id,e.clientY),S(this,el,e.pointerId),S(this,_g,e.pointerType),window.addEventListener("pointermove",p=>{i||(i=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:x,clientY:y,pointerId:v}=p;if(v!==u(this,el)){Zt(p);return}const[C,R]=this.screenToPageTranslation(x-u(this,Td),y-u(this,Id));S(this,Td,x),S(this,Id,y),this._uiManager.dragSelectedEditors(C,R)},l),window.addEventListener("touchmove",Zt,l),window.addEventListener("pointerdown",p=>{p.pointerType===u(this,_g)&&(u(this,Hc)||p.isPrimary)&&h(p),Zt(p)},l));const g=p=>{if(!u(this,el)||u(this,el)===p.pointerId){h(p);return}Zt(p)};window.addEventListener("pointerup",g,{signal:o}),window.addEventListener("blur",g,{signal:o})},Og=new WeakSet,Db=function(){if(u(this,tl)||!this.div)return;S(this,tl,new AbortController);const e=this._uiManager.combinedSignal(u(this,tl));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},Tw=new WeakSet,U4=function(e){Ue._resizerKeyboardManager.exec(this,e)},Iw=new WeakSet,j4=function(e){var t;u(this,Uo)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==u(this,Qn)&&P(this,Vc,J0).call(this)},Nw=new WeakSet,z4=function(e){S(this,Tg,u(this,Uo)?e:"")},Lg=new WeakSet,Mb=function(e){if(u(this,xs))for(const t of u(this,xs))t.tabIndex=e},Vc=new WeakSet,J0=function(){S(this,Uo,!1),P(this,Lg,Mb).call(this,-1),P(this,Rd,jx).call(this)},E(Ue,kg),ue(Ue,"_l10n",null),ue(Ue,"_l10nResizer",null),ue(Ue,"_borderLineWidth",-1),ue(Ue,"_colorManager",new Ab),ue(Ue,"_zIndex",1),ue(Ue,"_telemetryTimeout",1e3);let Mt=Ue;class w6 extends Mt{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Y3=3285377520,Fr=4294901760,Ws=65535;class H4{constructor(e){this.h1=e?e&4294967295:Y3,this.h2=e?e&4294967295:Y3}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let I=0,O=e.length;I<O;I++){const _=e.charCodeAt(I);_<=255?t[i++]=_:(t[i++]=_>>>8,t[i++]=_&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=i>>2,o=i-r*4,l=new Uint32Array(t.buffer,0,r);let h=0,g=0,p=this.h1,x=this.h2;const y=3432918353,v=461845907,C=y&Ws,R=v&Ws;for(let I=0;I<r;I++)I&1?(h=l[I],h=h*y&Fr|h*C&Ws,h=h<<15|h>>>17,h=h*v&Fr|h*R&Ws,p^=h,p=p<<13|p>>>19,p=p*5+3864292196):(g=l[I],g=g*y&Fr|g*C&Ws,g=g<<15|g>>>17,g=g*v&Fr|g*R&Ws,x^=g,x=x<<13|x>>>19,x=x*5+3864292196);switch(h=0,o){case 3:h^=t[r*4+2]<<16;case 2:h^=t[r*4+1]<<8;case 1:h^=t[r*4],h=h*y&Fr|h*C&Ws,h=h<<15|h>>>17,h=h*v&Fr|h*R&Ws,r&1?p^=h:x^=h}this.h1=p,this.h2=x}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Fr|e*36045&Ws,t=t*4283543511&Fr|((t<<16|e>>>16)*2950163797&Fr)>>>16,e^=t>>>1,e=e*444984403&Fr|e*60499&Ws,t=t*3301882366&Fr|((t<<16|e>>>16)*3120437893&Fr)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Ob=Object.freeze({map:null,hash:"",transfer:void 0});var Wc,Gc,jo,Jn,Rw,V4;class $C{constructor(){E(this,Rw);E(this,Wc,!1);E(this,Gc,null);E(this,jo,null);E(this,Jn,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const i=u(this,Jn).get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return u(this,Jn).get(e)}remove(e){const t=u(this,Jn).get(e);if(t!==void 0&&(t instanceof Mt&&u(this,jo).delete(t.annotationElementId),u(this,Jn).delete(e),u(this,Jn).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const i of u(this,Jn).values())if(i instanceof Mt)return;this.onAnnotationEditor(null)}}setValue(e,t){const i=u(this,Jn).get(e);let r=!1;if(i!==void 0)for(const[o,l]of Object.entries(t))i[o]!==l&&(r=!0,i[o]=l);else r=!0,u(this,Jn).set(e,t);r&&P(this,Rw,V4).call(this),t instanceof Mt&&((u(this,jo)||S(this,jo,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return u(this,Jn).has(e)}get size(){return u(this,Jn).size}resetModified(){u(this,Wc)&&(S(this,Wc,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new W4(this)}get serializable(){if(u(this,Jn).size===0)return Ob;const e=new Map,t=new H4,i=[],r=Object.create(null);let o=!1;for(const[l,h]of u(this,Jn)){const g=h instanceof Mt?h.serialize(!1,r):h;g&&(e.set(l,g),t.update(`${l}:${JSON.stringify(g)}`),o||(o=!!g.bitmap))}if(o)for(const l of e.values())l.bitmap&&i.push(l.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:Ob}get editorStats(){let e=null;const t=new Map;let i=0,r=0;for(const o of u(this,Jn).values()){if(!(o instanceof Mt)){o.popup&&(o.popup.deleted?r+=1:i+=1);continue}o.isCommentDeleted?r+=1:o.hasEditedComment&&(i+=1);const l=o.telemetryFinalData;if(!l)continue;const{type:h}=l;t.has(h)||t.set(h,Object.getPrototypeOf(o).constructor),e||(e=Object.create(null));const g=e[h]||(e[h]=new Map);for(const[p,x]of Object.entries(l)){if(p==="type")continue;let y=g.get(p);y||(y=new Map,g.set(p,y));const v=y.get(x)??0;y.set(x,v+1)}}if((r>0||i>0)&&(e||(e=Object.create(null)),e.comments={deleted:r,edited:i}),!e)return null;for(const[o,l]of t)e[o]=l.computeTelemetryFinalData(e[o]);return e}resetModifiedIds(){S(this,Gc,null)}updateEditor(e,t){var r;const i=(r=u(this,jo))==null?void 0:r.get(e);return i?(i.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=u(this,jo))==null?void 0:t.get(e))||null}get modifiedIds(){if(u(this,Gc))return u(this,Gc);const e=[];if(u(this,jo))for(const t of u(this,jo).values())t.serialize()&&e.push(t.annotationElementId);return S(this,Gc,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return u(this,Jn).entries()}}Wc=new WeakMap,Gc=new WeakMap,jo=new WeakMap,Jn=new WeakMap,Rw=new WeakSet,V4=function(){u(this,Wc)||(S(this,Wc,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Bg;class W4 extends $C{constructor(t){super();E(this,Bg,void 0);const{map:i,hash:r,transfer:o}=t.serializable,l=structuredClone(i,o?{transfer:o}:null);S(this,Bg,{map:l,hash:r,transfer:o})}get print(){It("Should not call PrintAnnotationStorage.print")}get serializable(){return u(this,Bg)}get modifiedIds(){return Ve(this,"modifiedIds",{ids:new Set,hash:""})}}Bg=new WeakMap;var kd;class y6{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){E(this,kd,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),u(this,kd).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:i}){if(!(!e||u(this,kd).has(e.loadedName))){if(it(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:o,style:l}=e,h=new FontFace(r,o,l);this.addNativeFontFace(h);try{await h.load(),u(this,kd).add(r),i==null||i(e)}catch{Fe(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(h)}return}It("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(r){throw Fe(`Failed to load font '${i.family}': '${r}'.`),e.disableFontFace=!0,r}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const r=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,r)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return Ve(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Ve(this,"isSyncFontLoadingSupported",Ii||Gn.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(it(!r.done,"completeRequest() cannot be called twice."),r.done=!0;i.length>0&&i[0].done;){const o=i.shift();setTimeout(o.callback,0)}}const{loadingRequests:i}=this,r={done:!1,complete:t,callback:e};return i.push(r),r}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ve(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(B,z){return B.charCodeAt(z)<<24|B.charCodeAt(z+1)<<16|B.charCodeAt(z+2)<<8|B.charCodeAt(z+3)&255}function r(B,z,H,F){const Y=B.substring(0,z),W=B.substring(z+H);return Y+F+W}let o,l;const h=this._document.createElement("canvas");h.width=1,h.height=1;const g=h.getContext("2d");let p=0;function x(B,z){if(++p>30){Fe("Load test font never loaded."),z();return}if(g.font="30px "+B,g.fillText(".",0,20),g.getImageData(0,0,1,1).data[3]>0){z();return}setTimeout(x.bind(null,B,z))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=r(v,976,y.length,y);const R=16,I=1482184792;let O=i(v,R);for(o=0,l=y.length-3;o<l;o+=4)O=O-I+i(y,o)|0;o<y.length&&(O=O-I+i(y+"XXX",o)|0),v=r(v,R,4,o6(O));const _=`url(data:font/opentype;base64,${btoa(v)});`,N=`@font-face {font-family:"${y}";src:${_}}`;this.insertRule(N);const k=this._document.createElement("div");k.style.visibility="hidden",k.style.width=k.style.height="10px",k.style.position="absolute",k.style.top=k.style.left="0px";for(const B of[e.loadedName,y]){const z=this._document.createElement("span");z.textContent="Hi",z.style.fontFamily=B,k.append(z)}this._document.body.append(k),x(y,()=>{k.remove(),t.complete()})}}kd=new WeakMap;var wt;class A6{constructor(e,t=null,i,r){E(this,wt,void 0);this.compiledGlyphs=Object.create(null),S(this,wt,e),this._inspectFont=t,i&&Object.assign(this,i),r&&(this.charProcOperatorList=r)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var i;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${o4(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let r=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(r+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${r}src:${e}}`}return(i=this._inspectFont)==null||i.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const i=this.loadedName+"_path_"+t;let r;try{r=e.get(i)}catch(l){Fe(`getPathGenerator - ignoring character: "${l}".`)}const o=new Path2D(r||"");return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=o}get black(){return u(this,wt).black}get bold(){return u(this,wt).bold}get disableFontFace(){return u(this,wt).disableFontFace??!1}get fontExtraProperties(){return u(this,wt).fontExtraProperties??!1}get isInvalidPDFjsFont(){return u(this,wt).isInvalidPDFjsFont}get isType3Font(){return u(this,wt).isType3Font}get italic(){return u(this,wt).italic}get missingFile(){return u(this,wt).missingFile}get remeasure(){return u(this,wt).remeasure}get vertical(){return u(this,wt).vertical}get ascent(){return u(this,wt).ascent}get defaultWidth(){return u(this,wt).defaultWidth}get descent(){return u(this,wt).descent}get bbox(){return u(this,wt).bbox}get fontMatrix(){return u(this,wt).fontMatrix}get fallbackName(){return u(this,wt).fallbackName}get loadedName(){return u(this,wt).loadedName}get mimetype(){return u(this,wt).mimetype}get name(){return u(this,wt).name}get data(){return u(this,wt).data}clearData(){u(this,wt).clearData()}get cssFontInfo(){return u(this,wt).cssFontInfo}get systemFontInfo(){return u(this,wt).systemFontInfo}get defaultVMetrics(){return u(this,wt).defaultVMetrics}}wt=new WeakMap;function v6(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(Ii)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function b6(n){if(Ii&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return km(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function fx(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const Lb=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,E6=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",G4=u6.bind(null,Lb,E6);var zo,kw;class C6{constructor(){E(this,zo,new Map);E(this,kw,Promise.resolve())}postMessage(e,t){const i={data:structuredClone(e,t?{transfer:t}:null)};u(this,kw).then(()=>{for(const[r]of u(this,zo))r.call(this,i)})}addEventListener(e,t,i=null){let r=null;if((i==null?void 0:i.signal)instanceof AbortSignal){const{signal:o}=i;if(o.aborted){Fe("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(e,t);r=()=>o.removeEventListener("abort",l),o.addEventListener("abort",l)}u(this,zo).set(t,r)}removeEventListener(e,t){const i=u(this,zo).get(t);i==null||i(),u(this,zo).delete(t)}terminate(){for(const[,e]of u(this,zo))e==null||e();u(this,zo).clear()}}zo=new WeakMap,kw=new WeakMap;const gx={DATA:1,ERROR:2},An={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function $3(){}function zi(n){if(n instanceof va||n instanceof B2||n instanceof j3||n instanceof V1||n instanceof hv)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||It('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new va(n.message);case"InvalidPDFException":return new B2(n.message);case"PasswordException":return new j3(n.message,n.code);case"ResponseException":return new V1(n.message,n.status,n.missing);case"UnknownErrorException":return new hv(n.message,n.details)}return new hv(n.message,n.toString())}var Pd,Pw,X4,Dw,Y4,Mw,$4,Dd,zx;class e1{constructor(e,t,i){E(this,Pw);E(this,Dw);E(this,Mw);E(this,Dd);E(this,Pd,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",P(this,Pw,X4).bind(this),{signal:u(this,Pd).signal})}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const r=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[r]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},i)}catch(l){o.reject(l)}return o.promise}sendWithStream(e,t,i,r){const o=this.streamId++,l=this.sourceName,h=this.targetName,g=this.comObj;return new ReadableStream({start:p=>{const x=Promise.withResolvers();return this.streamControllers[o]={controller:p,startCall:x,pullCall:null,cancelCall:null,isClosed:!1},g.postMessage({sourceName:l,targetName:h,action:e,streamId:o,data:t,desiredSize:p.desiredSize},r),x.promise},pull:p=>{const x=Promise.withResolvers();return this.streamControllers[o].pullCall=x,g.postMessage({sourceName:l,targetName:h,stream:An.PULL,streamId:o,desiredSize:p.desiredSize}),x.promise},cancel:p=>{it(p instanceof Error,"cancel must have a valid reason");const x=Promise.withResolvers();return this.streamControllers[o].cancelCall=x,this.streamControllers[o].isClosed=!0,g.postMessage({sourceName:l,targetName:h,stream:An.CANCEL,streamId:o,reason:zi(p)}),x.promise}},i)}destroy(){var e;(e=u(this,Pd))==null||e.abort(),S(this,Pd,null)}}Pd=new WeakMap,Pw=new WeakSet,X4=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){P(this,Mw,$4).call(this,e);return}if(e.callback){const i=e.callbackId,r=this.callbackCapabilities[i];if(!r)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===gx.DATA)r.resolve(e.data);else if(e.callback===gx.ERROR)r.reject(zi(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,r=e.sourceName,o=this.comObj;Promise.try(t,e.data).then(function(l){o.postMessage({sourceName:i,targetName:r,callback:gx.DATA,callbackId:e.callbackId,data:l})},function(l){o.postMessage({sourceName:i,targetName:r,callback:gx.ERROR,callbackId:e.callbackId,reason:zi(l)})});return}if(e.streamId){P(this,Dw,Y4).call(this,e);return}t(e.data)},Dw=new WeakSet,Y4=function(e){const t=e.streamId,i=this.sourceName,r=e.sourceName,o=this.comObj,l=this,h=this.actionHandler[e.action],g={enqueue(p,x=1,y){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=x,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:i,targetName:r,stream:An.ENQUEUE,streamId:t,chunk:p},y)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:i,targetName:r,stream:An.CLOSE,streamId:t}),delete l.streamSinks[t])},error(p){it(p instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:i,targetName:r,stream:An.ERROR,streamId:t,reason:zi(p)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};g.sinkCapability.resolve(),g.ready=g.sinkCapability.promise,this.streamSinks[t]=g,Promise.try(h,e.data,g).then(function(){o.postMessage({sourceName:i,targetName:r,stream:An.START_COMPLETE,streamId:t,success:!0})},function(p){o.postMessage({sourceName:i,targetName:r,stream:An.START_COMPLETE,streamId:t,reason:zi(p)})})},Mw=new WeakSet,$4=function(e){const t=e.streamId,i=this.sourceName,r=e.sourceName,o=this.comObj,l=this.streamControllers[t],h=this.streamSinks[t];switch(e.stream){case An.START_COMPLETE:e.success?l.startCall.resolve():l.startCall.reject(zi(e.reason));break;case An.PULL_COMPLETE:e.success?l.pullCall.resolve():l.pullCall.reject(zi(e.reason));break;case An.PULL:if(!h){o.postMessage({sourceName:i,targetName:r,stream:An.PULL_COMPLETE,streamId:t,success:!0});break}h.desiredSize<=0&&e.desiredSize>0&&h.sinkCapability.resolve(),h.desiredSize=e.desiredSize,Promise.try(h.onPull||$3).then(function(){o.postMessage({sourceName:i,targetName:r,stream:An.PULL_COMPLETE,streamId:t,success:!0})},function(p){o.postMessage({sourceName:i,targetName:r,stream:An.PULL_COMPLETE,streamId:t,reason:zi(p)})});break;case An.ENQUEUE:if(it(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(e.chunk);break;case An.CLOSE:if(it(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),P(this,Dd,zx).call(this,l,t);break;case An.ERROR:it(l,"error should have stream controller"),l.controller.error(zi(e.reason)),P(this,Dd,zx).call(this,l,t);break;case An.CANCEL_COMPLETE:e.success?l.cancelCall.resolve():l.cancelCall.reject(zi(e.reason)),P(this,Dd,zx).call(this,l,t);break;case An.CANCEL:if(!h)break;const g=zi(e.reason);Promise.try(h.onCancel||$3,g).then(function(){o.postMessage({sourceName:i,targetName:r,stream:An.CANCEL_COMPLETE,streamId:t,success:!0})},function(p){o.postMessage({sourceName:i,targetName:r,stream:An.CANCEL_COMPLETE,streamId:t,reason:zi(p)})}),h.sinkCapability.reject(g),h.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Dd=new WeakSet,zx=async function(e,t){var i,r,o;await Promise.allSettled([(i=e.startCall)==null?void 0:i.promise,(r=e.pullCall)==null?void 0:r.promise,(o=e.cancelCall)==null?void 0:o.promise]),delete this.streamControllers[t]};var Fg;class K4{constructor({enableHWA:e=!1}){E(this,Fg,!1);S(this,Fg,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!u(this,Fg)})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){It("Abstract method `_createCanvas` called.")}}Fg=new WeakMap;class S6 extends K4{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const i=this._document.createElement("canvas");return i.width=e,i.height=t,i}}class q4{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){It("Abstract method `_fetch` called.")}}class K3 extends q4{async _fetch(e){const t=await y0(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):km(t)}}class Z4{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,r,o){return"none"}destroy(e=!1){}}var Xc,Md,Ho,Vo,fi,Yc,$c,Ln,ui,Kc,t1,nl,_h,Od,Hx,il,Th,Ow,Q4,Ug,Bb,rl,Ih,qc,n1,Zc,i1,jg,Fb,Qc,r1;class _6 extends Z4{constructor({docId:t,ownerDocument:i=globalThis.document}){super();E(this,Ln);E(this,Kc);E(this,nl);E(this,Od);E(this,il);E(this,Ow);E(this,Ug);E(this,rl);E(this,qc);E(this,Zc);E(this,jg);E(this,Qc);E(this,Xc,void 0);E(this,Md,void 0);E(this,Ho,void 0);E(this,Vo,void 0);E(this,fi,void 0);E(this,Yc,void 0);E(this,$c,0);S(this,Vo,t),S(this,fi,i)}addFilter(t){if(!t)return"none";let i=u(this,Ln,ui).get(t);if(i)return i;const[r,o,l]=P(this,Od,Hx).call(this,t),h=t.length===1?r:`${r}${o}${l}`;if(i=u(this,Ln,ui).get(h),i)return u(this,Ln,ui).set(t,i),i;const g=`g_${u(this,Vo)}_transfer_map_${Tn(this,$c)._++}`,p=P(this,il,Th).call(this,g);u(this,Ln,ui).set(t,p),u(this,Ln,ui).set(h,p);const x=P(this,rl,Ih).call(this,g);return P(this,Zc,i1).call(this,r,o,l,x),p}addHCMFilter(t,i){var R;const r=`${t}-${i}`,o="base";let l=u(this,Kc,t1).get(o);if((l==null?void 0:l.key)===r||(l?((R=l.filter)==null||R.remove(),l.key=r,l.url="none",l.filter=null):(l={key:r,url:"none",filter:null},u(this,Kc,t1).set(o,l)),!t||!i))return l.url;const h=P(this,Qc,r1).call(this,t);t=Ae.makeHexColor(...h);const g=P(this,Qc,r1).call(this,i);if(i=Ae.makeHexColor(...g),u(this,nl,_h).style.color="",t==="#000000"&&i==="#ffffff"||t===i)return l.url;const p=new Array(256);for(let I=0;I<=255;I++){const O=I/255;p[I]=O<=.03928?O/12.92:((O+.055)/1.055)**2.4}const x=p.join(","),y=`g_${u(this,Vo)}_hcm_filter`,v=l.filter=P(this,rl,Ih).call(this,y);P(this,Zc,i1).call(this,x,x,x,v),P(this,Ug,Bb).call(this,v);const C=(I,O)=>{const _=h[I]/255,N=g[I]/255,k=new Array(O+1);for(let B=0;B<=O;B++)k[B]=_+B/O*(N-_);return k.join(",")};return P(this,Zc,i1).call(this,C(0,5),C(1,5),C(2,5),v),l.url=P(this,il,Th).call(this,y),l.url}addAlphaFilter(t){let i=u(this,Ln,ui).get(t);if(i)return i;const[r]=P(this,Od,Hx).call(this,[t]),o=`alpha_${r}`;if(i=u(this,Ln,ui).get(o),i)return u(this,Ln,ui).set(t,i),i;const l=`g_${u(this,Vo)}_alpha_map_${Tn(this,$c)._++}`,h=P(this,il,Th).call(this,l);u(this,Ln,ui).set(t,h),u(this,Ln,ui).set(o,h);const g=P(this,rl,Ih).call(this,l);return P(this,jg,Fb).call(this,r,g),h}addLuminosityFilter(t){let i=u(this,Ln,ui).get(t||"luminosity");if(i)return i;let r,o;if(t?([r]=P(this,Od,Hx).call(this,[t]),o=`luminosity_${r}`):o="luminosity",i=u(this,Ln,ui).get(o),i)return u(this,Ln,ui).set(t,i),i;const l=`g_${u(this,Vo)}_luminosity_map_${Tn(this,$c)._++}`,h=P(this,il,Th).call(this,l);u(this,Ln,ui).set(t,h),u(this,Ln,ui).set(o,h);const g=P(this,rl,Ih).call(this,l);return P(this,Ow,Q4).call(this,g),t&&P(this,jg,Fb).call(this,r,g),h}addHighlightHCMFilter(t,i,r,o,l){var N;const h=`${i}-${r}-${o}-${l}`;let g=u(this,Kc,t1).get(t);if((g==null?void 0:g.key)===h||(g?((N=g.filter)==null||N.remove(),g.key=h,g.url="none",g.filter=null):(g={key:h,url:"none",filter:null},u(this,Kc,t1).set(t,g)),!i||!r))return g.url;const[p,x]=[i,r].map(P(this,Qc,r1).bind(this));let y=Math.round(.2126*p[0]+.7152*p[1]+.0722*p[2]),v=Math.round(.2126*x[0]+.7152*x[1]+.0722*x[2]),[C,R]=[o,l].map(P(this,Qc,r1).bind(this));v<y&&([y,v,C,R]=[v,y,R,C]),u(this,nl,_h).style.color="";const I=(k,B,z)=>{const H=new Array(256),F=(v-y)/z,Y=k/255,W=(B-k)/(255*z);let Z=0;for(let te=0;te<=z;te++){const ee=Math.round(y+te*F),le=Y+te*W;for(let ce=Z;ce<=ee;ce++)H[ce]=le;Z=ee+1}for(let te=Z;te<256;te++)H[te]=H[Z-1];return H.join(",")},O=`g_${u(this,Vo)}_hcm_${t}_filter`,_=g.filter=P(this,rl,Ih).call(this,O);return P(this,Ug,Bb).call(this,_),P(this,Zc,i1).call(this,I(C[0],R[0],5),I(C[1],R[1],5),I(C[2],R[2],5),_),g.url=P(this,il,Th).call(this,O),g.url}destroy(t=!1){var i,r,o,l;t&&((i=u(this,Yc))!=null&&i.size)||((r=u(this,Ho))==null||r.parentNode.parentNode.remove(),S(this,Ho,null),(o=u(this,Md))==null||o.clear(),S(this,Md,null),(l=u(this,Yc))==null||l.clear(),S(this,Yc,null),S(this,$c,0))}}Xc=new WeakMap,Md=new WeakMap,Ho=new WeakMap,Vo=new WeakMap,fi=new WeakMap,Yc=new WeakMap,$c=new WeakMap,Ln=new WeakSet,ui=function(){return u(this,Md)||S(this,Md,new Map)},Kc=new WeakSet,t1=function(){return u(this,Yc)||S(this,Yc,new Map)},nl=new WeakSet,_h=function(){if(!u(this,Ho)){const t=u(this,fi).createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const r=u(this,fi).createElementNS(bo,"svg");r.setAttribute("width",0),r.setAttribute("height",0),S(this,Ho,u(this,fi).createElementNS(bo,"defs")),t.append(r),r.append(u(this,Ho)),u(this,fi).body.append(t)}return u(this,Ho)},Od=new WeakSet,Hx=function(t){if(t.length===1){const p=t[0],x=new Array(256);for(let v=0;v<256;v++)x[v]=p[v]/255;const y=x.join(",");return[y,y,y]}const[i,r,o]=t,l=new Array(256),h=new Array(256),g=new Array(256);for(let p=0;p<256;p++)l[p]=i[p]/255,h[p]=r[p]/255,g[p]=o[p]/255;return[l.join(","),h.join(","),g.join(",")]},il=new WeakSet,Th=function(t){if(u(this,Xc)===void 0){S(this,Xc,"");const i=u(this,fi).URL;i!==u(this,fi).baseURI&&(Dm(i)?Fe('#createUrl: ignore "data:"-URL for performance reasons.'):S(this,Xc,VC(i,"")))}return`url(${u(this,Xc)}#${t})`},Ow=new WeakSet,Q4=function(t){const i=u(this,fi).createElementNS(bo,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)},Ug=new WeakSet,Bb=function(t){const i=u(this,fi).createElementNS(bo,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)},rl=new WeakSet,Ih=function(t){const i=u(this,fi).createElementNS(bo,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),u(this,nl,_h).append(i),i},qc=new WeakSet,n1=function(t,i,r){const o=u(this,fi).createElementNS(bo,i);o.setAttribute("type","discrete"),o.setAttribute("tableValues",r),t.append(o)},Zc=new WeakSet,i1=function(t,i,r,o){const l=u(this,fi).createElementNS(bo,"feComponentTransfer");o.append(l),P(this,qc,n1).call(this,l,"feFuncR",t),P(this,qc,n1).call(this,l,"feFuncG",i),P(this,qc,n1).call(this,l,"feFuncB",r)},jg=new WeakSet,Fb=function(t,i){const r=u(this,fi).createElementNS(bo,"feComponentTransfer");i.append(r),P(this,qc,n1).call(this,r,"feFuncA",t)},Qc=new WeakSet,r1=function(t){return u(this,nl,_h).style.color=t,A0(getComputedStyle(u(this,nl,_h)).getPropertyValue("color"))};class J4{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){It("Abstract method `_fetch` called.")}}class q3 extends J4{async _fetch(e){const t=await y0(e,"arraybuffer");return new Uint8Array(t)}}class e8{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){It("Abstract method `_fetch` called.")}}class Z3 extends e8{async _fetch(e){const t=await y0(e,"arraybuffer");return new Uint8Array(t)}}Ii&&Fe("Please use the `legacy` build in Node.js environments.");async function KC(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class T6 extends Z4{}class I6 extends K4{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class N6 extends q4{async _fetch(e){return KC(e)}}class R6 extends J4{async _fetch(e){return KC(e)}}class k6 extends e8{async _fetch(e){return KC(e)}}const Eh="__forcedDependency",{floor:Q3,ceil:J3}=Math;function px(n,e,t,i,r,o){n[e*4+0]=Math.min(n[e*4+0],t),n[e*4+1]=Math.min(n[e*4+1],i),n[e*4+2]=Math.max(n[e*4+2],r),n[e*4+3]=Math.max(n[e*4+3],o)}const Ub=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var Ld,sl;class P6{constructor(e,t){E(this,Ld,void 0);E(this,sl,void 0);S(this,Ld,e),S(this,sl,t)}get length(){return u(this,Ld).length}isEmpty(e){return u(this,Ld)[e]===Ub}minX(e){return u(this,sl)[e*4+0]/256}minY(e){return u(this,sl)[e*4+1]/256}maxX(e){return(u(this,sl)[e*4+2]+1)/256}maxY(e){return(u(this,sl)[e*4+3]+1)/256}}Ld=new WeakMap,sl=new WeakMap;const mx=(n,e)=>{if(!n)return;let t=n.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},n.set(e,t)),t};var Wi,Gi,Jc,ws,eu,Wo,pt,yt,Go,Xi,zg,Bd,tu,nu,Xo,gi,io,Hg,jb;class D6{constructor(e,t,i=!1){E(this,Hg);E(this,Wi,{__proto__:null});E(this,Gi,{__proto__:null,transform:[],moveText:[],sameLineText:[],[Eh]:[]});E(this,Jc,new Map);E(this,ws,[]);E(this,eu,[]);E(this,Wo,[[1,0,0,1,0,0]]);E(this,pt,[-1/0,-1/0,1/0,1/0]);E(this,yt,new Float64Array([1/0,1/0,-1/0,-1/0]));E(this,Go,-1);E(this,Xi,new Set);E(this,zg,new Map);E(this,Bd,new Map);E(this,tu,void 0);E(this,nu,void 0);E(this,Xo,void 0);E(this,gi,void 0);E(this,io,void 0);S(this,tu,e.width),S(this,nu,e.height),P(this,Hg,jb).call(this,t),i&&S(this,io,new Map)}growOperationsCount(e){e>=u(this,gi).length&&P(this,Hg,jb).call(this,e,u(this,gi))}save(e){return S(this,Wi,{__proto__:u(this,Wi)}),S(this,Gi,{__proto__:u(this,Gi),transform:{__proto__:u(this,Gi).transform},moveText:{__proto__:u(this,Gi).moveText},sameLineText:{__proto__:u(this,Gi).sameLineText},[Eh]:{__proto__:u(this,Gi)[Eh]}}),S(this,pt,{__proto__:u(this,pt)}),u(this,ws).push(e),this}restore(e){var r;const t=Object.getPrototypeOf(u(this,Wi));if(t===null)return this;S(this,Wi,t),S(this,Gi,Object.getPrototypeOf(u(this,Gi))),S(this,pt,Object.getPrototypeOf(u(this,pt)));const i=u(this,ws).pop();return i!==void 0&&((r=mx(u(this,io),e))==null||r.dependencies.add(i),u(this,gi)[e]=u(this,gi)[i]),this}recordOpenMarker(e){return u(this,ws).push(e),this}getOpenMarker(){return u(this,ws).length===0?null:u(this,ws).at(-1)}recordCloseMarker(e){var i;const t=u(this,ws).pop();return t!==void 0&&((i=mx(u(this,io),e))==null||i.dependencies.add(t),u(this,gi)[e]=u(this,gi)[t]),this}beginMarkedContent(e){return u(this,eu).push(e),this}endMarkedContent(e){var i;const t=u(this,eu).pop();return t!==void 0&&((i=mx(u(this,io),e))==null||i.dependencies.add(t),u(this,gi)[e]=u(this,gi)[t]),this}pushBaseTransform(e){return u(this,Wo).push(Ae.multiplyByDOMMatrix(u(this,Wo).at(-1),e.getTransform())),this}popBaseTransform(){return u(this,Wo).length>1&&u(this,Wo).pop(),this}recordSimpleData(e,t){return u(this,Wi)[e]=t,this}recordIncrementalData(e,t){return u(this,Gi)[e].push(t),this}resetIncrementalData(e,t){return u(this,Gi)[e].length=0,this}recordNamedData(e,t){return u(this,Jc).set(e,t),this}recordSimpleDataFromNamed(e,t,i){u(this,Wi)[e]=u(this,Jc).get(t)??i}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Eh,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in u(this,Wi)&&this.recordFutureForcedDependency(t,u(this,Wi)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of u(this,Xi))this.recordFutureForcedDependency(Eh,e);return this}resetBBox(e){return u(this,Go)!==e&&(S(this,Go,e),u(this,yt)[0]=1/0,u(this,yt)[1]=1/0,u(this,yt)[2]=-1/0,u(this,yt)[3]=-1/0),this}recordClipBox(e,t,i,r,o,l){const h=Ae.multiplyByDOMMatrix(u(this,Wo).at(-1),t.getTransform()),g=[1/0,1/0,-1/0,-1/0];Ae.axialAlignedBoundingBox([i,o,r,l],h,g);const p=Ae.intersect(u(this,pt),g);return p?(u(this,pt)[0]=p[0],u(this,pt)[1]=p[1],u(this,pt)[2]=p[2],u(this,pt)[3]=p[3]):(u(this,pt)[0]=u(this,pt)[1]=1/0,u(this,pt)[2]=u(this,pt)[3]=-1/0),this}recordBBox(e,t,i,r,o,l){const h=u(this,pt);if(h[0]===1/0)return this;const g=Ae.multiplyByDOMMatrix(u(this,Wo).at(-1),t.getTransform());if(h[0]===-1/0)return Ae.axialAlignedBoundingBox([i,o,r,l],g,u(this,yt)),this;const p=[1/0,1/0,-1/0,-1/0];return Ae.axialAlignedBoundingBox([i,o,r,l],g,p),u(this,yt)[0]=Math.min(u(this,yt)[0],Math.max(p[0],h[0])),u(this,yt)[1]=Math.min(u(this,yt)[1],Math.max(p[1],h[1])),u(this,yt)[2]=Math.max(u(this,yt)[2],Math.min(p[2],h[2])),u(this,yt)[3]=Math.max(u(this,yt)[3],Math.min(p[3],h[3])),this}recordCharacterBBox(e,t,i,r=1,o=0,l=0,h){const g=i.bbox;let p,x;if(g&&(p=g[2]!==g[0]&&g[3]!==g[1]&&u(this,Bd).get(i),p!==!1&&(x=[0,0,0,0],Ae.axialAlignedBoundingBox(g,i.fontMatrix,x),(r!==1||o!==0||l!==0)&&Ae.scaleMinMax([r,0,0,-r,o,l],x),p)))return this.recordBBox(e,t,x[0],x[2],x[1],x[3]);if(!h)return this.recordFullPageBBox(e);const y=h();return g&&x&&p===void 0&&(p=x[0]<=o-y.actualBoundingBoxLeft&&x[2]>=o+y.actualBoundingBoxRight&&x[1]<=l-y.actualBoundingBoxAscent&&x[3]>=l+y.actualBoundingBoxDescent,u(this,Bd).set(i,p),p)?this.recordBBox(e,t,x[0],x[2],x[1],x[3]):this.recordBBox(e,t,o-y.actualBoundingBoxLeft,o+y.actualBoundingBoxRight,l-y.actualBoundingBoxAscent,l+y.actualBoundingBoxDescent)}recordFullPageBBox(e){return u(this,yt)[0]=Math.max(0,u(this,pt)[0]),u(this,yt)[1]=Math.max(0,u(this,pt)[1]),u(this,yt)[2]=Math.min(u(this,tu),u(this,pt)[2]),u(this,yt)[3]=Math.min(u(this,nu),u(this,pt)[3]),this}getSimpleIndex(e){return u(this,Wi)[e]}recordDependencies(e,t){const i=u(this,Xi),r=u(this,Wi),o=u(this,Gi);for(const l of t)l in u(this,Wi)?i.add(r[l]):l in o&&o[l].forEach(i.add,i);return this}recordNamedDependency(e,t){return u(this,Jc).has(t)&&u(this,Xi).add(u(this,Jc).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[Eh]),u(this,io)){const i=mx(u(this,io),e),{dependencies:r}=i;u(this,Xi).forEach(r.add,r),u(this,ws).forEach(r.add,r),u(this,eu).forEach(r.add,r),r.delete(e),i.isRenderingOperation=!0}if(u(this,Go)===e){const i=Q3(u(this,yt)[0]*256/u(this,tu)),r=Q3(u(this,yt)[1]*256/u(this,nu)),o=J3(u(this,yt)[2]*256/u(this,tu)),l=J3(u(this,yt)[3]*256/u(this,nu));px(u(this,Xo),e,i,r,o,l);for(const h of u(this,Xi))h!==e&&px(u(this,Xo),h,i,r,o,l);for(const h of u(this,ws))h!==e&&px(u(this,Xo),h,i,r,o,l);for(const h of u(this,eu))h!==e&&px(u(this,Xo),h,i,r,o,l);t||(u(this,Xi).clear(),S(this,Go,-1))}return this}recordShowTextOperation(e,t=!1){const i=Array.from(u(this,Xi));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const r of i)this.recordIncrementalData("sameLineText",r);return this}bboxToClipBoxDropOperation(e,t=!1){return u(this,Go)===e&&(S(this,Go,-1),u(this,pt)[0]=Math.max(u(this,pt)[0],u(this,yt)[0]),u(this,pt)[1]=Math.max(u(this,pt)[1],u(this,yt)[1]),u(this,pt)[2]=Math.min(u(this,pt)[2],u(this,yt)[2]),u(this,pt)[3]=Math.min(u(this,pt)[3],u(this,yt)[3]),t||u(this,Xi).clear()),this}_takePendingDependencies(){const e=u(this,Xi);return S(this,Xi,new Set),e}_extractOperation(e){const t=u(this,zg).get(e);return u(this,zg).delete(e),t}_pushPendingDependencies(e){for(const t of e)u(this,Xi).add(t)}take(){return u(this,Bd).clear(),new P6(u(this,gi),u(this,Xo))}takeDebugMetadata(){return u(this,io)}}Wi=new WeakMap,Gi=new WeakMap,Jc=new WeakMap,ws=new WeakMap,eu=new WeakMap,Wo=new WeakMap,pt=new WeakMap,yt=new WeakMap,Go=new WeakMap,Xi=new WeakMap,zg=new WeakMap,Bd=new WeakMap,tu=new WeakMap,nu=new WeakMap,Xo=new WeakMap,gi=new WeakMap,io=new WeakMap,Hg=new WeakSet,jb=function(e,t){const i=new ArrayBuffer(e*4);S(this,Xo,new Uint8ClampedArray(i)),S(this,gi,new Uint32Array(i)),t&&t.length>0?(u(this,gi).set(t),u(this,gi).fill(Ub,t.length)):u(this,gi).fill(Ub)};var _t,an,ys,Fd,Ud;const dS=class dS{constructor(e,t,i){E(this,_t,void 0);E(this,an,void 0);E(this,ys,void 0);E(this,Fd,0);E(this,Ud,0);if(e instanceof dS&&u(e,ys)===!!i)return e;S(this,_t,e),S(this,an,t),S(this,ys,!!i)}growOperationsCount(){throw new Error("Unreachable")}save(e){return Tn(this,Ud)._++,u(this,_t).save(u(this,an)),this}restore(e){return u(this,Ud)>0&&(u(this,_t).restore(u(this,an)),Tn(this,Ud)._--),this}recordOpenMarker(e){return Tn(this,Fd)._++,this}getOpenMarker(){return u(this,Fd)>0?u(this,an):u(this,_t).getOpenMarker()}recordCloseMarker(e){return Tn(this,Fd)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return u(this,_t).pushBaseTransform(e),this}popBaseTransform(){return u(this,_t).popBaseTransform(),this}recordSimpleData(e,t){return u(this,_t).recordSimpleData(e,u(this,an)),this}recordIncrementalData(e,t){return u(this,_t).recordIncrementalData(e,u(this,an)),this}resetIncrementalData(e,t){return u(this,_t).resetIncrementalData(e,u(this,an)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,i){return u(this,_t).recordSimpleDataFromNamed(e,t,u(this,an)),this}recordFutureForcedDependency(e,t){return u(this,_t).recordFutureForcedDependency(e,u(this,an)),this}inheritSimpleDataAsFutureForcedDependencies(e){return u(this,_t).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return u(this,_t).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return u(this,ys)||u(this,_t).resetBBox(u(this,an)),this}recordClipBox(e,t,i,r,o,l){return u(this,ys)||u(this,_t).recordClipBox(u(this,an),t,i,r,o,l),this}recordBBox(e,t,i,r,o,l){return u(this,ys)||u(this,_t).recordBBox(u(this,an),t,i,r,o,l),this}recordCharacterBBox(e,t,i,r,o,l,h){return u(this,ys)||u(this,_t).recordCharacterBBox(u(this,an),t,i,r,o,l,h),this}recordFullPageBBox(e){return u(this,ys)||u(this,_t).recordFullPageBBox(u(this,an)),this}getSimpleIndex(e){return u(this,_t).getSimpleIndex(e)}recordDependencies(e,t){return u(this,_t).recordDependencies(u(this,an),t),this}recordNamedDependency(e,t){return u(this,_t).recordNamedDependency(u(this,an),t),this}recordOperation(e){return u(this,_t).recordOperation(u(this,an),!0),this}recordShowTextOperation(e){return u(this,_t).recordShowTextOperation(u(this,an),!0),this}bboxToClipBoxDropOperation(e){return u(this,ys)||u(this,_t).bboxToClipBoxDropOperation(u(this,an),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};_t=new WeakMap,an=new WeakMap,ys=new WeakMap,Fd=new WeakMap,Ud=new WeakMap;let j2=dS;const Ur={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},ii={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function zb(n,e){if(!e)return;const t=e[2]-e[0],i=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],t,i),n.clip(r)}class qC{isModifyingCurrentTransform(){return!1}getPattern(){It("Abstract method `getPattern` called.")}}class M6 extends qC{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)t.addColorStop(i[0],i[1]);return t}getPattern(e,t,i,r){let o;if(r===ii.STROKE||r===ii.FILL){const l=t.current.getClippedPathBoundingBox(r,Kt(e))||[0,0,0,0],h=Math.ceil(l[2]-l[0])||1,g=Math.ceil(l[3]-l[1])||1,p=t.cachedCanvases.getCanvas("pattern",h,g),x=p.context;x.clearRect(0,0,x.canvas.width,x.canvas.height),x.beginPath(),x.rect(0,0,x.canvas.width,x.canvas.height),x.translate(-l[0],-l[1]),i=Ae.transform(i,[1,0,0,1,l[0],l[1]]),x.transform(...t.baseTransform),this.matrix&&x.transform(...this.matrix),zb(x,this._bbox),x.fillStyle=this._createGradient(x),x.fill(),o=e.createPattern(p.canvas,"no-repeat");const y=new DOMMatrix(i);o.setTransform(y)}else zb(e,this._bbox),o=this._createGradient(e);return o}}function gv(n,e,t,i,r,o,l,h){const g=e.coords,p=e.colors,x=n.data,y=n.width*4;let v;g[t+1]>g[i+1]&&(v=t,t=i,i=v,v=o,o=l,l=v),g[i+1]>g[r+1]&&(v=i,i=r,r=v,v=l,l=h,h=v),g[t+1]>g[i+1]&&(v=t,t=i,i=v,v=o,o=l,l=v);const C=(g[t]+e.offsetX)*e.scaleX,R=(g[t+1]+e.offsetY)*e.scaleY,I=(g[i]+e.offsetX)*e.scaleX,O=(g[i+1]+e.offsetY)*e.scaleY,_=(g[r]+e.offsetX)*e.scaleX,N=(g[r+1]+e.offsetY)*e.scaleY;if(R>=N)return;const k=p[o],B=p[o+1],z=p[o+2],H=p[l],F=p[l+1],Y=p[l+2],W=p[h],Z=p[h+1],te=p[h+2],ee=Math.round(R),le=Math.round(N);let ce,$,oe,ne,ie,ge,ye,Me;for(let we=ee;we<=le;we++){if(we<O){const He=we<R?0:(R-we)/(R-O);ce=C-(C-I)*He,$=k-(k-H)*He,oe=B-(B-F)*He,ne=z-(z-Y)*He}else{let He;we>N?He=1:O===N?He=0:He=(O-we)/(O-N),ce=I-(I-_)*He,$=H-(H-W)*He,oe=F-(F-Z)*He,ne=Y-(Y-te)*He}let me;we<R?me=0:we>N?me=1:me=(R-we)/(R-N),ie=C-(C-_)*me,ge=k-(k-W)*me,ye=B-(B-Z)*me,Me=z-(z-te)*me;const Le=Math.round(Math.min(ce,ie)),dt=Math.round(Math.max(ce,ie));let xe=y*we+Le*4;for(let He=Le;He<=dt;He++)me=(ce-He)/(ce-ie),me<0?me=0:me>1&&(me=1),x[xe++]=$-($-ge)*me|0,x[xe++]=oe-(oe-ye)*me|0,x[xe++]=ne-(ne-Me)*me|0,x[xe++]=255}}function O6(n,e,t){const i=e.coords,r=e.colors;let o,l;switch(e.type){case"lattice":const h=e.verticesPerRow,g=Math.floor(i.length/h)-1,p=h-1;for(o=0;o<g;o++){let x=o*h;for(let y=0;y<p;y++,x++)gv(n,t,i[x],i[x+1],i[x+h],r[x],r[x+1],r[x+h]),gv(n,t,i[x+h+1],i[x+1],i[x+h],r[x+h+1],r[x+1],r[x+h])}break;case"triangles":for(o=0,l=i.length;o<l;o+=3)gv(n,t,i[o],i[o+1],i[o+2],r[o],r[o+1],r[o+2]);break;default:throw new Error("illegal figure")}}class L6 extends qC{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,i){const h=Math.floor(this._bounds[0]),g=Math.floor(this._bounds[1]),p=Math.ceil(this._bounds[2])-h,x=Math.ceil(this._bounds[3])-g,y=Math.min(Math.ceil(Math.abs(p*e[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(x*e[1]*1.1)),3e3),C=p/y,R=x/v,I={coords:this._coords,colors:this._colors,offsetX:-h,offsetY:-g,scaleX:1/C,scaleY:1/R},O=y+2*2,_=v+2*2,N=i.getCanvas("mesh",O,_),k=N.context,B=k.createImageData(y,v);if(t){const H=B.data;for(let F=0,Y=H.length;F<Y;F+=4)H[F]=t[0],H[F+1]=t[1],H[F+2]=t[2],H[F+3]=255}for(const H of this._figures)O6(B,H,I);return k.putImageData(B,2,2),{canvas:N.canvas,offsetX:h-2*C,offsetY:g-2*R,scaleX:C,scaleY:R}}isModifyingCurrentTransform(){return!0}getPattern(e,t,i,r){zb(e,this._bbox);const o=new Float32Array(2);if(r===ii.SHADING)Ae.singularValueDecompose2dScale(Kt(e),o);else if(this.matrix){Ae.singularValueDecompose2dScale(this.matrix,o);const[h,g]=o;Ae.singularValueDecompose2dScale(t.baseTransform,o),o[0]*=h,o[1]*=g}else Ae.singularValueDecompose2dScale(t.baseTransform,o);const l=this._createMeshCanvas(o,r===ii.SHADING?null:this._background,t.cachedCanvases);return r!==ii.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(l.offsetX,l.offsetY),e.scale(l.scaleX,l.scaleY),e.createPattern(l.canvas,"no-repeat")}}class B6 extends qC{getPattern(){return"hotpink"}}function F6(n){switch(n[0]){case"RadialAxial":return new M6(n);case"Mesh":return new L6(n);case"Dummy":return new B6}throw new Error(`Unknown IR type: ${n[0]}`)}const e_={COLORED:1,UNCOLORED:2},Lw=class Lw{constructor(e,t,i,r){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=i,this.baseTransform=r}createPatternCanvas(e,t){var ge,ye;const{bbox:i,operatorList:r,paintType:o,tilingType:l,color:h,canvasGraphicsFactory:g}=this;let{xstep:p,ystep:x}=this;p=Math.abs(p),x=Math.abs(x),sA("TilingType: "+l);const y=i[0],v=i[1],C=i[2],R=i[3],I=C-y,O=R-v,_=new Float32Array(2);Ae.singularValueDecompose2dScale(this.matrix,_);const[N,k]=_;Ae.singularValueDecompose2dScale(this.baseTransform,_);const B=N*_[0],z=k*_[1];let H=I,F=O,Y=!1,W=!1;const Z=Math.ceil(p*B),te=Math.ceil(x*z),ee=Math.ceil(I*B),le=Math.ceil(O*z);Z>=ee?H=p:Y=!0,te>=le?F=x:W=!0;const ce=this.getSizeAndScale(H,this.ctx.canvas.width,B),$=this.getSizeAndScale(F,this.ctx.canvas.height,z),oe=e.cachedCanvases.getCanvas("pattern",ce.size,$.size),ne=oe.context,ie=g.createCanvasGraphics(ne,t);if(ie.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(ie,o,h),ne.translate(-ce.scale*y,-$.scale*v),ie.transform(0,ce.scale,0,0,$.scale,0,0),ne.save(),(ge=ie.dependencyTracker)==null||ge.save(),this.clipBbox(ie,y,v,C,R),ie.baseTransform=Kt(ie.ctx),ie.executeOperatorList(r),ie.endDrawing(),(ye=ie.dependencyTracker)==null||ye.restore(),ne.restore(),Y||W){const Me=oe.canvas;Y&&(H=p),W&&(F=x);const we=this.getSizeAndScale(H,this.ctx.canvas.width,B),me=this.getSizeAndScale(F,this.ctx.canvas.height,z),Le=we.size,dt=me.size,xe=e.cachedCanvases.getCanvas("pattern-workaround",Le,dt),He=xe.context,st=Y?Math.floor(I/p):0,yn=W?Math.floor(O/x):0;for(let bt=0;bt<=st;bt++)for(let De=0;De<=yn;De++)He.drawImage(Me,Le*bt,dt*De,Le,dt,0,0,Le,dt);return{canvas:xe.canvas,scaleX:we.scale,scaleY:me.scale,offsetX:y,offsetY:v}}return{canvas:oe.canvas,scaleX:ce.scale,scaleY:$.scale,offsetX:y,offsetY:v}}getSizeAndScale(e,t,i){const r=Math.max(Lw.MAX_PATTERN_SIZE,t);let o=Math.ceil(e*i);return o>=r?o=r:i=o/e,{scale:i,size:o}}clipBbox(e,t,i,r,o){const l=r-t,h=o-i;e.ctx.rect(t,i,l,h),Ae.axialAlignedBoundingBox([t,i,r,o],Kt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,i){const r=e.ctx,o=e.current;switch(t){case e_.COLORED:const{fillStyle:l,strokeStyle:h}=this.ctx;r.fillStyle=o.fillColor=l,r.strokeStyle=o.strokeColor=h;break;case e_.UNCOLORED:r.fillStyle=r.strokeStyle=i,o.fillColor=o.strokeColor=i;break;default:throw new s6(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,i,r,o){let l=i;r!==ii.SHADING&&(l=Ae.transform(l,t.baseTransform),this.matrix&&(l=Ae.transform(l,this.matrix)));const h=this.createPatternCanvas(t,o);let g=new DOMMatrix(l);g=g.translate(h.offsetX,h.offsetY),g=g.scale(1/h.scaleX,1/h.scaleY);const p=e.createPattern(h.canvas,"repeat");return p.setTransform(g),p}};ue(Lw,"MAX_PATTERN_SIZE",3e3);let Hb=Lw;function U6({src:n,srcPos:e=0,dest:t,width:i,height:r,nonBlackColor:o=4294967295,inverseDecode:l=!1}){const h=Gn.isLittleEndian?4278190080:255,[g,p]=l?[o,h]:[h,o],x=i>>3,y=i&7,v=n.length;t=new Uint32Array(t.buffer);let C=0;for(let R=0;R<r;R++){for(const O=e+x;e<O;e++){const _=e<v?n[e]:255;t[C++]=_&128?p:g,t[C++]=_&64?p:g,t[C++]=_&32?p:g,t[C++]=_&16?p:g,t[C++]=_&8?p:g,t[C++]=_&4?p:g,t[C++]=_&2?p:g,t[C++]=_&1?p:g}if(y===0)continue;const I=e<v?n[e++]:255;for(let O=0;O<y;O++)t[C++]=I&1<<7-O?p:g}return{srcPos:e,destPos:C}}const t_=16,n_=100,j6=15,i_=10,qi=16,pv=new DOMMatrix,_r=new Float32Array(2),Gh=new Float32Array([1/0,1/0,-1/0,-1/0]);function z6(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,i){e.translate(t,i),this.__originalTranslate(t,i)},n.scale=function(t,i){e.scale(t,i),this.__originalScale(t,i)},n.transform=function(t,i,r,o,l,h){e.transform(t,i,r,o,l,h),this.__originalTransform(t,i,r,o,l,h)},n.setTransform=function(t,i,r,o,l,h){e.setTransform(t,i,r,o,l,h),this.__originalSetTransform(t,i,r,o,l,h)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},n.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},n.bezierCurveTo=function(t,i,r,o,l,h){e.bezierCurveTo(t,i,r,o,l,h),this.__originalBezierCurveTo(t,i,r,o,l,h)},n.rect=function(t,i,r,o){e.rect(t,i,r,o),this.__originalRect(t,i,r,o)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class H6{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let r;return this.cache[e]!==void 0?(r=this.cache[e],this.canvasFactory.reset(r,t,i)):(r=this.canvasFactory.create(t,i),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function xx(n,e,t,i,r,o,l,h,g,p){const[x,y,v,C,R,I]=Kt(n);if(y===0&&v===0){const N=l*x+R,k=Math.round(N),B=h*C+I,z=Math.round(B),H=(l+g)*x+R,F=Math.abs(Math.round(H)-k)||1,Y=(h+p)*C+I,W=Math.abs(Math.round(Y)-z)||1;return n.setTransform(Math.sign(x),0,0,Math.sign(C),k,z),n.drawImage(e,t,i,r,o,0,0,F,W),n.setTransform(x,y,v,C,R,I),[F,W]}if(x===0&&C===0){const N=h*v+R,k=Math.round(N),B=l*y+I,z=Math.round(B),H=(h+p)*v+R,F=Math.abs(Math.round(H)-k)||1,Y=(l+g)*y+I,W=Math.abs(Math.round(Y)-z)||1;return n.setTransform(0,Math.sign(y),Math.sign(v),0,k,z),n.drawImage(e,t,i,r,o,0,0,W,F),n.setTransform(x,y,v,C,R,I),[W,F]}n.drawImage(e,t,i,r,o,l,h,g,p);const O=Math.hypot(x,y),_=Math.hypot(v,C);return[O*g,_*p]}class r_{constructor(e,t,i){ue(this,"alphaIsShape",!1);ue(this,"fontSize",0);ue(this,"fontSizeScale",1);ue(this,"textMatrix",null);ue(this,"textMatrixScale",1);ue(this,"fontMatrix",gb);ue(this,"leading",0);ue(this,"x",0);ue(this,"y",0);ue(this,"lineX",0);ue(this,"lineY",0);ue(this,"charSpacing",0);ue(this,"wordSpacing",0);ue(this,"textHScale",1);ue(this,"textRenderingMode",Kn.FILL);ue(this,"textRise",0);ue(this,"fillColor","#000000");ue(this,"strokeColor","#000000");ue(this,"patternFill",!1);ue(this,"patternStroke",!1);ue(this,"fillAlpha",1);ue(this,"strokeAlpha",1);ue(this,"lineWidth",1);ue(this,"activeSMask",null);ue(this,"transferMaps","none");i==null||i(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Gh.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=ii.FILL,t=null){const i=this.minMax.slice();if(e===ii.STROKE){t||It("Stroke bounding box must include transform."),Ae.singularValueDecompose2dScale(t,_r);const r=_r[0]*this.lineWidth/2,o=_r[1]*this.lineWidth/2;i[0]-=r,i[1]-=o,i[2]+=r,i[3]+=o}return i}updateClipFromPath(){const e=Ae.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Gh,0)}getClippedPathBoundingBox(e=ii.FILL,t=null){return Ae.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function s_(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,i=e.width,r=t%qi,o=(t-r)/qi,l=r===0?o:o+1,h=n.createImageData(i,qi);let g=0,p;const x=e.data,y=h.data;let v,C,R,I;if(e.kind===C1.GRAYSCALE_1BPP){const O=x.byteLength,_=new Uint32Array(y.buffer,0,y.byteLength>>2),N=_.length,k=i+7>>3,B=4294967295,z=Gn.isLittleEndian?4278190080:255;for(v=0;v<l;v++){for(R=v<o?qi:r,p=0,C=0;C<R;C++){const H=O-g;let F=0;const Y=H>k?i:H*8-7,W=Y&-8;let Z=0,te=0;for(;F<W;F+=8)te=x[g++],_[p++]=te&128?B:z,_[p++]=te&64?B:z,_[p++]=te&32?B:z,_[p++]=te&16?B:z,_[p++]=te&8?B:z,_[p++]=te&4?B:z,_[p++]=te&2?B:z,_[p++]=te&1?B:z;for(;F<Y;F++)Z===0&&(te=x[g++],Z=128),_[p++]=te&Z?B:z,Z>>=1}for(;p<N;)_[p++]=0;n.putImageData(h,0,v*qi)}}else if(e.kind===C1.RGBA_32BPP){for(C=0,I=i*qi*4,v=0;v<o;v++)y.set(x.subarray(g,g+I)),g+=I,n.putImageData(h,0,C),C+=qi;v<l&&(I=i*r*4,y.set(x.subarray(g,g+I)),n.putImageData(h,0,C))}else if(e.kind===C1.RGB_24BPP)for(R=qi,I=i*R,v=0;v<l;v++){for(v>=o&&(R=r,I=i*R),p=0,C=I;C--;)y[p++]=x[g++],y[p++]=x[g++],y[p++]=x[g++],y[p++]=255;n.putImageData(h,0,v*qi)}else throw new Error(`bad image kind: ${e.kind}`)}function o_(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,i=e.width,r=t%qi,o=(t-r)/qi,l=r===0?o:o+1,h=n.createImageData(i,qi);let g=0;const p=e.data,x=h.data;for(let y=0;y<l;y++){const v=y<o?qi:r;({srcPos:g}=U6({src:p,srcPos:g,dest:x,width:i,height:v,nonBlackColor:0})),n.putImageData(h,0,y*qi)}}function U0(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)n[i]!==void 0&&(e[i]=n[i]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function wx(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function a_(n,e){if(e)return!0;Ae.singularValueDecompose2dScale(n,_r);const t=Math.fround(Ms.pixelRatio*ba.PDF_TO_CSS_UNITS);return _r[0]<=t&&_r[1]<=t}const V6=["butt","round","square"],W6=["miter","round","bevel"],G6={},l_={};var Vg,Vb,Wg,Wb,Gg,Gb;const fS=class fS{constructor(e,t,i,r,o,{optionalContentConfig:l,markedContentStack:h=null},g,p,x){E(this,Vg);E(this,Wg);E(this,Gg);this.ctx=e,this.current=new r_(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=r,this.filterFactory=o,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=h||[],this.optionalContentConfig=l,this.cachedCanvases=new H6(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=g,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=p,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=x??null}getObject(e,t,i=null){var r;return typeof t=="string"?((r=this.dependencyTracker)==null||r.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):i}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:r=null}){const o=this.ctx.canvas.width,l=this.ctx.canvas.height,h=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,o,l),this.ctx.fillStyle=h,i){const g=this.cachedCanvases.getCanvas("transparent",o,l);this.compositeCtx=this.ctx,this.transparentCanvas=g.canvas,this.ctx=g.context,this.ctx.save(),this.ctx.transform(...Kt(this.compositeCtx))}this.ctx.save(),wx(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Kt(this.ctx)}executeOperatorList(e,t,i,r,o){var _;const l=e.argsArray,h=e.fnArray;let g=t||0;const p=l.length;if(p===g)return g;const x=p-g>i_&&typeof i=="function",y=x?Date.now()+j6:0;let v=0;const C=this.commonObjs,R=this.objs;let I,O;for(;;){if(r!==void 0&&g===r.nextBreakPoint)return r.breakIt(g,i),g;if(!o||o(g))if(I=h[g],O=l[g]??null,I!==f0.dependency)O===null?this[I](g):this[I](g,...O);else for(const N of O){(_=this.dependencyTracker)==null||_.recordNamedData(N,g);const k=N.startsWith("g_")?C:R;if(!k.has(N))return k.get(N,i),g}if(g++,g===p)return g;if(x&&++v>i_){if(Date.now()>y)return i(),g;v=0}}}endDrawing(){P(this,Vg,Vb).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),P(this,Wg,Wb).call(this)}_scaleImage(e,t){const i=e.width??e.displayWidth,r=e.height??e.displayHeight;let o=Math.max(Math.hypot(t[0],t[1]),1),l=Math.max(Math.hypot(t[2],t[3]),1),h=i,g=r,p="prescale1",x,y;for(;o>2&&h>1||l>2&&g>1;){let v=h,C=g;o>2&&h>1&&(v=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h/2),o/=h/v),l>2&&g>1&&(C=g>=16384?Math.floor(g/2)-1||1:Math.ceil(g)/2,l/=g/C),x=this.cachedCanvases.getCanvas(p,v,C),y=x.context,y.clearRect(0,0,v,C),y.drawImage(e,0,0,h,g,0,0,v,C),e=x.canvas,h=v,g=C,p=p==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:h,paintHeight:g}}_createMaskCanvas(e,t){var Z,te;const i=this.ctx,{width:r,height:o}=t,l=this.current.fillColor,h=this.current.patternFill,g=Kt(i);let p,x,y,v;if((t.bitmap||t.data)&&t.count>1){const ee=t.bitmap||t.data.buffer;x=JSON.stringify(h?g:[g.slice(0,4),l]),p=this._cachedBitmapsMap.get(ee),p||(p=new Map,this._cachedBitmapsMap.set(ee,p));const le=p.get(x);if(le&&!h){const ce=Math.round(Math.min(g[0],g[2])+g[4]),$=Math.round(Math.min(g[1],g[3])+g[5]);return(Z=this.dependencyTracker)==null||Z.recordDependencies(e,Ur.transformAndFill),{canvas:le,offsetX:ce,offsetY:$}}y=le}y||(v=this.cachedCanvases.getCanvas("maskCanvas",r,o),o_(v.context,t));let C=Ae.transform(g,[1/r,0,0,-1/o,0,0]);C=Ae.transform(C,[1,0,0,1,0,-o]);const R=Gh.slice();Ae.axialAlignedBoundingBox([0,0,r,o],C,R);const[I,O,_,N]=R,k=Math.round(_-I)||1,B=Math.round(N-O)||1,z=this.cachedCanvases.getCanvas("fillCanvas",k,B),H=z.context,F=I,Y=O;H.translate(-F,-Y),H.transform(...C),y||(y=this._scaleImage(v.canvas,Vs(H)),y=y.img,p&&h&&p.set(x,y)),H.imageSmoothingEnabled=a_(Kt(H),t.interpolate),xx(H,y,0,0,y.width,y.height,0,0,r,o),H.globalCompositeOperation="source-in";const W=Ae.transform(Vs(H),[1,0,0,1,-F,-Y]);return H.fillStyle=h?l.getPattern(i,this,W,ii.FILL,e):l,H.fillRect(0,0,r,o),p&&!h&&(this.cachedCanvases.delete("fillCanvas"),p.set(x,z.canvas)),(te=this.dependencyTracker)==null||te.recordDependencies(e,Ur.transformAndFill),{canvas:z.canvas,offsetX:Math.round(F),offsetY:Math.round(Y)}}setLineWidth(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("lineCap",e),this.ctx.lineCap=V6[t]}setLineJoin(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("lineJoin",e),this.ctx.lineJoin=W6[t]}setMiterLimit(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,i){var o;(o=this.dependencyTracker)==null||o.recordSimpleData("dash",e);const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(t),r.lineDashOffset=i)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var i,r,o,l,h;for(const[g,p]of t)switch(g){case"LW":this.setLineWidth(e,p);break;case"LC":this.setLineCap(e,p);break;case"LJ":this.setLineJoin(e,p);break;case"ML":this.setMiterLimit(e,p);break;case"D":this.setDash(e,p[0],p[1]);break;case"RI":this.setRenderingIntent(e,p);break;case"FL":this.setFlatness(e,p);break;case"Font":this.setFont(e,p[0],p[1]);break;case"CA":(i=this.dependencyTracker)==null||i.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=p;break;case"ca":(r=this.dependencyTracker)==null||r.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=p;break;case"BM":(o=this.dependencyTracker)==null||o.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=p;break;case"SMask":(l=this.dependencyTracker)==null||l.recordSimpleData("SMask",e),this.current.activeSMask=p?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(h=this.dependencyTracker)==null||h.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(p);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,i=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(r,t,i);this.suspendedCtx=this.ctx;const l=this.ctx=o.context;l.setTransform(this.suspendedCtx.getTransform()),U0(this.suspendedCtx,l),z6(l,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),U0(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,r){const o=r[0],l=r[1],h=r[2]-o,g=r[3]-l;h===0||g===0||(this.genericComposeSMask(t.context,i,h,g,t.subtype,t.backdrop,t.transferMap,o,l,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,r,o,l,h,g,p,x,y){let v=e.canvas,C=g-x,R=p-y;if(l)if(C<0||R<0||C+i>v.width||R+r>v.height){const O=this.cachedCanvases.getCanvas("maskExtension",i,r),_=O.context;_.drawImage(v,-C,-R),_.globalCompositeOperation="destination-atop",_.fillStyle=l,_.fillRect(0,0,i,r),_.globalCompositeOperation="source-over",v=O.canvas,C=R=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const O=new Path2D;O.rect(C,R,i,r),e.clip(O),e.globalCompositeOperation="destination-atop",e.fillStyle=l,e.fillRect(C,R,i,r),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),o==="Alpha"&&h?t.filter=this.filterFactory.addAlphaFilter(h):o==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(h));const I=new Path2D;I.rect(g,p,i,r),t.clip(I),t.globalCompositeOperation="destination-in",t.drawImage(v,C,R,i,r,g,p,i,r),t.restore()}save(e){var i;this.inSMaskMode&&U0(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(i=this.dependencyTracker)==null||i.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&U0(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,i,r,o,l,h){var g;(g=this.dependencyTracker)==null||g.recordIncrementalData("transform",e),this.ctx.transform(t,i,r,o,l,h),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i,r){let[o]=i;if(!r){o||(o=i[0]=new Path2D),this[t](e,o);return}if(this.dependencyTracker!==null){const l=t===f0.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,r[0]-l,r[2]+l,r[1]-l,r[3]+l).recordDependencies(e,["transform"])}if(!(o instanceof Path2D)){const l=i[0]=new Path2D;for(let h=0,g=o.length;h<g;)switch(o[h++]){case hx.moveTo:l.moveTo(o[h++],o[h++]);break;case hx.lineTo:l.lineTo(o[h++],o[h++]);break;case hx.curveTo:l.bezierCurveTo(o[h++],o[h++],o[h++],o[h++],o[h++],o[h++]);break;case hx.closePath:l.closePath();break;default:Fe(`Unrecognized drawing path operator: ${o[h-1]}`);break}o=l}Ae.axialAlignedBoundingBox(r,Kt(this.ctx),this.current.minMax),this[t](e,o),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,i=!0){var l;const r=this.ctx,o=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&(o!=null&&o.getPattern)){const h=o.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=o.getPattern(r,this,Vs(r),ii.STROKE,e),h){const g=new Path2D;g.addPath(t,r.getTransform().invertSelf().multiplySelf(h)),t=g}this.rescaleAndStroke(t,!1),r.restore()}else this.rescaleAndStroke(t,!0);(l=this.dependencyTracker)==null||l.recordDependencies(e,Ur.stroke),i&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(ii.STROKE,Kt(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,i=!0){var p,x,y;const r=this.ctx,o=this.current.fillColor,l=this.current.patternFill;let h=!1;if(l){const v=o.isModifyingCurrentTransform()?r.getTransform():null;if((p=this.dependencyTracker)==null||p.save(e),r.save(),r.fillStyle=o.getPattern(r,this,Vs(r),ii.FILL,e),v){const C=new Path2D;C.addPath(t,r.getTransform().invertSelf().multiplySelf(v)),t=C}h=!0}const g=this.current.getClippedPathBoundingBox();this.contentVisible&&g!==null&&(this.pendingEOFill?(r.fill(t,"evenodd"),this.pendingEOFill=!1):r.fill(t)),(x=this.dependencyTracker)==null||x.recordDependencies(e,Ur.fill),h&&(r.restore(),(y=this.dependencyTracker)==null||y.restore(e)),i&&this.consumePath(e,t,g)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var i;this.ctx.fill(t),(i=this.dependencyTracker)==null||i.recordDependencies(e,Ur.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=G6}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=l_}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:r}=this;t!==void 0&&r.recordFutureForcedDependency("textClip",r.getOpenMarker()).recordFutureForcedDependency("textClip",e),r.recordCloseMarker(e)}if(t!==void 0){const r=new Path2D,o=i.getTransform().invertSelf();for(const{transform:l,x:h,y:g,fontSize:p,path:x}of t)x&&r.addPath(x,new DOMMatrix(l).preMultiplySelf(o).translate(h,g).scale(p,-p));i.clip(r)}delete this.pendingTextPaths}setCharSpacing(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,i){var y,v;(y=this.dependencyTracker)==null||y.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const r=this.commonObjs.get(t),o=this.current;if(!r)throw new Error(`Can't find font for ${t}`);if(o.fontMatrix=r.fontMatrix||gb,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&Fe("Invalid font matrix for font "+t),i<0?(i=-i,o.fontDirection=-1):o.fontDirection=1,this.current.font=r,this.current.fontSize=i,r.isType3Font)return;const l=r.loadedName||"sans-serif",h=((v=r.systemFontInfo)==null?void 0:v.css)||`"${l}", ${r.fallbackName}`;let g="normal";r.black?g="900":r.bold&&(g="bold");const p=r.italic?"italic":"normal";let x=i;i<t_?x=t_:i>n_&&(x=n_),this.current.fontSizeScale=i/x,this.ctx.font=`${p} ${g} ${x}px ${h}`}setTextRenderingMode(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,i){var r;(r=this.dependencyTracker)==null||r.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=i}setLeadingMoveText(e,t,i){this.setLeading(e,-i),this.moveText(e,t,i)}setTextMatrix(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("textMatrix",e);const{current:i}=this;i.textMatrix=t,i.textMatrixScale=Math.hypot(t[0],t[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,i,r,o,l){var _,N,k,B;const h=this.ctx,g=this.current,p=g.font,x=g.textRenderingMode,y=g.fontSize/g.fontSizeScale,v=x&Kn.FILL_STROKE_MASK,C=!!(x&Kn.ADD_TO_PATH_FLAG),R=g.patternFill&&!p.missingFile,I=g.patternStroke&&!p.missingFile;let O;if((p.disableFontFace||C||R||I)&&!p.missingFile&&(O=p.getPathGenerator(this.commonObjs,t)),O&&(p.disableFontFace||R||I)){h.save(),h.translate(i,r),h.scale(y,-y),(_=this.dependencyTracker)==null||_.recordCharacterBBox(e,h,p);let z;if(v===Kn.FILL||v===Kn.FILL_STROKE)if(o){z=h.getTransform(),h.setTransform(...o);const H=P(this,Gg,Gb).call(this,O,z,o);h.fill(H)}else h.fill(O);if(v===Kn.STROKE||v===Kn.FILL_STROKE)if(l){z||(z=h.getTransform()),h.setTransform(...l);const{a:H,b:F,c:Y,d:W}=z,Z=Ae.inverseTransform(l),te=Ae.transform([H,F,Y,W,0,0],Z);Ae.singularValueDecompose2dScale(te,_r),h.lineWidth*=Math.max(_r[0],_r[1])/y,h.stroke(P(this,Gg,Gb).call(this,O,z,l))}else h.lineWidth/=y,h.stroke(O);h.restore()}else(v===Kn.FILL||v===Kn.FILL_STROKE)&&(h.fillText(t,i,r),(N=this.dependencyTracker)==null||N.recordCharacterBBox(e,h,p,y,i,r,()=>h.measureText(t))),(v===Kn.STROKE||v===Kn.FILL_STROKE)&&(this.dependencyTracker&&((k=this.dependencyTracker)==null||k.recordCharacterBBox(e,h,p,y,i,r,()=>h.measureText(t)).recordDependencies(e,Ur.stroke)),h.strokeText(t,i,r));C&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Kt(h),x:i,y:r,fontSize:y,path:O}),(B=this.dependencyTracker)==null||B.recordCharacterBBox(e,h,p,y,i,r))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let i=!1;for(let r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){i=!0;break}return Ve(this,"isFontSubpixelAAEnabled",i)}showText(e,t){var Y,W,Z,te;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,Ur.showText).resetBBox(e),this.current.textRenderingMode&Kn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,r=i.font;if(r.isType3Font){this.showType3Text(e,t),(Y=this.dependencyTracker)==null||Y.recordShowTextOperation(e);return}const o=i.fontSize;if(o===0){(W=this.dependencyTracker)==null||W.recordOperation(e);return}const l=this.ctx,h=i.fontSizeScale,g=i.charSpacing,p=i.wordSpacing,x=i.fontDirection,y=i.textHScale*x,v=t.length,C=r.vertical,R=C?1:-1,I=r.defaultVMetrics,O=o*i.fontMatrix[0],_=i.textRenderingMode===Kn.FILL&&!r.disableFontFace&&!i.patternFill;l.save(),i.textMatrix&&l.transform(...i.textMatrix),l.translate(i.x,i.y+i.textRise),x>0?l.scale(y,-1):l.scale(y,1);let N,k;if(i.patternFill){l.save();const ee=i.fillColor.getPattern(l,this,Vs(l),ii.FILL,e);N=Kt(l),l.restore(),l.fillStyle=ee}if(i.patternStroke){l.save();const ee=i.strokeColor.getPattern(l,this,Vs(l),ii.STROKE,e);k=Kt(l),l.restore(),l.strokeStyle=ee}let B=i.lineWidth;const z=i.textMatrixScale;if(z===0||B===0){const ee=i.textRenderingMode&Kn.FILL_STROKE_MASK;(ee===Kn.STROKE||ee===Kn.FILL_STROKE)&&(B=this.getSinglePixelWidth())}else B/=z;if(h!==1&&(l.scale(h,h),B/=h),l.lineWidth=B,r.isInvalidPDFjsFont){const ee=[];let le=0;for(const $ of t)ee.push($.unicode),le+=$.width;const ce=ee.join("");if(l.fillText(ce,0,0),this.dependencyTracker!==null){const $=l.measureText(ce);this.dependencyTracker.recordBBox(e,this.ctx,-$.actualBoundingBoxLeft,$.actualBoundingBoxRight,-$.actualBoundingBoxAscent,$.actualBoundingBoxDescent).recordShowTextOperation(e)}i.x+=le*O*y,l.restore(),this.compose();return}let H=0,F;for(F=0;F<v;++F){const ee=t[F];if(typeof ee=="number"){H+=R*ee*o/1e3;continue}let le=!1;const ce=(ee.isSpace?p:0)+g,$=ee.fontChar,oe=ee.accent;let ne,ie,ge=ee.width;if(C){const we=ee.vmetric||I,me=-(ee.vmetric?we[1]:ge*.5)*O,Le=we[2]*O;ge=we?-we[0]:ge,ne=me/h,ie=(H+Le)/h}else ne=H/h,ie=0;let ye;if(r.remeasure&&ge>0){ye=l.measureText($);const we=ye.width*1e3/o*h;if(ge<we&&this.isFontSubpixelAAEnabled){const me=ge/we;le=!0,l.save(),l.scale(me,1),ne/=me}else ge!==we&&(ne+=(ge-we)/2e3*o/h)}if(this.contentVisible&&(ee.isInFont||r.missingFile)){if(_&&!oe)l.fillText($,ne,ie),(Z=this.dependencyTracker)==null||Z.recordCharacterBBox(e,l,ye?{bbox:null}:r,o/h,ne,ie,()=>ye??l.measureText($));else if(this.paintChar(e,$,ne,ie,N,k),oe){const we=ne+o*oe.offset.x/h,me=ie-o*oe.offset.y/h;this.paintChar(e,oe.fontChar,we,me,N,k)}}const Me=C?ge*O-ce*x:ge*O+ce*x;H+=Me,le&&l.restore()}C?i.y-=H:i.x+=H*y,l.restore(),this.compose(),(te=this.dependencyTracker)==null||te.recordShowTextOperation(e)}showType3Text(e,t){const i=this.ctx,r=this.current,o=r.font,l=r.fontSize,h=r.fontDirection,g=o.vertical?1:-1,p=r.charSpacing,x=r.wordSpacing,y=r.textHScale*h,v=r.fontMatrix||gb,C=t.length,R=r.textRenderingMode===Kn.INVISIBLE;let I,O,_,N;if(R||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),r.textMatrix&&i.transform(...r.textMatrix),i.translate(r.x,r.y+r.textRise),i.scale(y,h);const k=this.dependencyTracker;for(this.dependencyTracker=k?new j2(k,e):null,I=0;I<C;++I){if(O=t[I],typeof O=="number"){N=g*O*l/1e3,this.ctx.translate(N,0),r.x+=N*y;continue}const B=(O.isSpace?x:0)+p,z=o.charProcOperatorList[O.operatorListId];z?this.contentVisible&&(this.save(),i.scale(l,l),i.transform(...v),this.executeOperatorList(z),this.restore()):Fe(`Type3 character "${O.operatorListId}" is not available.`);const H=[O.width,0];Ae.applyTransform(H,v),_=H[0]*l+B,i.translate(_,0),r.x+=_*y}i.restore(),k&&(this.dependencyTracker=k)}setCharWidth(e,t,i){}setCharWidthAndBounds(e,t,i,r,o,l,h){var p;const g=new Path2D;g.rect(r,o,l-r,h-o),this.ctx.clip(g),(p=this.dependencyTracker)==null||p.recordBBox(e,this.ctx,r,l,o,h).recordClipBox(e,this.ctx,r,l,o,h),this.endPath(e)}getColorN_Pattern(e,t){let i;if(t[0]==="TilingPattern"){const r=this.baseTransform||Kt(this.ctx),o={createCanvasGraphics:(l,h)=>new fS(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new j2(this.dependencyTracker,h,!0):null)};i=new Hb(t,this.ctx,o,r)}else i=this._getPattern(e,t[1],t[2]);return i}setStrokeColorN(e,...t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,i=null){let r;return this.cachedPatterns.has(t)?r=this.cachedPatterns.get(t):(r=F6(this.getObject(e,t)),this.cachedPatterns.set(t,r)),i&&(r.matrix=i),r}shadingFill(e,t){var l;if(!this.contentVisible)return;const i=this.ctx;this.save(e);const r=this._getPattern(e,t);i.fillStyle=r.getPattern(i,this,Vs(i),ii.SHADING,e);const o=Vs(i);if(o){const{width:h,height:g}=i.canvas,p=Gh.slice();Ae.axialAlignedBoundingBox([0,0,h,g],o,p);const[x,y,v,C]=p;this.ctx.fillRect(x,y,v-x,C-y)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(l=this.dependencyTracker)==null||l.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,Ur.transform).recordDependencies(e,Ur.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){It("Should not call beginInlineImage")}beginImageData(){It("Should not call beginImageData")}paintFormXObjectBegin(e,t,i){var r;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Kt(this.ctx),i)){Ae.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[o,l,h,g]=i,p=new Path2D;p.rect(o,l,h-o,g-l),this.ctx.clip(p),(r=this.dependencyTracker)==null||r.recordClipBox(e,this.ctx,o,h,l,g),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var k;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;t.isolated||sA("TODO: Support non-isolated groups."),t.knockout&&Fe("Knockout groups not supported.");const r=Kt(i);if(t.matrix&&i.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let o=Gh.slice();Ae.axialAlignedBoundingBox(t.bbox,Kt(i),o);const l=[0,0,i.canvas.width,i.canvas.height];o=Ae.intersect(o,l)||[0,0,0,0];const h=Math.floor(o[0]),g=Math.floor(o[1]),p=Math.max(Math.ceil(o[2])-h,1),x=Math.max(Math.ceil(o[3])-g,1);this.current.startNewPathAndClipBox([0,0,p,x]);let y="groupAt"+this.groupLevel;t.smask&&(y+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(y,p,x),C=v.context;C.translate(-h,-g),C.transform(...r);let R=new Path2D;const[I,O,_,N]=t.bbox;if(R.rect(I,O,_-I,N-O),t.matrix){const B=new Path2D;B.addPath(R,new DOMMatrix(t.matrix)),R=B}C.clip(R),t.smask&&this.smaskStack.push({canvas:v.canvas,context:C,offsetX:h,offsetY:g,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(i.setTransform(1,0,0,1,0,0),i.translate(h,g),i.save()),U0(i,C),this.ctx=C,(k=this.dependencyTracker)==null||k.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(e,t){var o;if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,(o=this.dependencyTracker)==null||o.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const l=Kt(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...l);const h=Gh.slice();Ae.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],l,h),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(h)}}beginAnnotation(e,t,i,r,o,l){if(P(this,Vg,Vb).call(this),wx(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const h=i[2]-i[0],g=i[3]-i[1];if(l&&this.annotationCanvasMap){r=r.slice(),r[4]-=i[0],r[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=h,i[3]=g,Ae.singularValueDecompose2dScale(Kt(this.ctx),_r);const{viewportScale:p}=this,x=Math.ceil(h*this.outputScaleX*p),y=Math.ceil(g*this.outputScaleY*p);this.annotationCanvas=this.canvasFactory.create(x,y);const{canvas:v,context:C}=this.annotationCanvas;this.annotationCanvasMap.set(t,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=C,this.ctx.save(),this.ctx.setTransform(_r[0],0,0,-_r[1],0,g*_r[1]),wx(this.ctx)}else{wx(this.ctx),this.endPath(e);const p=new Path2D;p.rect(i[0],i[1],h,g),this.ctx.clip(p)}}this.current=new r_(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...r),this.transform(e,...o)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),P(this,Wg,Wb).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var h;if(!this.contentVisible)return;const i=t.count;t=this.getObject(e,t.data,t),t.count=i;const r=this.ctx,o=this._createMaskCanvas(e,t),l=o.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(l,o.offsetX,o.offsetY),(h=this.dependencyTracker)==null||h.resetBBox(e).recordBBox(e,this.ctx,o.offsetX,o.offsetX+l.width,o.offsetY,o.offsetY+l.height).recordOperation(e),r.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i,r=0,o=0,l,h){var y,v,C;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const g=this.ctx;g.save();const p=Kt(g);g.transform(i,r,o,l,0,0);const x=this._createMaskCanvas(e,t);g.setTransform(1,0,0,1,x.offsetX-p[4],x.offsetY-p[5]),(y=this.dependencyTracker)==null||y.resetBBox(e);for(let R=0,I=h.length;R<I;R+=2){const O=Ae.transform(p,[i,r,o,l,h[R],h[R+1]]);g.drawImage(x.canvas,O[4],O[5]),(v=this.dependencyTracker)==null||v.recordBBox(e,this.ctx,O[4],O[4]+x.canvas.width,O[5],O[5]+x.canvas.height)}g.restore(),this.compose(),(C=this.dependencyTracker)==null||C.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var l,h,g;if(!this.contentVisible)return;const i=this.ctx,r=this.current.fillColor,o=this.current.patternFill;(l=this.dependencyTracker)==null||l.resetBBox(e).recordDependencies(e,Ur.transformAndFill);for(const p of t){const{data:x,width:y,height:v,transform:C}=p,R=this.cachedCanvases.getCanvas("maskCanvas",y,v),I=R.context;I.save();const O=this.getObject(e,x,p);o_(I,O),I.globalCompositeOperation="source-in",I.fillStyle=o?r.getPattern(I,this,Vs(i),ii.FILL,e):r,I.fillRect(0,0,y,v),I.restore(),i.save(),i.transform(...C),i.scale(1,-1),xx(i,R.canvas,0,0,y,v,0,-1,1,1),(h=this.dependencyTracker)==null||h.recordBBox(e,i,0,y,0,v),i.restore()}this.compose(),(g=this.dependencyTracker)==null||g.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const i=this.getObject(e,t);if(!i){Fe("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,i)}paintImageXObjectRepeat(e,t,i,r,o){if(!this.contentVisible)return;const l=this.getObject(e,t);if(!l){Fe("Dependent image isn't ready yet");return}const h=l.width,g=l.height,p=[];for(let x=0,y=o.length;x<y;x+=2)p.push({transform:[i,0,0,r,o[x],o[x+1]],x:0,y:0,w:h,h:g});this.paintInlineImageXObjectGroup(e,l,p)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:i,height:r}=e,o=this.cachedCanvases.getCanvas("inlineImage",i,r),l=o.context;return l.filter=this.current.transferMaps,l.drawImage(t,0,0),l.filter="none",o.canvas}paintInlineImageXObject(e,t){var p;if(!this.contentVisible)return;const i=t.width,r=t.height,o=this.ctx;this.save(e);const{filter:l}=o;l!=="none"&&l!==""&&(o.filter="none"),o.scale(1/i,-1/r);let h;if(t.bitmap)h=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)h=t;else{const y=this.cachedCanvases.getCanvas("inlineImage",i,r).context;s_(y,t),h=this.applyTransferMapsToCanvas(y)}const g=this._scaleImage(h,Vs(o));o.imageSmoothingEnabled=a_(Kt(o),t.interpolate),(p=this.dependencyTracker)==null||p.resetBBox(e).recordBBox(e,o,0,i,-r,0).recordDependencies(e,Ur.imageXObject).recordOperation(e),xx(o,g.img,0,0,g.paintWidth,g.paintHeight,0,-r,i,r),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,i){var l,h,g;if(!this.contentVisible)return;const r=this.ctx;let o;if(t.bitmap)o=t.bitmap;else{const p=t.width,x=t.height,v=this.cachedCanvases.getCanvas("inlineImage",p,x).context;s_(v,t),o=this.applyTransferMapsToCanvas(v)}(l=this.dependencyTracker)==null||l.resetBBox(e);for(const p of i)r.save(),r.transform(...p.transform),r.scale(1,-1),xx(r,o,p.x,p.y,p.w,p.h,0,-1,1,1),(h=this.dependencyTracker)==null||h.recordBBox(e,r,0,1,-1,0),r.restore();(g=this.dependencyTracker)==null||g.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,Ur.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,i){}beginMarkedContent(e,t){var i;(i=this.dependencyTracker)==null||i.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,i){var r;(r=this.dependencyTracker)==null||r.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,i){var l,h;const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const o=this.ctx;this.pendingClip?(r||(this.pendingClip===l_?o.clip(t,"evenodd"):o.clip(t)),this.pendingClip=null,(l=this.dependencyTracker)==null||l.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(h=this.dependencyTracker)==null||h.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Kt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:i,c:r,d:o}=this.ctx.getTransform();let l,h;if(i===0&&r===0){const g=Math.abs(t),p=Math.abs(o);if(g===p)if(e===0)l=h=1/g;else{const x=g*e;l=h=x<1?1/x:1}else if(e===0)l=1/g,h=1/p;else{const x=g*e,y=p*e;l=x<1?1/x:1,h=y<1?1/y:1}}else{const g=Math.abs(t*o-i*r),p=Math.hypot(t,i),x=Math.hypot(r,o);if(e===0)l=x/g,h=p/g;else{const y=e*g;l=x>y?x/y:1,h=p>y?p/y:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=h}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:i,current:{lineWidth:r}}=this,[o,l]=this.getScaleForStroking();if(o===l){i.lineWidth=(r||1)*o,i.stroke(e);return}const h=i.getLineDash();t&&i.save(),i.scale(o,l),pv.a=1/o,pv.d=1/l;const g=new Path2D;if(g.addPath(e,pv),h.length>0){const p=Math.max(o,l);i.setLineDash(h.map(x=>x/p)),i.lineDashOffset/=p}i.lineWidth=r||1,i.stroke(g),t&&i.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Vg=new WeakSet,Vb=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Wg=new WeakSet,Wb=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},Gg=new WeakSet,Gb=function(e,t,i){const r=new Path2D;return r.addPath(e,new DOMMatrix(i).invertSelf().multiplySelf(t)),r};let id=fS;for(const n in f0)id.prototype[n]!==void 0&&(id.prototype[f0[n]]=id.prototype[n]);var jd,zd,Xg,Hd,Vx;const $h=class $h{constructor(e){E(this,Hd);E(this,jd,void 0);E(this,zd,void 0);E(this,Xg,void 0);S(this,jd,e),S(this,zd,new DataView(u(this,jd))),S(this,Xg,new TextDecoder)}static write(e){const t=new TextEncoder,i={};let r=0;for(const p of $h.strings){const x=t.encode(e[p]);i[p]=x,r+=4+x.length}const o=new ArrayBuffer(r),l=new Uint8Array(o),h=new DataView(o);let g=0;for(const p of $h.strings){const x=i[p],y=x.length;h.setUint32(g,y),l.set(x,g+4),g+=4+y}return it(g===o.byteLength,"CssFontInfo.write: Buffer overflow"),o}get fontFamily(){return P(this,Hd,Vx).call(this,0)}get fontWeight(){return P(this,Hd,Vx).call(this,1)}get italicAngle(){return P(this,Hd,Vx).call(this,2)}};jd=new WeakMap,zd=new WeakMap,Xg=new WeakMap,Hd=new WeakSet,Vx=function(e){it(e<$h.strings.length,"Invalid string index");let t=0;for(let r=0;r<e;r++)t+=u(this,zd).getUint32(t)+4;const i=u(this,zd).getUint32(t);return u(this,Xg).decode(new Uint8Array(u(this,jd),t+4,i))},ue($h,"strings",["fontFamily","fontWeight","italicAngle"]);let z2=$h;var ol,ro,iu,ru,s1;const Kh=class Kh{constructor(e){E(this,ru);E(this,ol,void 0);E(this,ro,void 0);E(this,iu,void 0);S(this,ol,e),S(this,ro,new DataView(u(this,ol))),S(this,iu,new TextDecoder)}static write(e){const t=new TextEncoder,i={};let r=0;for(const v of Kh.strings){const C=t.encode(e[v]);i[v]=C,r+=4+C.length}r+=4;let o,l,h=1+r;e.style&&(o=t.encode(e.style.style),l=t.encode(e.style.weight),h+=4+o.length+4+l.length);const g=new ArrayBuffer(h),p=new Uint8Array(g),x=new DataView(g);let y=0;x.setUint8(y++,e.guessFallback?1:0),x.setUint32(y,0),y+=4,r=0;for(const v of Kh.strings){const C=i[v],R=C.length;r+=4+R,x.setUint32(y,R),p.set(C,y+4),y+=4+R}return x.setUint32(y-r-4,r),e.style&&(x.setUint32(y,o.length),p.set(o,y+4),y+=4+o.length,x.setUint32(y,l.length),p.set(l,y+4),y+=4+l.length),it(y<=g.byteLength,"SubstitionInfo.write: Buffer overflow"),g.transferToFixedLength(y)}get guessFallback(){return u(this,ro).getUint8(0)!==0}get css(){return P(this,ru,s1).call(this,0)}get loadedName(){return P(this,ru,s1).call(this,1)}get baseFontName(){return P(this,ru,s1).call(this,2)}get src(){return P(this,ru,s1).call(this,3)}get style(){let e=1;e+=4+u(this,ro).getUint32(e);const t=u(this,ro).getUint32(e),i=u(this,iu).decode(new Uint8Array(u(this,ol),e+4,t));e+=4+t;const r=u(this,ro).getUint32(e),o=u(this,iu).decode(new Uint8Array(u(this,ol),e+4,r));return{style:i,weight:o}}};ol=new WeakMap,ro=new WeakMap,iu=new WeakMap,ru=new WeakSet,s1=function(e){it(e<Kh.strings.length,"Invalid string index");let t=5;for(let r=0;r<e;r++)t+=u(this,ro).getUint32(t)+4;const i=u(this,ro).getUint32(t);return u(this,iu).decode(new Uint8Array(u(this,ol),t+4,i))},ue(Kh,"strings",["css","loadedName","baseFontName","src"]);let H2=Kh;var Vd,Wd,Gd,Xd,cr,so,Yg,At,ur,hs,Yd,Wx,su,o1;const ze=class ze{constructor({data:e,extra:t}){E(this,ur);E(this,Yd);E(this,su);E(this,so,void 0);E(this,Yg,void 0);E(this,At,void 0);S(this,so,e),S(this,Yg,new TextDecoder),S(this,At,new DataView(u(this,so))),t&&Object.assign(this,t)}get black(){return P(this,ur,hs).call(this,0)}get bold(){return P(this,ur,hs).call(this,1)}get disableFontFace(){return P(this,ur,hs).call(this,2)}get fontExtraProperties(){return P(this,ur,hs).call(this,3)}get isInvalidPDFjsFont(){return P(this,ur,hs).call(this,4)}get isType3Font(){return P(this,ur,hs).call(this,5)}get italic(){return P(this,ur,hs).call(this,6)}get missingFile(){return P(this,ur,hs).call(this,7)}get remeasure(){return P(this,ur,hs).call(this,8)}get vertical(){return P(this,ur,hs).call(this,9)}get ascent(){return P(this,Yd,Wx).call(this,0)}get defaultWidth(){return P(this,Yd,Wx).call(this,1)}get descent(){return P(this,Yd,Wx).call(this,2)}get bbox(){let e=u(ze,Wd);if(u(this,At).getUint8(e)===0)return;e+=1;const i=[];for(let r=0;r<4;r++)i.push(u(this,At).getInt16(e,!0)),e+=2;return i}get fontMatrix(){let e=u(ze,Gd);if(u(this,At).getUint8(e)===0)return;e+=1;const i=[];for(let r=0;r<6;r++)i.push(u(this,At).getFloat64(e,!0)),e+=8;return i}get defaultVMetrics(){let e=u(ze,Xd);if(u(this,At).getUint8(e)===0)return;e+=1;const i=[];for(let r=0;r<3;r++)i.push(u(this,At).getInt16(e,!0)),e+=2;return i}get fallbackName(){return P(this,su,o1).call(this,0)}get loadedName(){return P(this,su,o1).call(this,1)}get mimetype(){return P(this,su,o1).call(this,2)}get name(){return P(this,su,o1).call(this,3)}get data(){let e=u(ze,cr);const t=u(this,At).getUint32(e);e+=4+t;const i=u(this,At).getUint32(e);e+=4+i;const r=u(this,At).getUint32(e);e+=4+r;const o=u(this,At).getUint32(e);if(o!==0)return new Uint8Array(u(this,so),e+4,o)}clearData(){let e=u(ze,cr);const t=u(this,At).getUint32(e);e+=4+t;const i=u(this,At).getUint32(e);e+=4+i;const r=u(this,At).getUint32(e);e+=4+r;const o=u(this,At).getUint32(e);new Uint8Array(u(this,so),e+4,o).fill(0),u(this,At).setUint32(e,0)}get cssFontInfo(){let e=u(ze,cr);const t=u(this,At).getUint32(e);e+=4+t;const i=u(this,At).getUint32(e);e+=4+i;const r=u(this,At).getUint32(e);if(r===0)return null;const o=new Uint8Array(r);return o.set(new Uint8Array(u(this,so),e+4,r)),new z2(o.buffer)}get systemFontInfo(){let e=u(ze,cr);const t=u(this,At).getUint32(e);e+=4+t;const i=u(this,At).getUint32(e);if(i===0)return null;const r=new Uint8Array(i);return r.set(new Uint8Array(u(this,so),e+4,i)),new H2(r.buffer)}static write(e){const t=e.systemFontInfo?H2.write(e.systemFontInfo):null,i=e.cssFontInfo?z2.write(e.cssFontInfo):null,r=new TextEncoder,o={};let l=0;for(const I of ze.strings)o[I]=r.encode(e[I]),l+=4+o[I].length;const h=u(ze,cr)+4+l+4+(t?t.byteLength:0)+4+(i?i.byteLength:0)+4+(e.data?e.data.length:0),g=new ArrayBuffer(h),p=new Uint8Array(g),x=new DataView(g);let y=0;const v=ze.bools.length;let C=0,R=0;for(let I=0;I<v;I++){const O=e[ze.bools[I]];C|=(O===void 0?0:O?2:1)<<R,R+=2,(R===8||I===v-1)&&(x.setUint8(y++,C),C=0,R=0)}it(y===u(ze,Vd),"FontInfo.write: Boolean properties offset mismatch");for(const I of ze.numbers)x.setFloat64(y,e[I]),y+=8;if(it(y===u(ze,Wd),"FontInfo.write: Number properties offset mismatch"),e.bbox){x.setUint8(y++,4);for(const I of e.bbox)x.setInt16(y,I,!0),y+=2}else x.setUint8(y++,0),y+=2*4;if(it(y===u(ze,Gd),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){x.setUint8(y++,6);for(const I of e.fontMatrix)x.setFloat64(y,I,!0),y+=8}else x.setUint8(y++,0),y+=8*6;if(it(y===u(ze,Xd),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){x.setUint8(y++,1);for(const I of e.defaultVMetrics)x.setInt16(y,I,!0),y+=2}else x.setUint8(y++,0),y+=3*2;it(y===u(ze,cr),"FontInfo.write: DefaultVMetrics properties offset mismatch"),x.setUint32(u(ze,cr),0),y+=4;for(const I of ze.strings){const O=o[I],_=O.length;x.setUint32(y,_),p.set(O,y+4),y+=4+_}if(x.setUint32(u(ze,cr),y-u(ze,cr)-4),!t)x.setUint32(y,0),y+=4;else{const I=t.byteLength;x.setUint32(y,I),it(y+4+I<=g.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),p.set(new Uint8Array(t),y+4),y+=4+I}if(!i)x.setUint32(y,0),y+=4;else{const I=i.byteLength;x.setUint32(y,I),it(y+4+I<=g.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),p.set(new Uint8Array(i),y+4),y+=4+I}return e.data===void 0?(x.setUint32(y,0),y+=4):(x.setUint32(y,e.data.length),p.set(e.data,y+4),y+=4+e.data.length),it(y<=g.byteLength,"FontInfo.write: Buffer overflow"),g.transferToFixedLength(y)}};Vd=new WeakMap,Wd=new WeakMap,Gd=new WeakMap,Xd=new WeakMap,cr=new WeakMap,so=new WeakMap,Yg=new WeakMap,At=new WeakMap,ur=new WeakSet,hs=function(e){it(e<ze.bools.length,"Invalid boolean index");const t=Math.floor(e/4),i=e*2%8,r=u(this,At).getUint8(t)>>i&3;return r===0?void 0:r===2},Yd=new WeakSet,Wx=function(e){return it(e<ze.numbers.length,"Invalid number index"),u(this,At).getFloat64(u(ze,Vd)+e*8)},su=new WeakSet,o1=function(e){it(e<ze.strings.length,"Invalid string index");let t=u(ze,cr)+4;for(let o=0;o<e;o++)t+=u(this,At).getUint32(t)+4;const i=u(this,At).getUint32(t),r=new Uint8Array(i);return r.set(new Uint8Array(u(this,so),t+4,i)),u(this,Yg).decode(r)},ue(ze,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),ue(ze,"numbers",["ascent","defaultWidth","descent"]),ue(ze,"strings",["fallbackName","loadedName","mimetype","name"]),E(ze,Vd,Math.ceil(ze.bools.length*2/8)),E(ze,Wd,u(ze,Vd)+ze.numbers.length*8),E(ze,Gd,u(ze,Wd)+1+2*4),E(ze,Xd,u(ze,Gd)+1+8*6),E(ze,cr,u(ze,Xd)+1+2*3);let Xb=ze;var $g,Kg;class es{static get workerPort(){return u(this,$g)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");S(this,$g,e)}static get workerSrc(){return u(this,Kg)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");S(this,Kg,e)}}$g=new WeakMap,Kg=new WeakMap,E(es,$g,null),E(es,Kg,"");var $d,qg;class X6{constructor({parsedData:e,rawData:t}){E(this,$d,void 0);E(this,qg,void 0);S(this,$d,e),S(this,qg,t)}getRaw(){return u(this,qg)}get(e){return u(this,$d).get(e)??null}[Symbol.iterator](){return u(this,$d).entries()}}$d=new WeakMap,qg=new WeakMap;const Nh=Symbol("INTERNAL");var Zg,Qg,Jg,Kd;class Y6{constructor(e,{name:t,intent:i,usage:r,rbGroups:o}){E(this,Zg,!1);E(this,Qg,!1);E(this,Jg,!1);E(this,Kd,!0);S(this,Zg,!!(e&Cr.DISPLAY)),S(this,Qg,!!(e&Cr.PRINT)),this.name=t,this.intent=i,this.usage=r,this.rbGroups=o}get visible(){if(u(this,Jg))return u(this,Kd);if(!u(this,Kd))return!1;const{print:e,view:t}=this.usage;return u(this,Zg)?(t==null?void 0:t.viewState)!=="OFF":u(this,Qg)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,i=!1){e!==Nh&&It("Internal method `_setVisible` called."),S(this,Jg,i),S(this,Kd,t)}}Zg=new WeakMap,Qg=new WeakMap,Jg=new WeakMap,Kd=new WeakMap;var al,vt,qd,Zd,ep,Yb;class $6{constructor(e,t=Cr.DISPLAY){E(this,ep);E(this,al,null);E(this,vt,new Map);E(this,qd,null);E(this,Zd,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,S(this,Zd,e.order);for(const i of e.groups)u(this,vt).set(i.id,new Y6(t,i));if(e.baseState==="OFF")for(const i of u(this,vt).values())i._setVisible(Nh,!1);for(const i of e.on)u(this,vt).get(i)._setVisible(Nh,!0);for(const i of e.off)u(this,vt).get(i)._setVisible(Nh,!1);S(this,qd,this.getHash())}}isVisible(e){if(u(this,vt).size===0)return!0;if(!e)return sA("Optional content group not defined."),!0;if(e.type==="OCG")return u(this,vt).has(e.id)?u(this,vt).get(e.id).visible:(Fe(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return P(this,ep,Yb).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!u(this,vt).has(t))return Fe(`Optional content group not found: ${t}`),!0;if(u(this,vt).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!u(this,vt).has(t))return Fe(`Optional content group not found: ${t}`),!0;if(!u(this,vt).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!u(this,vt).has(t))return Fe(`Optional content group not found: ${t}`),!0;if(!u(this,vt).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!u(this,vt).has(t))return Fe(`Optional content group not found: ${t}`),!0;if(u(this,vt).get(t).visible)return!1}return!0}return Fe(`Unknown optional content policy ${e.policy}.`),!0}return Fe(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){var o;const r=u(this,vt).get(e);if(!r){Fe(`Optional content group not found: ${e}`);return}if(i&&t&&r.rbGroups.length)for(const l of r.rbGroups)for(const h of l)h!==e&&((o=u(this,vt).get(h))==null||o._setVisible(Nh,!1,!0));r._setVisible(Nh,!!t,!0),S(this,al,null)}setOCGState({state:e,preserveRB:t}){let i;for(const r of e){switch(r){case"ON":case"OFF":case"Toggle":i=r;continue}const o=u(this,vt).get(r);if(o)switch(i){case"ON":this.setVisibility(r,!0,t);break;case"OFF":this.setVisibility(r,!1,t);break;case"Toggle":this.setVisibility(r,!o.visible,t);break}}S(this,al,null)}get hasInitialVisibility(){return u(this,qd)===null||this.getHash()===u(this,qd)}getOrder(){return u(this,vt).size?u(this,Zd)?u(this,Zd).slice():[...u(this,vt).keys()]:null}getGroup(e){return u(this,vt).get(e)||null}getHash(){if(u(this,al)!==null)return u(this,al);const e=new H4;for(const[t,i]of u(this,vt))e.update(`${t}:${i.visible}`);return S(this,al,e.hexdigest())}[Symbol.iterator](){return u(this,vt).entries()}}al=new WeakMap,vt=new WeakMap,qd=new WeakMap,Zd=new WeakMap,ep=new WeakSet,Yb=function(e){const t=e.length;if(t<2)return!0;const i=e[0];for(let r=1;r<t;r++){const o=e[r];let l;if(Array.isArray(o))l=P(this,ep,Yb).call(this,o);else if(u(this,vt).has(o))l=u(this,vt).get(o).visible;else return Fe(`Optional content group not found: ${o}`),!0;switch(i){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return i==="And"};class K6{constructor(e,{disableRange:t=!1,disableStream:i=!1}){it(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:o,progressiveDone:l,contentDispositionFilename:h}=e;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=h,(o==null?void 0:o.length)>0){const g=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(g)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!t,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((g,p)=>{this._onReceiveData({begin:g,chunk:p})}),e.addProgressListener((g,p)=>{this._onProgress({loaded:g,total:p})}),e.addProgressiveReadListener(g=>{this._onReceiveData({chunk:g})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const r=this._rangeReaders.some(function(o){return o._begin!==e?!1:(o._enqueue(i),!0)});it(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,i,r,o;e.total===void 0?(i=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||i.call(t,{loaded:e.loaded}):(o=(r=this._fullRequestReader)==null?void 0:r.onProgress)==null||o.call(r,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){it(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new q6(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new Z6(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeReaders.slice(0))i.cancel(e);this._pdfDataRangeTransport.abort()}}class q6{constructor(e,t,i=!1,r=null){this._stream=e,this._done=i||!1,this._filename=aA(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Z6{constructor(e,t,i){this._stream=e,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Q6(n){let e=!0,t=i("filename\\*","i").exec(n);if(t){t=t[1];let x=h(t);return x=unescape(x),x=g(x),x=p(x),o(x)}if(t=l(n),t){const x=p(t);return o(x)}if(t=i("filename","i").exec(n),t){t=t[1];let x=h(t);return x=p(x),o(x)}function i(x,y){return new RegExp("(?:^|;)\\s*"+x+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function r(x,y){if(x){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const v=new TextDecoder(x,{fatal:!0}),C=km(y);y=v.decode(C),e=!1}catch{}}return y}function o(x){return e&&/[\x80-\xff]/.test(x)&&(x=r("utf-8",x),e&&(x=r("iso-8859-1",x))),x}function l(x){const y=[];let v;const C=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=C.exec(x))!==null;){let[,I,O,_]=v;if(I=parseInt(I,10),I in y){if(I===0)break;continue}y[I]=[O,_]}const R=[];for(let I=0;I<y.length&&I in y;++I){let[O,_]=y[I];_=h(_),O&&(_=unescape(_),I===0&&(_=g(_))),R.push(_)}return R.join("")}function h(x){if(x.startsWith('"')){const y=x.slice(1).split('\\"');for(let v=0;v<y.length;++v){const C=y[v].indexOf('"');C!==-1&&(y[v]=y[v].slice(0,C),y.length=v+1),y[v]=y[v].replaceAll(/\\(.)/g,"$1")}x=y.join('"')}return x}function g(x){const y=x.indexOf("'");if(y===-1)return x;const v=x.slice(0,y),R=x.slice(y+1).replace(/^[^']*'/,"");return r(v,R)}function p(x){return!x.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(x)?x:x.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,v,C,R){if(C==="q"||C==="Q")return R=R.replaceAll("_"," "),R=R.replaceAll(/=([0-9a-fA-F]{2})/g,function(I,O){return String.fromCharCode(parseInt(O,16))}),r(v,R);try{R=atob(R)}catch{}return r(v,R)})}return""}function t8(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const i in e){const r=e[i];r!==void 0&&t.append(i,r)}return t}function lA(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function n8({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:i}){const r={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(n.get("Content-Length"),10);return!Number.isInteger(o)||(r.suggestedLength=o,o<=2*t)||i||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function i8(n){const e=n.get("Content-Disposition");if(e){let t=Q6(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(aA(t))return t}return null}function Om(n,e){return new V1(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function r8(n){return n===200||n===206}function s8(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function o8(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(Fe(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class J6{constructor(e){ue(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=t8(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return it(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new eD(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new tD(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class eD{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const i=new Headers(e.headers),r=t.url;fetch(r,s8(i,this._withCredentials,this._abortController)).then(o=>{if(e._responseOrigin=lA(o.url),!r8(o.status))throw Om(o.status,r);this._reader=o.body.getReader(),this._headersCapability.resolve();const l=o.headers,{allowRangeRequests:h,suggestedLength:g}=n8({responseHeaders:l,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=h,this._contentLength=g||this._contentLength,this._filename=i8(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new va("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:o8(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class tD{constructor(e,t,i){this._stream=e,this._reader=null,this._loaded=0;const r=e.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const o=new Headers(e.headers);o.append("Range",`bytes=${t}-${i-1}`);const l=r.url;fetch(l,s8(o,this._withCredentials,this._abortController)).then(h=>{const g=lA(h.url);if(g!==e._responseOrigin)throw new Error(`Expected range response-origin "${g}" to match "${e._responseOrigin}".`);if(!r8(h.status))throw Om(h.status,l);this._readCapability.resolve(),this._reader=h.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:o8(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const mv=200,xv=206;function nD(n){const e=n.response;return typeof e!="string"?e:km(e).buffer}class iD{constructor({url:e,httpHeaders:t,withCredentials:i}){ue(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=t8(this.isHttp,t),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,i=this.currXhrId++,r=this.pendingRequests[i]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[o,l]of this.headers)t.setRequestHeader(o,l);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),r.expectedStatus=xv):r.expectedStatus=mv,t.responseType="arraybuffer",it(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,i),t.onprogress=this.onProgress.bind(this,i),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),i}onProgress(e,t){var r;const i=this.pendingRequests[e];i&&((r=i.onProgress)==null||r.call(i,t))}onStateChange(e,t){const i=this.pendingRequests[e];if(!i)return;const r=i.xhr;if(r.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),r.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],r.status===0&&this.isHttp){i.onError(r.status);return}const o=r.status||mv;if(!(o===mv&&i.expectedStatus===xv)&&o!==i.expectedStatus){i.onError(r.status);return}const h=nD(r);if(o===xv){const g=r.getResponseHeader("Content-Range"),p=/bytes (\d+)-(\d+)\/(\d+)/.exec(g);p?i.onDone({begin:parseInt(p[1],10),chunk:h}):(Fe('Missing or invalid "Content-Range" header.'),i.onError(0))}else h?i.onDone({begin:0,chunk:h}):i.onError(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class rD{constructor(e){this._source=e,this._manager=new iD(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return it(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new sD(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const i=new oD(this._manager,e,t);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class sD{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=lA(t.responseURL);const i=t.getAllResponseHeaders(),r=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(h=>{const[g,...p]=h.split(": ");return[g,p.join(": ")]}):[]),{allowRangeRequests:o,suggestedLength:l}=n8({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=i8(r),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Om(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class oD{constructor(e,t,i){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=lA((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Om(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const aD=/^[a-z][a-z0-9\-+.]+:/i;function lD(n){if(aD.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class cD{constructor(e){this.source=e,this.url=lD(e.url),it(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return it(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new uD(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new hD(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class uD{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=Om(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new va("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class hD{constructor(e,t,i){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=e.source;this._isStreamingSupported=!r.disableStream;const o=process.getBuiltinModule("fs");this._setReadableStream(o.createReadStream(this._url,{start:t,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const j0=Symbol("INITIAL_DATA");var hr,tp,$b;class a8{constructor(){E(this,tp);E(this,hr,Object.create(null))}get(e,t=null){if(t){const r=P(this,tp,$b).call(this,e);return r.promise.then(()=>t(r.data)),null}const i=u(this,hr)[e];if(!i||i.data===j0)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){const t=u(this,hr)[e];return!!t&&t.data!==j0}delete(e){const t=u(this,hr)[e];return!t||t.data===j0?!1:(delete u(this,hr)[e],!0)}resolve(e,t=null){const i=P(this,tp,$b).call(this,e);i.data=t,i.resolve()}clear(){var e;for(const t in u(this,hr)){const{data:i}=u(this,hr)[t];(e=i==null?void 0:i.bitmap)==null||e.close()}S(this,hr,Object.create(null))}*[Symbol.iterator](){for(const e in u(this,hr)){const{data:t}=u(this,hr)[e];t!==j0&&(yield[e,t])}}}hr=new WeakMap,tp=new WeakSet,$b=function(e){var t;return(t=u(this,hr))[e]||(t[e]={...Promise.withResolvers(),data:j0})};const dD=1e5,c_=30;var z_,ll,Yi,np,ip,ou,Yo,rp,sp,au,Qd,Jd,cl,ef,op,tf,lu,ap,lp,Gt,nf,cu,cp,ul,rf,Bw,l8,Fw,c8,up,Kb,sf,Gx,hp,qb,Uw,u8,jw,h8;let Y1=(Gt=class{constructor({textContentSource:e,container:t,viewport:i}){E(this,Bw);E(this,Fw);E(this,up);E(this,ll,Promise.withResolvers());E(this,Yi,null);E(this,np,!1);E(this,ip,!!((z_=globalThis.FontInspector)!=null&&z_.enabled));E(this,ou,null);E(this,Yo,null);E(this,rp,0);E(this,sp,0);E(this,au,null);E(this,Qd,null);E(this,Jd,0);E(this,cl,0);E(this,ef,Object.create(null));E(this,op,[]);E(this,tf,null);E(this,lu,[]);E(this,ap,new WeakMap);E(this,lp,null);var g;if(e instanceof ReadableStream)S(this,tf,e);else if(typeof e=="object")S(this,tf,new ReadableStream({start(p){p.enqueue(e),p.close()}}));else throw new Error('No "textContentSource" parameter specified.');S(this,Yi,S(this,Qd,t)),S(this,cl,i.scale*Ms.pixelRatio),S(this,Jd,i.rotation),S(this,Yo,{div:null,properties:null,ctx:null});const{pageWidth:r,pageHeight:o,pageX:l,pageY:h}=i.rawDims;S(this,lp,[1,0,0,-1,-l,h+o]),S(this,sp,r),S(this,rp,o),P(g=Gt,Uw,u8).call(g),ql(t,i),u(this,ll).promise.finally(()=>{u(Gt,rf).delete(this),S(this,Yo,null),S(this,ef,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Gn.platform;return Ve(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{u(this,au).read().then(({value:t,done:i})=>{if(i){u(this,ll).resolve();return}u(this,ou)??S(this,ou,t.lang),Object.assign(u(this,ef),t.styles),P(this,Bw,l8).call(this,t.items),e()},u(this,ll).reject)};return S(this,au,u(this,tf).getReader()),u(Gt,rf).add(this),e(),u(this,ll).promise}update({viewport:e,onBefore:t=null}){var o;const i=e.scale*Ms.pixelRatio,r=e.rotation;if(r!==u(this,Jd)&&(t==null||t(),S(this,Jd,r),ql(u(this,Qd),{rotation:r})),i!==u(this,cl)){t==null||t(),S(this,cl,i);const l={div:null,properties:null,ctx:P(o=Gt,sf,Gx).call(o,u(this,ou))};for(const h of u(this,lu))l.properties=u(this,ap).get(h),l.div=h,P(this,up,Kb).call(this,l)}}cancel(){var t;const e=new va("TextLayer task cancelled.");(t=u(this,au))==null||t.cancel(e).catch(()=>{}),S(this,au,null),u(this,ll).reject(e)}get textDivs(){return u(this,lu)}get textContentItemsStr(){return u(this,op)}static cleanup(){if(!(u(this,rf).size>0)){u(this,nf).clear();for(const{canvas:e}of u(this,cu).values())e.remove();u(this,cu).clear()}}},ll=new WeakMap,Yi=new WeakMap,np=new WeakMap,ip=new WeakMap,ou=new WeakMap,Yo=new WeakMap,rp=new WeakMap,sp=new WeakMap,au=new WeakMap,Qd=new WeakMap,Jd=new WeakMap,cl=new WeakMap,ef=new WeakMap,op=new WeakMap,tf=new WeakMap,lu=new WeakMap,ap=new WeakMap,lp=new WeakMap,nf=new WeakMap,cu=new WeakMap,cp=new WeakMap,ul=new WeakMap,rf=new WeakMap,Bw=new WeakSet,l8=function(e){var r,o;if(u(this,np))return;(o=u(this,Yo)).ctx??(o.ctx=P(r=Gt,sf,Gx).call(r,u(this,ou)));const t=u(this,lu),i=u(this,op);for(const l of e){if(t.length>dD){Fe("Ignoring additional textDivs for performance reasons."),S(this,np,!0);return}if(l.str===void 0){if(l.type==="beginMarkedContentProps"||l.type==="beginMarkedContent"){const h=u(this,Yi);S(this,Yi,document.createElement("span")),u(this,Yi).classList.add("markedContent"),l.id&&u(this,Yi).setAttribute("id",`${l.id}`),h.append(u(this,Yi))}else l.type==="endMarkedContent"&&S(this,Yi,u(this,Yi).parentNode);continue}i.push(l.str),P(this,Fw,c8).call(this,l)}},Fw=new WeakSet,c8=function(e){var I;const t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};u(this,lu).push(t);const r=Ae.transform(u(this,lp),e.transform);let o=Math.atan2(r[1],r[0]);const l=u(this,ef)[e.fontName];l.vertical&&(o+=Math.PI/2);let h=u(this,ip)&&l.fontSubstitution||l.fontFamily;h=Gt.fontFamilyMap.get(h)||h;const g=Math.hypot(r[2],r[3]),p=g*P(I=Gt,jw,h8).call(I,h,l,u(this,ou));let x,y;o===0?(x=r[4],y=r[5]-p):(x=r[4]+p*Math.sin(o),y=r[5]-p*Math.cos(o));const v="calc(var(--total-scale-factor) *",C=t.style;u(this,Yi)===u(this,Qd)?(C.left=`${(100*x/u(this,sp)).toFixed(2)}%`,C.top=`${(100*y/u(this,rp)).toFixed(2)}%`):(C.left=`${v}${x.toFixed(2)}px)`,C.top=`${v}${y.toFixed(2)}px)`),C.fontSize=`${v}${(u(Gt,ul)*g).toFixed(2)}px)`,C.fontFamily=h,i.fontSize=g,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,u(this,ip)&&(t.dataset.fontName=l.fontSubstitutionLoadedName||e.fontName),o!==0&&(i.angle=o*(180/Math.PI));let R=!1;if(e.str.length>1)R=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const O=Math.abs(e.transform[0]),_=Math.abs(e.transform[3]);O!==_&&Math.max(O,_)/Math.min(O,_)>1.5&&(R=!0)}if(R&&(i.canvasWidth=l.vertical?e.height:e.width),u(this,ap).set(t,i),u(this,Yo).div=t,u(this,Yo).properties=i,P(this,up,Kb).call(this,u(this,Yo)),i.hasText&&u(this,Yi).append(t),i.hasEOL){const O=document.createElement("br");O.setAttribute("role","presentation"),u(this,Yi).append(O)}},up=new WeakSet,Kb=function(e){var h;const{div:t,properties:i,ctx:r}=e,{style:o}=t;let l="";if(u(Gt,ul)>1&&(l=`scale(${1/u(Gt,ul)})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:g}=o,{canvasWidth:p,fontSize:x}=i;P(h=Gt,hp,qb).call(h,r,x*u(this,cl),g);const{width:y}=r.measureText(t.textContent);y>0&&(l=`scaleX(${p*u(this,cl)/y}) ${l}`)}i.angle!==0&&(l=`rotate(${i.angle}deg) ${l}`),l.length>0&&(o.transform=l)},sf=new WeakSet,Gx=function(e=null){let t=u(this,cu).get(e||(e=""));if(!t){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),u(this,cu).set(e,t),u(this,cp).set(t,{size:0,family:""})}return t},hp=new WeakSet,qb=function(e,t,i){const r=u(this,cp).get(e);t===r.size&&i===r.family||(e.font=`${t}px ${i}`,r.size=t,r.family=i)},Uw=new WeakSet,u8=function(){if(u(this,ul)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),S(this,ul,e.getBoundingClientRect().height),e.remove()},jw=new WeakSet,h8=function(e,t,i){const r=u(this,nf).get(e);if(r)return r;const o=P(this,sf,Gx).call(this,i);o.canvas.width=o.canvas.height=c_,P(this,hp,qb).call(this,o,c_,e);const l=o.measureText(""),h=l.fontBoundingBoxAscent,g=Math.abs(l.fontBoundingBoxDescent);o.canvas.width=o.canvas.height=0;let p=.8;return h?p=h/(h+g):(Gn.platform.isFirefox&&Fe("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?p=t.ascent:t.descent&&(p=1+t.descent)),u(this,nf).set(e,p),p},E(Gt,sf),E(Gt,hp),E(Gt,Uw),E(Gt,jw),E(Gt,nf,new Map),E(Gt,cu,new Map),E(Gt,cp,new WeakMap),E(Gt,ul,null),E(Gt,rf,new Set),Gt);const fD=100;function ZC(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new Zb,{docId:t}=e,i=n.url?v6(n.url):null,r=n.data?b6(n.data):null,o=n.httpHeaders||null,l=n.withCredentials===!0,h=n.password??null,g=n.range instanceof QC?n.range:null,p=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let x=n.worker instanceof g0?n.worker:null;const y=n.verbosity,v=typeof n.docBaseUrl=="string"&&!Dm(n.docBaseUrl)?n.docBaseUrl:null,C=fx(n.cMapUrl),R=n.cMapPacked!==!1,I=n.CMapReaderFactory||(Ii?N6:K3),O=fx(n.iccUrl),_=fx(n.standardFontDataUrl),N=n.StandardFontDataFactory||(Ii?R6:q3),k=fx(n.wasmUrl),B=n.WasmFactory||(Ii?k6:Z3),z=n.stopAtErrors!==!0,H=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,F=n.isEvalSupported!==!1,Y=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Ii,W=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Ii&&(Gn.platform.isFirefox||!globalThis.chrome),Z=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,te=typeof n.disableFontFace=="boolean"?n.disableFontFace:Ii,ee=n.fontExtraProperties===!0,le=n.enableXfa===!0,ce=n.ownerDocument||globalThis.document,$=n.disableRange===!0,oe=n.disableStream===!0,ne=n.disableAutoFetch===!0,ie=n.pdfBug===!0,ge=n.CanvasFactory||(Ii?I6:S6),ye=n.FilterFactory||(Ii?T6:_6),Me=n.enableHWA===!0,we=n.useWasm!==!1,me=g?g.length:n.length??NaN,Le=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Ii&&!te,dt=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(I===K3&&N===q3&&B===Z3&&C&&_&&k&&$0(C,document.baseURI)&&$0(_,document.baseURI)&&$0(k,document.baseURI)),xe=null;n6(y);const He={canvasFactory:new ge({ownerDocument:ce,enableHWA:Me}),filterFactory:new ye({docId:t,ownerDocument:ce}),cMapReaderFactory:dt?null:new I({baseUrl:C,isCompressed:R}),standardFontDataFactory:dt?null:new N({baseUrl:_}),wasmFactory:dt?null:new B({baseUrl:k})};x||(x=g0.create({verbosity:y,port:es.workerPort}),e._worker=x);const st={docId:t,apiVersion:"5.4.296",data:r,password:h,disableAutoFetch:ne,rangeChunkSize:p,length:me,docBaseUrl:v,enableXfa:le,evaluatorOptions:{maxImageSize:H,disableFontFace:te,ignoreErrors:z,isEvalSupported:F,isOffscreenCanvasSupported:Y,isImageDecoderSupported:W,canvasMaxAreaInBytes:Z,fontExtraProperties:ee,useSystemFonts:Le,useWasm:we,useWorkerFetch:dt,cMapUrl:C,iccUrl:O,standardFontDataUrl:_,wasmUrl:k}},yn={ownerDocument:ce,pdfBug:ie,styleElement:xe,loadingParams:{disableAutoFetch:ne,enableXfa:le}};return x.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(x.destroyed)throw new Error("Worker was destroyed");const bt=x.messageHandler.sendWithPromise("GetDocRequest",st,r?[r.buffer]:null);let De;if(g)De=new K6(g,{disableRange:$,disableStream:oe});else if(!r){if(!i)throw new Error("getDocument - no `url` parameter provided.");const Cn=$0(i)?J6:Ii?cD:rD;De=new Cn({url:i,length:me,httpHeaders:o,withCredentials:l,rangeChunkSize:p,disableRange:$,disableStream:oe})}return bt.then(Cn=>{if(e.destroyed)throw new Error("Loading aborted");if(x.destroyed)throw new Error("Worker was destroyed");const Te=new e1(t,Cn,x.port),Qe=new mD(Te,e,De,yn,He,Me);e._transport=Qe,Te.send("Ready",null)})}).catch(e._capability.reject),e}var zw;const Hw=class Hw{constructor(){ue(this,"_capability",Promise.withResolvers());ue(this,"_transport",null);ue(this,"_worker",null);ue(this,"docId",`d${Tn(Hw,zw)._++}`);ue(this,"destroyed",!1);ue(this,"onPassword",null);ue(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,i,r;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(o){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,o}this._transport=null,(r=this._worker)==null||r.destroy(),this._worker=null}async getData(){return this._transport.getData()}};zw=new WeakMap,E(Hw,zw,0);let Zb=Hw;var uu,dp,fp,gp,pp,H_;let QC=(H_=class{constructor(e,t,i=!1,r=null){E(this,uu,Promise.withResolvers());E(this,dp,[]);E(this,fp,[]);E(this,gp,[]);E(this,pp,[]);this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=r}addRangeListener(e){u(this,pp).push(e)}addProgressListener(e){u(this,gp).push(e)}addProgressiveReadListener(e){u(this,fp).push(e)}addProgressiveDoneListener(e){u(this,dp).push(e)}onDataRange(e,t){for(const i of u(this,pp))i(e,t)}onDataProgress(e,t){u(this,uu).promise.then(()=>{for(const i of u(this,gp))i(e,t)})}onDataProgressiveRead(e){u(this,uu).promise.then(()=>{for(const t of u(this,fp))t(e)})}onDataProgressiveDone(){u(this,uu).promise.then(()=>{for(const e of u(this,dp))e()})}transportReady(){u(this,uu).resolve()}requestDataRange(e,t){It("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},uu=new WeakMap,dp=new WeakMap,fp=new WeakMap,gp=new WeakMap,pp=new WeakMap,H_);class gD{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ve(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var $o,hu,a1;class pD{constructor(e,t,i,r=!1){E(this,hu);E(this,$o,!1);this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=r?new H3:null,this._pdfBug=r,this.commonObjs=i.commonObjs,this.objs=new a8,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:r=0,dontFlip:o=!1}={}){return new Pm({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:r,dontFlip:o})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ve(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:i,intent:r="display",annotationMode:o=yo.ENABLE,transform:l=null,background:h=null,optionalContentConfigPromise:g=null,annotationCanvasMap:p=null,pageColors:x=null,printAnnotationStorage:y=null,isEditing:v=!1,recordOperations:C=!1,operationsFilter:R=null}){var W,Z,te;(W=this._stats)==null||W.time("Overall");const I=this._transport.getRenderingIntent(r,o,y,v),{renderingIntent:O,cacheKey:_}=I;S(this,$o,!1),g||(g=this._transport.getOptionalContentConfig(O));let N=this._intentStates.get(_);N||(N=Object.create(null),this._intentStates.set(_,N)),N.streamReaderCancelTimeout&&(clearTimeout(N.streamReaderCancelTimeout),N.streamReaderCancelTimeout=null);const k=!!(O&Cr.PRINT);N.displayReadyCapability||(N.displayReadyCapability=Promise.withResolvers(),N.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Z=this._stats)==null||Z.time("Page Request"),this._pumpOperatorList(I));const B=!!(this._pdfBug&&((te=globalThis.StepperManager)!=null&&te.enabled)),z=!this.recordedBBoxes&&(C||B),H=ee=>{var le,ce;if(N.renderTasks.delete(F),z){const $=(le=F.gfx)==null?void 0:le.dependencyTracker.take();$&&(F.stepper&&F.stepper.setOperatorBBoxes($,F.gfx.dependencyTracker.takeDebugMetadata()),C&&(this.recordedBBoxes=$))}k&&S(this,$o,!0),P(this,hu,a1).call(this),ee?(F.capability.reject(ee),this._abortOperatorList({intentState:N,reason:ee instanceof Error?ee:new Error(ee)})):F.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(ce=globalThis.Stats)!=null&&ce.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},F=new Qb({callback:H,params:{canvas:t,canvasContext:e,dependencyTracker:z?new D6(t,N.operatorList.length,B):null,viewport:i,transform:l,background:h},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:p,operatorList:N.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!k,pdfBug:this._pdfBug,pageColors:x,enableHWA:this._transport.enableHWA,operationsFilter:R});(N.renderTasks||(N.renderTasks=new Set)).add(F);const Y=F.task;return Promise.all([N.displayReadyCapability.promise,g]).then(([ee,le])=>{var ce;if(this.destroyed){H();return}if((ce=this._stats)==null||ce.time("Rendering"),!(le.renderingIntent&O))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");F.initializeGraphics({transparency:ee,optionalContentConfig:le}),F.operatorListChanged()}).catch(H),Y}getOperatorList({intent:e="display",annotationMode:t=yo.ENABLE,printAnnotationStorage:i=null,isEditing:r=!1}={}){var p;function o(){h.operatorList.lastChunk&&(h.opListReadCapability.resolve(h.operatorList),h.renderTasks.delete(g))}const l=this._transport.getRenderingIntent(e,t,i,r,!0);let h=this._intentStates.get(l.cacheKey);h||(h=Object.create(null),this._intentStates.set(l.cacheKey,h));let g;return h.opListReadCapability||(g=Object.create(null),g.operatorListChanged=o,h.opListReadCapability=Promise.withResolvers(),(h.renderTasks||(h.renderTasks=new Set)).add(g),h.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(p=this._stats)==null||p.time("Page Request"),this._pumpOperatorList(l)),h.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>W1.textContent(i));const t=this.streamTextContent(e);return new Promise(function(i,r){function o(){l.read().then(function({value:g,done:p}){if(p){i(h);return}h.lang??(h.lang=g.lang),Object.assign(h.styles,g.styles),h.items.push(...g.items),o()},r)}const l=t.getReader(),h={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),S(this,$o,!1),Promise.all(e)}cleanup(e=!1){S(this,$o,!0);const t=P(this,hu,a1).call(this);return e&&t&&this._stats&&(this._stats=new H3),t}_startRenderPage(e,t){var r,o;const i=this._intentStates.get(t);i&&((r=this._stats)==null||r.timeEnd("Page Request"),(o=i.displayReadyCapability)==null||o.resolve(e))}_renderPageChunk(e,t){for(let i=0,r=e.length;i<r;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const i of t.renderTasks)i.operatorListChanged();e.lastChunk&&P(this,hu,a1).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:r}){const{map:o,transfer:l}=i,g=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:o,modifiedIds:r},l).getReader(),p=this._intentStates.get(t);p.streamReader=g;const x=()=>{g.read().then(({value:y,done:v})=>{if(v){p.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,p),x())},y=>{if(p.streamReader=null,!this._transport.destroyed){if(p.operatorList){p.operatorList.lastChunk=!0;for(const v of p.renderTasks)v.operatorListChanged();P(this,hu,a1).call(this)}if(p.displayReadyCapability)p.displayReadyCapability.reject(y);else if(p.opListReadCapability)p.opListReadCapability.reject(y);else throw y}})};x()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof oA){let r=fD;t.extraDelay>0&&t.extraDelay<1e3&&(r+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},r);return}}if(e.streamReader.cancel(new va(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[r,o]of this._intentStates)if(o===e){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}$o=new WeakMap,hu=new WeakSet,a1=function(){if(!u(this,$o)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),S(this,$o,!1),!0};var hl,As,Ko,du,Vw,fu,gu,of,Xx,Ww,d8,Gw,f8,pu,l1,af,Yx;const zt=class zt{constructor({name:e=null,port:t=null,verbosity:i=i6()}={}){E(this,of);E(this,Ww);E(this,Gw);E(this,pu);E(this,hl,Promise.withResolvers());E(this,As,null);E(this,Ko,null);E(this,du,null);if(this.name=e,this.destroyed=!1,this.verbosity=i,t){if(u(zt,gu).has(t))throw new Error("Cannot use more than one PDFWorker per port.");u(zt,gu).set(t,this),P(this,Ww,d8).call(this,t)}else P(this,Gw,f8).call(this)}get promise(){return u(this,hl).promise}get port(){return u(this,Ko)}get messageHandler(){return u(this,As)}destroy(){var e,t;this.destroyed=!0,(e=u(this,du))==null||e.terminate(),S(this,du,null),u(zt,gu).delete(u(this,Ko)),S(this,Ko,null),(t=u(this,As))==null||t.destroy(),S(this,As,null)}static create(e){const t=u(this,gu).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new zt(e)}static get workerSrc(){if(es.workerSrc)return es.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ve(this,"_setupFakeWorkerGlobal",(async()=>u(this,af,Yx)?u(this,af,Yx):(await t6(()=>import(this.workerSrc),[])).WorkerMessageHandler)())}};hl=new WeakMap,As=new WeakMap,Ko=new WeakMap,du=new WeakMap,Vw=new WeakMap,fu=new WeakMap,gu=new WeakMap,of=new WeakSet,Xx=function(){u(this,hl).resolve(),u(this,As).send("configure",{verbosity:this.verbosity})},Ww=new WeakSet,d8=function(e){S(this,Ko,e),S(this,As,new e1("main","worker",e)),u(this,As).on("ready",()=>{}),P(this,of,Xx).call(this)},Gw=new WeakSet,f8=function(){if(u(zt,fu)||u(zt,af,Yx)){P(this,pu,l1).call(this);return}let{workerSrc:e}=zt;try{zt._isSameOrigin(window.location,e)||(e=zt._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),i=new e1("main","worker",t),r=()=>{o.abort(),i.destroy(),t.terminate(),this.destroyed?u(this,hl).reject(new Error("Worker was destroyed")):P(this,pu,l1).call(this)},o=new AbortController;t.addEventListener("error",()=>{u(this,du)||r()},{signal:o.signal}),i.on("test",h=>{if(o.abort(),this.destroyed||!h){r();return}S(this,As,i),S(this,Ko,t),S(this,du,t),P(this,of,Xx).call(this)}),i.on("ready",h=>{if(o.abort(),this.destroyed){r();return}try{l()}catch{P(this,pu,l1).call(this)}});const l=()=>{const h=new Uint8Array;i.send("test",h,[h.buffer])};l();return}catch{sA("The worker has been disabled.")}P(this,pu,l1).call(this)},pu=new WeakSet,l1=function(){u(zt,fu)||(Fe("Setting up fake worker."),S(zt,fu,!0)),zt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){u(this,hl).reject(new Error("Worker was destroyed"));return}const t=new C6;S(this,Ko,t);const i=`fake${Tn(zt,Vw)._++}`,r=new e1(i+"_worker",i,t);e.setup(r,t),S(this,As,new e1(i,i+"_worker",t)),P(this,of,Xx).call(this)}).catch(e=>{u(this,hl).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},af=new WeakSet,Yx=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},E(zt,af),E(zt,Vw,0),E(zt,fu,!1),E(zt,gu,new WeakMap),Ii&&(S(zt,fu,!0),es.workerSrc||(es.workerSrc="./pdf.worker.mjs")),zt._isSameOrigin=(e,t)=>{const i=URL.parse(e);if(!(i!=null&&i.origin)||i.origin==="null")return!1;const r=new URL(t,i);return i.origin===r.origin},zt._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},zt.fromPort=e=>{if(d6("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return zt.create(e)};let g0=zt;var qo,oo,lf,cf,Zo,mu,c1;class mD{constructor(e,t,i,r,o,l){E(this,mu);E(this,qo,new Map);E(this,oo,new Map);E(this,lf,new Map);E(this,cf,new Map);E(this,Zo,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new a8,this.fontLoader=new y6({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.wasmFactory=o.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=l,this.setupMessageHandler()}get annotationStorage(){return Ve(this,"annotationStorage",new $C)}getRenderingIntent(e,t=yo.ENABLE,i=null,r=!1,o=!1){let l=Cr.DISPLAY,h=Ob;switch(e){case"any":l=Cr.ANY;break;case"display":break;case"print":l=Cr.PRINT;break;default:Fe(`getRenderingIntent - invalid intent: ${e}`)}const g=l&Cr.PRINT&&i instanceof W4?i:this.annotationStorage;switch(t){case yo.DISABLE:l+=Cr.ANNOTATIONS_DISABLE;break;case yo.ENABLE:break;case yo.ENABLE_FORMS:l+=Cr.ANNOTATIONS_FORMS;break;case yo.ENABLE_STORAGE:l+=Cr.ANNOTATIONS_STORAGE,h=g.serializable;break;default:Fe(`getRenderingIntent - invalid annotationMode: ${t}`)}r&&(l+=Cr.IS_EDITING),o&&(l+=Cr.OPLIST);const{ids:p,hash:x}=g.modifiedIds,y=[l,h.hash,x];return{renderingIntent:l,cacheKey:y.join("_"),annotationStorageSerializable:h,modifiedIds:p}}destroy(){var i;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(i=u(this,Zo))==null||i.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const r of u(this,oo).values())e.push(r._destroy());u(this,oo).clear(),u(this,lf).clear(),u(this,cf).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var r,o;this.commonObjs.clear(),this.fontLoader.clear(),u(this,qo).clear(),this.filterFactory.destroy(),Y1.cleanup(),(r=this._networkStream)==null||r.cancelAllRequests(new va("Worker was terminated.")),(o=this.messageHandler)==null||o.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,r)=>{it(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},r.onPull=()=>{this._fullReader.read().then(function({value:o,done:l}){if(l){r.close();return}it(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{r.error(o)})},r.onCancel=o=>{this._fullReader.cancel(o),r.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("ReaderHeadersReady",async i=>{var h;await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:o,contentLength:l}=this._fullReader;return(!r||!o)&&(this._lastProgress&&((h=t.onProgress)==null||h.call(t,this._lastProgress)),this._fullReader.onProgress=g=>{var p;(p=t.onProgress)==null||p.call(t,{loaded:g.loaded,total:g.total})}),{isStreamingSupported:r,isRangeSupported:o,contentLength:l}}),e.on("GetRangeReader",(i,r)=>{it(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(i.begin,i.end);if(!o){r.close();return}r.onPull=()=>{o.read().then(function({value:l,done:h}){if(h){r.close();return}it(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{r.error(l)})},r.onCancel=l=>{o.cancel(l),r.ready.catch(h=>{if(!this.destroyed)throw h})}}),e.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new gD(i,this))}),e.on("DocException",i=>{t._capability.reject(zi(i))}),e.on("PasswordRequest",i=>{S(this,Zo,Promise.withResolvers());try{if(!t.onPassword)throw zi(i);const r=o=>{o instanceof Error?u(this,Zo).reject(o):u(this,Zo).resolve({password:o})};t.onPassword(r,i.code)}catch(r){u(this,Zo).reject(r)}return u(this,Zo).promise}),e.on("DataLoaded",i=>{var r;(r=t.onProgress)==null||r.call(t,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;u(this,oo).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,r,o])=>{var l;if(this.destroyed||this.commonObjs.has(i))return null;switch(r){case"Font":if("error"in o){const y=o.error;Fe(`Error during font loading: ${y}`),this.commonObjs.resolve(i,y);break}const h=new Xb(o),g=this._params.pdfBug&&((l=globalThis.FontInspector)!=null&&l.enabled)?(y,v)=>globalThis.FontInspector.fontAdded(y,v):null,p=new A6(h,g,o.extra,o.charProcOperatorList);this.fontLoader.bind(p).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!p.fontExtraProperties&&p.data&&p.clearData(),this.commonObjs.resolve(i,p)});break;case"CopyLocalImage":const{imageRef:x}=o;it(x,"The imageRef must be defined.");for(const y of u(this,oo).values())for(const[,v]of y.objs)if((v==null?void 0:v.ref)===x)return v.dataLen?(this.commonObjs.resolve(i,structuredClone(v)),v.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,o);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),e.on("obj",([i,r,o,l])=>{var g;if(this.destroyed)return;const h=u(this,oo).get(r);if(!h.objs.has(i)){if(h._intentStates.size===0){(g=l==null?void 0:l.bitmap)==null||g.close();return}switch(o){case"Image":case"Pattern":h.objs.resolve(i,l);break;default:throw new Error(`Got unknown object type ${o}`)}}}),e.on("DocProgress",i=>{var r;this.destroyed||(r=t.onProgress)==null||r.call(t,{loaded:i.loaded,total:i.total})}),e.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[i.type];if(!r)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;this.annotationStorage.size<=0&&Fe("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((i=this._fullReader)==null?void 0:i.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,i=u(this,lf).get(t);if(i)return i;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&u(this,cf).set(o.refStr,e);const l=new pD(t,o,this,this._params.pdfBug);return u(this,oo).set(t,l),l});return u(this,lf).set(t,r),r}getPageIndex(e){return Lb(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return P(this,mu,c1).call(this,"GetFieldObjects")}hasJSActions(){return P(this,mu,c1).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return P(this,mu,c1).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return P(this,mu,c1).call(this,"GetOptionalContentConfig").then(t=>new $6(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=u(this,qo).get(e);if(t)return t;const i=this.messageHandler.sendWithPromise(e,null).then(r=>{var o,l;return{info:r[0],metadata:r[1]?new X6(r[1]):null,contentDispositionFilename:((o=this._fullReader)==null?void 0:o.filename)??null,contentLength:((l=this._fullReader)==null?void 0:l.contentLength)??null}});return u(this,qo).set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of u(this,oo).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),u(this,qo).clear(),this.filterFactory.destroy(!0),Y1.cleanup()}}cachedPageNumber(e){if(!Lb(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return u(this,cf).get(t)??null}}qo=new WeakMap,oo=new WeakMap,lf=new WeakMap,cf=new WeakMap,Zo=new WeakMap,mu=new WeakSet,c1=function(e,t=null){const i=u(this,qo).get(e);if(i)return i;const r=this.messageHandler.sendWithPromise(e,t);return u(this,qo).set(e,r),r};var dl;class xD{constructor(e){E(this,dl,null);ue(this,"onContinue",null);ue(this,"onError",null);S(this,dl,e)}get promise(){return u(this,dl).capability.promise}cancel(e=0){u(this,dl).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=u(this,dl).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=u(this,dl);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}dl=new WeakMap;var fl,xu;const xc=class xc{constructor({callback:e,params:t,objs:i,commonObjs:r,annotationCanvasMap:o,operatorList:l,pageIndex:h,canvasFactory:g,filterFactory:p,useRequestAnimationFrame:x=!1,pdfBug:y=!1,pageColors:v=null,enableHWA:C=!1,operationsFilter:R=null}){E(this,fl,null);this.callback=e,this.params=t,this.objs=i,this.commonObjs=r,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=h,this.canvasFactory=g,this.filterFactory=p,this._pdfBug=y,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=x===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new xD(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=C,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=R}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var g,p;if(this.cancelled)return;if(this._canvas){if(u(xc,xu).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");u(xc,xu).add(this._canvas)}this._pdfBug&&((g=globalThis.StepperManager)!=null&&g.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:r,background:o,dependencyTracker:l}=this.params,h=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new id(h,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:r,viewport:i,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(p=this.graphicsReadyCallback)==null||p.call(this)}cancel(e=null,t=0){var i,r,o;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),u(this,fl)&&(window.cancelAnimationFrame(u(this,fl)),S(this,fl,null)),u(xc,xu).delete(this._canvas),e||(e=new oA(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(o=(r=this.task).onError)==null||o.call(r,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?S(this,fl,window.requestAnimationFrame(()=>{S(this,fl,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),u(xc,xu).delete(this._canvas),this.callback())))}};fl=new WeakMap,xu=new WeakMap,E(xc,xu,new WeakSet);let Qb=xc;const JC="5.4.296",g8="f56dc8601";var dr,wu,uf,Rn,mp,hf,Qo,xp,gl,vs,wp,yp,Jb,Ap,eE,vp,tE,Jo,fc,Xw,p8,ao,Pa;const Hi=class Hi{constructor({editor:e=null,uiManager:t=null}){E(this,yp);E(this,Ap);E(this,vp);E(this,Jo);E(this,Xw);E(this,ao);E(this,dr,null);E(this,wu,null);E(this,uf,void 0);E(this,Rn,null);E(this,mp,!1);E(this,hf,!1);E(this,Qo,null);E(this,xp,void 0);E(this,gl,null);E(this,vs,null);var i,r;e?(S(this,hf,!1),S(this,Qo,e)):S(this,hf,!0),S(this,vs,(e==null?void 0:e._uiManager)||t),S(this,xp,u(this,vs)._eventBus),S(this,uf,((i=e==null?void 0:e.color)==null?void 0:i.toUpperCase())||((r=u(this,vs))==null?void 0:r.highlightColors.values().next().value)||"#FFFF98"),u(Hi,wp)||S(Hi,wp,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Ve(this,"_keyboardManager",new Mm([[["Escape","mac+Escape"],Hi.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Hi.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Hi.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Hi.prototype._moveToPrevious],[["Home","mac+Home"],Hi.prototype._moveToBeginning],[["End","mac+End"],Hi.prototype._moveToEnd]]))}renderButton(){const e=S(this,dr,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",u(this,Qo)&&(e.ariaControls=`${u(this,Qo).id}_colorpicker_dropdown`);const t=u(this,vs)._signal;e.addEventListener("click",P(this,Jo,fc).bind(this),{signal:t}),e.addEventListener("keydown",P(this,vp,tE).bind(this),{signal:t});const i=S(this,wu,document.createElement("span"));return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=u(this,uf),e.append(i),e}renderMainDropdown(){const e=S(this,Rn,P(this,yp,Jb).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===u(this,dr)){P(this,Jo,fc).call(this,e);return}const t=e.target.getAttribute("data-color");t&&P(this,Ap,eE).call(this,t,e)}_moveToNext(e){var t,i;if(!u(this,ao,Pa)){P(this,Jo,fc).call(this,e);return}if(e.target===u(this,dr)){(t=u(this,Rn).firstChild)==null||t.focus();return}(i=e.target.nextSibling)==null||i.focus()}_moveToPrevious(e){var t,i;if(e.target===((t=u(this,Rn))==null?void 0:t.firstChild)||e.target===u(this,dr)){u(this,ao,Pa)&&this._hideDropdownFromKeyboard();return}u(this,ao,Pa)||P(this,Jo,fc).call(this,e),(i=e.target.previousSibling)==null||i.focus()}_moveToBeginning(e){var t;if(!u(this,ao,Pa)){P(this,Jo,fc).call(this,e);return}(t=u(this,Rn).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!u(this,ao,Pa)){P(this,Jo,fc).call(this,e);return}(t=u(this,Rn).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=u(this,Rn))==null||e.classList.add("hidden"),u(this,dr).ariaExpanded="false",(t=u(this,gl))==null||t.abort(),S(this,gl,null)}_hideDropdownFromKeyboard(){var e;if(!u(this,hf)){if(!u(this,ao,Pa)){(e=u(this,Qo))==null||e.unselect();return}this.hideDropdown(),u(this,dr).focus({preventScroll:!0,focusVisible:u(this,mp)})}}updateColor(e){if(u(this,wu)&&(u(this,wu).style.backgroundColor=e),!u(this,Rn))return;const t=u(this,vs).highlightColors.values();for(const i of u(this,Rn).children)i.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=u(this,dr))==null||e.remove(),S(this,dr,null),S(this,wu,null),(t=u(this,Rn))==null||t.remove(),S(this,Rn,null)}};dr=new WeakMap,wu=new WeakMap,uf=new WeakMap,Rn=new WeakMap,mp=new WeakMap,hf=new WeakMap,Qo=new WeakMap,xp=new WeakMap,gl=new WeakMap,vs=new WeakMap,wp=new WeakMap,yp=new WeakSet,Jb=function(){const e=document.createElement("div"),t=u(this,vs)._signal;e.addEventListener("contextmenu",Rr,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),u(this,Qo)&&(e.id=`${u(this,Qo).id}_colorpicker_dropdown`);for(const[i,r]of u(this,vs).highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",r),o.title=i,o.setAttribute("data-l10n-id",u(Hi,wp)[i]);const l=document.createElement("span");o.append(l),l.className="swatch",l.style.backgroundColor=r,o.ariaSelected=r===u(this,uf),o.addEventListener("click",P(this,Ap,eE).bind(this,r),{signal:t}),e.append(o)}return e.addEventListener("keydown",P(this,vp,tE).bind(this),{signal:t}),e},Ap=new WeakSet,eE=function(e,t){t.stopPropagation(),u(this,xp).dispatch("switchannotationeditorparams",{source:this,type:Ze.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},vp=new WeakSet,tE=function(e){Hi._keyboardManager.exec(this,e)},Jo=new WeakSet,fc=function(e){if(u(this,ao,Pa)){this.hideDropdown();return}if(S(this,mp,e.detail===0),u(this,gl)||(S(this,gl,new AbortController),window.addEventListener("pointerdown",P(this,Xw,p8).bind(this),{signal:u(this,vs).combinedSignal(u(this,gl))})),u(this,dr).ariaExpanded="true",u(this,Rn)){u(this,Rn).classList.remove("hidden");return}const t=S(this,Rn,P(this,yp,Jb).call(this));u(this,dr).append(t)},Xw=new WeakSet,p8=function(e){var t;(t=u(this,Rn))!=null&&t.contains(e.target)||this.hideDropdown()},ao=new WeakSet,Pa=function(){return u(this,Rn)&&!u(this,Rn).classList.contains("hidden")},E(Hi,wp,null);let $1=Hi;var lo,bp,df,Ep;const wc=class wc{constructor(e){E(this,lo,null);E(this,bp,null);E(this,df,null);S(this,bp,e),S(this,df,e._uiManager),u(wc,Ep)||S(wc,Ep,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(u(this,lo))return u(this,lo);const{editorType:e,colorType:t,colorValue:i}=u(this,bp),r=S(this,lo,document.createElement("input"));return r.type="color",r.value=i||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",u(wc,Ep)[e]),r.addEventListener("input",()=>{u(this,df).updateParams(t,r.value)},{signal:u(this,df)._signal}),r}update(e){u(this,lo)&&(u(this,lo).value=e)}destroy(){var e;(e=u(this,lo))==null||e.remove(),S(this,lo,null)}hideDropdown(){}};lo=new WeakMap,bp=new WeakMap,df=new WeakMap,Ep=new WeakMap,E(wc,Ep,null);let V2=wc;function u_(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function z0(n){return Math.max(0,Math.min(255,255*n))}class h_{static CMYK_G([e,t,i,r]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+r)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=z0(e),[e,e,e]}static G_HTML([e]){const t=u_(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(z0)}static RGB_HTML(e){return`#${e.map(u_).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,r]){return["RGB",1-Math.min(1,e+r),1-Math.min(1,i+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,i,r]){return[z0(1-Math.min(1,e+r)),z0(1-Math.min(1,i+r)),z0(1-Math.min(1,t+r))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){const r=1-e,o=1-t,l=1-i,h=Math.min(r,o,l);return["CMYK",r,o,l,h]}}class wD{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),i||(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${e} ${t}`),r}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){It("Abstract method `_createSVG` called.")}}class K1 extends wD{_createSVG(e){return document.createElementNS(bo,e)}}const yD=9,rh=new WeakSet,AD=new Date().getTimezoneOffset()*60*1e3;class d_{static create(e){switch(e.data.annotationType){case pn.LINK:return new eS(e);case pn.TEXT:return new bD(e);case pn.WIDGET:switch(e.data.fieldType){case"Tx":return new ED(e);case"Btn":return e.data.radioButton?new w8(e):e.data.checkBox?new SD(e):new _D(e);case"Ch":return new TD(e);case"Sig":return new CD(e)}return new uh(e);case pn.POPUP:return new iE(e);case pn.FREETEXT:return new E8(e);case pn.LINE:return new ND(e);case pn.SQUARE:return new RD(e);case pn.CIRCLE:return new kD(e);case pn.POLYLINE:return new C8(e);case pn.CARET:return new DD(e);case pn.INK:return new tS(e);case pn.POLYGON:return new PD(e);case pn.HIGHLIGHT:return new S8(e);case pn.UNDERLINE:return new MD(e);case pn.SQUIGGLY:return new OD(e);case pn.STRIKEOUT:return new LD(e);case pn.STAMP:return new _8(e);case pn.FILEATTACHMENT:return new BD(e);default:return new Jt(e)}}}var yu,ff,$r,Cp,nE;const gS=class gS{constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:r=!1}={}){E(this,Cp);E(this,yu,null);E(this,ff,!1);E(this,$r,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(i)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return gS._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var i;const{data:e}=this,t=(i=this.annotationStorage)==null?void 0:i.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var h;const e=(h=this.annotationStorage)==null?void 0:h.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:i,rect:r}=this.data;let o=-1/0,l=-1/0;if((t==null?void 0:t.length)>=8){for(let g=0;g<t.length;g+=8)t[g+1]>l?(l=t[g+1],o=t[g+2]):t[g+1]===l&&(o=Math.max(o,t[g+2]));return[o,l]}if((i==null?void 0:i.length)>=1){for(const g of i)for(let p=0,x=g.length;p<x;p+=2)g[p+1]>l?(l=g[p+1],o=g[p]):g[p+1]===l&&(o=Math.max(o,g[p]));if(o!==1/0)return[o,l]}return r?[r[2],r[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:i,pageHeight:r,pageX:o,pageY:l}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-o)/i,e[1]=100*(e[1]-l)/r,e}get commentText(){var t,i,r;const{data:e}=this;return((i=(t=this.annotationStorage.getRawValue(`${H1}${e.id}`))==null?void 0:t.popup)==null?void 0:i.contents)||((r=e.contentsObj)==null?void 0:r.str)||""}set commentText(e){const{data:t}=this,i={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:i})||this.annotationStorage.setValue(`${H1}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:i,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=u(this,$r))==null?void 0:e.popup)||this.popup)==null||t.remove(),S(this,$r,this.popup=null)}updateEdited(e){var o;if(!this.container)return;e.rect&&(u(this,yu)||S(this,yu,{rect:this.data.rect.slice(0)}));const{rect:t,popup:i}=e;t&&P(this,Cp,nE).call(this,t);let r=((o=u(this,$r))==null?void 0:o.popup)||this.popup;!r&&(i!=null&&i.text)&&(this._createPopup(i),r=u(this,$r).popup),r&&(r.updateEdited(e),i!=null&&i.deleted&&(r.remove(),S(this,$r,null),this.popup=null))}resetEdited(){var e;u(this,yu)&&(P(this,Cp,nE).call(this,u(this,yu).rect),(e=u(this,$r))==null||e.popup.resetEdited(),S(this,yu,null))}_createContainer(e){const{data:t,parent:{page:i,viewport:r}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",t.id),!(this instanceof uh)&&!(this instanceof eS)&&(o.tabIndex=0);const{style:l}=o;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(o.title=t.alternativeText),t.noRotate&&o.classList.add("norotate"),!t.rect||this instanceof iE){const{rotation:I}=t;return!t.hasOwnCanvas&&I!==0&&this.setRotation(I,o),o}const{width:h,height:g}=this;if(!e&&t.borderStyle.width>0){l.borderWidth=`${t.borderStyle.width}px`;const I=t.borderStyle.horizontalCornerRadius,O=t.borderStyle.verticalCornerRadius;if(I>0||O>0){const N=`calc(${I}px * var(--total-scale-factor)) / calc(${O}px * var(--total-scale-factor))`;l.borderRadius=N}else if(this instanceof w8){const N=`calc(${h}px * var(--total-scale-factor)) / calc(${g}px * var(--total-scale-factor))`;l.borderRadius=N}switch(t.borderStyle.style){case Ch.SOLID:l.borderStyle="solid";break;case Ch.DASHED:l.borderStyle="dashed";break;case Ch.BEVELED:Fe("Unimplemented border style: beveled");break;case Ch.INSET:Fe("Unimplemented border style: inset");break;case Ch.UNDERLINE:l.borderBottomStyle="solid";break}const _=t.borderColor||null;_?(S(this,ff,!0),l.borderColor=Ae.makeHexColor(_[0]|0,_[1]|0,_[2]|0)):l.borderWidth=0}const p=Ae.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:x,pageHeight:y,pageX:v,pageY:C}=r.rawDims;l.left=`${100*(p[0]-v)/x}%`,l.top=`${100*(p[1]-C)/y}%`;const{rotation:R}=t;return t.hasOwnCanvas||R===0?(l.width=`${100*h/x}%`,l.height=`${100*g/y}%`):this.setRotation(R,o),o}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:r}=this.parent.viewport.rawDims;let{width:o,height:l}=this;e%180!==0&&([o,l]=[l,o]),t.style.width=`${100*o/i}%`,t.style.height=`${100*l/r}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,i,r)=>{const o=r.detail[t],l=o[0],h=o.slice(1);r.target.style[i]=h_[`${l}_HTML`](h),this.annotationStorage.setValue(this.data.id,{[i]:h_[`${l}_rgb`](h)})};return Ve(this,"_commonActions",{display:t=>{const{display:i}=t.detail,r=i%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){const i=this._commonActions;for(const r of Object.keys(t.detail)){const o=e[r]||i[r];o==null||o(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const i=this._commonActions;for(const[r,o]of Object.entries(t)){const l=i[r];if(l){const h={detail:{[r]:o},target:e};l(h),delete t[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,i,r,o]=this.data.rect.map(I=>Math.fround(I));if(e.length===8){const[I,O,_,N]=e.subarray(2,6);if(r===I&&o===O&&t===_&&i===N)return}const{style:l}=this.container;let h;if(u(this,ff)){const{borderColor:I,borderWidth:O}=l;l.borderWidth=0,h=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${I}" stroke-width="${O}">`],this.container.classList.add("hasBorder")}const g=r-t,p=o-i,{svgFactory:x}=this,y=x.createElement("svg");y.classList.add("quadrilateralsContainer"),y.setAttribute("width",0),y.setAttribute("height",0),y.role="none";const v=x.createElement("defs");y.append(v);const C=x.createElement("clipPath"),R=`clippath_${this.data.id}`;C.setAttribute("id",R),C.setAttribute("clipPathUnits","objectBoundingBox"),v.append(C);for(let I=2,O=e.length;I<O;I+=8){const _=e[I],N=e[I+1],k=e[I+2],B=e[I+3],z=x.createElement("rect"),H=(k-t)/g,F=(o-N)/p,Y=(_-k)/g,W=(N-B)/p;z.setAttribute("x",H),z.setAttribute("y",F),z.setAttribute("width",Y),z.setAttribute("height",W),C.append(z),h==null||h.push(`<rect vector-effect="non-scaling-stroke" x="${H}" y="${F}" width="${Y}" height="${W}"/>`)}u(this,ff)&&(h.push("</g></svg>')"),l.backgroundImage=h.join("")),this.container.append(y),this.container.style.clipPath=`url(#${R})`}_createPopup(e=null){const{data:t}=this;let i,r;e?(i={str:e.text},r=e.date):(i=t.contentsObj,r=t.modificationDate);const o=S(this,$r,new iE({data:{color:t.color,titleObj:t.titleObj,modificationDate:r,contentsObj:i,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}));this.parent._commentManager||this.parent.div.append(o.render())}get hasPopupElement(){return!!(u(this,$r)||this.popup||this.data.popupRef)}get extraPopupElement(){return u(this,$r)}render(){It("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const i=[];if(this._fieldObjects){const r=this._fieldObjects[e];if(r)for(const{page:o,id:l,exportValues:h}of r){if(o===-1||l===t)continue;const g=typeof h=="string"?h:null,p=document.querySelector(`[data-element-id="${l}"]`);if(p&&!rh.has(p)){Fe(`_getElementsByName - element not allowed: ${l}`);continue}i.push({id:l,exportValue:g,domElement:p})}return i}for(const r of document.getElementsByName(e)){const{exportValue:o}=r,l=r.getAttribute("data-element-id");l!==t&&rh.has(r)&&i.push({id:l,exportValue:o,domElement:r})}return i}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};yu=new WeakMap,ff=new WeakMap,$r=new WeakMap,Cp=new WeakSet,nE=function(e){const{container:{style:t},data:{rect:i,rotation:r},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:l,pageX:h,pageY:g}}}}=this;i==null||i.splice(0,4,...e),t.left=`${100*(e[0]-h)/o}%`,t.top=`${100*(l-e[3]+g)/l}%`,r===0?(t.width=`${100*(e[2]-e[0])/o}%`,t.height=`${100*(e[3]-e[1])/l}%`):this.setRotation(r)};let Jt=gS;class vD extends Jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&(this._createPopup(e.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}var ea,gc,Yw,m8,$w,x8;class eS extends Jt{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});E(this,ea);E(this,Yw);E(this,$w);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,r=document.createElement("a");r.setAttribute("data-element-id",t.id);let o=!1;return t.url?(i.addLinkAttributes(r,t.url,t.newWindow),o=!0):t.action?(this._bindNamedAction(r,t.action,t.overlaidText),o=!0):t.attachment?(P(this,Yw,m8).call(this,r,t.attachment,t.overlaidText,t.attachmentDest),o=!0):t.setOCGState?(P(this,$w,x8).call(this,r,t.setOCGState,t.overlaidText),o=!0):t.dest?(this._bindLink(r,t.dest,t.overlaidText),o=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(r,t),o=!0),t.resetForm?(this._bindResetFormAction(r,t.resetForm),o=!0):this.isTooltipOnly&&!o&&(this._bindLink(r,""),o=!0)),this.container.classList.add("linkAnnotation"),o&&this.container.append(r),this.container}_bindLink(t,i,r=""){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&P(this,ea,gc).call(this),r&&(t.title=r)}_bindNamedAction(t,i,r=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),r&&(t.title=r),P(this,ea,gc).call(this)}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const r=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const o of Object.keys(i.actions)){const l=r.get(o);l&&(t[l]=()=>{var h;return(h=this.linkService.eventBus)==null||h.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:o}}),!1})}i.overlaidText&&(t.title=i.overlaidText),t.onclick||(t.onclick=()=>!1),P(this,ea,gc).call(this)}_bindResetFormAction(t,i){const r=t.onclick;if(r||(t.href=this.linkService.getAnchorUrl("")),P(this,ea,gc).call(this),!this._fieldObjects){Fe('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),r||(t.onclick=()=>!1);return}t.onclick=()=>{var y;r==null||r();const{fields:o,refs:l,include:h}=i,g=[];if(o.length!==0||l.length!==0){const v=new Set(l);for(const C of o){const R=this._fieldObjects[C]||[];for(const{id:I}of R)v.add(I)}for(const C of Object.values(this._fieldObjects))for(const R of C)v.has(R.id)===h&&g.push(R)}else for(const v of Object.values(this._fieldObjects))g.push(...v);const p=this.annotationStorage,x=[];for(const v of g){const{id:C}=v;switch(x.push(C),v.type){case"text":{const I=v.defaultValue||"";p.setValue(C,{value:I});break}case"checkbox":case"radiobutton":{const I=v.defaultValue===v.exportValues;p.setValue(C,{value:I});break}case"combobox":case"listbox":{const I=v.defaultValue||"";p.setValue(C,{value:I});break}default:continue}const R=document.querySelector(`[data-element-id="${C}"]`);if(R){if(!rh.has(R)){Fe(`_bindResetFormAction - element not allowed: ${C}`);continue}}else continue;R.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((y=this.linkService.eventBus)==null||y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:x,name:"ResetForm"}})),!1}}}ea=new WeakSet,gc=function(){this.container.setAttribute("data-internal-link","")},Yw=new WeakSet,m8=function(t,i,r="",o=null){t.href=this.linkService.getAnchorUrl(""),i.description?t.title=i.description:r&&(t.title=r),t.onclick=()=>{var l;return(l=this.downloadManager)==null||l.openOrDownloadData(i.content,i.filename,o),!1},P(this,ea,gc).call(this)},$w=new WeakSet,x8=function(t,i,r=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),r&&(t.title=r),P(this,ea,gc).call(this)};class bD extends Jt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class uh extends Jt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Gn.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,r,o){i.includes("mouse")?e.addEventListener(i,l=>{var h;(h=this.linkService.eventBus)==null||h.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:o(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):e.addEventListener(i,l=>{var h;if(i==="blur"){if(!t.focused||!l.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}o&&((h=this.linkService.eventBus)==null||h.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:o(l)}}))})}_setEventListeners(e,t,i,r){var o,l,h;for(const[g,p]of i)(p==="Action"||(o=this.data.actions)!=null&&o[p])&&((p==="Focus"||p==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,g,p,r),p==="Focus"&&!((l=this.data.actions)!=null&&l.Blur)?this._setEventListener(e,t,"blur","Blur",null):p==="Blur"&&!((h=this.data.actions)!=null&&h.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Ae.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||yD,o=e.style;let l;const h=2,g=p=>Math.round(10*p)/10;if(this.data.multiLine){const p=Math.abs(this.data.rect[3]-this.data.rect[1]-h),x=Math.round(p/(uv*r))||1,y=p/x;l=Math.min(r,g(y/uv))}else{const p=Math.abs(this.data.rect[3]-this.data.rect[1]-h);l=Math.min(r,g(p/uv))}o.fontSize=`calc(${l}px * var(--total-scale-factor))`,o.color=Ae.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(o.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class ED extends uh{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,r){const o=this.annotationStorage;for(const l of this._getElementsByName(e.name,e.id))l.domElement&&(l.domElement[t]=i),o.setValue(l.id,{[r]:i})}render(){var r,o;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const l=e.getValue(t,{value:this.data.fieldValue});let h=l.value||"";const g=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;g&&h.length>g&&(h=h.slice(0,g));let p=l.formattedValue||((r=this.data.textContent)==null?void 0:r.join(`
`))||null;p&&this.data.comb&&(p=p.replaceAll(/\s+/g,""));const x={userValue:h,formattedValue:p,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=p??h,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",p??h),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),rh.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:y,datetimeType:v,timeStep:C}=this.data,R=!!v&&this.enableScripting;y&&(i.title=y),this._setRequired(i,this.data.required),g&&(i.maxLength=g),i.addEventListener("input",O=>{e.setValue(t,{value:O.target.value}),this.setPropertyOnSiblings(i,"value",O.target.value,"value"),x.formattedValue=null}),i.addEventListener("resetform",O=>{const _=this.data.defaultFieldValue??"";i.value=x.userValue=_,x.formattedValue=null});let I=O=>{const{formattedValue:_}=x;_!=null&&(O.target.value=_),O.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",_=>{var k;if(x.focused)return;const{target:N}=_;if(R&&(N.type=v,C&&(N.step=C)),x.userValue){const B=x.userValue;if(R)if(v==="time"){const z=new Date(B),H=[z.getHours(),z.getMinutes(),z.getSeconds()];N.value=H.map(F=>F.toString().padStart(2,"0")).join(":")}else N.value=new Date(B-AD).toISOString().split(v==="date"?"T":".",1)[0];else N.value=B}x.lastCommittedValue=N.value,x.commitKey=1,(k=this.data.actions)!=null&&k.Focus||(x.focused=!0)}),i.addEventListener("updatefromsandbox",_=>{this.showElementAndHideCanvas(_.target);const N={value(k){x.userValue=k.detail.value??"",R||e.setValue(t,{value:x.userValue.toString()}),k.target.value=x.userValue},formattedValue(k){const{formattedValue:B}=k.detail;x.formattedValue=B,B!=null&&k.target!==document.activeElement&&(k.target.value=B);const z={formattedValue:B};R&&(z.value=B),e.setValue(t,z)},selRange(k){k.target.setSelectionRange(...k.detail.selRange)},charLimit:k=>{var F;const{charLimit:B}=k.detail,{target:z}=k;if(B===0){z.removeAttribute("maxLength");return}z.setAttribute("maxLength",B);let H=x.userValue;!H||H.length<=B||(H=H.slice(0,B),z.value=x.userValue=H,e.setValue(t,{value:H}),(F=this.linkService.eventBus)==null||F.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:H,willCommit:!0,commitKey:1,selStart:z.selectionStart,selEnd:z.selectionEnd}}))}};this._dispatchEventFromSandbox(N,_)}),i.addEventListener("keydown",_=>{var B;x.commitKey=1;let N=-1;if(_.key==="Escape"?N=0:_.key==="Enter"&&!this.data.multiLine?N=2:_.key==="Tab"&&(x.commitKey=3),N===-1)return;const{value:k}=_.target;x.lastCommittedValue!==k&&(x.lastCommittedValue=k,x.userValue=k,(B=this.linkService.eventBus)==null||B.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:k,willCommit:!0,commitKey:N,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}}))});const O=I;I=null,i.addEventListener("blur",_=>{var B,z;if(!x.focused||!_.relatedTarget)return;(B=this.data.actions)!=null&&B.Blur||(x.focused=!1);const{target:N}=_;let{value:k}=N;if(R){if(k&&v==="time"){const H=k.split(":").map(F=>parseInt(F,10));k=new Date(2e3,0,1,H[0],H[1],H[2]||0).valueOf(),N.step=""}else k.includes("T")||(k=`${k}T00:00`),k=new Date(k).valueOf();N.type="text"}x.userValue=k,x.lastCommittedValue!==k&&((z=this.linkService.eventBus)==null||z.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:k,willCommit:!0,commitKey:x.commitKey,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}})),O(_)}),(o=this.data.actions)!=null&&o.Keystroke&&i.addEventListener("beforeinput",_=>{var W;x.lastCommittedValue=null;const{data:N,target:k}=_,{value:B,selectionStart:z,selectionEnd:H}=k;let F=z,Y=H;switch(_.inputType){case"deleteWordBackward":{const Z=B.substring(0,z).match(/\w*[^\w]*$/);Z&&(F-=Z[0].length);break}case"deleteWordForward":{const Z=B.substring(z).match(/^[^\w]*\w*/);Z&&(Y+=Z[0].length);break}case"deleteContentBackward":z===H&&(F-=1);break;case"deleteContentForward":z===H&&(Y+=1);break}_.preventDefault(),(W=this.linkService.eventBus)==null||W.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:B,change:N||"",willCommit:!1,selStart:F,selEnd:Y}})}),this._setEventListeners(i,x,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_=>_.target.value)}if(I&&i.addEventListener("blur",I),this.data.comb){const _=(this.data.rect[2]-this.data.rect[0])/g;i.classList.add("comb"),i.style.letterSpacing=`calc(${_}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class CD extends uh{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class SD extends uh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,i=t.id;let r=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",e.setValue(i,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return rh.add(o),o.setAttribute("data-element-id",i),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=t.fieldName,r&&o.setAttribute("checked",!0),o.setAttribute("exportValue",t.exportValue),o.tabIndex=0,o.addEventListener("change",l=>{const{name:h,checked:g}=l.target;for(const p of this._getElementsByName(h,i)){const x=g&&p.exportValue===t.exportValue;p.domElement&&(p.domElement.checked=x),e.setValue(p.id,{value:x})}e.setValue(i,{value:g})}),o.addEventListener("resetform",l=>{const h=t.defaultFieldValue||"Off";l.target.checked=h===t.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",l=>{const h={value(g){g.target.checked=g.detail.value!=="Off",e.setValue(i,{value:g.target.checked})}};this._dispatchEventFromSandbox(h,l)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class w8 extends uh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,i=t.id;let r=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof r=="string"&&(r=r!==t.buttonValue,e.setValue(i,{value:r})),r)for(const l of this._getElementsByName(t.fieldName,i))e.setValue(l.id,{value:!1});const o=document.createElement("input");if(rh.add(o),o.setAttribute("data-element-id",i),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=t.fieldName,r&&o.setAttribute("checked",!0),o.tabIndex=0,o.addEventListener("change",l=>{const{name:h,checked:g}=l.target;for(const p of this._getElementsByName(h,i))e.setValue(p.id,{value:!1});e.setValue(i,{value:g})}),o.addEventListener("resetform",l=>{const h=t.defaultFieldValue;l.target.checked=h!=null&&h===t.buttonValue}),this.enableScripting&&this.hasJSActions){const l=t.buttonValue;o.addEventListener("updatefromsandbox",h=>{const g={value:p=>{const x=l===p.detail.value;for(const y of this._getElementsByName(p.target.name)){const v=x&&y.id===i;y.domElement&&(y.domElement.checked=v),e.setValue(y.id,{value:v})}}};this._dispatchEventFromSandbox(g,h)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],h=>h.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class _D extends eS{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}}class TD extends uh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");rh.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",x=>{const y=this.data.defaultFieldValue;for(const v of r.options)v.selected=v.value===y});for(const x of this.data.options){const y=document.createElement("option");y.textContent=x.displayValue,y.value=x.exportValue,i.value.includes(x.exportValue)&&(y.setAttribute("selected",!0),o=!1),r.append(y)}let l=null;if(o){const x=document.createElement("option");x.value=" ",x.setAttribute("hidden",!0),x.setAttribute("selected",!0),r.prepend(x),l=()=>{x.remove(),r.removeEventListener("input",l),l=null},r.addEventListener("input",l)}const h=x=>{const y=x?"value":"textContent",{options:v,multiple:C}=r;return C?Array.prototype.filter.call(v,R=>R.selected).map(R=>R[y]):v.selectedIndex===-1?null:v[v.selectedIndex][y]};let g=h(!1);const p=x=>{const y=x.target.options;return Array.prototype.map.call(y,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",x=>{const y={value(v){l==null||l();const C=v.detail.value,R=new Set(Array.isArray(C)?C:[C]);for(const I of r.options)I.selected=R.has(I.value);e.setValue(t,{value:h(!0)}),g=h(!1)},multipleSelection(v){r.multiple=!0},remove(v){const C=r.options,R=v.detail.remove;C[R].selected=!1,r.remove(R),C.length>0&&Array.prototype.findIndex.call(C,O=>O.selected)===-1&&(C[0].selected=!0),e.setValue(t,{value:h(!0),items:p(v)}),g=h(!1)},clear(v){for(;r.length!==0;)r.remove(0);e.setValue(t,{value:null,items:[]}),g=h(!1)},insert(v){const{index:C,displayValue:R,exportValue:I}=v.detail.insert,O=r.children[C],_=document.createElement("option");_.textContent=R,_.value=I,O?O.before(_):r.append(_),e.setValue(t,{value:h(!0),items:p(v)}),g=h(!1)},items(v){const{items:C}=v.detail;for(;r.length!==0;)r.remove(0);for(const R of C){const{displayValue:I,exportValue:O}=R,_=document.createElement("option");_.textContent=I,_.value=O,r.append(_)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:h(!0),items:p(v)}),g=h(!1)},indices(v){const C=new Set(v.detail.indices);for(const R of v.target.options)R.selected=C.has(R.index);e.setValue(t,{value:h(!0)}),g=h(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(y,x)}),r.addEventListener("input",x=>{var C;const y=h(!0),v=h(!1);e.setValue(t,{value:y}),x.preventDefault(),(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:g,change:v,changeEx:y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],x=>x.target.value)):r.addEventListener("input",function(x){e.setValue(t,{value:h(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}var Sp,rE;class iE extends Jt{constructor(t){const{data:i,elements:r,parent:o}=t,l=!!o._commentManager;super(t,{isRenderable:!l&&Jt._hasPopupData(i)});E(this,Sp);if(this.elements=r,l&&Jt._hasPopupData(i)){const h=this.popup=P(this,Sp,rE).call(this);for(const g of r)g.popup=h}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const i=this.popup=P(this,Sp,rE).call(this),r=[];for(const o of this.elements)o.popup=i,o.container.ariaHasPopup="dialog",r.push(o.data.id),o.addHighlightArea();return this.container.setAttribute("aria-controls",r.map(o=>`${GC}${o}`).join(",")),this.container}}Sp=new WeakSet,rE=function(){return new ID({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var fr,pl,Kw,qw,gf,pf,ln,co,ml,Au,mf,xf,uo,gr,ta,na,Bn,ia,xl,_p,ra,wf,vu,wl,pi,yl,yf,$x,Tp,sE,Ip,oE,Np,aE,Af,Kx,Rp,lE,Zw,y8,Qw,A8,Jw,v8,ey,b8,vf,qx,bf,Zx,kp,cE;class ID{constructor({container:e,color:t,elements:i,titleObj:r,modificationDate:o,contentsObj:l,richText:h,parent:g,rect:p,parentRect:x,open:y,commentManager:v=null}){E(this,yf);E(this,Tp);E(this,Ip);E(this,Np);E(this,Af);E(this,Rp);E(this,Zw);E(this,Qw);E(this,Jw);E(this,ey);E(this,vf);E(this,bf);E(this,kp);E(this,fr,null);E(this,pl,P(this,Jw,v8).bind(this));E(this,Kw,P(this,kp,cE).bind(this));E(this,qw,P(this,bf,Zx).bind(this));E(this,gf,P(this,vf,qx).bind(this));E(this,pf,null);E(this,ln,null);E(this,co,null);E(this,ml,null);E(this,Au,null);E(this,mf,null);E(this,xf,null);E(this,uo,!1);E(this,gr,null);E(this,ta,null);E(this,na,null);E(this,Bn,null);E(this,ia,null);E(this,xl,null);E(this,_p,null);E(this,ra,null);E(this,wf,null);E(this,vu,null);E(this,wl,!1);E(this,pi,null);E(this,yl,null);S(this,ln,e),S(this,wf,r),S(this,co,l),S(this,ra,h),S(this,mf,g),S(this,pf,t),S(this,_p,p),S(this,xf,x),S(this,Au,i),S(this,fr,v),S(this,pi,i[0]),S(this,ml,G1.toDateObject(o)),this.trigger=i.flatMap(C=>C.getElementsToTriggerPopup()),v?this.renderCommentButton():(P(this,yf,$x).call(this),u(this,ln).hidden=!0,y&&P(this,vf,qx).call(this))}renderCommentButton(){if(u(this,Bn)||(u(this,ia)||P(this,Tp,sE).call(this),!u(this,ia)))return;const{signal:e}=S(this,ta,new AbortController),t=!!u(this,pi).extraPopupElement,i=()=>{u(this,fr).toggleCommentPopup(this,!0,void 0,!t)},r=()=>{u(this,fr).toggleCommentPopup(this,!1,!0,!t)},o=()=>{u(this,fr).toggleCommentPopup(this,!1,!1)};if(t){S(this,Bn,u(this,pi).container);for(const l of this.trigger)l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.addEventListener("keydown",u(this,pl),{signal:e}),l.addEventListener("click",i,{signal:e}),l.addEventListener("pointerenter",r,{signal:e}),l.addEventListener("pointerleave",o,{signal:e}),l.classList.add("popupTriggerArea")}else{const l=S(this,Bn,document.createElement("button"));l.className="annotationCommentButton";const h=u(this,pi).container;l.style.zIndex=h.style.zIndex+1,l.tabIndex=0,l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.setAttribute("data-l10n-id","pdfjs-show-comment-button"),P(this,Np,aE).call(this),P(this,Ip,oE).call(this),l.addEventListener("keydown",u(this,pl),{signal:e}),l.addEventListener("click",i,{signal:e}),l.addEventListener("pointerenter",r,{signal:e}),l.addEventListener("pointerleave",o,{signal:e}),h.after(l)}}get commentButtonColor(){const{color:e,opacity:t}=u(this,pi).commentData;return e?u(this,mf)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=u(this,Bn))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:i,creationDate:r,modificationDate:o}=u(this,pi).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:i,creationDate:r,modificationDate:o}}get elementBeforePopup(){return u(this,Bn)}get comment(){return u(this,yl)||S(this,yl,u(this,pi).commentText),u(this,yl)}set comment(e){e!==this.comment&&(u(this,pi).commentText=S(this,yl,e))}get parentBoundingClientRect(){return u(this,pi).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){u(this,Bn)&&(u(this,Bn).classList.toggle("selected",e),u(this,Bn).ariaExpanded=t)}setSelectedCommentButton(e){u(this,Bn).classList.toggle("selected",e)}get commentPopupPosition(){if(u(this,xl))return u(this,xl);const{x:e,y:t,height:i}=u(this,Bn).getBoundingClientRect(),{x:r,y:o,width:l,height:h}=u(this,pi).layer.getBoundingClientRect();return[(e-r)/l,(t+i-o)/h]}set commentPopupPosition(e){S(this,xl,e)}hasDefaultPopupPosition(){return u(this,xl)===null}get commentButtonPosition(){return u(this,ia)}get commentButtonWidth(){return u(this,Bn).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,i]=u(this,xl)||this.commentButtonPosition.map(p=>p/100),r=this.parentBoundingClientRect,{x:o,y:l,width:h,height:g}=r;u(this,fr).showDialog(null,this,o+t*h,l+i*g,{...e,parentDimensions:r})}render(){var i,r;if(u(this,gr))return;const e=S(this,gr,document.createElement("div"));if(e.className="popup",u(this,pf)){const o=e.style.outlineColor=Ae.makeHexColor(...u(this,pf));e.style.backgroundColor=`color-mix(in srgb, ${o} 30%, white)`}const t=document.createElement("span");if(t.className="header",(i=u(this,wf))!=null&&i.str){const o=document.createElement("span");o.className="title",t.append(o),{dir:o.dir,str:o.textContent}=u(this,wf)}if(e.append(t),u(this,ml)){const o=document.createElement("time");o.className="popupDate",o.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),o.setAttribute("data-l10n-args",JSON.stringify({dateObj:u(this,ml).valueOf()})),o.dateTime=u(this,ml).toISOString(),t.append(o)}YC({html:u(this,Af,Kx)||u(this,co).str,dir:(r=u(this,co))==null?void 0:r.dir,className:"popupContent"},e),u(this,ln).append(e)}updateEdited({rect:e,popup:t,deleted:i}){var r;if(u(this,fr)){i?(this.remove(),S(this,yl,null)):t&&(t.deleted?this.remove():(P(this,Np,aE).call(this),S(this,yl,t.text))),e&&(S(this,ia,null),P(this,Tp,sE).call(this),P(this,Ip,oE).call(this));return}if(i||t!=null&&t.deleted){this.remove();return}P(this,yf,$x).call(this),u(this,vu)||S(this,vu,{contentsObj:u(this,co),richText:u(this,ra)}),e&&S(this,na,null),t&&t.text&&(S(this,ra,P(this,Qw,A8).call(this,t.text)),S(this,ml,G1.toDateObject(t.date)),S(this,co,null)),(r=u(this,gr))==null||r.remove(),S(this,gr,null)}resetEdited(){var e;u(this,vu)&&({contentsObj:Tn(this,co)._,richText:Tn(this,ra)._}=u(this,vu),S(this,vu,null),(e=u(this,gr))==null||e.remove(),S(this,gr,null),S(this,na,null))}remove(){var e,t,i;if((e=u(this,ta))==null||e.abort(),S(this,ta,null),(t=u(this,gr))==null||t.remove(),S(this,gr,null),S(this,wl,!1),S(this,uo,!1),(i=u(this,Bn))==null||i.remove(),S(this,Bn,null),this.trigger)for(const r of this.trigger)r.classList.remove("popupTriggerArea")}forceHide(){S(this,wl,this.isVisible),u(this,wl)&&(u(this,ln).hidden=!0)}maybeShow(){u(this,fr)||(P(this,yf,$x).call(this),u(this,wl)&&(u(this,gr)||P(this,bf,Zx).call(this),S(this,wl,!1),u(this,ln).hidden=!1))}get isVisible(){return u(this,fr)?!1:u(this,ln).hidden===!1}}fr=new WeakMap,pl=new WeakMap,Kw=new WeakMap,qw=new WeakMap,gf=new WeakMap,pf=new WeakMap,ln=new WeakMap,co=new WeakMap,ml=new WeakMap,Au=new WeakMap,mf=new WeakMap,xf=new WeakMap,uo=new WeakMap,gr=new WeakMap,ta=new WeakMap,na=new WeakMap,Bn=new WeakMap,ia=new WeakMap,xl=new WeakMap,_p=new WeakMap,ra=new WeakMap,wf=new WeakMap,vu=new WeakMap,wl=new WeakMap,pi=new WeakMap,yl=new WeakMap,yf=new WeakSet,$x=function(){var t;if(u(this,ta))return;S(this,ta,new AbortController);const{signal:e}=u(this,ta);for(const i of this.trigger)i.addEventListener("click",u(this,gf),{signal:e}),i.addEventListener("pointerenter",u(this,qw),{signal:e}),i.addEventListener("pointerleave",u(this,Kw),{signal:e}),i.classList.add("popupTriggerArea");for(const i of u(this,Au))(t=i.container)==null||t.addEventListener("keydown",u(this,pl),{signal:e})},Tp=new WeakSet,sE=function(){const e=u(this,Au).find(t=>t.hasCommentButton);e&&S(this,ia,e._normalizePoint(e.commentButtonPosition))},Ip=new WeakSet,oE=function(){if(u(this,pi).extraPopupElement&&!u(this,pi).editor)return;this.renderCommentButton();const[e,t]=u(this,ia),{style:i}=u(this,Bn);i.left=`calc(${e}%)`,i.top=`calc(${t}% - var(--comment-button-dim))`},Np=new WeakSet,aE=function(){u(this,pi).extraPopupElement||(this.renderCommentButton(),u(this,Bn).style.backgroundColor=this.commentButtonColor||"")},Af=new WeakSet,Kx=function(){const e=u(this,ra),t=u(this,co);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&u(this,ra).html||null},Rp=new WeakSet,lE=function(){var e,t,i;return((i=(t=(e=u(this,Af,Kx))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.fontSize)||0},Zw=new WeakSet,y8=function(){var e,t,i;return((i=(t=(e=u(this,Af,Kx))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.color)||null},Qw=new WeakSet,A8=function(e){const t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},r={style:{color:u(this,Zw,y8),fontSize:u(this,Rp,lE)?`calc(${u(this,Rp,lE)}px * var(--total-scale-factor))`:""}};for(const o of e.split(`
`))t.push({name:"span",value:o,attributes:r});return i},Jw=new WeakSet,v8=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&u(this,uo))&&P(this,vf,qx).call(this)},ey=new WeakSet,b8=function(){if(u(this,na)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:r,pageY:o}}}=u(this,mf);let l=!!u(this,xf),h=l?u(this,xf):u(this,_p);for(const R of u(this,Au))if(!h||Ae.intersect(R.data.rect,h)!==null){h=R.data.rect,l=!0;break}const g=Ae.normalizeRect([h[0],e[3]-h[1]+e[1],h[2],e[3]-h[3]+e[1]]),p=5,x=l?h[2]-h[0]+p:0,y=g[0]+x,v=g[1];S(this,na,[100*(y-r)/t,100*(v-o)/i]);const{style:C}=u(this,ln);C.left=`${u(this,na)[0]}%`,C.top=`${u(this,na)[1]}%`},vf=new WeakSet,qx=function(){if(u(this,fr)){u(this,fr).toggleCommentPopup(this,!1);return}S(this,uo,!u(this,uo)),u(this,uo)?(P(this,bf,Zx).call(this),u(this,ln).addEventListener("click",u(this,gf)),u(this,ln).addEventListener("keydown",u(this,pl))):(P(this,kp,cE).call(this),u(this,ln).removeEventListener("click",u(this,gf)),u(this,ln).removeEventListener("keydown",u(this,pl)))},bf=new WeakSet,Zx=function(){u(this,gr)||this.render(),this.isVisible?u(this,uo)&&u(this,ln).classList.add("focused"):(P(this,ey,b8).call(this),u(this,ln).hidden=!1,u(this,ln).style.zIndex=parseInt(u(this,ln).style.zIndex)+1e3)},kp=new WeakSet,cE=function(){u(this,ln).classList.remove("focused"),!(u(this,uo)||!this.isVisible)&&(u(this,ln).hidden=!0,u(this,ln).style.zIndex=parseInt(u(this,ln).style.zIndex)-1e3)};class E8 extends Jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Be.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Pp;class ND extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});E(this,Pp,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:i,height:r}=this,o=this.svgFactory.create(i,r,!0),l=S(this,Pp,this.svgFactory.createElement("svg:line"));return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),o.append(l),this.container.append(o),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,Pp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Pp=new WeakMap;var Dp;class RD extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});E(this,Dp,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:i,height:r}=this,o=this.svgFactory.create(i,r,!0),l=t.borderStyle.width,h=S(this,Dp,this.svgFactory.createElement("svg:rect"));return h.setAttribute("x",l/2),h.setAttribute("y",l/2),h.setAttribute("width",i-l),h.setAttribute("height",r-l),h.setAttribute("stroke-width",l||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),o.append(h),this.container.append(o),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,Dp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Dp=new WeakMap;var Mp;class kD extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});E(this,Mp,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:i,height:r}=this,o=this.svgFactory.create(i,r,!0),l=t.borderStyle.width,h=S(this,Mp,this.svgFactory.createElement("svg:ellipse"));return h.setAttribute("cx",i/2),h.setAttribute("cy",r/2),h.setAttribute("rx",i/2-l/2),h.setAttribute("ry",r/2-l/2),h.setAttribute("stroke-width",l||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),o.append(h),this.container.append(o),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,Mp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Mp=new WeakMap;var Op;class C8 extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});E(this,Op,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:r,popupRef:o},width:l,height:h}=this;if(!i)return this.container;const g=this.svgFactory.create(l,h,!0);let p=[];for(let y=0,v=i.length;y<v;y+=2){const C=i[y]-t[0],R=t[3]-i[y+1];p.push(`${C},${R}`)}p=p.join(" ");const x=S(this,Op,this.svgFactory.createElement(this.svgElementName));return x.setAttribute("points",p),x.setAttribute("stroke-width",r.width||1),x.setAttribute("stroke","transparent"),x.setAttribute("fill","transparent"),g.append(x),this.container.append(g),!o&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,Op)}addHighlightArea(){this.container.classList.add("highlightArea")}}Op=new WeakMap;class PD extends C8{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class DD extends Jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Lp,bu,Bp,uE;class tS extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});E(this,Bp);E(this,Lp,null);E(this,bu,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Be.HIGHLIGHT:Be.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:r,borderStyle:o,popupRef:l}}=this,{transform:h,width:g,height:p}=P(this,Bp,uE).call(this,i,t),x=this.svgFactory.create(g,p,!0),y=S(this,Lp,this.svgFactory.createElement("svg:g"));x.append(y),y.setAttribute("stroke-width",o.width||1),y.setAttribute("stroke-linecap","round"),y.setAttribute("stroke-linejoin","round"),y.setAttribute("stroke-miterlimit",10),y.setAttribute("stroke","transparent"),y.setAttribute("fill","transparent"),y.setAttribute("transform",h);for(let v=0,C=r.length;v<C;v++){const R=this.svgFactory.createElement(this.svgElementName);u(this,bu).push(R),R.setAttribute("points",r[v].join(",")),y.append(R)}return!l&&this.hasPopupData&&this._createPopup(),this.container.append(x),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:r,rect:o}=t,l=u(this,Lp);if(i>=0&&l.setAttribute("stroke-width",i||1),r)for(let h=0,g=u(this,bu).length;h<g;h++)u(this,bu)[h].setAttribute("points",r[h].join(","));if(o){const{transform:h,width:g,height:p}=P(this,Bp,uE).call(this,this.data.rotation,o);l.parentElement.setAttribute("viewBox",`0 0 ${g} ${p}`),l.setAttribute("transform",h)}}getElementsToTriggerPopup(){return u(this,bu)}addHighlightArea(){this.container.classList.add("highlightArea")}}Lp=new WeakMap,bu=new WeakMap,Bp=new WeakSet,uE=function(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}};class S8 extends Jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Be.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class MD extends Jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class OD extends Jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class LD extends Jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class _8 extends Jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Be.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Fp,Up,hE;class BD extends Jt{constructor(t){var r;super(t,{isRenderable:!0});E(this,Up);E(this,Fp,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(r=this.linkService.eventBus)==null||r.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let r;i.hasAppearance||i.fillAlpha===0?r=document.createElement("div"):(r=document.createElement("img"),r.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(r.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),r.addEventListener("dblclick",P(this,Up,hE).bind(this)),S(this,Fp,r);const{isMac:o}=Gn.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(o?l.metaKey:l.ctrlKey)&&P(this,Up,hE).call(this)}),!i.popupRef&&this.hasPopupData?this._createPopup():r.classList.add("popupTriggerArea"),t.append(r),t}getElementsToTriggerPopup(){return u(this,Fp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Fp=new WeakMap,Up=new WeakSet,hE=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Ef,Eu,Cf,Al,jp,Cu,zp,dE,Hp,fE,Vp;let nS=(Vp=class{constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:r,page:o,viewport:l,structTreeLayer:h,commentManager:g,linkService:p,annotationStorage:x}){E(this,zp);E(this,Hp);E(this,Ef,null);E(this,Eu,null);E(this,Cf,null);E(this,Al,new Map);E(this,jp,null);E(this,Cu,null);this.div=e,S(this,Ef,t),S(this,Eu,i),S(this,jp,h||null),S(this,Cu,p||null),S(this,Cf,x||new $C),this.page=o,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=r,this._commentManager=g||null}hasEditableAnnotations(){return u(this,Al).size>0}async render(e){var l,h,g;const{annotations:t}=e,i=this.div;ql(i,this.viewport);const r=new Map,o={data:null,layer:i,linkService:u(this,Cu),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new K1,annotationStorage:u(this,Cf),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const p of t){if(p.noHTML)continue;const x=p.annotationType===pn.POPUP;if(x){const C=r.get(p.id);if(!C)continue;o.elements=C}else if(p.rect[2]===p.rect[0]||p.rect[3]===p.rect[1])continue;o.data=p;const y=d_.create(o);if(!y.isRenderable)continue;if(!x&&p.popupRef){const C=r.get(p.popupRef);C?C.push(y):r.set(p.popupRef,[y])}const v=y.render();p.hidden&&(v.style.visibility="hidden"),await P(this,zp,dE).call(this,v,p.id,o.elements),(h=(l=y.extraPopupElement)==null?void 0:l.popup)==null||h.renderCommentButton(),y._isEditable&&(u(this,Al).set(y.data.id,y),(g=this._annotationEditorUIManager)==null||g.renderAnnotationElement(y))}P(this,Hp,fE).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:u(this,Cu),svgFactory:new K1,parent:this};for(const i of e){i.borderStyle||(i.borderStyle=Vp._defaultBorderStyle),t.data=i;const r=d_.create(t);if(!r.isRenderable)continue;const o=r.render();await P(this,zp,dE).call(this,o,i.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,ql(t,{rotation:e.rotation}),P(this,Hp,fE).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(u(this,Al).values())}getEditableAnnotation(e){return u(this,Al).get(e)}addFakeAnnotation(e){var h;const{div:t}=this,{id:i,rotation:r}=e,o=new vD({data:{id:i,rect:e.getPDFRect(),rotation:r},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:u(this,Cu),annotationStorage:u(this,Cf)}),l=o.render();return t.append(l),(h=u(this,Ef))==null||h.moveElementInDOM(t,l,l,!1),o.createOrUpdatePopup(),o}static get _defaultBorderStyle(){return Ve(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Ch.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}},Ef=new WeakMap,Eu=new WeakMap,Cf=new WeakMap,Al=new WeakMap,jp=new WeakMap,Cu=new WeakMap,zp=new WeakSet,dE=async function(e,t,i){var h,g;const r=e.firstChild||e,o=r.id=`${GC}${t}`,l=await((h=u(this,jp))==null?void 0:h.getAriaAttributes(o));if(l)for(const[p,x]of l)r.setAttribute(p,x);i?i.at(-1).container.after(e):(this.div.append(e),(g=u(this,Ef))==null||g.moveElementInDOM(this.div,e,r,!1))},Hp=new WeakSet,fE=function(){var t;if(!u(this,Eu))return;const e=this.div;for(const[i,r]of u(this,Eu)){const o=e.querySelector(`[data-annotation-id="${i}"]`);if(!o)continue;r.className="annotationContent";const{firstChild:l}=o;l?l.nodeName==="CANVAS"?l.replaceWith(r):l.classList.contains("annotationContent")?l.after(r):l.before(r):o.append(r);const h=u(this,Al).get(i);h&&(h._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(i,o.id,r),h._hasNoCanvas=!1):h.canvas=r)}u(this,Eu).clear()},Vp);const yx=/\r\n?|\n/g;var pr,Wp,Su,mr,ty,T8,ny,I8,iy,N8,Sf,Qx,_f,Jx,Tf,e2,ry,R8,Gp,pE,sy,k8;const Rt=class Rt extends Mt{constructor(t){super({...t,name:"freeTextEditor"});E(this,ty);E(this,ny);E(this,iy);E(this,Sf);E(this,Tf);E(this,ry);E(this,sy);E(this,pr,"");E(this,Wp,`${this.id}-editor`);E(this,Su,null);E(this,mr,void 0);ue(this,"_colorPicker",null);this.color=t.color||Rt._defaultColor||Mt._defaultLineColor,S(this,mr,t.fontSize||Rt._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const t=Rt.prototype,i=l=>l.isEmpty(),r=Zl.TRANSLATE_SMALL,o=Zl.TRANSLATE_BIG;return Ve(this,"_keyboardManager",new Mm([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-o,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[o,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-o],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,o],checker:i}]]))}static initialize(t,i){Mt.initialize(t,i);const r=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(r.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case Ze.FREETEXT_SIZE:Rt._defaultFontSize=i;break;case Ze.FREETEXT_COLOR:Rt._defaultColor=i;break}}updateParams(t,i){switch(t){case Ze.FREETEXT_SIZE:P(this,ty,T8).call(this,i);break;case Ze.FREETEXT_COLOR:P(this,ny,I8).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Ze.FREETEXT_SIZE,Rt._defaultFontSize],[Ze.FREETEXT_COLOR,Rt._defaultColor||Mt._defaultLineColor]]}get propertiesToUpdate(){return[[Ze.FREETEXT_SIZE,u(this,mr)],[Ze.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new V2(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Ze.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-Rt._internalPadding*t,-(Rt._internalPadding+u(this,mr))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),S(this,Su,new AbortController);const t=this._uiManager.combinedSignal(u(this,Su));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",u(this,Wp)),this._isDraggable=!0,(t=u(this,Su))==null||t.abort(),S(this,Su,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var i;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(i=this._initialOptions)!=null&&i.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=u(this,pr),i=S(this,pr,P(this,iy,N8).call(this).trimEnd());if(t===i)return;const r=o=>{if(S(this,pr,o),!o){this.remove();return}P(this,Tf,e2).call(this),this._uiManager.rebuild(this),P(this,Sf,Qx).call(this)};this.addCommands({cmd:()=>{r(i)},undo:()=>{r(t)},mustExec:!1}),P(this,Sf,Qx).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Rt._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,i;(this._isCopy||this.annotationElementId)&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",u(this,Wp)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:r}=this.editorDiv;if(r.fontSize=`calc(${u(this,mr)}px * var(--total-scale-factor))`,r.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[o,l]=this.parentDimensions;if(this.annotationElementId){const{position:h}=this._initialData;let[g,p]=this.getInitialTranslation();[g,p]=this.pageTranslationToScreen(g,p);const[x,y]=this.pageDimensions,[v,C]=this.pageTranslation;let R,I;switch(this.rotation){case 0:R=t+(h[0]-v)/x,I=i+this.height-(h[1]-C)/y;break;case 90:R=t+(h[0]-v)/x,I=i-(h[1]-C)/y,[g,p]=[p,-g];break;case 180:R=t-this.width+(h[0]-v)/x,I=i-(h[1]-C)/y,[g,p]=[-g,-p];break;case 270:R=t+(h[0]-v-this.height*y)/x,I=i+(h[1]-C-this.width*x)/y,[g,p]=[-p,g];break}this.setAt(R*o,I*l,g,p)}else this._moveAfterPaste(t,i);P(this,Tf,e2).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var R,I,O;const i=t.clipboardData||window.clipboardData,{types:r}=i;if(r.length===1&&r[0]==="text/plain")return;t.preventDefault();const o=P(R=Rt,Gp,pE).call(R,i.getData("text")||"").replaceAll(yx,`
`);if(!o)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const h=l.getRangeAt(0);if(!o.includes(`
`)){h.insertNode(document.createTextNode(o)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:g,startOffset:p}=h,x=[],y=[];if(g.nodeType===Node.TEXT_NODE){const _=g.parentElement;if(y.push(g.nodeValue.slice(p).replaceAll(yx,"")),_!==this.editorDiv){let N=x;for(const k of this.editorDiv.childNodes){if(k===_){N=y;continue}N.push(P(I=Rt,_f,Jx).call(I,k))}}x.push(g.nodeValue.slice(0,p).replaceAll(yx,""))}else if(g===this.editorDiv){let _=x,N=0;for(const k of this.editorDiv.childNodes)N++===p&&(_=y),_.push(P(O=Rt,_f,Jx).call(O,k))}S(this,pr,`${x.join(`
`)}${o}${y.join(`
`)}`),P(this,Tf,e2).call(this);const v=new Range;let C=Math.sumPrecise(x.map(_=>_.length));for(const{firstChild:_}of this.editorDiv.childNodes)if(_.nodeType===Node.TEXT_NODE){const N=_.nodeValue.length;if(C<=N){v.setStart(_,C),v.setEnd(_,C);break}C-=N}l.removeAllRanges(),l.addRange(v)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Rt._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,i,r){var h;let o=null;if(t instanceof E8){const{data:{defaultAppearanceData:{fontSize:g,fontColor:p},rect:x,rotation:y,id:v,popupRef:C,richText:R,contentsObj:I,creationDate:O,modificationDate:_},textContent:N,textPosition:k,parent:{page:{pageNumber:B}}}=t;if(!N||N.length===0)return null;o=t={annotationType:Be.FREETEXT,color:Array.from(p),fontSize:g,value:N.join(`
`),position:k,pageIndex:B-1,rect:x.slice(0),rotation:y,annotationElementId:v,id:v,deleted:!1,popupRef:C,comment:(I==null?void 0:I.str)||null,richText:R,creationDate:O,modificationDate:_}}const l=await super.deserialize(t,i,r);return S(l,mr,t.fontSize),l.color=Ae.makeHexColor(...t.color),S(l,pr,P(h=Rt,Gp,pE).call(h,t.value)),l._initialData=o,t.comment&&l.setCommentData(t),l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Mt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),r=Object.assign(super.serialize(t),{color:i,fontSize:u(this,mr),value:P(this,ry,R8).call(this)});return this.addComment(r),t?(r.isCopy=!0,r):this.annotationElementId&&!P(this,sy,k8).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(!i)return null;const{style:r}=i;r.fontSize=`calc(${u(this,mr)}px * var(--total-scale-factor))`,r.color=this.color,i.replaceChildren();for(const o of u(this,pr).split(`
`)){const l=document.createElement("div");l.append(o?document.createTextNode(o):document.createElement("br")),i.append(l)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:u(this,pr)}}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};pr=new WeakMap,Wp=new WeakMap,Su=new WeakMap,mr=new WeakMap,ty=new WeakSet,T8=function(t){const i=o=>{this.editorDiv.style.fontSize=`calc(${o}px * var(--total-scale-factor))`,this.translate(0,-(o-u(this,mr))*this.parentScale),S(this,mr,o),P(this,Sf,Qx).call(this)},r=u(this,mr);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ze.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},ny=new WeakSet,I8=function(t){const i=o=>{this.color=o,this.onUpdatedColor()},r=this.color;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ze.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},iy=new WeakSet,N8=function(){var r;const t=[];this.editorDiv.normalize();let i=null;for(const o of this.editorDiv.childNodes)(i==null?void 0:i.nodeType)===Node.TEXT_NODE&&o.nodeName==="BR"||(t.push(P(r=Rt,_f,Jx).call(r,o)),i=o);return t.join(`
`)},Sf=new WeakSet,Qx=function(){const[t,i]=this.parentDimensions;let r;if(this.isAttachedToDOM)r=this.div.getBoundingClientRect();else{const{currentLayer:o,div:l}=this,h=l.style.display,g=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",o.div.append(this.div),r=l.getBoundingClientRect(),l.remove(),l.style.display=h,l.classList.toggle("hidden",g)}this.rotation%180===this.parentRotation%180?(this.width=r.width/t,this.height=r.height/i):(this.width=r.height/t,this.height=r.width/i),this.fixAndSetPosition()},_f=new WeakSet,Jx=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(yx,"")},Tf=new WeakSet,e2=function(){if(this.editorDiv.replaceChildren(),!!u(this,pr))for(const t of u(this,pr).split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}},ry=new WeakSet,R8=function(){return u(this,pr).replaceAll(""," ")},Gp=new WeakSet,pE=function(t){return t.replaceAll(" ","")},sy=new WeakSet,k8=function(t){const{value:i,fontSize:r,color:o,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==i||t.fontSize!==r||t.color.some((h,g)=>h!==o[g])||t.pageIndex!==l},E(Rt,_f),E(Rt,Gp),ue(Rt,"_freeTextDefaultContent",""),ue(Rt,"_internalPadding",0),ue(Rt,"_defaultColor",null),ue(Rt,"_defaultFontSize",10),ue(Rt,"_type","freetext"),ue(Rt,"_editorType",Be.FREETEXT);let gE=Rt;class be{toSVGPath(){It("Abstract method `toSVGPath` must be implemented.")}get box(){It("Abstract getter `box` must be implemented.")}serialize(e,t){It("Abstract method `serialize` must be implemented.")}static _rescale(e,t,i,r,o,l){l||(l=new Float32Array(e.length));for(let h=0,g=e.length;h<g;h+=2)l[h]=t+e[h]*r,l[h+1]=i+e[h+1]*o;return l}static _rescaleAndSwap(e,t,i,r,o,l){l||(l=new Float32Array(e.length));for(let h=0,g=e.length;h<g;h+=2)l[h]=t+e[h+1]*r,l[h+1]=i+e[h]*o;return l}static _translate(e,t,i,r){r||(r=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)r[o]=t+e[o],r[o+1]=i+e[o+1];return r}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,i,r,o){switch(o){case 90:return[1-t/i,e/r];case 180:return[1-e/i,1-t/r];case 270:return[t/i,1-e/r];default:return[e/i,t/r]}}static _normalizePagePoint(e,t,i){switch(i){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,i,r,o,l){return[(e+5*i)/6,(t+5*r)/6,(5*i+o)/6,(5*r+l)/6,(i+o)/2,(r+l)/2]}}ue(be,"PRECISION",1e-4);var xr,bs,If,Nf,ho,Ye,_u,Tu,Xp,Yp,Rf,kf,vl,$p,oy,ay,Iu,u1,ly,P8,cy,D8,uy,M8,hy,O8,dy,L8,fy,B8;const Io=class Io{constructor({x:e,y:t},i,r,o,l,h=0){E(this,Iu);E(this,ly);E(this,cy);E(this,uy);E(this,hy);E(this,dy);E(this,fy);E(this,xr,void 0);E(this,bs,[]);E(this,If,void 0);E(this,Nf,void 0);E(this,ho,[]);E(this,Ye,new Float32Array(18));E(this,_u,void 0);E(this,Tu,void 0);E(this,Xp,void 0);E(this,Yp,void 0);E(this,Rf,void 0);E(this,kf,void 0);E(this,vl,[]);S(this,xr,i),S(this,kf,o*r),S(this,Nf,l),u(this,Ye).set([NaN,NaN,NaN,NaN,e,t],6),S(this,If,h),S(this,Yp,u(Io,$p)*r),S(this,Xp,u(Io,ay)*r),S(this,Rf,r),u(this,vl).push(e,t)}isEmpty(){return isNaN(u(this,Ye)[8])}add({x:e,y:t}){var W;S(this,_u,e),S(this,Tu,t);const[i,r,o,l]=u(this,xr);let[h,g,p,x]=u(this,Ye).subarray(8,12);const y=e-p,v=t-x,C=Math.hypot(y,v);if(C<u(this,Xp))return!1;const R=C-u(this,Yp),I=R/C,O=I*y,_=I*v;let N=h,k=g;h=p,g=x,p+=O,x+=_,(W=u(this,vl))==null||W.push(e,t);const B=-_/R,z=O/R,H=B*u(this,kf),F=z*u(this,kf);return u(this,Ye).set(u(this,Ye).subarray(2,8),0),u(this,Ye).set([p+H,x+F],4),u(this,Ye).set(u(this,Ye).subarray(14,18),12),u(this,Ye).set([p-H,x-F],16),isNaN(u(this,Ye)[6])?(u(this,ho).length===0&&(u(this,Ye).set([h+H,g+F],2),u(this,ho).push(NaN,NaN,NaN,NaN,(h+H-i)/o,(g+F-r)/l),u(this,Ye).set([h-H,g-F],14),u(this,bs).push(NaN,NaN,NaN,NaN,(h-H-i)/o,(g-F-r)/l)),u(this,Ye).set([N,k,h,g,p,x],6),!this.isEmpty()):(u(this,Ye).set([N,k,h,g,p,x],6),Math.abs(Math.atan2(k-g,N-h)-Math.atan2(_,O))<Math.PI/2?([h,g,p,x]=u(this,Ye).subarray(2,6),u(this,ho).push(NaN,NaN,NaN,NaN,((h+p)/2-i)/o,((g+x)/2-r)/l),[h,g,N,k]=u(this,Ye).subarray(14,18),u(this,bs).push(NaN,NaN,NaN,NaN,((N+h)/2-i)/o,((k+g)/2-r)/l),!0):([N,k,h,g,p,x]=u(this,Ye).subarray(0,6),u(this,ho).push(((N+5*h)/6-i)/o,((k+5*g)/6-r)/l,((5*h+p)/6-i)/o,((5*g+x)/6-r)/l,((h+p)/2-i)/o,((g+x)/2-r)/l),[p,x,h,g,N,k]=u(this,Ye).subarray(12,18),u(this,bs).push(((N+5*h)/6-i)/o,((k+5*g)/6-r)/l,((5*h+p)/6-i)/o,((5*g+x)/6-r)/l,((h+p)/2-i)/o,((g+x)/2-r)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const e=u(this,ho),t=u(this,bs);if(isNaN(u(this,Ye)[6])&&!this.isEmpty())return P(this,ly,P8).call(this);const i=[];i.push(`M${e[4]} ${e[5]}`);for(let r=6;r<e.length;r+=6)isNaN(e[r])?i.push(`L${e[r+4]} ${e[r+5]}`):i.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);P(this,uy,M8).call(this,i);for(let r=t.length-6;r>=6;r-=6)isNaN(t[r])?i.push(`L${t[r+4]} ${t[r+5]}`):i.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);return P(this,cy,D8).call(this,i),i.join(" ")}newFreeDrawOutline(e,t,i,r,o,l){return new F8(e,t,i,r,o,l)}getOutlines(){var y;const e=u(this,ho),t=u(this,bs),i=u(this,Ye),[r,o,l,h]=u(this,xr),g=new Float32Array((((y=u(this,vl))==null?void 0:y.length)??0)+2);for(let v=0,C=g.length-2;v<C;v+=2)g[v]=(u(this,vl)[v]-r)/l,g[v+1]=(u(this,vl)[v+1]-o)/h;if(g[g.length-2]=(u(this,_u)-r)/l,g[g.length-1]=(u(this,Tu)-o)/h,isNaN(i[6])&&!this.isEmpty())return P(this,hy,O8).call(this,g);const p=new Float32Array(u(this,ho).length+24+u(this,bs).length);let x=e.length;for(let v=0;v<x;v+=2){if(isNaN(e[v])){p[v]=p[v+1]=NaN;continue}p[v]=e[v],p[v+1]=e[v+1]}x=P(this,fy,B8).call(this,p,x);for(let v=t.length-6;v>=6;v-=6)for(let C=0;C<6;C+=2){if(isNaN(t[v+C])){p[x]=p[x+1]=NaN,x+=2;continue}p[x]=t[v+C],p[x+1]=t[v+C+1],x+=2}return P(this,dy,L8).call(this,p,x),this.newFreeDrawOutline(p,g,u(this,xr),u(this,Rf),u(this,If),u(this,Nf))}};xr=new WeakMap,bs=new WeakMap,If=new WeakMap,Nf=new WeakMap,ho=new WeakMap,Ye=new WeakMap,_u=new WeakMap,Tu=new WeakMap,Xp=new WeakMap,Yp=new WeakMap,Rf=new WeakMap,kf=new WeakMap,vl=new WeakMap,$p=new WeakMap,oy=new WeakMap,ay=new WeakMap,Iu=new WeakSet,u1=function(){const e=u(this,Ye).subarray(4,6),t=u(this,Ye).subarray(16,18),[i,r,o,l]=u(this,xr);return[(u(this,_u)+(e[0]-t[0])/2-i)/o,(u(this,Tu)+(e[1]-t[1])/2-r)/l,(u(this,_u)+(t[0]-e[0])/2-i)/o,(u(this,Tu)+(t[1]-e[1])/2-r)/l]},ly=new WeakSet,P8=function(){const[e,t,i,r]=u(this,xr),[o,l,h,g]=P(this,Iu,u1).call(this);return`M${(u(this,Ye)[2]-e)/i} ${(u(this,Ye)[3]-t)/r} L${(u(this,Ye)[4]-e)/i} ${(u(this,Ye)[5]-t)/r} L${o} ${l} L${h} ${g} L${(u(this,Ye)[16]-e)/i} ${(u(this,Ye)[17]-t)/r} L${(u(this,Ye)[14]-e)/i} ${(u(this,Ye)[15]-t)/r} Z`},cy=new WeakSet,D8=function(e){const t=u(this,bs);e.push(`L${t[4]} ${t[5]} Z`)},uy=new WeakSet,M8=function(e){const[t,i,r,o]=u(this,xr),l=u(this,Ye).subarray(4,6),h=u(this,Ye).subarray(16,18),[g,p,x,y]=P(this,Iu,u1).call(this);e.push(`L${(l[0]-t)/r} ${(l[1]-i)/o} L${g} ${p} L${x} ${y} L${(h[0]-t)/r} ${(h[1]-i)/o}`)},hy=new WeakSet,O8=function(e){const t=u(this,Ye),[i,r,o,l]=u(this,xr),[h,g,p,x]=P(this,Iu,u1).call(this),y=new Float32Array(36);return y.set([NaN,NaN,NaN,NaN,(t[2]-i)/o,(t[3]-r)/l,NaN,NaN,NaN,NaN,(t[4]-i)/o,(t[5]-r)/l,NaN,NaN,NaN,NaN,h,g,NaN,NaN,NaN,NaN,p,x,NaN,NaN,NaN,NaN,(t[16]-i)/o,(t[17]-r)/l,NaN,NaN,NaN,NaN,(t[14]-i)/o,(t[15]-r)/l],0),this.newFreeDrawOutline(y,e,u(this,xr),u(this,Rf),u(this,If),u(this,Nf))},dy=new WeakSet,L8=function(e,t){const i=u(this,bs);return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6},fy=new WeakSet,B8=function(e,t){const i=u(this,Ye).subarray(4,6),r=u(this,Ye).subarray(16,18),[o,l,h,g]=u(this,xr),[p,x,y,v]=P(this,Iu,u1).call(this);return e.set([NaN,NaN,NaN,NaN,(i[0]-o)/h,(i[1]-l)/g,NaN,NaN,NaN,NaN,p,x,NaN,NaN,NaN,NaN,y,v,NaN,NaN,NaN,NaN,(r[0]-o)/h,(r[1]-l)/g],t),t+=24},E(Io,$p,8),E(Io,oy,2),E(Io,ay,u(Io,$p)+u(Io,oy));let W2=Io;var Pf,Nu,sa,Kp,wr,qp,xn,gy,U8;class F8 extends be{constructor(t,i,r,o,l,h){super();E(this,gy);E(this,Pf,void 0);E(this,Nu,new Float32Array(4));E(this,sa,void 0);E(this,Kp,void 0);E(this,wr,void 0);E(this,qp,void 0);E(this,xn,void 0);S(this,xn,t),S(this,wr,i),S(this,Pf,r),S(this,qp,o),S(this,sa,l),S(this,Kp,h),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],P(this,gy,U8).call(this,h);const[g,p,x,y]=u(this,Nu);for(let v=0,C=t.length;v<C;v+=2)t[v]=(t[v]-g)/x,t[v+1]=(t[v+1]-p)/y;for(let v=0,C=i.length;v<C;v+=2)i[v]=(i[v]-g)/x,i[v+1]=(i[v+1]-p)/y}toSVGPath(){const t=[`M${u(this,xn)[4]} ${u(this,xn)[5]}`];for(let i=6,r=u(this,xn).length;i<r;i+=6){if(isNaN(u(this,xn)[i])){t.push(`L${u(this,xn)[i+4]} ${u(this,xn)[i+5]}`);continue}t.push(`C${u(this,xn)[i]} ${u(this,xn)[i+1]} ${u(this,xn)[i+2]} ${u(this,xn)[i+3]} ${u(this,xn)[i+4]} ${u(this,xn)[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,r,o],l){const h=r-t,g=o-i;let p,x;switch(l){case 0:p=be._rescale(u(this,xn),t,o,h,-g),x=be._rescale(u(this,wr),t,o,h,-g);break;case 90:p=be._rescaleAndSwap(u(this,xn),t,i,h,g),x=be._rescaleAndSwap(u(this,wr),t,i,h,g);break;case 180:p=be._rescale(u(this,xn),r,i,-h,g),x=be._rescale(u(this,wr),r,i,-h,g);break;case 270:p=be._rescaleAndSwap(u(this,xn),r,o,-h,-g),x=be._rescaleAndSwap(u(this,wr),r,o,-h,-g);break}return{outline:Array.from(p),points:[Array.from(x)]}}get box(){return u(this,Nu)}newOutliner(t,i,r,o,l,h=0){return new W2(t,i,r,o,l,h)}getNewOutline(t,i){const[r,o,l,h]=u(this,Nu),[g,p,x,y]=u(this,Pf),v=l*x,C=h*y,R=r*x+g,I=o*y+p,O=this.newOutliner({x:u(this,wr)[0]*v+R,y:u(this,wr)[1]*C+I},u(this,Pf),u(this,qp),t,u(this,Kp),i??u(this,sa));for(let _=2;_<u(this,wr).length;_+=2)O.add({x:u(this,wr)[_]*v+R,y:u(this,wr)[_+1]*C+I});return O.getOutlines()}}Pf=new WeakMap,Nu=new WeakMap,sa=new WeakMap,Kp=new WeakMap,wr=new WeakMap,qp=new WeakMap,xn=new WeakMap,gy=new WeakSet,U8=function(t){const i=u(this,xn);let r=i[4],o=i[5];const l=[r,o,r,o];let h=r,g=o,p=r,x=o;const y=t?Math.max:Math.min,v=new Float32Array(4);for(let R=6,I=i.length;R<I;R+=6){const O=i[R+4],_=i[R+5];isNaN(i[R])?(Ae.pointBoundingBox(O,_,l),g>_?(h=O,g=_):g===_&&(h=y(h,O)),x<_?(p=O,x=_):x===_&&(p=y(p,O))):(v[0]=v[1]=1/0,v[2]=v[3]=-1/0,Ae.bezierBoundingBox(r,o,...i.slice(R,R+6),v),Ae.rectBoundingBox(v[0],v[1],v[2],v[3],l),g>v[1]?(h=v[0],g=v[1]):g===v[1]&&(h=y(h,v[0])),x<v[3]?(p=v[2],x=v[3]):x===v[3]&&(p=y(p,v[2]))),r=O,o=_}const C=u(this,Nu);C[0]=l[0]-u(this,sa),C[1]=l[1]-u(this,sa),C[2]=l[2]-l[0]+2*u(this,sa),C[3]=l[3]-l[1]+2*u(this,sa),this.firstPoint=[h,g],this.lastPoint=[p,x]};var Zp,Qp,Jp,bl,Es,py,j8,Df,t2,my,z8,xy,H8,em,xE;class mE{constructor(e,t=0,i=0,r=!0){E(this,py);E(this,Df);E(this,my);E(this,xy);E(this,em);E(this,Zp,void 0);E(this,Qp,void 0);E(this,Jp,void 0);E(this,bl,[]);E(this,Es,[]);const o=[1/0,1/0,-1/0,-1/0],h=10**-4;for(const{x:O,y:_,width:N,height:k}of e){const B=Math.floor((O-t)/h)*h,z=Math.ceil((O+N+t)/h)*h,H=Math.floor((_-t)/h)*h,F=Math.ceil((_+k+t)/h)*h,Y=[B,H,F,!0],W=[z,H,F,!1];u(this,bl).push(Y,W),Ae.rectBoundingBox(B,H,z,F,o)}const g=o[2]-o[0]+2*i,p=o[3]-o[1]+2*i,x=o[0]-i,y=o[1]-i;let v=r?-1/0:1/0,C=1/0;const R=u(this,bl).at(r?-1:-2),I=[R[0],R[2]];for(const O of u(this,bl)){const[_,N,k,B]=O;!B&&r?N<C?(C=N,v=_):N===C&&(v=Math.max(v,_)):B&&!r&&(N<C?(C=N,v=_):N===C&&(v=Math.min(v,_))),O[0]=(_-x)/g,O[1]=(N-y)/p,O[2]=(k-y)/p}S(this,Zp,new Float32Array([x,y,g,p])),S(this,Qp,[v,C]),S(this,Jp,I)}getOutlines(){u(this,bl).sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);const e=[];for(const t of u(this,bl))t[3]?(e.push(...P(this,em,xE).call(this,t)),P(this,my,z8).call(this,t)):(P(this,xy,H8).call(this,t),e.push(...P(this,em,xE).call(this,t)));return P(this,py,j8).call(this,e)}}Zp=new WeakMap,Qp=new WeakMap,Jp=new WeakMap,bl=new WeakMap,Es=new WeakMap,py=new WeakSet,j8=function(e){const t=[],i=new Set;for(const l of e){const[h,g,p]=l;t.push([h,g,l],[h,p,l])}t.sort((l,h)=>l[1]-h[1]||l[0]-h[0]);for(let l=0,h=t.length;l<h;l+=2){const g=t[l][2],p=t[l+1][2];g.push(p),p.push(g),i.add(g),i.add(p)}const r=[];let o;for(;i.size>0;){const l=i.values().next().value;let[h,g,p,x,y]=l;i.delete(l);let v=h,C=g;for(o=[h,p],r.push(o);;){let R;if(i.has(x))R=x;else if(i.has(y))R=y;else break;i.delete(R),[h,g,p,x,y]=R,v!==h&&(o.push(v,C,h,C===g?g:p),v=h),C=C===g?p:g}o.push(v,C)}return new FD(r,u(this,Zp),u(this,Qp),u(this,Jp))},Df=new WeakSet,t2=function(e){const t=u(this,Es);let i=0,r=t.length-1;for(;i<=r;){const o=i+r>>1,l=t[o][0];if(l===e)return o;l<e?i=o+1:r=o-1}return r+1},my=new WeakSet,z8=function([,e,t]){const i=P(this,Df,t2).call(this,e);u(this,Es).splice(i,0,[e,t])},xy=new WeakSet,H8=function([,e,t]){const i=P(this,Df,t2).call(this,e);for(let r=i;r<u(this,Es).length;r++){const[o,l]=u(this,Es)[r];if(o!==e)break;if(o===e&&l===t){u(this,Es).splice(r,1);return}}for(let r=i-1;r>=0;r--){const[o,l]=u(this,Es)[r];if(o!==e)break;if(o===e&&l===t){u(this,Es).splice(r,1);return}}},em=new WeakSet,xE=function(e){const[t,i,r]=e,o=[[t,i,r]],l=P(this,Df,t2).call(this,r);for(let h=0;h<l;h++){const[g,p]=u(this,Es)[h];for(let x=0,y=o.length;x<y;x++){const[,v,C]=o[x];if(!(p<=v||C<=g)){if(v>=g){if(C>p)o[x][1]=p;else{if(y===1)return[];o.splice(x,1),x--,y--}continue}o[x][2]=g,C>p&&o.push([t,p,C])}}}return o};var tm,Mf;class FD extends be{constructor(t,i,r,o){super();E(this,tm,void 0);E(this,Mf,void 0);S(this,Mf,t),S(this,tm,i),this.firstPoint=r,this.lastPoint=o}toSVGPath(){const t=[];for(const i of u(this,Mf)){let[r,o]=i;t.push(`M${r} ${o}`);for(let l=2;l<i.length;l+=2){const h=i[l],g=i[l+1];h===r?(t.push(`V${g}`),o=g):g===o&&(t.push(`H${h}`),r=h)}t.push("Z")}return t.join(" ")}serialize([t,i,r,o],l){const h=[],g=r-t,p=o-i;for(const x of u(this,Mf)){const y=new Array(x.length);for(let v=0;v<x.length;v+=2)y[v]=t+x[v]*g,y[v+1]=o-x[v+1]*p;h.push(y)}return h}get box(){return u(this,tm)}get classNamesForOutlining(){return["highlightOutline"]}}tm=new WeakMap,Mf=new WeakMap;class wE extends W2{newFreeDrawOutline(e,t,i,r,o,l){return new UD(e,t,i,r,o,l)}}class UD extends F8{newOutliner(e,t,i,r,o,l=0){return new wE(e,t,i,r,o,l)}}var Of,nm,oa,Ru,im,$i,rm,sm,ku,yr,Ar,ei,Lf,Bf,mi,Ff,Kr,om,am,yE,Uf,n2,wy,V8,yy,W8,Ay,G8,lm,AE,aa,pc,El,Rh,vy,X8,jf,i2,zf,r2,by,Y8,Ey,$8,Cy,K8,Sy,q8,_y,Z8;const at=class at extends Mt{constructor(t){super({...t,name:"highlightEditor"});E(this,am);E(this,Uf);E(this,wy);E(this,yy);E(this,Ay);E(this,lm);E(this,aa);E(this,vy);E(this,jf);E(this,zf);E(this,by);E(this,Ey);E(this,_y);E(this,Of,null);E(this,nm,0);E(this,oa,void 0);E(this,Ru,null);E(this,im,null);E(this,$i,null);E(this,rm,null);E(this,sm,0);E(this,ku,null);E(this,yr,null);E(this,Ar,null);E(this,ei,!1);E(this,Lf,null);E(this,Bf,null);E(this,mi,null);E(this,Ff,"");E(this,Kr,void 0);E(this,om,"");this.color=t.color||at._defaultColor,S(this,Kr,t.thickness||at._defaultThickness),this.opacity=t.opacity||at._defaultOpacity,S(this,oa,t.boxes||null),S(this,om,t.methodOfCreation||""),S(this,Ff,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(S(this,ei,!0),P(this,Uf,n2).call(this,t),P(this,aa,pc).call(this)):u(this,oa)&&(S(this,Of,t.anchorNode),S(this,nm,t.anchorOffset),S(this,rm,t.focusNode),S(this,sm,t.focusOffset),P(this,am,yE).call(this),P(this,aa,pc).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=at.prototype;return Ve(this,"_keyboardManager",new Mm([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:u(this,ei)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:u(this,Kr),methodOfCreation:u(this,om)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,i){var r;Mt.initialize(t,i),at._defaultColor||(at._defaultColor=((r=i.highlightColors)==null?void 0:r.values().next().value)||"#fff066")}static updateDefaultParams(t,i){switch(t){case Ze.HIGHLIGHT_COLOR:at._defaultColor=i;break;case Ze.HIGHLIGHT_THICKNESS:at._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return u(this,Bf)}get commentButtonPosition(){return u(this,Lf)}updateParams(t,i){switch(t){case Ze.HIGHLIGHT_COLOR:P(this,wy,V8).call(this,i);break;case Ze.HIGHLIGHT_THICKNESS:P(this,yy,W8).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Ze.HIGHLIGHT_COLOR,at._defaultColor],[Ze.HIGHLIGHT_THICKNESS,at._defaultThickness]]}get propertiesToUpdate(){return[[Ze.HIGHLIGHT_COLOR,this.color||at._defaultColor],[Ze.HIGHLIGHT_THICKNESS,u(this,Kr)||at._defaultThickness],[Ze.HIGHLIGHT_FREE,u(this,ei)]]}onUpdatedColor(){var t,i;(t=this.parent)==null||t.drawLayer.updateProperties(u(this,Ar),{root:{fill:this.color,"fill-opacity":this.opacity}}),(i=u(this,im))==null||i.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",S(this,im,new $1({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(P(this,zf,r2).call(this))}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,P(this,zf,r2).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){P(this,lm,AE).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(P(this,aa,pc).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var r;let i=!1;this.parent&&!t?P(this,lm,AE).call(this):t&&(P(this,aa,pc).call(this,t),i=!this.parent&&((r=this.div)==null?void 0:r.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),i&&this.select()}rotate(t){var o,l,h;const{drawLayer:i}=this.parent;let r;u(this,ei)?(t=(t-this.rotation+360)%360,r=P(o=at,El,Rh).call(o,u(this,yr).box,t)):r=P(l=at,El,Rh).call(l,[this.x,this.y,this.width,this.height],t),i.updateProperties(u(this,Ar),{bbox:r,root:{"data-main-rotation":t}}),i.updateProperties(u(this,mi),{bbox:P(h=at,El,Rh).call(h,u(this,$i).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();u(this,Ff)&&(t.setAttribute("aria-label",u(this,Ff)),t.setAttribute("role","mark")),u(this,ei)?t.classList.add("free"):this.div.addEventListener("keydown",P(this,vy,X8).bind(this),{signal:this._uiManager._signal});const i=S(this,ku,document.createElement("div"));return t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=u(this,Ru),this.setDims(this.width,this.height),w4(this,u(this,ku),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(u(this,mi),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(u(this,mi),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:P(this,jf,i2).call(this,!0);break;case 1:case 3:P(this,jf,i2).call(this,!1);break}}select(){var t;super.select(),u(this,mi)&&((t=this.parent)==null||t.drawLayer.updateProperties(u(this,mi),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),u(this,mi)&&((t=this.parent)==null||t.drawLayer.updateProperties(u(this,mi),{rootClass:{selected:!1}}),u(this,ei)||P(this,jf,i2).call(this,!1))}get _mustFixPosition(){return!u(this,ei)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(u(this,Ar),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(u(this,mi),{rootClass:{hidden:!t}}))}static startHighlighting(t,i,{target:r,x:o,y:l}){const{x:h,y:g,width:p,height:x}=r.getBoundingClientRect(),y=new AbortController,v=t.combinedSignal(y),C=R=>{y.abort(),P(this,Sy,q8).call(this,t,R)};window.addEventListener("blur",C,{signal:v}),window.addEventListener("pointerup",C,{signal:v}),window.addEventListener("pointerdown",Zt,{capture:!0,passive:!1,signal:v}),window.addEventListener("contextmenu",Rr,{signal:v}),r.addEventListener("pointermove",P(this,Cy,K8).bind(this,t),{signal:v}),this._freeHighlight=new wE({x:o,y:l},[h,g,p,x],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,i,r){var I,O,_,N;let o=null;if(t instanceof S8){const{data:{quadPoints:k,rect:B,rotation:z,id:H,color:F,opacity:Y,popupRef:W,richText:Z,contentsObj:te,creationDate:ee,modificationDate:le},parent:{page:{pageNumber:ce}}}=t;o=t={annotationType:Be.HIGHLIGHT,color:Array.from(F),opacity:Y,quadPoints:k,boxes:null,pageIndex:ce-1,rect:B.slice(0),rotation:z,annotationElementId:H,id:H,deleted:!1,popupRef:W,richText:Z,comment:(te==null?void 0:te.str)||null,creationDate:ee,modificationDate:le}}else if(t instanceof tS){const{data:{inkLists:k,rect:B,rotation:z,id:H,color:F,borderStyle:{rawWidth:Y},popupRef:W,richText:Z,contentsObj:te,creationDate:ee,modificationDate:le},parent:{page:{pageNumber:ce}}}=t;o=t={annotationType:Be.HIGHLIGHT,color:Array.from(F),thickness:Y,inkLists:k,boxes:null,pageIndex:ce-1,rect:B.slice(0),rotation:z,annotationElementId:H,id:H,deleted:!1,popupRef:W,richText:Z,comment:(te==null?void 0:te.str)||null,creationDate:ee,modificationDate:le}}const{color:l,quadPoints:h,inkLists:g,opacity:p}=t,x=await super.deserialize(t,i,r);x.color=Ae.makeHexColor(...l),x.opacity=p||1,g&&S(x,Kr,t.thickness),x._initialData=o,t.comment&&x.setCommentData(t);const[y,v]=x.pageDimensions,[C,R]=x.pageTranslation;if(h){const k=S(x,oa,[]);for(let B=0;B<h.length;B+=8)k.push({x:(h[B]-C)/y,y:1-(h[B+1]-R)/v,width:(h[B+2]-h[B])/y,height:(h[B+1]-h[B+5])/v});P(I=x,am,yE).call(I),P(O=x,aa,pc).call(O),x.rotate(x.rotation)}else if(g){S(x,ei,!0);const k=g[0],B={x:k[0]-C,y:v-(k[1]-R)},z=new wE(B,[0,0,y,v],1,u(x,Kr)/2,!0,.001);for(let Y=0,W=k.length;Y<W;Y+=2)B.x=k[Y]-C,B.y=v-(k[Y+1]-R),z.add(B);const{id:H,clipPathId:F}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:x.color,"fill-opacity":x._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:z.toSVGPath()}},!0,!0);P(_=x,Uf,n2).call(_,{highlightOutlines:z.getOutlines(),highlightId:H,clipPathId:F}),P(N=x,aa,pc).call(N),x.rotate(x.parentRotation)}return x}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=Mt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),r=super.serialize(t);return Object.assign(r,{color:i,opacity:this.opacity,thickness:u(this,Kr),quadPoints:P(this,by,Y8).call(this),outlines:P(this,Ey,$8).call(this,r.rect)}),this.addComment(r),this.annotationElementId&&!P(this,_y,Z8).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};Of=new WeakMap,nm=new WeakMap,oa=new WeakMap,Ru=new WeakMap,im=new WeakMap,$i=new WeakMap,rm=new WeakMap,sm=new WeakMap,ku=new WeakMap,yr=new WeakMap,Ar=new WeakMap,ei=new WeakMap,Lf=new WeakMap,Bf=new WeakMap,mi=new WeakMap,Ff=new WeakMap,Kr=new WeakMap,om=new WeakMap,am=new WeakSet,yE=function(){const t=new mE(u(this,oa),.001);S(this,yr,t.getOutlines()),[this.x,this.y,this.width,this.height]=u(this,yr).box;const i=new mE(u(this,oa),.0025,.001,this._uiManager.direction==="ltr");S(this,$i,i.getOutlines());const{firstPoint:r}=u(this,yr);S(this,Lf,[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]);const{lastPoint:o}=u(this,$i);S(this,Bf,[(o[0]-this.x)/this.width,(o[1]-this.y)/this.height])},Uf=new WeakSet,n2=function({highlightOutlines:t,highlightId:i,clipPathId:r}){var v,C;S(this,yr,t);const o=1.5;if(S(this,$i,t.getNewOutline(u(this,Kr)/2+o,.0025)),i>=0)S(this,Ar,i),S(this,Ru,r),this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),S(this,mi,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:u(this,$i).box,path:{d:u(this,$i).toSVGPath()}},!0));else if(this.parent){const R=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(u(this,Ar),{bbox:P(v=at,El,Rh).call(v,u(this,yr).box,(R-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(u(this,mi),{bbox:P(C=at,El,Rh).call(C,u(this,$i).box,R),path:{d:u(this,$i).toSVGPath()}})}const[l,h,g,p]=t.box;switch(this.rotation){case 0:this.x=l,this.y=h,this.width=g,this.height=p;break;case 90:{const[R,I]=this.parentDimensions;this.x=h,this.y=1-l,this.width=g*I/R,this.height=p*R/I;break}case 180:this.x=1-l,this.y=1-h,this.width=g,this.height=p;break;case 270:{const[R,I]=this.parentDimensions;this.x=1-h,this.y=l,this.width=g*I/R,this.height=p*R/I;break}}const{firstPoint:x}=t;S(this,Lf,[(x[0]-l)/g,(x[1]-h)/p]);const{lastPoint:y}=u(this,$i);S(this,Bf,[(y[0]-l)/g,(y[1]-h)/p])},wy=new WeakSet,V8=function(t){const i=(l,h)=>{this.color=l,this.opacity=h,this.onUpdatedColor()},r=this.color,o=this.opacity;this.addCommands({cmd:i.bind(this,t,at._defaultOpacity),undo:i.bind(this,r,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ze.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},yy=new WeakSet,W8=function(t){const i=u(this,Kr),r=o=>{S(this,Kr,o),P(this,Ay,G8).call(this,o)};this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ze.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},Ay=new WeakSet,G8=function(t){u(this,ei)&&(P(this,Uf,n2).call(this,{highlightOutlines:u(this,yr).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))},lm=new WeakSet,AE=function(){u(this,Ar)===null||!this.parent||(this.parent.drawLayer.remove(u(this,Ar)),S(this,Ar,null),this.parent.drawLayer.remove(u(this,mi)),S(this,mi,null))},aa=new WeakSet,pc=function(t=this.parent){u(this,Ar)===null&&({id:Tn(this,Ar)._,clipPathId:Tn(this,Ru)._}=t.drawLayer.draw({bbox:u(this,yr).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:u(this,ei)},path:{d:u(this,yr).toSVGPath()}},!1,!0),S(this,mi,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:u(this,ei)},bbox:u(this,$i).box,path:{d:u(this,$i).toSVGPath()}},u(this,ei))),u(this,ku)&&(u(this,ku).style.clipPath=u(this,Ru)))},El=new WeakSet,Rh=function([t,i,r,o],l){switch(l){case 90:return[1-i-o,t,o,r];case 180:return[1-t-r,1-i-o,r,o];case 270:return[i,1-t-r,o,r]}return[t,i,r,o]},vy=new WeakSet,X8=function(t){at._keyboardManager.exec(this,t)},jf=new WeakSet,i2=function(t){if(!u(this,Of))return;const i=window.getSelection();t?i.setPosition(u(this,Of),u(this,nm)):i.setPosition(u(this,rm),u(this,sm))},zf=new WeakSet,r2=function(){return u(this,ei)?this.rotation:0},by=new WeakSet,Y8=function(){if(u(this,ei))return null;const[t,i]=this.pageDimensions,[r,o]=this.pageTranslation,l=u(this,oa),h=new Float32Array(l.length*8);let g=0;for(const{x:p,y:x,width:y,height:v}of l){const C=p*t+r,R=(1-x)*i+o;h[g]=h[g+4]=C,h[g+1]=h[g+3]=R,h[g+2]=h[g+6]=C+y*t,h[g+5]=h[g+7]=R-v*i,g+=8}return h},Ey=new WeakSet,$8=function(t){return u(this,yr).serialize(t,P(this,zf,r2).call(this))},Cy=new WeakSet,K8=function(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},Sy=new WeakSet,q8=function(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},_y=new WeakSet,Z8=function(t){const{color:i}=this._initialData;return this.hasEditedComment||t.color.some((r,o)=>r!==i[o])},E(at,El),E(at,Cy),E(at,Sy),ue(at,"_defaultColor",null),ue(at,"_defaultOpacity",1),ue(at,"_defaultThickness",12),ue(at,"_type","highlight"),ue(at,"_editorType",Be.HIGHLIGHT),ue(at,"_freeHighlightId",-1),ue(at,"_freeHighlight",null),ue(at,"_freeHighlightClipId","");let G2=at;var Pu;class Q8{constructor(){E(this,Pu,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,i]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,i)}updateSVGProperty(e,t){u(this,Pu)[e]=t}toSVGProperties(){const e=u(this,Pu);return S(this,Pu,Object.create(null)),{root:e}}reset(){S(this,Pu,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){It("Not implemented")}}Pu=new WeakMap;var vr,Hf,Fn,Du,Mu,Cl,Sl,_l,Ou,cm,vE,um,bE,hm,EE,Lu,h1,Ty,J8,Vf,s2,Bu,d1,Tl,kh;const _e=class _e extends Mt{constructor(t){super(t);E(this,cm);E(this,um);E(this,hm);E(this,Lu);E(this,Ty);E(this,Vf);E(this,Bu);E(this,Tl);E(this,vr,null);E(this,Hf,void 0);ue(this,"_colorPicker",null);ue(this,"_drawId",null);S(this,Hf,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(P(this,cm,vE).call(this,t),P(this,Lu,h1).call(this))}static _mergeSVGProperties(t,i){const r=new Set(Object.keys(t));for(const[o,l]of Object.entries(i))r.has(o)?Object.assign(t[o],l):t[o]=l;return t}static getDefaultDrawingOptions(t){It("Not implemented")}static get typesMap(){It("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const r=this.typesMap.get(t);r&&this._defaultDrawingOptions.updateProperty(r,i),this._currentParent&&(u(_e,Fn).updateProperty(r,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const r=this.constructor.typesMap.get(t);r&&this._updateProperty(t,r,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[r,o]of this.typesMap)t.push([r,i[o]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[r,o]of this.constructor.typesMap)t.push([r,i[o]]);return t}_updateProperty(t,i,r){const o=this._drawingOptions,l=o[i],h=g=>{var x;o.updateProperty(i,g);const p=u(this,vr).updateProperty(i,g);p&&P(this,Bu,d1).call(this,p),(x=this.parent)==null||x.drawLayer.updateProperties(this._drawId,o.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:h.bind(this,r),undo:h.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties(u(this,vr).getPathResizingSVGProperties(P(this,Vf,s2).call(this)),{bbox:P(this,Tl,kh).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties(u(this,vr).getPathResizedSVGProperties(P(this,Vf,s2).call(this)),{bbox:P(this,Tl,kh).call(this)}))}_onTranslating(t,i){var r;(r=this.parent)==null||r.drawLayer.updateProperties(this._drawId,{bbox:P(this,Tl,kh).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties(u(this,vr).getPathTranslatedSVGProperties(P(this,Vf,s2).call(this),this.parentDimensions),{bbox:P(this,Tl,kh).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,u(this,Hf)&&(S(this,Hf,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){P(this,hm,EE).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(P(this,Lu,h1).call(this),P(this,Bu,d1).call(this,u(this,vr).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var r;let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),P(this,hm,EE).call(this)):t&&(this._uiManager.addShouldRescale(this),P(this,Lu,h1).call(this,t),i=!this.parent&&((r=this.div)==null?void 0:r.classList.contains("selectedEditor"))),super.setParent(t),i&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties({bbox:P(this,Tl,kh).call(this)},u(this,vr).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&P(this,Bu,d1).call(this,u(this,vr).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,i;this._isCopy&&(t=this.x,i=this.y);const r=super.render();r.classList.add("draw");const o=document.createElement("div");return r.append(o),o.setAttribute("aria-hidden","true"),o.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,i),r}static createDrawerInstance(t,i,r,o,l){It("Not implemented")}static startDrawing(t,i,r,o){var O;const{target:l,offsetX:h,offsetY:g,pointerId:p,pointerType:x}=o;if(u(_e,Sl)&&u(_e,Sl)!==x)return;const{viewport:{rotation:y}}=t,{width:v,height:C}=l.getBoundingClientRect(),R=S(_e,Du,new AbortController),I=t.combinedSignal(R);if(u(_e,Cl)||S(_e,Cl,p),u(_e,Sl)??S(_e,Sl,x),window.addEventListener("pointerup",_=>{var N;u(_e,Cl)===_.pointerId?this._endDraw(_):(N=u(_e,_l))==null||N.delete(_.pointerId)},{signal:I}),window.addEventListener("pointercancel",_=>{var N;u(_e,Cl)===_.pointerId?this._currentParent.endDrawingSession():(N=u(_e,_l))==null||N.delete(_.pointerId)},{signal:I}),window.addEventListener("pointerdown",_=>{u(_e,Sl)===_.pointerType&&((u(_e,_l)||S(_e,_l,new Set)).add(_.pointerId),u(_e,Fn).isCancellable()&&(u(_e,Fn).removeLastElement(),u(_e,Fn).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:I}),window.addEventListener("contextmenu",Rr,{signal:I}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:I}),l.addEventListener("touchmove",_=>{_.timeStamp===u(_e,Ou)&&Zt(_)},{signal:I}),t.toggleDrawing(),(O=i._editorUndoBar)==null||O.hide(),u(_e,Fn)){t.drawLayer.updateProperties(this._currentDrawId,u(_e,Fn).startNew(h,g,v,C,y));return}i.updateUIForDefaultProperties(this),S(_e,Fn,this.createDrawerInstance(h,g,v,C,y)),S(_e,Mu,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(u(_e,Mu).toSVGProperties(),u(_e,Fn).defaultSVGProperties),!0,!1)}static _drawMove(t){var l;if(S(_e,Ou,-1),!u(_e,Fn))return;const{offsetX:i,offsetY:r,pointerId:o}=t;if(u(_e,Cl)===o){if(((l=u(_e,_l))==null?void 0:l.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,u(_e,Fn).add(i,r)),S(_e,Ou,t.timeStamp),Zt(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,S(_e,Fn,null),S(_e,Mu,null),S(_e,Sl,null),S(_e,Ou,NaN)),u(_e,Du)&&(u(_e,Du).abort(),S(_e,Du,null),S(_e,Cl,NaN),S(_e,_l,null))}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===i.div&&i.drawLayer.updateProperties(this._currentDrawId,u(_e,Fn).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const r=u(_e,Fn),o=this._currentDrawId,l=r.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(o,r.setLastElement(l))},undo:()=>{i.drawLayer.updateProperties(o,r.removeLastElement())},mustExec:!1,type:Ze.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Ze.DRAW_STEP),!u(_e,Fn).isEmpty()){const{pageDimensions:[r,o],scale:l}=i,h=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:u(_e,Fn).getOutlines(r*l,o*l,l,this._INNER_MARGIN),drawingOptions:u(_e,Mu),mustBeCommitted:!t});return this._cleanup(!0),h}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,r,o,l,h){It("Not implemented")}static async deserialize(t,i,r){var y,v;const{rawDims:{pageWidth:o,pageHeight:l,pageX:h,pageY:g}}=i.viewport,p=this.deserializeDraw(h,g,o,l,this._INNER_MARGIN,t),x=await super.deserialize(t,i,r);return x.createDrawingOptions(t),P(y=x,cm,vE).call(y,{drawOutlines:p}),P(v=x,Lu,h1).call(v),x.onScaleChanging(),x.rotate(),x}serializeDraw(t){const[i,r]=this.pageTranslation,[o,l]=this.pageDimensions;return u(this,vr).serialize([i,r,o,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};vr=new WeakMap,Hf=new WeakMap,Fn=new WeakMap,Du=new WeakMap,Mu=new WeakMap,Cl=new WeakMap,Sl=new WeakMap,_l=new WeakMap,Ou=new WeakMap,cm=new WeakSet,vE=function({drawOutlines:t,drawId:i,drawingOptions:r}){S(this,vr,t),this._drawingOptions||(this._drawingOptions=r),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=P(this,um,bE).call(this,t,this.parent),P(this,Bu,d1).call(this,t.box)},um=new WeakSet,bE=function(t,i){const{id:r}=i.drawLayer.draw(_e._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return r},hm=new WeakSet,EE=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Lu=new WeakSet,h1=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=P(this,um,bE).call(this,u(this,vr),t)}},Ty=new WeakSet,J8=function([t,i,r,o]){const{parentDimensions:[l,h],rotation:g}=this;switch(g){case 90:return[i,1-t,r*(h/l),o*(l/h)];case 180:return[1-t,1-i,r,o];case 270:return[1-i,t,r*(h/l),o*(l/h)];default:return[t,i,r,o]}},Vf=new WeakSet,s2=function(){const{x:t,y:i,width:r,height:o,parentDimensions:[l,h],rotation:g}=this;switch(g){case 90:return[1-i,t,r*(l/h),o*(h/l)];case 180:return[1-t,1-i,r,o];case 270:return[i,1-t,r*(l/h),o*(h/l)];default:return[t,i,r,o]}},Bu=new WeakSet,d1=function(t){[this.x,this.y,this.width,this.height]=P(this,Ty,J8).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},Tl=new WeakSet,kh=function(){const{x:t,y:i,width:r,height:o,rotation:l,parentRotation:h,parentDimensions:[g,p]}=this;switch((l*4+h)/90){case 1:return[1-i-o,t,o,r];case 2:return[1-t-r,1-i-o,r,o];case 3:return[i,1-t-r,o,r];case 4:return[t,i-r*(g/p),o*(p/g),r*(g/p)];case 5:return[1-i,t,r*(g/p),o*(p/g)];case 6:return[1-t-o*(p/g),1-i,o*(p/g),r*(g/p)];case 7:return[i-r*(g/p),1-t-o*(p/g),r*(g/p),o*(p/g)];case 8:return[t-r,i-o,r,o];case 9:return[1-i,t-r,o,r];case 10:return[1-t,1-i,r,o];case 11:return[i-o,1-t,o,r];case 12:return[t-o*(p/g),i,o*(p/g),r*(g/p)];case 13:return[1-i-r*(g/p),t-o*(p/g),r*(g/p),o*(p/g)];case 14:return[1-t,1-i-r*(g/p),o*(p/g),r*(g/p)];case 15:return[i,1-t,r*(g/p),o*(p/g)];default:return[t,i,r,o]}},ue(_e,"_currentDrawId",-1),ue(_e,"_currentParent",null),E(_e,Fn,null),E(_e,Du,null),E(_e,Mu,null),E(_e,Cl,NaN),E(_e,Sl,null),E(_e,_l,null),E(_e,Ou,NaN),ue(_e,"_INNER_MARGIN",3);let X2=_e;var fo,Un,jn,Fu,Wf,Si,ti,qr,Uu,ju,zu,Gf,o2;class jD{constructor(e,t,i,r,o,l){E(this,Gf);E(this,fo,new Float64Array(6));E(this,Un,void 0);E(this,jn,void 0);E(this,Fu,void 0);E(this,Wf,void 0);E(this,Si,void 0);E(this,ti,"");E(this,qr,0);E(this,Uu,new Lm);E(this,ju,void 0);E(this,zu,void 0);S(this,ju,i),S(this,zu,r),S(this,Fu,o),S(this,Wf,l),[e,t]=P(this,Gf,o2).call(this,e,t);const h=S(this,Un,[NaN,NaN,NaN,NaN,e,t]);S(this,Si,[e,t]),S(this,jn,[{line:h,points:u(this,Si)}]),u(this,fo).set(h,0)}updateProperty(e,t){e==="stroke-width"&&S(this,Wf,t)}isEmpty(){return!u(this,jn)||u(this,jn).length===0}isCancellable(){return u(this,Si).length<=10}add(e,t){[e,t]=P(this,Gf,o2).call(this,e,t);const[i,r,o,l]=u(this,fo).subarray(2,6),h=e-o,g=t-l;return Math.hypot(u(this,ju)*h,u(this,zu)*g)<=2?null:(u(this,Si).push(e,t),isNaN(i)?(u(this,fo).set([o,l,e,t],2),u(this,Un).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(u(this,fo)[0])&&u(this,Un).splice(6,6),u(this,fo).set([i,r,o,l,e,t],0),u(this,Un).push(...be.createBezierPoints(i,r,o,l,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const i=this.add(e,t);return i||(u(this,Si).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,i,r,o){S(this,ju,i),S(this,zu,r),S(this,Fu,o),[e,t]=P(this,Gf,o2).call(this,e,t);const l=S(this,Un,[NaN,NaN,NaN,NaN,e,t]);S(this,Si,[e,t]);const h=u(this,jn).at(-1);return h&&(h.line=new Float32Array(h.line),h.points=new Float32Array(h.points)),u(this,jn).push({line:l,points:u(this,Si)}),u(this,fo).set(l,0),S(this,qr,0),this.toSVGPath(),null}getLastElement(){return u(this,jn).at(-1)}setLastElement(e){return u(this,jn)?(u(this,jn).push(e),S(this,Un,e.line),S(this,Si,e.points),S(this,qr,0),{path:{d:this.toSVGPath()}}):u(this,Uu).setLastElement(e)}removeLastElement(){if(!u(this,jn))return u(this,Uu).removeLastElement();u(this,jn).pop(),S(this,ti,"");for(let e=0,t=u(this,jn).length;e<t;e++){const{line:i,points:r}=u(this,jn)[e];S(this,Un,i),S(this,Si,r),S(this,qr,0),this.toSVGPath()}return{path:{d:u(this,ti)}}}toSVGPath(){const e=be.svgRound(u(this,Un)[4]),t=be.svgRound(u(this,Un)[5]);if(u(this,Si).length===2)return S(this,ti,`${u(this,ti)} M ${e} ${t} Z`),u(this,ti);if(u(this,Si).length<=6){const r=u(this,ti).lastIndexOf("M");S(this,ti,`${u(this,ti).slice(0,r)} M ${e} ${t}`),S(this,qr,6)}if(u(this,Si).length===4){const r=be.svgRound(u(this,Un)[10]),o=be.svgRound(u(this,Un)[11]);return S(this,ti,`${u(this,ti)} L ${r} ${o}`),S(this,qr,12),u(this,ti)}const i=[];u(this,qr)===0&&(i.push(`M ${e} ${t}`),S(this,qr,6));for(let r=u(this,qr),o=u(this,Un).length;r<o;r+=6){const[l,h,g,p,x,y]=u(this,Un).slice(r,r+6).map(be.svgRound);i.push(`C${l} ${h} ${g} ${p} ${x} ${y}`)}return S(this,ti,u(this,ti)+i.join(" ")),S(this,qr,u(this,Un).length),u(this,ti)}getOutlines(e,t,i,r){const o=u(this,jn).at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),u(this,Uu).build(u(this,jn),e,t,i,u(this,Fu),u(this,Wf),r),S(this,fo,null),S(this,Un,null),S(this,jn,null),S(this,ti,null),u(this,Uu)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}fo=new WeakMap,Un=new WeakMap,jn=new WeakMap,Fu=new WeakMap,Wf=new WeakMap,Si=new WeakMap,ti=new WeakMap,qr=new WeakMap,Uu=new WeakMap,ju=new WeakMap,zu=new WeakMap,Gf=new WeakSet,o2=function(e,t){return be._normalizePoint(e,t,u(this,ju),u(this,zu),u(this,Fu))};var _i,dm,fm,br,go,po,Xf,Yf,Hu,Cs,Co,Iy,eN,Ny,tN,Ry,nN;class Lm extends be{constructor(){super(...arguments);E(this,Cs);E(this,Iy);E(this,Ny);E(this,Ry);E(this,_i,void 0);E(this,dm,0);E(this,fm,void 0);E(this,br,void 0);E(this,go,void 0);E(this,po,void 0);E(this,Xf,void 0);E(this,Yf,void 0);E(this,Hu,void 0)}build(t,i,r,o,l,h,g){S(this,go,i),S(this,po,r),S(this,Xf,o),S(this,Yf,l),S(this,Hu,h),S(this,fm,g??0),S(this,br,t),P(this,Ny,tN).call(this)}get thickness(){return u(this,Hu)}setLastElement(t){return u(this,br).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return u(this,br).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of u(this,br)){if(t.push(`M${be.svgRound(i[4])} ${be.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12&&isNaN(i[6])){t.push(`L${be.svgRound(i[10])} ${be.svgRound(i[11])}`);continue}for(let r=6,o=i.length;r<o;r+=6){const[l,h,g,p,x,y]=i.subarray(r,r+6).map(be.svgRound);t.push(`C${l} ${h} ${g} ${p} ${x} ${y}`)}}return t.join("")}serialize([t,i,r,o],l){const h=[],g=[],[p,x,y,v]=P(this,Iy,eN).call(this);let C,R,I,O,_,N,k,B,z;switch(u(this,Yf)){case 0:z=be._rescale,C=t,R=i+o,I=r,O=-o,_=t+p*r,N=i+(1-x-v)*o,k=t+(p+y)*r,B=i+(1-x)*o;break;case 90:z=be._rescaleAndSwap,C=t,R=i,I=r,O=o,_=t+x*r,N=i+p*o,k=t+(x+v)*r,B=i+(p+y)*o;break;case 180:z=be._rescale,C=t+r,R=i,I=-r,O=o,_=t+(1-p-y)*r,N=i+x*o,k=t+(1-p)*r,B=i+(x+v)*o;break;case 270:z=be._rescaleAndSwap,C=t+r,R=i+o,I=-r,O=-o,_=t+(1-x-v)*r,N=i+(1-p-y)*o,k=t+(1-x)*r,B=i+(1-p)*o;break}for(const{line:H,points:F}of u(this,br))h.push(z(H,C,R,I,O,l?new Array(H.length):null)),g.push(z(F,C,R,I,O,l?new Array(F.length):null));return{lines:h,points:g,rect:[_,N,k,B]}}static deserialize(t,i,r,o,l,{paths:{lines:h,points:g},rotation:p,thickness:x}){const y=[];let v,C,R,I,O;switch(p){case 0:O=be._rescale,v=-t/r,C=i/o+1,R=1/r,I=-1/o;break;case 90:O=be._rescaleAndSwap,v=-i/o,C=-t/r,R=1/o,I=1/r;break;case 180:O=be._rescale,v=t/r+1,C=-i/o,R=-1/r,I=1/o;break;case 270:O=be._rescaleAndSwap,v=i/o+1,C=t/r+1,R=-1/o,I=-1/r;break}if(!h){h=[];for(const N of g){const k=N.length;if(k===2){h.push(new Float32Array([NaN,NaN,NaN,NaN,N[0],N[1]]));continue}if(k===4){h.push(new Float32Array([NaN,NaN,NaN,NaN,N[0],N[1],NaN,NaN,NaN,NaN,N[2],N[3]]));continue}const B=new Float32Array(3*(k-2));h.push(B);let[z,H,F,Y]=N.subarray(0,4);B.set([NaN,NaN,NaN,NaN,z,H],0);for(let W=4;W<k;W+=2){const Z=N[W],te=N[W+1];B.set(be.createBezierPoints(z,H,F,Y,Z,te),(W-2)*3),[z,H,F,Y]=[F,Y,Z,te]}}}for(let N=0,k=h.length;N<k;N++)y.push({line:O(h[N].map(B=>B??NaN),v,C,R,I),points:O(g[N].map(B=>B??NaN),v,C,R,I)});const _=new this.prototype.constructor;return _.build(y,r,o,1,p,x,l),_}get box(){return u(this,_i)}updateProperty(t,i){return t==="stroke-width"?P(this,Ry,nN).call(this,i):null}updateParentDimensions([t,i],r){const[o,l]=P(this,Cs,Co).call(this);S(this,go,t),S(this,po,i),S(this,Xf,r);const[h,g]=P(this,Cs,Co).call(this),p=h-o,x=g-l,y=u(this,_i);return y[0]-=p,y[1]-=x,y[2]+=2*p,y[3]+=2*x,y}updateRotation(t){return S(this,dm,t),{path:{transform:this.rotationTransform}}}get viewBox(){return u(this,_i).map(be.svgRound).join(" ")}get defaultProperties(){const[t,i]=u(this,_i);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${be.svgRound(t)} ${be.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=u(this,_i);let r=0,o=0,l=0,h=0,g=0,p=0;switch(u(this,dm)){case 90:o=i/t,l=-t/i,g=t;break;case 180:r=-1,h=-1,g=t,p=i;break;case 270:o=-i/t,l=t/i,p=i;break;default:return""}return`matrix(${r} ${o} ${l} ${h} ${be.svgRound(g)} ${be.svgRound(p)})`}getPathResizingSVGProperties([t,i,r,o]){const[l,h]=P(this,Cs,Co).call(this),[g,p,x,y]=u(this,_i);if(Math.abs(x-l)<=be.PRECISION||Math.abs(y-h)<=be.PRECISION){const O=t+r/2-(g+x/2),_=i+o/2-(p+y/2);return{path:{"transform-origin":`${be.svgRound(t)} ${be.svgRound(i)}`,transform:`${this.rotationTransform} translate(${O} ${_})`}}}const v=(r-2*l)/(x-2*l),C=(o-2*h)/(y-2*h),R=x/r,I=y/o;return{path:{"transform-origin":`${be.svgRound(g)} ${be.svgRound(p)}`,transform:`${this.rotationTransform} scale(${R} ${I}) translate(${be.svgRound(l)} ${be.svgRound(h)}) scale(${v} ${C}) translate(${be.svgRound(-l)} ${be.svgRound(-h)})`}}}getPathResizedSVGProperties([t,i,r,o]){const[l,h]=P(this,Cs,Co).call(this),g=u(this,_i),[p,x,y,v]=g;if(g[0]=t,g[1]=i,g[2]=r,g[3]=o,Math.abs(y-l)<=be.PRECISION||Math.abs(v-h)<=be.PRECISION){const _=t+r/2-(p+y/2),N=i+o/2-(x+v/2);for(const{line:k,points:B}of u(this,br))be._translate(k,_,N,k),be._translate(B,_,N,B);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${be.svgRound(t)} ${be.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const C=(r-2*l)/(y-2*l),R=(o-2*h)/(v-2*h),I=-C*(p+l)+t+l,O=-R*(x+h)+i+h;if(C!==1||R!==1||I!==0||O!==0)for(const{line:_,points:N}of u(this,br))be._rescale(_,I,O,C,R,_),be._rescale(N,I,O,C,R,N);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${be.svgRound(t)} ${be.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],r){const[o,l]=r,h=u(this,_i),g=t-h[0],p=i-h[1];if(u(this,go)===o&&u(this,po)===l)for(const{line:x,points:y}of u(this,br))be._translate(x,g,p,x),be._translate(y,g,p,y);else{const x=u(this,go)/o,y=u(this,po)/l;S(this,go,o),S(this,po,l);for(const{line:v,points:C}of u(this,br))be._rescale(v,g,p,x,y,v),be._rescale(C,g,p,x,y,C);h[2]*=x,h[3]*=y}return h[0]=t,h[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${be.svgRound(t)} ${be.svgRound(i)}`}}}get defaultSVGProperties(){const t=u(this,_i);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${be.svgRound(t[0])} ${be.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}_i=new WeakMap,dm=new WeakMap,fm=new WeakMap,br=new WeakMap,go=new WeakMap,po=new WeakMap,Xf=new WeakMap,Yf=new WeakMap,Hu=new WeakMap,Cs=new WeakSet,Co=function(t=u(this,Hu)){const i=u(this,fm)+t/2*u(this,Xf);return u(this,Yf)%180===0?[i/u(this,go),i/u(this,po)]:[i/u(this,po),i/u(this,go)]},Iy=new WeakSet,eN=function(){const[t,i,r,o]=u(this,_i),[l,h]=P(this,Cs,Co).call(this,0);return[t+l,i+h,r-2*l,o-2*h]},Ny=new WeakSet,tN=function(){const t=S(this,_i,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:o}of u(this,br)){if(o.length<=12){for(let g=4,p=o.length;g<p;g+=6)Ae.pointBoundingBox(o[g],o[g+1],t);continue}let l=o[4],h=o[5];for(let g=6,p=o.length;g<p;g+=6){const[x,y,v,C,R,I]=o.subarray(g,g+6);Ae.bezierBoundingBox(l,h,x,y,v,C,R,I,t),l=R,h=I}}const[i,r]=P(this,Cs,Co).call(this);t[0]=xi(t[0]-i,0,1),t[1]=xi(t[1]-r,0,1),t[2]=xi(t[2]+i,0,1),t[3]=xi(t[3]+r,0,1),t[2]-=t[0],t[3]-=t[1]},Ry=new WeakSet,nN=function(t){const[i,r]=P(this,Cs,Co).call(this);S(this,Hu,t);const[o,l]=P(this,Cs,Co).call(this),[h,g]=[o-i,l-r],p=u(this,_i);return p[0]-=h,p[1]-=g,p[2]+=2*h,p[3]+=2*g,p};class cA extends Q8{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Mt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new cA(this._viewParameters);return e.updateAll(this),e}}var ky,iN;const qh=class qh extends X2{constructor(t){super({...t,name:"inkEditor"});E(this,ky);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,i){Mt.initialize(t,i),this._defaultDrawingOptions=new cA(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ve(this,"typesMap",new Map([[Ze.INK_THICKNESS,"stroke-width"],[Ze.INK_COLOR,"stroke"],[Ze.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,r,o,l){return new jD(t,i,r,o,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,r,o,l,h){return Lm.deserialize(t,i,r,o,l,h)}static async deserialize(t,i,r){let o=null;if(t instanceof tS){const{data:{inkLists:h,rect:g,rotation:p,id:x,color:y,opacity:v,borderStyle:{rawWidth:C},popupRef:R,richText:I,contentsObj:O,creationDate:_,modificationDate:N},parent:{page:{pageNumber:k}}}=t;o=t={annotationType:Be.INK,color:Array.from(y),thickness:C,opacity:v,paths:{points:h},boxes:null,pageIndex:k-1,rect:g.slice(0),rotation:p,annotationElementId:x,id:x,deleted:!1,popupRef:R,richText:I,comment:(O==null?void 0:O.str)||null,creationDate:_,modificationDate:N}}const l=await super.deserialize(t,i,r);return l._initialData=o,t.comment&&l.setCommentData(t),l}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new V2(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Ze.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:r}=this;i.updateSVGProperty("stroke-width"),r.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:r}){this._drawingOptions=qh.getDefaultDrawingOptions({stroke:Ae.makeHexColor(...t),"stroke-width":i,"stroke-opacity":r})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:r}=this.serializeDraw(t),{_drawingOptions:{stroke:o,"stroke-opacity":l,"stroke-width":h}}=this,g=Object.assign(super.serialize(t),{color:Mt._colorManager.convert(o),opacity:l,thickness:h,paths:{lines:i,points:r}});return this.addComment(g),t?(g.isCopy=!0,g):this.annotationElementId&&!P(this,ky,iN).call(this,g)?null:(g.id=this.annotationElementId,g)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:i,rect:r}=this.serializeDraw(!1);return t.updateEdited({rect:r,thickness:this._drawingOptions["stroke-width"],points:i,popup:this.comment}),null}};ky=new WeakSet,iN=function(t){const{color:i,thickness:r,opacity:o,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((h,g)=>h!==i[g])||t.thickness!==r||t.opacity!==o||t.pageIndex!==l},ue(qh,"_type","ink"),ue(qh,"_editorType",Be.INK),ue(qh,"_defaultDrawingOptions",null);let CE=qh;class SE extends Lm{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Ax=8,H0=3;var Vu,gm,_E,Ss,Py,rN,Dy,sN,pm,TE,$f,a2,My,oN,Oy,aN,Ly,lN,mm,IE,xm,NE,By,cN;class bn{static extractContoursFromText(e,{fontFamily:t,fontStyle:i,fontWeight:r},o,l,h,g){let p=new OffscreenCanvas(1,1),x=p.getContext("2d",{alpha:!1});const y=200,v=x.font=`${i} ${r} ${y}px ${t}`,{actualBoundingBoxLeft:C,actualBoundingBoxRight:R,actualBoundingBoxAscent:I,actualBoundingBoxDescent:O,fontBoundingBoxAscent:_,fontBoundingBoxDescent:N,width:k}=x.measureText(e),B=1.5,z=Math.ceil(Math.max(Math.abs(C)+Math.abs(R)||0,k)*B),H=Math.ceil(Math.max(Math.abs(I)+Math.abs(O)||y,Math.abs(_)+Math.abs(N)||y)*B);p=new OffscreenCanvas(z,H),x=p.getContext("2d",{alpha:!0,willReadFrequently:!0}),x.font=v,x.filter="grayscale(1)",x.fillStyle="white",x.fillRect(0,0,z,H),x.fillStyle="black",x.fillText(e,z*(B-1)/2,H*(3-B)/2);const F=P(this,mm,IE).call(this,x.getImageData(0,0,z,H).data),Y=P(this,Ly,lN).call(this,F),W=P(this,xm,NE).call(this,Y),Z=P(this,pm,TE).call(this,F,z,H,W);return this.processDrawnLines({lines:{curves:Z,width:z,height:H},pageWidth:o,pageHeight:l,rotation:h,innerMargin:g,mustSmooth:!0,areContours:!0})}static process(e,t,i,r,o){const[l,h,g]=P(this,By,cN).call(this,e),[p,x]=P(this,Oy,aN).call(this,l,h,g,Math.hypot(h,g)*u(this,Vu).sigmaSFactor,u(this,Vu).sigmaR,u(this,Vu).kernelSize),y=P(this,xm,NE).call(this,x),v=P(this,pm,TE).call(this,p,h,g,y);return this.processDrawnLines({lines:{curves:v,width:h,height:g},pageWidth:t,pageHeight:i,rotation:r,innerMargin:o,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:i,rotation:r,innerMargin:o,mustSmooth:l,areContours:h}){r%180!==0&&([t,i]=[i,t]);const{curves:g,width:p,height:x}=e,y=e.thickness??0,v=[],C=Math.min(t/p,i/x),R=C/t,I=C/i,O=[];for(const{points:N}of g){const k=l?P(this,My,oN).call(this,N):N;if(!k)continue;O.push(k);const B=k.length,z=new Float32Array(B),H=new Float32Array(3*(B===2?2:B-2));if(v.push({line:H,points:z}),B===2){z[0]=k[0]*R,z[1]=k[1]*I,H.set([NaN,NaN,NaN,NaN,z[0],z[1]],0);continue}let[F,Y,W,Z]=k;F*=R,Y*=I,W*=R,Z*=I,z.set([F,Y,W,Z],0),H.set([NaN,NaN,NaN,NaN,F,Y],0);for(let te=4;te<B;te+=2){const ee=z[te]=k[te]*R,le=z[te+1]=k[te+1]*I;H.set(be.createBezierPoints(F,Y,W,Z,ee,le),(te-2)*3),[F,Y,W,Z]=[W,Z,ee,le]}}if(v.length===0)return null;const _=h?new SE:new Lm;return _.build(v,t,i,1,r,h?0:y,o),{outline:_,newCurves:O,areContours:h,thickness:y,width:p,height:x}}static async compressSignature({outlines:e,areContours:t,thickness:i,width:r,height:o}){let l=1/0,h=-1/0,g=0;for(const k of e){g+=k.length;for(let B=2,z=k.length;B<z;B++){const H=k[B]-k[B-2];l=Math.min(l,H),h=Math.max(h,H)}}let p;l>=-128&&h<=127?p=Int8Array:l>=-32768&&h<=32767?p=Int16Array:p=Int32Array;const x=e.length,y=Ax+H0*x,v=new Uint32Array(y);let C=0;v[C++]=y*Uint32Array.BYTES_PER_ELEMENT+(g-2*x)*p.BYTES_PER_ELEMENT,v[C++]=0,v[C++]=r,v[C++]=o,v[C++]=t?0:1,v[C++]=Math.max(0,Math.floor(i??0)),v[C++]=x,v[C++]=p.BYTES_PER_ELEMENT;for(const k of e)v[C++]=k.length-2,v[C++]=k[0],v[C++]=k[1];const R=new CompressionStream("deflate-raw"),I=R.writable.getWriter();await I.ready,I.write(v);const O=p.prototype.constructor;for(const k of e){const B=new O(k.length-2);for(let z=2,H=k.length;z<H;z++)B[z-2]=k[z]-k[z-2];I.write(B)}I.close();const _=await new Response(R.readable).arrayBuffer(),N=new Uint8Array(_);return o4(N)}static async decompressSignature(e){try{const t=h6(e),{readable:i,writable:r}=new DecompressionStream("deflate-raw"),o=r.getWriter();await o.ready,o.write(t).then(async()=>{await o.ready,await o.close()}).catch(()=>{});let l=null,h=0;for await(const k of i)l||(l=new Uint8Array(new Uint32Array(k.buffer,0,4)[0])),l.set(k,h),h+=k.length;const g=new Uint32Array(l.buffer,0,l.length>>2),p=g[1];if(p!==0)throw new Error(`Invalid version: ${p}`);const x=g[2],y=g[3],v=g[4]===0,C=g[5],R=g[6],I=g[7],O=[],_=(Ax+H0*R)*Uint32Array.BYTES_PER_ELEMENT;let N;switch(I){case Int8Array.BYTES_PER_ELEMENT:N=new Int8Array(l.buffer,_);break;case Int16Array.BYTES_PER_ELEMENT:N=new Int16Array(l.buffer,_);break;case Int32Array.BYTES_PER_ELEMENT:N=new Int32Array(l.buffer,_);break}h=0;for(let k=0;k<R;k++){const B=g[H0*k+Ax],z=new Float32Array(B+2);O.push(z);for(let H=0;H<H0-1;H++)z[H]=g[H0*k+Ax+H+1];for(let H=0;H<B;H++)z[H+2]=z[H]+N[h++]}return{areContours:v,thickness:C,outlines:O,width:x,height:y}}catch(t){return Fe(`decompressSignature: ${t}`),null}}}Vu=new WeakMap,gm=new WeakSet,_E=function(e,t,i,r){return i-=e,r-=t,i===0?r>0?0:4:i===1?r+6:2-r},Ss=new WeakMap,Py=new WeakSet,rN=function(e,t,i,r,o,l,h){const g=P(this,gm,_E).call(this,i,r,o,l);for(let p=0;p<8;p++){const x=(-p+g-h+16)%8,y=u(this,Ss)[2*x],v=u(this,Ss)[2*x+1];if(e[(i+y)*t+(r+v)]!==0)return x}return-1},Dy=new WeakSet,sN=function(e,t,i,r,o,l,h){const g=P(this,gm,_E).call(this,i,r,o,l);for(let p=0;p<8;p++){const x=(p+g+h+16)%8,y=u(this,Ss)[2*x],v=u(this,Ss)[2*x+1];if(e[(i+y)*t+(r+v)]!==0)return x}return-1},pm=new WeakSet,TE=function(e,t,i,r){const o=e.length,l=new Int32Array(o);for(let x=0;x<o;x++)l[x]=e[x]<=r?1:0;for(let x=1;x<i-1;x++)l[x*t]=l[x*t+t-1]=0;for(let x=0;x<t;x++)l[x]=l[t*i-1-x]=0;let h=1,g;const p=[];for(let x=1;x<i-1;x++){g=1;for(let y=1;y<t-1;y++){const v=x*t+y,C=l[v];if(C===0)continue;let R=x,I=y;if(C===1&&l[v-1]===0)h+=1,I-=1;else if(C>=1&&l[v+1]===0)h+=1,I+=1,C>1&&(g=C);else{C!==1&&(g=Math.abs(C));continue}const O=[y,x],_=I===y+1,N={isHole:_,points:O,id:h,parent:0};p.push(N);let k;for(const te of p)if(te.id===g){k=te;break}k?k.isHole?N.parent=_?k.parent:g:N.parent=_?g:k.parent:N.parent=_?g:0;const B=P(this,Py,rN).call(this,l,t,x,y,R,I,0);if(B===-1){l[v]=-h,l[v]!==1&&(g=Math.abs(l[v]));continue}let z=u(this,Ss)[2*B],H=u(this,Ss)[2*B+1];const F=x+z,Y=y+H;R=F,I=Y;let W=x,Z=y;for(;;){const te=P(this,Dy,sN).call(this,l,t,W,Z,R,I,1);z=u(this,Ss)[2*te],H=u(this,Ss)[2*te+1];const ee=W+z,le=Z+H;O.push(le,ee);const ce=W*t+Z;if(l[ce+1]===0?l[ce]=-h:l[ce]===1&&(l[ce]=h),ee===x&&le===y&&W===F&&Z===Y){l[v]!==1&&(g=Math.abs(l[v]));break}else R=W,I=Z,W=ee,Z=le}}}return p},$f=new WeakSet,a2=function(e,t,i,r){if(i-t<=4){for(let F=t;F<i-2;F+=2)r.push(e[F],e[F+1]);return}const o=e[t],l=e[t+1],h=e[i-4]-o,g=e[i-3]-l,p=Math.hypot(h,g),x=h/p,y=g/p,v=x*l-y*o,C=g/h,R=1/p,I=Math.atan(C),O=Math.cos(I),_=Math.sin(I),N=R*(Math.abs(O)+Math.abs(_)),k=R*(1-N+N**2),B=Math.max(Math.atan(Math.abs(_+O)*k),Math.atan(Math.abs(_-O)*k));let z=0,H=t;for(let F=t+2;F<i-2;F+=2){const Y=Math.abs(v-x*e[F+1]+y*e[F]);Y>z&&(H=F,z=Y)}z>(p*B)**2?(P(this,$f,a2).call(this,e,t,H+2,r),P(this,$f,a2).call(this,e,H,i,r)):r.push(o,l)},My=new WeakSet,oN=function(e){const t=[],i=e.length;return P(this,$f,a2).call(this,e,0,i,t),t.push(e[i-2],e[i-1]),t.length<=4?null:t},Oy=new WeakSet,aN=function(e,t,i,r,o,l){const h=new Float32Array(l**2),g=-2*r**2,p=l>>1;for(let I=0;I<l;I++){const O=(I-p)**2;for(let _=0;_<l;_++)h[I*l+_]=Math.exp((O+(_-p)**2)/g)}const x=new Float32Array(256),y=-2*o**2;for(let I=0;I<256;I++)x[I]=Math.exp(I**2/y);const v=e.length,C=new Uint8Array(v),R=new Uint32Array(256);for(let I=0;I<i;I++)for(let O=0;O<t;O++){const _=I*t+O,N=e[_];let k=0,B=0;for(let H=0;H<l;H++){const F=I+H-p;if(!(F<0||F>=i))for(let Y=0;Y<l;Y++){const W=O+Y-p;if(W<0||W>=t)continue;const Z=e[F*t+W],te=h[H*l+Y]*x[Math.abs(Z-N)];k+=Z*te,B+=te}}const z=C[_]=Math.round(k/B);R[z]++}return[C,R]},Ly=new WeakSet,lN=function(e){const t=new Uint32Array(256);for(const i of e)t[i]++;return t},mm=new WeakSet,IE=function(e){const t=e.length,i=new Uint8ClampedArray(t>>2);let r=-1/0,o=1/0;for(let h=0,g=i.length;h<g;h++){const p=i[h]=e[h<<2];r=Math.max(r,p),o=Math.min(o,p)}const l=255/(r-o);for(let h=0,g=i.length;h<g;h++)i[h]=(i[h]-o)*l;return i},xm=new WeakSet,NE=function(e){let t,i=-1/0,r=-1/0;const o=e.findIndex(g=>g!==0);let l=o,h=o;for(t=o;t<256;t++){const g=e[t];g>i&&(t-l>r&&(r=t-l,h=t-1),i=g,l=t)}for(t=h-1;t>=0&&!(e[t]>e[t+1]);t--);return t},By=new WeakSet,cN=function(e){const t=e,{width:i,height:r}=e,{maxDim:o}=u(this,Vu);let l=i,h=r;if(i>o||r>o){let v=i,C=r,R=Math.log2(Math.max(i,r)/o);const I=Math.floor(R);R=R===I?I-1:I;for(let _=0;_<R;_++){l=Math.ceil(v/2),h=Math.ceil(C/2);const N=new OffscreenCanvas(l,h);N.getContext("2d").drawImage(e,0,0,v,C,0,0,l,h),v=l,C=h,e!==t&&e.close(),e=N.transferToImageBitmap()}const O=Math.min(o/l,o/h);l=Math.round(l*O),h=Math.round(h*O)}const p=new OffscreenCanvas(l,h).getContext("2d",{willReadFrequently:!0});p.fillStyle="white",p.fillRect(0,0,l,h),p.filter="grayscale(1)",p.drawImage(e,0,0,e.width,e.height,0,0,l,h);const x=p.getImageData(0,0,l,h).data;return[P(this,mm,IE).call(this,x),l,h]},E(bn,gm),E(bn,Py),E(bn,Dy),E(bn,pm),E(bn,$f),E(bn,My),E(bn,Oy),E(bn,Ly),E(bn,mm),E(bn,xm),E(bn,By),E(bn,Vu,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),E(bn,Ss,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class iS extends Q8{constructor(){super(),super.updateProperties({fill:Mt._defaultLineColor,"stroke-width":0})}clone(){const e=new iS;return e.updateAll(this),e}}class rS extends cA{constructor(e){super(e),super.updateProperties({stroke:Mt._defaultLineColor,"stroke-width":1})}clone(){const e=new rS(this._viewParameters);return e.updateAll(this),e}}var Il,mo,Nl,Wu;const sr=class sr extends X2{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});E(this,Il,!1);E(this,mo,null);E(this,Nl,null);E(this,Wu,null);this._willKeepAspectRatio=!0,S(this,Nl,t.signatureData||null),S(this,mo,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,i){Mt.initialize(t,i),this._defaultDrawingOptions=new iS,this._defaultDrawnSignatureOptions=new rS(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return Ve(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!u(this,mo)}}static computeTelemetryFinalData(t){const i=t.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,i;const{_isCopy:r}=this;if(r&&(this._isCopy=!1,t=this.x,i=this.y),super.render(),this._drawId===null)if(u(this,Nl)){const{lines:o,mustSmooth:l,areContours:h,description:g,uuid:p,heightInPage:x}=u(this,Nl),{rawDims:{pageWidth:y,pageHeight:v},rotation:C}=this.parent.viewport,R=bn.processDrawnLines({lines:o,pageWidth:y,pageHeight:v,rotation:C,innerMargin:sr._INNER_MARGIN,mustSmooth:l,areContours:h});this.addSignature(R,x,g,p)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:u(this,mo)||""}));return r&&(this._isCopy=!0,this._moveAfterPaste(t,i)),this.div}setUuid(t){S(this,Wu,t),this.addEditToolbar()}getUuid(){return u(this,Wu)}get description(){return u(this,mo)}set description(t){S(this,mo,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(i=>{i==null||i.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:i,thickness:r,width:o,height:l}=u(this,Nl),h=Math.max(o,l),g=bn.processDrawnLines({lines:{curves:t.map(p=>({points:p})),thickness:r,width:o,height:l},pageWidth:h,pageHeight:h,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:g.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,i,r,o){const{x:l,y:h}=this,{outline:g}=S(this,Nl,t);S(this,Il,g instanceof SE),this.description=r;let p;u(this,Il)?p=sr.getDefaultDrawingOptions():(p=sr._defaultDrawnSignatureOptions.clone(),p.updateProperties({"stroke-width":g.thickness})),this._addOutlines({drawOutlines:g,drawingOptions:p});const[,x]=this.pageDimensions;let y=i/x;y=y>=1?.5:y,this.width*=y/this.height,this.width>=1&&(y*=.9/this.width,this.width=.9),this.height=y,this.setDims(),this.x=l,this.y=h,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(o),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!o,hasDescription:!!r}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:i,pageHeight:r},rotation:o}=this.parent.viewport;return bn.process(t,i,r,o,sr._INNER_MARGIN)}getFromText(t,i){const{rawDims:{pageWidth:r,pageHeight:o},rotation:l}=this.parent.viewport;return bn.extractContoursFromText(t,i,r,o,l,sr._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:i,pageHeight:r},rotation:o}=this.parent.viewport;return bn.processDrawnLines({lines:t,pageWidth:i,pageHeight:r,rotation:o,innerMargin:sr._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:i}){t?this._drawingOptions=sr.getDefaultDrawingOptions():(this._drawingOptions=sr._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:i,points:r}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":o}}=this,l=Object.assign(super.serialize(t),{isSignature:!0,areContours:u(this,Il),color:[0,0,0],thickness:u(this,Il)?0:o});return this.addComment(l),t?(l.paths={lines:i,points:r},l.uuid=u(this,Wu),l.isCopy=!0):l.lines=i,u(this,mo)&&(l.accessibilityData={type:"Figure",alt:u(this,mo)}),l}static deserializeDraw(t,i,r,o,l,h){return h.areContours?SE.deserialize(t,i,r,o,l,h):Lm.deserialize(t,i,r,o,l,h)}static async deserialize(t,i,r){var l;const o=await super.deserialize(t,i,r);return S(o,Il,t.areContours),o.description=((l=t.accessibilityData)==null?void 0:l.alt)||"",S(o,Wu,t.uuid),o}};Il=new WeakMap,mo=new WeakMap,Nl=new WeakMap,Wu=new WeakMap,ue(sr,"_type","signature"),ue(sr,"_editorType",Be.SIGNATURE),ue(sr,"_defaultDrawingOptions",null);let RE=sr;var Vt,zn,Rl,la,kl,Kf,ca,Gu,xo,Er,qf,Xu,f1,Yu,g1,Zf,l2,Qf,c2,Jf,u2,wm,PE,e0,h2,Fy,uN;class kE extends Mt{constructor(t){super({...t,name:"stampEditor"});E(this,Xu);E(this,Yu);E(this,Zf);E(this,Qf);E(this,Jf);E(this,wm);E(this,e0);E(this,Fy);E(this,Vt,null);E(this,zn,null);E(this,Rl,null);E(this,la,null);E(this,kl,null);E(this,Kf,"");E(this,ca,null);E(this,Gu,!1);E(this,xo,null);E(this,Er,!1);E(this,qf,!1);S(this,la,t.bitmapUrl),S(this,kl,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,i){Mt.initialize(t,i)}static isHandlingMimeForPasting(t){return F2.includes(t)}static paste(t,i){i.pasteEditor({mode:Be.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:r}=this._uiManager;if(!r)throw new Error("No ML.");if(!await r.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:o,width:l,height:h}=t||this.copyCanvas(null,null,!0).imageData,g=await r.guess({name:"altText",request:{data:o,width:l,height:h,channels:o.length/(l*h)}});if(!g)throw new Error("No response from the AI service.");if(g.error)throw new Error("Error from the AI service.");if(g.cancel)return null;if(!g.output)throw new Error("No valid response from the AI service.");const p=g.output;return await this.setGuessedAltText(p),i&&!this.hasAltTextData()&&(this.altTextData={alt:p,decorative:!1}),p}remove(){var t;u(this,zn)&&(S(this,Vt,null),this._uiManager.imageManager.deleteId(u(this,zn)),(t=u(this,ca))==null||t.remove(),S(this,ca,null),u(this,xo)&&(clearTimeout(u(this,xo)),S(this,xo,null))),super.remove()}rebuild(){if(!this.parent){u(this,zn)&&P(this,Zf,l2).call(this);return}super.rebuild(),this.div!==null&&(u(this,zn)&&u(this,ca)===null&&P(this,Zf,l2).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(u(this,Rl)||u(this,Vt)||u(this,la)||u(this,kl)||u(this,zn)||u(this,Gu))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;return this._isCopy&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.createAltText(),u(this,Gu)||(u(this,Vt)?P(this,Qf,c2).call(this):P(this,Zf,l2).call(this)),this._isCopy&&this._moveAfterPaste(t,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,i){const{id:r,bitmap:o}=this._uiManager.imageManager.getFromCanvas(t,i);i.remove(),r&&this._uiManager.imageManager.isValidId(r)&&(S(this,zn,r),o&&S(this,Vt,o),S(this,Gu,!1),P(this,Qf,c2).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;u(this,xo)!==null&&clearTimeout(u(this,xo)),S(this,xo,setTimeout(()=>{S(this,xo,null),P(this,wm,PE).call(this)},200))}copyCanvas(t,i,r=!1){t||(t=224);const{width:o,height:l}=u(this,Vt),h=new Ms;let g=u(this,Vt),p=o,x=l,y=null;if(i){if(o>i||l>i){const F=Math.min(i/o,i/l);p=Math.floor(o*F),x=Math.floor(l*F)}y=document.createElement("canvas");const C=y.width=Math.ceil(p*h.sx),R=y.height=Math.ceil(x*h.sy);u(this,Er)||(g=P(this,Jf,u2).call(this,C,R));const I=y.getContext("2d");I.filter=this._uiManager.hcmFilter;let O="white",_="#cfcfd8";this._uiManager.hcmFilter!=="none"?_="black":g6.isDarkMode&&(O="#8f8f9d",_="#42414d");const N=15,k=N*h.sx,B=N*h.sy,z=new OffscreenCanvas(k*2,B*2),H=z.getContext("2d");H.fillStyle=O,H.fillRect(0,0,k*2,B*2),H.fillStyle=_,H.fillRect(0,0,k,B),H.fillRect(k,B,k,B),I.fillStyle=I.createPattern(z,"repeat"),I.fillRect(0,0,C,R),I.drawImage(g,0,0,g.width,g.height,0,0,C,R)}let v=null;if(r){let C,R;if(h.symmetric&&g.width<t&&g.height<t)C=g.width,R=g.height;else if(g=u(this,Vt),o>t||l>t){const _=Math.min(t/o,t/l);C=Math.floor(o*_),R=Math.floor(l*_),u(this,Er)||(g=P(this,Jf,u2).call(this,C,R))}const O=new OffscreenCanvas(C,R).getContext("2d",{willReadFrequently:!0});O.drawImage(g,0,0,g.width,g.height,0,0,C,R),v={width:C,height:R,data:O.getImageData(0,0,C,R).data}}return{canvas:y,width:p,height:x,imageData:v}}static async deserialize(t,i,r){var O;let o=null,l=!1;if(t instanceof _8){const{data:{rect:_,rotation:N,id:k,structParent:B,popupRef:z,richText:H,contentsObj:F,creationDate:Y,modificationDate:W},container:Z,parent:{page:{pageNumber:te}},canvas:ee}=t;let le,ce;ee?(delete t.canvas,{id:le,bitmap:ce}=r.imageManager.getFromCanvas(Z.id,ee),ee.remove()):(l=!0,t._hasNoCanvas=!0);const $=((O=await i._structTree.getAriaAttributes(`${GC}${k}`))==null?void 0:O.get("aria-label"))||"";o=t={annotationType:Be.STAMP,bitmapId:le,bitmap:ce,pageIndex:te-1,rect:_.slice(0),rotation:N,annotationElementId:k,id:k,deleted:!1,accessibilityData:{decorative:!1,altText:$},isSvg:!1,structParent:B,popupRef:z,richText:H,comment:(F==null?void 0:F.str)||null,creationDate:Y,modificationDate:W}}const h=await super.deserialize(t,i,r),{rect:g,bitmap:p,bitmapUrl:x,bitmapId:y,isSvg:v,accessibilityData:C}=t;l?(r.addMissingCanvas(t.id,h),S(h,Gu,!0)):y&&r.imageManager.isValidId(y)?(S(h,zn,y),p&&S(h,Vt,p)):S(h,la,x),S(h,Er,v);const[R,I]=h.pageDimensions;return h.width=(g[2]-g[0])/R,h.height=(g[3]-g[1])/I,C&&(h.altTextData=C),h._initialData=o,t.comment&&h.setCommentData(t),S(h,qf,!!o),h}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r=Object.assign(super.serialize(t),{bitmapId:u(this,zn),isSvg:u(this,Er)});if(this.addComment(r),t)return r.bitmapUrl=P(this,e0,h2).call(this,!0),r.accessibilityData=this.serializeAltText(!0),r.isCopy=!0,r;const{decorative:o,altText:l}=this.serializeAltText(!1);if(!o&&l&&(r.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const g=P(this,Fy,uN).call(this,r);return g.isSame?null:(g.isSameAltText?delete r.accessibilityData:r.accessibilityData.structParent=this._initialData.structParent??-1,r.id=this.annotationElementId,delete r.bitmapId,r)}if(i===null)return r;i.stamps||(i.stamps=new Map);const h=u(this,Er)?(r.rect[2]-r.rect[0])*(r.rect[3]-r.rect[1]):null;if(!i.stamps.has(u(this,zn)))i.stamps.set(u(this,zn),{area:h,serialized:r}),r.bitmap=P(this,e0,h2).call(this,!1);else if(u(this,Er)){const g=i.stamps.get(u(this,zn));h>g.area&&(g.area=h,g.serialized.bitmap.close(),g.serialized.bitmap=P(this,e0,h2).call(this,!1))}return r}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}Vt=new WeakMap,zn=new WeakMap,Rl=new WeakMap,la=new WeakMap,kl=new WeakMap,Kf=new WeakMap,ca=new WeakMap,Gu=new WeakMap,xo=new WeakMap,Er=new WeakMap,qf=new WeakMap,Xu=new WeakSet,f1=function(t,i=!1){if(!t){this.remove();return}S(this,Vt,t.bitmap),i||(S(this,zn,t.id),S(this,Er,t.isSvg)),t.file&&S(this,Kf,t.file.name),P(this,Qf,c2).call(this)},Yu=new WeakSet,g1=function(){if(S(this,Rl,null),this._uiManager.enableWaiting(!1),!!u(this,ca)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&u(this,Vt)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&u(this,Vt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Zf=new WeakSet,l2=function(){if(u(this,zn)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(u(this,zn)).then(r=>P(this,Xu,f1).call(this,r,!0)).finally(()=>P(this,Yu,g1).call(this));return}if(u(this,la)){const r=u(this,la);S(this,la,null),this._uiManager.enableWaiting(!0),S(this,Rl,this._uiManager.imageManager.getFromUrl(r).then(o=>P(this,Xu,f1).call(this,o)).finally(()=>P(this,Yu,g1).call(this)));return}if(u(this,kl)){const r=u(this,kl);S(this,kl,null),this._uiManager.enableWaiting(!0),S(this,Rl,this._uiManager.imageManager.getFromFile(r).then(o=>P(this,Xu,f1).call(this,o)).finally(()=>P(this,Yu,g1).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=F2.join(",");const i=this._uiManager._signal;S(this,Rl,new Promise(r=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const o=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),P(this,Xu,f1).call(this,o)}r()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),r()},{signal:i})}).finally(()=>P(this,Yu,g1).call(this))),t.click()},Qf=new WeakSet,c2=function(){var p;const{div:t}=this;let{width:i,height:r}=u(this,Vt);const[o,l]=this.pageDimensions,h=.75;if(this.width)i=this.width*o,r=this.height*l;else if(i>h*o||r>h*l){const x=Math.min(h*o/i,h*l/r);i*=x,r*=x}this._uiManager.enableWaiting(!1);const g=S(this,ca,document.createElement("canvas"));g.setAttribute("role","img"),this.addContainer(g),this.width=i/o,this.height=r/l,this.setDims(),(p=this._initialOptions)!=null&&p.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),P(this,wm,PE).call(this),u(this,qf)||(this.parent.addUndoableEditor(this),S(this,qf,!0)),this._reportTelemetry({action:"inserted_image"}),u(this,Kf)&&this.div.setAttribute("aria-description",u(this,Kf)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},Jf=new WeakSet,u2=function(t,i){const{width:r,height:o}=u(this,Vt);let l=r,h=o,g=u(this,Vt);for(;l>2*t||h>2*i;){const p=l,x=h;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),h>2*i&&(h=h>=16384?Math.floor(h/2)-1:Math.ceil(h/2));const y=new OffscreenCanvas(l,h);y.getContext("2d").drawImage(g,0,0,p,x,0,0,l,h),g=y.transferToImageBitmap()}return g},wm=new WeakSet,PE=function(){const[t,i]=this.parentDimensions,{width:r,height:o}=this,l=new Ms,h=Math.ceil(r*t*l.sx),g=Math.ceil(o*i*l.sy),p=u(this,ca);if(!p||p.width===h&&p.height===g)return;p.width=h,p.height=g;const x=u(this,Er)?u(this,Vt):P(this,Jf,u2).call(this,h,g),y=p.getContext("2d");y.filter=this._uiManager.hcmFilter,y.drawImage(x,0,0,x.width,x.height,0,0,h,g)},e0=new WeakSet,h2=function(t){if(t){if(u(this,Er)){const o=this._uiManager.imageManager.getSvgUrl(u(this,zn));if(o)return o}const i=document.createElement("canvas");return{width:i.width,height:i.height}=u(this,Vt),i.getContext("2d").drawImage(u(this,Vt),0,0),i.toDataURL()}if(u(this,Er)){const[i,r]=this.pageDimensions,o=Math.round(this.width*i*ba.PDF_TO_CSS_UNITS),l=Math.round(this.height*r*ba.PDF_TO_CSS_UNITS),h=new OffscreenCanvas(o,l);return h.getContext("2d").drawImage(u(this,Vt),0,0,u(this,Vt).width,u(this,Vt).height,0,0,o,l),h.transferToImageBitmap()}return structuredClone(u(this,Vt))},Fy=new WeakSet,uN=function(t){var h;const{pageIndex:i,accessibilityData:{altText:r}}=this._initialData,o=t.pageIndex===i,l=(((h=t.accessibilityData)==null?void 0:h.alt)||"")===r;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&o&&l,isSameAltText:l}},ue(kE,"_type","stamp"),ue(kE,"_editorType",Be.STAMP);var $u,t0,Pl,Dl,ua,Ki,Ml,n0,i0,_s,ha,Hn,da,Ol,r0,Ie,Ll,ym,DE,Uy,hN,Zr,Gs,Am,ME,vm,OE,s0,d2;const ds=class ds{constructor({uiManager:e,pageIndex:t,div:i,structTreeLayer:r,accessibilityManager:o,annotationLayer:l,drawLayer:h,textLayer:g,viewport:p,l10n:x}){E(this,ym);E(this,Uy);E(this,Zr);E(this,Am);E(this,vm);E(this,s0);E(this,$u,void 0);E(this,t0,!1);E(this,Pl,null);E(this,Dl,null);E(this,ua,null);E(this,Ki,new Map);E(this,Ml,!1);E(this,n0,!1);E(this,i0,!1);E(this,_s,null);E(this,ha,null);E(this,Hn,null);E(this,da,null);E(this,Ol,null);E(this,r0,-1);E(this,Ie,void 0);const y=[...u(ds,Ll).values()];if(!ds._initialized){ds._initialized=!0;for(const v of y)v.initialize(x,e)}e.registerEditorTypes(y),S(this,Ie,e),this.pageIndex=t,this.div=i,S(this,$u,o),S(this,Pl,l),this.viewport=p,S(this,Hn,g),this.drawLayer=h,this._structTree=r,u(this,Ie).addLayer(this)}get isEmpty(){return u(this,Ki).size===0}get isInvisible(){return this.isEmpty&&u(this,Ie).getMode()===Be.NONE}updateToolbar(e){u(this,Ie).updateToolbar(e)}updateMode(e=u(this,Ie).getMode()){switch(P(this,s0,d2).call(this),e){case Be.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Be.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Be.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===Be.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const i of u(ds,Ll).values())t.toggle(`${i._type}Editing`,e===i._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=u(this,Hn))==null?void 0:t.div)}setEditingState(e){u(this,Ie).setEditingState(e)}addCommands(e){u(this,Ie).addCommands(e)}cleanUndoStack(e){u(this,Ie).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=u(this,Pl))==null||t.div.classList.toggle("disabled",!e)}async enable(){var i;S(this,i0,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(i=u(this,Ol))==null||i.abort(),S(this,Ol,null);const e=new Set;for(const r of u(this,ym,DE))r.enableEditing(),r.show(!0),r.annotationElementId&&(u(this,Ie).removeChangedExistingAnnotation(r),e.add(r.annotationElementId));const t=u(this,Pl);if(t)for(const r of t.getEditableAnnotations()){if(r.hide(),u(this,Ie).isDeletedAnnotationElement(r.data.id)||e.has(r.data.id))continue;const o=await this.deserialize(r);o&&(this.addOrRebuild(o),o.enableEditing())}S(this,i0,!1),u(this,Ie)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var i;if(S(this,n0,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),u(this,Hn)&&!u(this,Ol)){S(this,Ol,new AbortController);const r=u(this,Ie).combinedSignal(u(this,Ol));u(this,Hn).div.addEventListener("pointerdown",o=>{const{clientX:h,clientY:g,timeStamp:p}=o,x=u(this,r0);if(p-x>500){S(this,r0,p);return}S(this,r0,-1);const{classList:y}=this.div;y.toggle("getElements",!0);const v=document.elementsFromPoint(h,g);if(y.toggle("getElements",!1),!this.div.contains(v[0]))return;let C;const R=new RegExp(`^${H1}[0-9]+$`);for(const O of v)if(R.test(O.id)){C=O.id;break}if(!C)return;const I=u(this,Ki).get(C);(I==null?void 0:I.annotationElementId)===null&&(o.stopPropagation(),o.preventDefault(),I.dblclick(o))},{signal:r,capture:!0})}const e=u(this,Pl);if(e){const r=new Map,o=new Map;for(const h of u(this,ym,DE)){if(h.disableEditing(),!h.annotationElementId){h.updateFakeAnnotationElement(e);continue}if(h.serialize()!==null){r.set(h.annotationElementId,h);continue}else o.set(h.annotationElementId,h);(i=this.getEditableAnnotation(h.annotationElementId))==null||i.show(),h.remove()}const l=e.getEditableAnnotations();for(const h of l){const{id:g}=h.data;if(u(this,Ie).isDeletedAnnotationElement(g)){h.updateEdited({deleted:!0});continue}let p=o.get(g);if(p){p.resetAnnotationElement(h),p.show(!1),h.show();continue}p=r.get(g),p&&(u(this,Ie).addChangedExistingAnnotation(p),p.renderAnnotationElement(h)&&p.show(!1)),h.show()}}P(this,s0,d2).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:t}=this.div;for(const r of u(ds,Ll).values())t.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),S(this,n0,!1)}getEditableAnnotation(e){var t;return((t=u(this,Pl))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){u(this,Ie).getActive()!==e&&u(this,Ie).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=u(this,Hn))!=null&&e.div&&!u(this,da)){S(this,da,new AbortController);const t=u(this,Ie).combinedSignal(u(this,da));u(this,Hn).div.addEventListener("pointerdown",P(this,Uy,hN).bind(this),{signal:t}),u(this,Hn).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=u(this,Hn))!=null&&e.div&&u(this,da)&&(u(this,da).abort(),S(this,da,null),u(this,Hn).div.classList.remove("highlighting"))}enableClick(){if(u(this,Dl))return;S(this,Dl,new AbortController);const e=u(this,Ie).combinedSignal(u(this,Dl));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=u(this,Dl))==null||e.abort(),S(this,Dl,null)}attach(e){u(this,Ki).set(e.id,e);const{annotationElementId:t}=e;t&&u(this,Ie).isDeletedAnnotationElement(t)&&u(this,Ie).removeDeletedAnnotationElement(e)}detach(e){var t;u(this,Ki).delete(e.id),(t=u(this,$u))==null||t.removePointerInTextLayer(e.contentDiv),!u(this,n0)&&e.annotationElementId&&u(this,Ie).addDeletedAnnotationElement(e)}remove(e){this.detach(e),u(this,Ie).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(u(this,Ie).addDeletedAnnotationElement(e.annotationElementId),Mt.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),u(this,Ie).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!u(this,i0)),u(this,Ie).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var i;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!u(this,ua)&&(e._focusEventsAllowed=!1,S(this,ua,setTimeout(()=>{S(this,ua,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:u(this,Ie)._signal}),t.focus())},0))),e._structTreeParentId=(i=u(this,$u))==null?void 0:i.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),i=()=>{e.remove()};this.addCommands({cmd:t,undo:i,mustExec:!1})}getEditorByUID(e){for(const t of u(this,Ki).values())if(t.uid===e)return t;return null}getNextId(){return u(this,Ie).getId()}combinedSignal(e){return u(this,Ie).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=u(this,Zr,Gs))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await u(this,Ie).updateMode(e.mode);const{offsetX:i,offsetY:r}=P(this,vm,OE).call(this),o=this.getNextId(),l=P(this,Am,ME).call(this,{parent:this,id:o,x:i,y:r,uiManager:u(this,Ie),isCentered:!0,...t});l&&this.add(l)}async deserialize(e){var t;return await((t=u(ds,Ll).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,u(this,Ie)))||null}createAndAddNewEditor(e,t,i={}){const r=this.getNextId(),o=P(this,Am,ME).call(this,{parent:this,id:r,x:e.offsetX,y:e.offsetY,uiManager:u(this,Ie),isCentered:t,...i});return o&&this.add(o),o}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(P(this,vm,OE).call(this),!0,e)}setSelected(e){u(this,Ie).setSelected(e)}toggleSelected(e){u(this,Ie).toggleSelected(e)}unselect(e){u(this,Ie).unselect(e)}pointerup(e){var r;const{isMac:t}=Gn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!u(this,Ml)||(S(this,Ml,!1),(r=u(this,Zr,Gs))!=null&&r.isDrawer&&u(this,Zr,Gs).supportMultipleDrawings))return;if(!u(this,t0)){S(this,t0,!0);return}const i=u(this,Ie).getMode();if(i===Be.STAMP||i===Be.SIGNATURE){u(this,Ie).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var r;if(u(this,Ie).getMode()===Be.HIGHLIGHT&&this.enableTextSelection(),u(this,Ml)){S(this,Ml,!1);return}const{isMac:t}=Gn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(S(this,Ml,!0),(r=u(this,Zr,Gs))!=null&&r.isDrawer){this.startDrawingSession(e);return}const i=u(this,Ie).getActive();S(this,t0,!i||i.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),u(this,_s)){u(this,Zr,Gs).startDrawing(this,u(this,Ie),!1,e);return}u(this,Ie).setCurrentDrawingSession(this),S(this,_s,new AbortController);const t=u(this,Ie).combinedSignal(u(this,_s));this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(S(this,ha,null),this.commitOrRemove())},{signal:t}),u(this,Zr,Gs).startDrawing(this,u(this,Ie),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&S(this,ha,t);return}u(this,ha)&&setTimeout(()=>{var t;(t=u(this,ha))==null||t.focus(),S(this,ha,null)},0)}endDrawingSession(e=!1){return u(this,_s)?(u(this,Ie).setCurrentDrawingSession(null),u(this,_s).abort(),S(this,_s,null),S(this,ha,null),u(this,Zr,Gs).endDrawing(e)):null}findNewParent(e,t,i){const r=u(this,Ie).findParent(t,i);return r===null||r===this?!1:(r.changeParent(e),!0)}commitOrRemove(){return u(this,_s)?(this.endDrawingSession(),!0):!1}onScaleChanging(){u(this,_s)&&u(this,Zr,Gs).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=u(this,Ie).getActive())==null?void 0:e.parent)===this&&(u(this,Ie).commitOrRemove(),u(this,Ie).setActiveEditor(null)),u(this,ua)&&(clearTimeout(u(this,ua)),S(this,ua,null));for(const i of u(this,Ki).values())(t=u(this,$u))==null||t.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,u(this,Ki).clear(),u(this,Ie).removeLayer(this)}render({viewport:e}){this.viewport=e,ql(this.div,e);for(const t of u(this,Ie).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){u(this,Ie).commitOrRemove(),P(this,s0,d2).call(this);const t=this.viewport.rotation,i=e.rotation;if(this.viewport=e,ql(this.div,{rotation:i}),t!==i)for(const r of u(this,Ki).values())r.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return u(this,Ie).viewParameters.realScale}};$u=new WeakMap,t0=new WeakMap,Pl=new WeakMap,Dl=new WeakMap,ua=new WeakMap,Ki=new WeakMap,Ml=new WeakMap,n0=new WeakMap,i0=new WeakMap,_s=new WeakMap,ha=new WeakMap,Hn=new WeakMap,da=new WeakMap,Ol=new WeakMap,r0=new WeakMap,Ie=new WeakMap,Ll=new WeakMap,ym=new WeakSet,DE=function(){return u(this,Ki).size!==0?u(this,Ki).values():u(this,Ie).getEditors(this.pageIndex)},Uy=new WeakSet,hN=function(e){u(this,Ie).unselectAll();const{target:t}=e;if(t===u(this,Hn).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&u(this,Hn).div.contains(t)){const{isMac:i}=Gn.platform;if(e.button!==0||e.ctrlKey&&i)return;u(this,Ie).showAllEditors("highlight",!0,!0),u(this,Hn).div.classList.add("free"),this.toggleDrawing(),G2.startHighlighting(this,u(this,Ie).direction==="ltr",{target:u(this,Hn).div,x:e.x,y:e.y}),u(this,Hn).div.addEventListener("pointerup",()=>{u(this,Hn).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:u(this,Ie)._signal}),e.preventDefault()}},Zr=new WeakSet,Gs=function(){return u(ds,Ll).get(u(this,Ie).getMode())},Am=new WeakSet,ME=function(e){const t=u(this,Zr,Gs);return t?new t.prototype.constructor(e):null},vm=new WeakSet,OE=function(){const{x:e,y:t,width:i,height:r}=this.boundingClientRect,o=Math.max(0,e),l=Math.max(0,t),h=Math.min(window.innerWidth,e+i),g=Math.min(window.innerHeight,t+r),p=(o+h)/2-e,x=(l+g)/2-t,[y,v]=this.viewport.rotation%180===0?[p,x]:[x,p];return{offsetX:y,offsetY:v}},s0=new WeakSet,d2=function(){for(const e of u(this,Ki).values())e.isEmpty()&&e.remove()},ue(ds,"_initialized",!1),E(ds,Ll,new Map([gE,CE,kE,G2,RE].map(e=>[e._editorType,e])));let Y2=ds;var Ts,Ti,Ku,bm,jy,dN,Em,LE,zy,fN,Cm,BE;const In=class In{constructor({pageIndex:e}){E(this,Em);E(this,zy);E(this,Cm);E(this,Ts,null);E(this,Ti,new Map);E(this,Ku,new Map);this.pageIndex=e}setParent(e){if(!u(this,Ts)){S(this,Ts,e);return}if(u(this,Ts)!==e){if(u(this,Ti).size>0)for(const t of u(this,Ti).values())t.remove(),e.append(t);S(this,Ts,e)}}static get _svgFactory(){return Ve(this,"_svgFactory",new K1)}draw(e,t=!1,i=!1){const r=Tn(In,bm)._++,o=P(this,Em,LE).call(this),l=In._svgFactory.createElement("defs");o.append(l);const h=In._svgFactory.createElement("path");l.append(h);const g=`path_p${this.pageIndex}_${r}`;h.setAttribute("id",g),h.setAttribute("vector-effect","non-scaling-stroke"),t&&u(this,Ku).set(r,h);const p=i?P(this,zy,fN).call(this,l,g):null,x=In._svgFactory.createElement("use");return o.append(x),x.setAttribute("href",`#${g}`),this.updateProperties(o,e),u(this,Ti).set(r,o),{id:r,clipPathId:`url(#${p})`}}drawOutline(e,t){const i=Tn(In,bm)._++,r=P(this,Em,LE).call(this),o=In._svgFactory.createElement("defs");r.append(o);const l=In._svgFactory.createElement("path");o.append(l);const h=`path_p${this.pageIndex}_${i}`;l.setAttribute("id",h),l.setAttribute("vector-effect","non-scaling-stroke");let g;if(t){const y=In._svgFactory.createElement("mask");o.append(y),g=`mask_p${this.pageIndex}_${i}`,y.setAttribute("id",g),y.setAttribute("maskUnits","objectBoundingBox");const v=In._svgFactory.createElement("rect");y.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const C=In._svgFactory.createElement("use");y.append(C),C.setAttribute("href",`#${h}`),C.setAttribute("stroke","none"),C.setAttribute("fill","black"),C.setAttribute("fill-rule","nonzero"),C.classList.add("mask")}const p=In._svgFactory.createElement("use");r.append(p),p.setAttribute("href",`#${h}`),g&&p.setAttribute("mask",`url(#${g})`);const x=p.cloneNode();return r.append(x),p.classList.add("mainOutline"),x.classList.add("secondaryOutline"),this.updateProperties(r,e),u(this,Ti).set(i,r),i}finalizeDraw(e,t){u(this,Ku).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var g;if(!t)return;const{root:i,bbox:r,rootClass:o,path:l}=t,h=typeof e=="number"?u(this,Ti).get(e):e;if(h){if(i&&P(this,Cm,BE).call(this,h,i),r&&P(g=In,jy,dN).call(g,h,r),o){const{classList:p}=h;for(const[x,y]of Object.entries(o))p.toggle(x,y)}if(l){const x=h.firstChild.firstChild;P(this,Cm,BE).call(this,x,l)}}}updateParent(e,t){if(t===this)return;const i=u(this,Ti).get(e);i&&(u(t,Ts).append(i),u(this,Ti).delete(e),u(t,Ti).set(e,i))}remove(e){u(this,Ku).delete(e),u(this,Ts)!==null&&(u(this,Ti).get(e).remove(),u(this,Ti).delete(e))}destroy(){S(this,Ts,null);for(const e of u(this,Ti).values())e.remove();u(this,Ti).clear(),u(this,Ku).clear()}};Ts=new WeakMap,Ti=new WeakMap,Ku=new WeakMap,bm=new WeakMap,jy=new WeakSet,dN=function(e,[t,i,r,o]){const{style:l}=e;l.top=`${100*i}%`,l.left=`${100*t}%`,l.width=`${100*r}%`,l.height=`${100*o}%`},Em=new WeakSet,LE=function(){const e=In._svgFactory.create(1,1,!0);return u(this,Ts).append(e),e.setAttribute("aria-hidden",!0),e},zy=new WeakSet,fN=function(e,t){const i=In._svgFactory.createElement("clipPath");e.append(i);const r=`clip_${t}`;i.setAttribute("id",r),i.setAttribute("clipPathUnits","objectBoundingBox");const o=In._svgFactory.createElement("use");return i.append(o),o.setAttribute("href",`#${t}`),o.classList.add("clip"),r},Cm=new WeakSet,BE=function(e,t){for(const[i,r]of Object.entries(t))r===null?e.removeAttribute(i):e.setAttribute(i,r)},E(In,jy),E(In,bm,0);let $2=In;globalThis._pdfjsTestingUtils={HighlightOutliner:mE};globalThis.pdfjsLib={AbortException:va,AnnotationEditorLayer:Y2,AnnotationEditorParamsType:Ze,AnnotationEditorType:Be,AnnotationEditorUIManager:Zl,AnnotationLayer:nS,AnnotationMode:yo,AnnotationType:pn,applyOpacity:h4,build:g8,ColorPicker:$1,createValidAbsoluteUrl:HC,CSSConstants:u4,DOMSVGFactory:K1,DrawLayer:$2,FeatureTest:Gn,fetchData:y0,findContrastColor:d4,getDocument:ZC,getFilenameFromUrl:a4,getPdfFilenameFromUrl:l4,getRGB:A0,getUuid:WC,getXfaPageViewport:c4,GlobalWorkerOptions:es,ImageKind:C1,InvalidPDFException:B2,isDataScheme:Dm,isPdfFile:aA,isValidExplicitDest:G4,MathClamp:xi,noContextMenu:Rr,normalizeUnicode:s4,OPS:f0,OutputScale:Ms,PasswordResponses:i4,PDFDataRangeTransport:QC,PDFDateString:G1,PDFWorker:g0,PermissionFlag:n4,PixelsPerInch:ba,RenderingCancelledException:oA,renderRichText:YC,ResponseException:V1,setLayerDimensions:ql,shadow:Ve,SignatureExtractor:bn,stopEvent:Zt,SupportedImageMimeTypes:F2,TextLayer:Y1,TouchManager:X1,updateUrlHash:VC,Util:Ae,VerbosityLevel:Rm,version:JC,XfaLayer:XC};const zD=Object.freeze(Object.defineProperty({__proto__:null,AbortException:va,AnnotationEditorLayer:Y2,AnnotationEditorParamsType:Ze,AnnotationEditorType:Be,AnnotationEditorUIManager:Zl,AnnotationLayer:nS,AnnotationMode:yo,AnnotationType:pn,CSSConstants:u4,ColorPicker:$1,DOMSVGFactory:K1,DrawLayer:$2,FeatureTest:Gn,GlobalWorkerOptions:es,ImageKind:C1,InvalidPDFException:B2,MathClamp:xi,OPS:f0,OutputScale:Ms,PDFDataRangeTransport:QC,PDFDateString:G1,PDFWorker:g0,PasswordResponses:i4,PermissionFlag:n4,PixelsPerInch:ba,RenderingCancelledException:oA,ResponseException:V1,SignatureExtractor:bn,SupportedImageMimeTypes:F2,TextLayer:Y1,TouchManager:X1,Util:Ae,VerbosityLevel:Rm,XfaLayer:XC,applyOpacity:h4,build:g8,createValidAbsoluteUrl:HC,fetchData:y0,findContrastColor:d4,getDocument:ZC,getFilenameFromUrl:a4,getPdfFilenameFromUrl:l4,getRGB:A0,getUuid:WC,getXfaPageViewport:c4,isDataScheme:Dm,isPdfFile:aA,isValidExplicitDest:G4,noContextMenu:Rr,normalizeUnicode:s4,renderRichText:YC,setLayerDimensions:ql,shadow:Ve,stopEvent:Zt,updateUrlHash:VC,version:JC},Symbol.toStringTag,{value:"Module"}));function gN(n){var e,t,i="";if(typeof n=="string"||typeof n=="number")i+=n;else if(typeof n=="object")if(Array.isArray(n)){var r=n.length;for(e=0;e<r;e++)n[e]&&(t=gN(n[e]))&&(i&&(i+=" "),i+=t)}else for(t in n)n[t]&&(i&&(i+=" "),i+=t);return i}function uA(){for(var n,e,t=0,i="",r=arguments.length;t<r;t++)(n=arguments[t])&&(e=gN(n))&&(i&&(i+=" "),i+=e);return i}var f_=Object.prototype.hasOwnProperty;function g_(n,e,t){for(t of n.keys())if(rd(t,e))return t}function rd(n,e){var t,i,r;if(n===e)return!0;if(n&&e&&(t=n.constructor)===e.constructor){if(t===Date)return n.getTime()===e.getTime();if(t===RegExp)return n.toString()===e.toString();if(t===Array){if((i=n.length)===e.length)for(;i--&&rd(n[i],e[i]););return i===-1}if(t===Set){if(n.size!==e.size)return!1;for(i of n)if(r=i,r&&typeof r=="object"&&(r=g_(e,r),!r)||!e.has(r))return!1;return!0}if(t===Map){if(n.size!==e.size)return!1;for(i of n)if(r=i[0],r&&typeof r=="object"&&(r=g_(e,r),!r)||!rd(i[1],e.get(r)))return!1;return!0}if(t===ArrayBuffer)n=new Uint8Array(n),e=new Uint8Array(e);else if(t===DataView){if((i=n.byteLength)===e.byteLength)for(;i--&&n.getInt8(i)===e.getInt8(i););return i===-1}if(ArrayBuffer.isView(n)){if((i=n.byteLength)===e.byteLength)for(;i--&&n[i]===e[i];);return i===-1}if(!t||typeof n=="object"){i=0;for(t in n)if(f_.call(n,t)&&++i&&!f_.call(e,t)||!(t in e)||!rd(n[t],e[t]))return!1;return Object.keys(e).length===i}}return n!==n&&e!==e}function Bm(n){let e=!1;return{promise:new Promise((i,r)=>{n.then(o=>!e&&i(o)).catch(o=>!e&&r(o))}),cancel(){e=!0}}}const HD=["onCopy","onCut","onPaste"],VD=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],WD=["onFocus","onBlur"],GD=["onInput","onInvalid","onReset","onSubmit"],XD=["onLoad","onError"],YD=["onKeyDown","onKeyPress","onKeyUp"],$D=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],KD=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],qD=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],ZD=["onSelect"],QD=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],JD=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],eM=["onScroll"],tM=["onWheel"],nM=["onAnimationStart","onAnimationEnd","onAnimationIteration"],iM=["onTransitionEnd"],rM=["onToggle"],sM=["onChange"],oM=[...HD,...VD,...WD,...GD,...XD,...YD,...$D,...KD,...qD,...ZD,...QD,...JD,...eM,...tM,...nM,...iM,...sM,...rM];function pN(n,e){const t={};for(const i of oM){const r=n[i];r&&(e?t[i]=o=>r(o,e(i)):t[i]=r)}return t}var aM=!0,wv="Invariant failed";function Tt(n,e){if(!n){if(aM)throw new Error(wv);var t=typeof e=="function"?e():e,i=t?"".concat(wv,": ").concat(t):wv;throw new Error(i)}}var lM=function(){},cM=lM;const yi=YE(cM),uM=re.createContext(null),mN=uM,hM="noopener noreferrer nofollow";class dM{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHash(){}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return Tt(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber||0}set page(e){Tt(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}addLinkAttributes(e,t,i){e.href=t,e.rel=this.externalLinkRel||hM,e.target=i?"_blank":this.externalLinkTarget||""}goToDestination(e){return new Promise(t=>{Tt(this.pdfDocument,"PDF document not loaded."),Tt(e,"Destination is not specified."),typeof e=="string"?this.pdfDocument.getDestination(e).then(t):Array.isArray(e)?t(e):e.then(t)}).then(t=>{Tt(Array.isArray(t),`"${t}" is not a valid destination array.`);const i=t[0];new Promise(r=>{Tt(this.pdfDocument,"PDF document not loaded."),i instanceof Object?this.pdfDocument.getPageIndex(i).then(o=>{r(o)}).catch(()=>{Tt(!1,`"${i}" is not a valid page reference.`)}):typeof i=="number"?r(i):Tt(!1,`"${i}" is not a valid destination reference.`)}).then(r=>{const o=r+1;Tt(this.pdfViewer,"PDF viewer is not initialized."),Tt(o>=1&&o<=this.pagesCount,`"${o}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({dest:t,pageIndex:r,pageNumber:o})})})}goToPage(e){const t=e-1;Tt(this.pdfViewer,"PDF viewer is not initialized."),Tt(e>=1&&e<=this.pagesCount,`"${e}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({pageIndex:t,pageNumber:e})}goToXY(){}cachePageRef(){}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}executeNamedAction(){}executeSetOCGState(){}isPageVisible(){return!0}isPageCached(){return!0}navigateTo(e){this.goToDestination(e)}}function sd({children:n,type:e}){return U.jsx("div",{className:`react-pdf__message react-pdf__message--${e}`,children:n})}const fM={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},p_=fM;function gM(n,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return n}}function p0(){return re.useReducer(gM,{value:void 0,error:void 0})}const hA=typeof window<"u",xN=hA&&window.location.protocol==="file:";function pM(n){return typeof n<"u"}function uc(n){return pM(n)&&n!==null}function mM(n){return typeof n=="string"}function xM(n){return n instanceof ArrayBuffer}function wM(n){return Tt(hA,"isBlob can only be used in a browser environment"),n instanceof Blob}function FE(n){return mM(n)&&/^data:/.test(n)}function m_(n){Tt(FE(n),"Invalid data URI.");const[e="",t=""]=n.split(",");return e.split(";").indexOf("base64")!==-1?atob(t):unescape(t)}function yM(){return hA&&window.devicePixelRatio||1}const wN="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function x_(){yi(!xN,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${wN}`)}function AM(){yi(!xN,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${wN}`)}function sh(n){n!=null&&n.cancel&&n.cancel()}function UE(n,e){return Object.defineProperty(n,"width",{get(){return this.getViewport({scale:e}).width},configurable:!0}),Object.defineProperty(n,"height",{get(){return this.getViewport({scale:e}).height},configurable:!0}),Object.defineProperty(n,"originalWidth",{get(){return this.getViewport({scale:1}).width},configurable:!0}),Object.defineProperty(n,"originalHeight",{get(){return this.getViewport({scale:1}).height},configurable:!0}),n}function yN(n){return n.name==="AbortException"||n.name==="RenderingCancelledException"}function vM(n){return new Promise((e,t)=>{const i=new FileReader;i.onload=()=>{if(!i.result)return t(new Error("Error while reading a file."));e(i.result)},i.onerror=r=>{if(!r.target)return t(new Error("Error while reading a file."));const{error:o}=r.target;if(!o)return t(new Error("Error while reading a file."));switch(o.code){case o.NOT_FOUND_ERR:return t(new Error("Error while reading a file: File not found."));case o.SECURITY_ERR:return t(new Error("Error while reading a file: Security error."));case o.ABORT_ERR:return t(new Error("Error while reading a file: Aborted."));default:return t(new Error("Error while reading a file."))}},i.readAsArrayBuffer(n)})}const{PDFDataRangeTransport:bM}=zD,EM=(n,e)=>{switch(e){case p_.NEED_PASSWORD:{const t=prompt("Enter the password to open this PDF file.");n(t);break}case p_.INCORRECT_PASSWORD:{const t=prompt("Invalid password. Please try again.");n(t);break}}};function w_(n){return typeof n=="object"&&n!==null&&("data"in n||"range"in n||"url"in n)}const CM=re.forwardRef(function({children:e,className:t,error:i="Failed to load PDF file.",externalLinkRel:r,externalLinkTarget:o,file:l,inputRef:h,imageResourcesPath:g,loading:p="Loading PDF",noData:x="No PDF file specified.",onItemClick:y,onLoadError:v,onLoadProgress:C,onLoadSuccess:R,onPassword:I=EM,onSourceError:O,onSourceSuccess:_,options:N,renderMode:k,rotate:B,scale:z,...H},F){const[Y,W]=p0(),{value:Z,error:te}=Y,[ee,le]=p0(),{value:ce,error:$}=ee,oe=re.useRef(new dM),ne=re.useRef([]),ie=re.useRef(void 0),ge=re.useRef(void 0);l&&l!==ie.current&&w_(l)&&(yi(!rd(l,ie.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),ie.current=l),N&&N!==ge.current&&(yi(!rd(N,ge.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),ge.current=N);const ye=re.useRef({scrollPageIntoView:Te=>{const{dest:Qe,pageNumber:rt,pageIndex:tn=rt-1}=Te;if(y){y({dest:Qe,pageIndex:tn,pageNumber:rt});return}const Xe=ne.current[tn];if(Xe){Xe.scrollIntoView();return}yi(!1,`An internal link leading to page ${rt} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});re.useImperativeHandle(F,()=>({linkService:oe,pages:ne,viewer:ye}),[]);function Me(){_&&_()}function we(){te&&(yi(!1,te.toString()),O&&O(te))}function me(){W({type:"RESET"})}re.useEffect(me,[l,W]);const Le=re.useCallback(async()=>{if(!l)return null;if(typeof l=="string")return FE(l)?{data:m_(l)}:(x_(),{url:l});if(l instanceof bM)return{range:l};if(xM(l))return{data:l};if(hA&&wM(l))return{data:await vM(l)};if(Tt(typeof l=="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),Tt(w_(l),"Invalid parameter object: need either .data, .range or .url"),"url"in l&&typeof l.url=="string"){if(FE(l.url)){const{url:Te,...Qe}=l;return{data:m_(Te),...Qe}}x_()}return l},[l]);re.useEffect(()=>{const Te=Bm(Le());return Te.promise.then(Qe=>{W({type:"RESOLVE",value:Qe})}).catch(Qe=>{W({type:"REJECT",error:Qe})}),()=>{sh(Te)}},[Le,W]),re.useEffect(()=>{if(!(typeof Z>"u")){if(Z===!1){we();return}Me()}},[Z]);function dt(){ce&&(R&&R(ce),ne.current=new Array(ce.numPages),oe.current.setDocument(ce))}function xe(){$&&(yi(!1,$.toString()),v&&v($))}re.useEffect(function(){le({type:"RESET"})},[le,Z]),re.useEffect(function(){if(!Z)return;const Qe=N?{...Z,...N}:Z,rt=ZC(Qe);C&&(rt.onProgress=C),I&&(rt.onPassword=I);const tn=rt;return tn.promise.then(Xe=>{tn.destroyed||le({type:"RESOLVE",value:Xe})}).catch(Xe=>{tn.destroyed||le({type:"REJECT",error:Xe})}),()=>{tn.destroy()}},[N,le,Z]),re.useEffect(()=>{if(!(typeof ce>"u")){if(ce===!1){xe();return}dt()}},[ce]),re.useEffect(function(){oe.current.setViewer(ye.current),oe.current.setExternalLinkRel(r),oe.current.setExternalLinkTarget(o)},[r,o]);const He=re.useCallback((Te,Qe)=>{ne.current[Te]=Qe},[]),st=re.useCallback(Te=>{delete ne.current[Te]},[]),yn=re.useMemo(()=>({imageResourcesPath:g,linkService:oe.current,onItemClick:y,pdf:ce,registerPage:He,renderMode:k,rotate:B,scale:z,unregisterPage:st}),[g,y,ce,He,k,B,z,st]),bt=re.useMemo(()=>pN(H,()=>ce),[H,ce]);function De(){function Te(rt){return!!(rt!=null&&rt.pdf)}if(!Te(yn))throw new Error("pdf is undefined");const Qe=typeof e=="function"?e(yn):e;return U.jsx(mN.Provider,{value:yn,children:Qe})}function Cn(){return l?ce==null?U.jsx(sd,{type:"loading",children:typeof p=="function"?p():p}):ce===!1?U.jsx(sd,{type:"error",children:typeof i=="function"?i():i}):De():U.jsx(sd,{type:"no-data",children:typeof x=="function"?x():x})}return U.jsx("div",{className:uA("react-pdf__Document",t),ref:h,...bt,children:Cn()})}),SM=CM;function AN(){return re.useContext(mN)}function vN(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=n.filter(Boolean);if(t.length<=1){var i=t[0];return i||null}return function(o){for(var l=0,h=t;l<h.length;l++){var g=h[l];typeof g=="function"?g(o):g&&(g.current=o)}}}const _M=re.createContext(null),bN=_M;function dA(){return re.useContext(bN)}function TM(){const n=AN(),e=dA();Tt(e,"Unable to find Page context.");const t={...n,...e},{filterAnnotations:i,imageResourcesPath:r,linkService:o,onGetAnnotationsError:l,onGetAnnotationsSuccess:h,onRenderAnnotationLayerError:g,onRenderAnnotationLayerSuccess:p,page:x,pdf:y,renderForms:v,rotate:C,scale:R=1}=t;Tt(y,"Attempted to load page annotations, but no document was specified. Wrap <Page /> in a <Document /> or pass explicit `pdf` prop."),Tt(x,"Attempted to load page annotations, but no page was specified."),Tt(o,"Attempted to load page annotations, but no linkService was specified.");const[I,O]=p0(),{value:_,error:N}=I,k=re.useRef(null);yi(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function B(){_&&h&&h(_)}function z(){N&&(yi(!1,N.toString()),l&&l(N))}re.useEffect(function(){O({type:"RESET"})},[O,x]),re.useEffect(function(){if(!x)return;const Z=Bm(x.getAnnotations()),te=Z;return Z.promise.then(ee=>{O({type:"RESOLVE",value:ee})}).catch(ee=>{O({type:"REJECT",error:ee})}),()=>{sh(te)}},[O,x]),re.useEffect(()=>{if(_!==void 0){if(_===!1){z();return}B()}},[_]);function H(){p&&p()}function F(W){yi(!1,`${W}`),g&&g(W)}const Y=re.useMemo(()=>x.getViewport({scale:R,rotation:C}),[x,C,R]);return re.useEffect(function(){if(!y||!x||!o||!_)return;const{current:Z}=k;if(!Z)return;const te=Y.clone({dontFlip:!0}),ee={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,annotationStorage:y.annotationStorage,commentManager:null,div:Z,l10n:null,linkService:o,page:x,structTreeLayer:null,viewport:te},le={annotations:i?i({annotations:_}):_,annotationStorage:y.annotationStorage,div:Z,imageResourcesPath:r,linkService:o,page:x,renderForms:v,viewport:te};Z.innerHTML="";try{new nS(ee).render(le),H()}catch(ce){F(ce)}return()=>{}},[_,i,r,o,x,y,v,Y]),U.jsx("div",{className:uA("react-pdf__Page__annotations","annotationLayer"),ref:k})}const EN={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},IM=/^H(\d+)$/;function NM(n){return n in EN}function fA(n){return"children"in n}function CN(n){return fA(n)?n.children.length===1&&0 in n.children&&"id"in n.children[0]:!1}function RM(n){const e={};if(fA(n)){const{role:t}=n,i=t.match(IM);if(i)e.role="heading",e["aria-level"]=Number(i[1]);else if(NM(t)){const r=EN[t];r&&(e.role=r)}}return e}function SN(n){const e={};if(fA(n)){if(n.alt!==void 0&&(e["aria-label"]=n.alt),n.lang!==void 0&&(e.lang=n.lang),CN(n)){const[t]=n.children;if(t){const i=SN(t);return{...e,...i}}}}else"id"in n&&(e["aria-owns"]=n.id);return e}function kM(n){return n?{...RM(n),...SN(n)}:null}function _N({className:n,node:e}){const t=re.useMemo(()=>kM(e),[e]),i=re.useMemo(()=>!fA(e)||CN(e)?null:e.children.map((r,o)=>U.jsx(_N,{node:r},o)),[e]);return U.jsx("span",{className:n,...t,children:i})}function PM(){const n=dA();Tt(n,"Unable to find Page context.");const{onGetStructTreeError:e,onGetStructTreeSuccess:t}=n,[i,r]=p0(),{value:o,error:l}=i,{customTextRenderer:h,page:g}=n;function p(){o&&t&&t(o)}function x(){l&&(yi(!1,l.toString()),e&&e(l))}return re.useEffect(function(){r({type:"RESET"})},[r,g]),re.useEffect(function(){if(h||!g)return;const v=Bm(g.getStructTree()),C=v;return v.promise.then(R=>{r({type:"RESOLVE",value:R})}).catch(R=>{r({type:"REJECT",error:R})}),()=>sh(C)},[h,g,r]),re.useEffect(()=>{if(o!==void 0){if(o===!1){x();return}p()}},[o]),o?U.jsx(_N,{className:"react-pdf__Page__structTree structTree",node:o}):null}const y_=yo;function DM(n){const e=dA();Tt(e,"Unable to find Page context.");const t={...e,...n},{_className:i,canvasBackground:r,devicePixelRatio:o=yM(),onRenderError:l,onRenderSuccess:h,page:g,renderForms:p,renderTextLayer:x,rotate:y,scale:v}=t,{canvasRef:C}=n;Tt(g,"Attempted to render page canvas, but no page was specified.");const R=re.useRef(null);function I(){g&&h&&h(UE(g,v))}function O(B){yN(B)||(yi(!1,B.toString()),l&&l(B))}const _=re.useMemo(()=>g.getViewport({scale:v*o,rotation:y}),[o,g,y,v]),N=re.useMemo(()=>g.getViewport({scale:v,rotation:y}),[g,y,v]);re.useEffect(function(){if(!g)return;g.cleanup();const{current:z}=R;if(!z)return;z.width=_.width,z.height=_.height,z.style.width=`${Math.floor(N.width)}px`,z.style.height=`${Math.floor(N.height)}px`,z.style.visibility="hidden";const H={annotationMode:p?y_.ENABLE_FORMS:y_.ENABLE,canvas:z,canvasContext:z.getContext("2d",{alpha:!1}),viewport:_};r&&(H.background=r);const F=g.render(H),Y=F;return F.promise.then(()=>{z.style.visibility="",I()}).catch(O),()=>sh(Y)},[r,g,p,_,N]);const k=re.useCallback(()=>{const{current:B}=R;B&&(B.width=0,B.height=0)},[]);return re.useEffect(()=>k,[k]),U.jsx("canvas",{className:`${i}__canvas`,dir:"ltr",ref:vN(C,R),style:{display:"block",userSelect:"none"},children:x?U.jsx(PM,{}):null})}function MM(n){return"str"in n}function OM(){const n=dA();Tt(n,"Unable to find Page context.");const{customTextRenderer:e,onGetTextError:t,onGetTextSuccess:i,onRenderTextLayerError:r,onRenderTextLayerSuccess:o,page:l,pageIndex:h,pageNumber:g,rotate:p,scale:x}=n;Tt(l,"Attempted to load page text content, but no page was specified.");const[y,v]=p0(),{value:C,error:R}=y,I=re.useRef(null);yi(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function O(){C&&i&&i(C)}function _(){R&&(yi(!1,R.toString()),t&&t(R))}re.useEffect(function(){v({type:"RESET"})},[l,v]),re.useEffect(function(){if(!l)return;const Y=Bm(l.getTextContent()),W=Y;return Y.promise.then(Z=>{v({type:"RESOLVE",value:Z})}).catch(Z=>{v({type:"REJECT",error:Z})}),()=>sh(W)},[l,v]),re.useEffect(()=>{if(C!==void 0){if(C===!1){_();return}O()}},[C]);const N=re.useCallback(()=>{o&&o()},[o]),k=re.useCallback(F=>{yN(F)||(yi(!1,F.toString()),r&&r(F))},[r]);function B(){const F=I.current;F&&F.classList.add("selecting")}function z(){const F=I.current;F&&F.classList.remove("selecting")}const H=re.useMemo(()=>l.getViewport({scale:x,rotation:p}),[l,p,x]);return re.useLayoutEffect(function(){if(!l||!C)return;const{current:Y}=I;if(!Y)return;Y.innerHTML="";const W=l.streamTextContent({includeMarkedContent:!0}),Z={container:Y,textContentSource:W,viewport:H},te=new Y1(Z),ee=te;return te.render().then(()=>{const le=document.createElement("div");le.className="endOfContent",Y.append(le);const ce=Y.querySelectorAll('[role="presentation"]');if(e){let $=0;C.items.forEach((oe,ne)=>{if(!MM(oe))return;const ie=ce[$];if(!ie)return;const ge=e({pageIndex:h,pageNumber:g,itemIndex:ne,...oe});ie.innerHTML=ge,$+=oe.str&&oe.hasEOL?2:1})}N()}).catch(k),()=>sh(ee)},[e,k,N,l,h,g,C,H]),U.jsx("div",{className:uA("react-pdf__Page__textContent","textLayer"),onMouseUp:z,onMouseDown:B,ref:I})}const A_=1;function LM(n){const t={...AN(),...n},{_className:i="react-pdf__Page",_enableRegisterUnregisterPage:r=!0,canvasBackground:o,canvasRef:l,children:h,className:g,customRenderer:p,customTextRenderer:x,devicePixelRatio:y,error:v="Failed to load the page.",filterAnnotations:C,height:R,inputRef:I,loading:O="Loading page",noData:_="No page specified.",onGetAnnotationsError:N,onGetAnnotationsSuccess:k,onGetStructTreeError:B,onGetStructTreeSuccess:z,onGetTextError:H,onGetTextSuccess:F,onLoadError:Y,onLoadSuccess:W,onRenderAnnotationLayerError:Z,onRenderAnnotationLayerSuccess:te,onRenderError:ee,onRenderSuccess:le,onRenderTextLayerError:ce,onRenderTextLayerSuccess:$,pageIndex:oe,pageNumber:ne,pdf:ie,registerPage:ge,renderAnnotationLayer:ye=!0,renderForms:Me=!1,renderMode:we="canvas",renderTextLayer:me=!0,rotate:Le,scale:dt=A_,unregisterPage:xe,width:He,...st}=t,[yn,bt]=p0(),{value:De,error:Cn}=yn,Te=re.useRef(null);Tt(ie,"Attempted to load a page, but no document was specified. Wrap <Page /> in a <Document /> or pass explicit `pdf` prop.");const Qe=uc(ne)?ne-1:oe??null,rt=ne??(uc(oe)?oe+1:null),tn=Le??(De?De.rotate:null),Xe=re.useMemo(()=>{if(!De)return null;let ke=1;const et=dt??A_;if(He||R){const hn=De.getViewport({scale:1,rotation:tn});He?ke=He/hn.width:R&&(ke=R/hn.height)}return et*ke},[R,De,tn,dt,He]);re.useEffect(function(){return()=>{uc(Qe)&&r&&xe&&xe(Qe)}},[r,ie,Qe,xe]);function ut(){if(W){if(!De||!Xe)return;W(UE(De,Xe))}if(r&&ge){if(!uc(Qe)||!Te.current)return;ge(Qe,Te.current)}}function $e(){Cn&&(yi(!1,Cn.toString()),Y&&Y(Cn))}re.useEffect(function(){bt({type:"RESET"})},[bt,ie,Qe]),re.useEffect(function(){if(!ie||!rt)return;const et=Bm(ie.getPage(rt)),hn=et;return et.promise.then(oi=>{bt({type:"RESOLVE",value:oi})}).catch(oi=>{bt({type:"REJECT",error:oi})}),()=>sh(hn)},[bt,ie,rt]),re.useEffect(()=>{if(De!==void 0){if(De===!1){$e();return}ut()}},[De,Xe]);const Os=re.useMemo(()=>uc(Qe)&&rt&&uc(tn)&&uc(Xe)?{_className:i,canvasBackground:o,customTextRenderer:x,devicePixelRatio:y,filterAnnotations:C,onGetAnnotationsError:N,onGetAnnotationsSuccess:k,onGetStructTreeError:B,onGetStructTreeSuccess:z,onGetTextError:H,onGetTextSuccess:F,onRenderAnnotationLayerError:Z,onRenderAnnotationLayerSuccess:te,onRenderError:ee,onRenderSuccess:le,onRenderTextLayerError:ce,onRenderTextLayerSuccess:$,page:De,pageIndex:Qe,pageNumber:rt,renderForms:Me,renderTextLayer:me,rotate:tn,scale:Xe}:null,[i,o,x,y,C,N,k,B,z,H,F,Z,te,ee,le,ce,$,De,Qe,rt,Me,me,tn,Xe]),Se=re.useMemo(()=>pN(st,()=>De&&(Xe?UE(De,Xe):void 0)),[st,De,Xe]),os=`${Qe}@${Xe}/${tn}`;function Ca(){switch(we){case"custom":return Tt(p,'renderMode was set to "custom", but no customRenderer was passed.'),U.jsx(p,{},`${os}_custom`);case"none":return null;case"canvas":default:return U.jsx(DM,{canvasRef:l},`${os}_canvas`)}}function Di(){return me?U.jsx(OM,{},`${os}_text`):null}function Ls(){return ye?U.jsx(TM,{},`${os}_annotations`):null}function vi(){function ke(hn){return!!(hn!=null&&hn.page)}if(!ke(Os))throw new Error("page is undefined");const et=typeof h=="function"?h(Os):h;return U.jsxs(bN.Provider,{value:Os,children:[Ca(),Di(),Ls(),et]})}function Je(){return rt?ie===null||De===void 0||De===null?U.jsx(sd,{type:"loading",children:typeof O=="function"?O():O}):ie===!1||De===!1?U.jsx(sd,{type:"error",children:typeof v=="function"?v():v}):vi():U.jsx(sd,{type:"no-data",children:typeof _=="function"?_():_})}return U.jsx("div",{className:uA(i,g),"data-page-number":rt,ref:vN(I,Te),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${Xe}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:o||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"},...Se,children:Je()})}AM();es.workerSrc="pdf.worker.mjs";var ns=function(n,e){return Number(n.toFixed(e))},BM=function(n,e){return typeof n=="number"?n:e},Wt=function(n,e,t){t&&typeof t=="function"&&t(n,e)},FM=function(n){return-Math.cos(n*Math.PI)/2+.5},UM=function(n){return n},jM=function(n){return n*n},zM=function(n){return n*(2-n)},HM=function(n){return n<.5?2*n*n:-1+(4-2*n)*n},VM=function(n){return n*n*n},WM=function(n){return--n*n*n+1},GM=function(n){return n<.5?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1},XM=function(n){return n*n*n*n},YM=function(n){return 1- --n*n*n*n},$M=function(n){return n<.5?8*n*n*n*n:1-8*--n*n*n*n},KM=function(n){return n*n*n*n*n},qM=function(n){return 1+--n*n*n*n*n},ZM=function(n){return n<.5?16*n*n*n*n*n:1+16*--n*n*n*n*n},TN={easeOut:FM,linear:UM,easeInQuad:jM,easeOutQuad:zM,easeInOutQuad:HM,easeInCubic:VM,easeOutCubic:WM,easeInOutCubic:GM,easeInQuart:XM,easeOutQuart:YM,easeInOutQuart:$M,easeInQuint:KM,easeOutQuint:qM,easeInOutQuint:ZM},IN=function(n){typeof n=="number"&&cancelAnimationFrame(n)},Rs=function(n){n.mounted&&(IN(n.animation),n.animate=!1,n.animation=null,n.velocity=null)};function NN(n,e,t,i){if(n.mounted){var r=new Date().getTime(),o=1;Rs(n),n.animation=function(){if(!n.mounted)return IN(n.animation);var l=new Date().getTime()-r,h=l/t,g=TN[e],p=g(h);l>=t?(i(o),n.animation=null):n.animation&&(i(p),requestAnimationFrame(n.animation))},requestAnimationFrame(n.animation)}}function QM(n){var e=n.scale,t=n.positionX,i=n.positionY;return!(Number.isNaN(e)||Number.isNaN(t)||Number.isNaN(i))}function nc(n,e,t,i){var r=QM(e);if(!(!n.mounted||!r)){var o=n.setTransformState,l=n.transformState,h=l.scale,g=l.positionX,p=l.positionY,x=e.scale-h,y=e.positionX-g,v=e.positionY-p;t===0?o(e.scale,e.positionX,e.positionY):NN(n,i,t,function(C){var R=h+x*C,I=g+y*C,O=p+v*C;o(R,I,O)})}}function JM(n,e,t){var i=n.offsetWidth,r=n.offsetHeight,o=e.offsetWidth,l=e.offsetHeight,h=o*t,g=l*t,p=i-h,x=r-g;return{wrapperWidth:i,wrapperHeight:r,newContentWidth:h,newDiffWidth:p,newContentHeight:g,newDiffHeight:x}}var eO=function(n,e,t,i,r,o,l){var h=n>e?t*(l?1:.5):0,g=i>r?o*(l?1:.5):0,p=n-e-h,x=h,y=i-r-g,v=g;return{minPositionX:p,maxPositionX:x,minPositionY:y,maxPositionY:v}},sS=function(n,e){var t=n.wrapperComponent,i=n.contentComponent,r=n.setup.centerZoomedOut;if(!t||!i)throw new Error("Components are not mounted");var o=JM(t,i,e),l=o.wrapperWidth,h=o.wrapperHeight,g=o.newContentWidth,p=o.newDiffWidth,x=o.newContentHeight,y=o.newDiffHeight,v=eO(l,g,p,h,x,y,!!r);return v},jE=function(n,e,t,i){return i?n<e?ns(e,2):n>t?ns(t,2):ns(n,2):ns(n,2)},Qu=function(n,e){var t=sS(n,e);return n.bounds=t,t};function Fm(n,e,t,i,r,o,l){var h=t.minPositionX,g=t.minPositionY,p=t.maxPositionX,x=t.maxPositionY,y=0,v=0;l&&(y=r,v=o);var C=jE(n,h-y,p+y,i),R=jE(e,g-v,x+v,i);return{x:C,y:R}}function gA(n,e,t,i,r,o){var l=n.transformState,h=l.scale,g=l.positionX,p=l.positionY,x=i-h;if(typeof e!="number"||typeof t!="number")return console.error("Mouse X and Y position were not provided!"),{x:g,y:p};var y=g-e*x,v=p-t*x,C=Fm(y,v,r,o,0,0,null);return C}function Um(n,e,t,i,r){var o=r?i:0,l=e-o;return!Number.isNaN(t)&&n>=t?t:!Number.isNaN(e)&&n<=l?l:n}var v_=function(n,e){var t=n.setup.panning.excluded,i=n.isInitialized,r=n.wrapperComponent,o=e.target,l="shadowRoot"in o&&"composedPath"in e,h=l?e.composedPath().some(function(x){return x instanceof Element?r==null?void 0:r.contains(x):!1}):r==null?void 0:r.contains(o),g=i&&o&&h;if(!g)return!1;var p=pA(o,t);return!p},b_=function(n){var e=n.isInitialized,t=n.isPanning,i=n.setup,r=i.panning.disabled,o=e&&t&&!r;return!!o},tO=function(n,e){var t=n.transformState,i=t.positionX,r=t.positionY;n.isPanning=!0;var o=e.clientX,l=e.clientY;n.startCoords={x:o-i,y:l-r}},nO=function(n,e){var t=e.touches,i=n.transformState,r=i.positionX,o=i.positionY;n.isPanning=!0;var l=t.length===1;if(l){var h=t[0].clientX,g=t[0].clientY;n.startCoords={x:h-r,y:g-o}}};function iO(n){var e=n.transformState,t=e.positionX,i=e.positionY,r=e.scale,o=n.setup,l=o.disabled,h=o.limitToBounds,g=o.centerZoomedOut,p=n.wrapperComponent;if(!(l||!p||!n.bounds)){var x=n.bounds,y=x.maxPositionX,v=x.minPositionX,C=x.maxPositionY,R=x.minPositionY,I=t>y||t<v,O=i>C||i<R,_=t>y?p.offsetWidth:n.setup.minPositionX||0,N=i>C?p.offsetHeight:n.setup.minPositionY||0,k=gA(n,_,N,r,n.bounds,h||g),B=k.x,z=k.y;return{scale:r,positionX:I?B:t,positionY:O?z:i}}}function RN(n,e,t,i,r){var o=n.setup.limitToBounds,l=n.wrapperComponent,h=n.bounds,g=n.transformState,p=g.scale,x=g.positionX,y=g.positionY;if(!(l===null||h===null||e===x&&t===y)){var v=Fm(e,t,h,o,i,r,l),C=v.x,R=v.y;n.setTransformState(p,C,R)}}var rO=function(n,e,t){var i=n.startCoords,r=n.transformState,o=n.setup.panning,l=o.lockAxisX,h=o.lockAxisY,g=r.positionX,p=r.positionY;if(!i)return{x:g,y:p};var x=e-i.x,y=t-i.y,v=l?g:x,C=h?p:y;return{x:v,y:C}},Ql=function(n,e){var t=n.setup,i=n.transformState,r=i.scale,o=t.minScale,l=t.disablePadding;return e>0&&r>=o&&!l?e:0},sO=function(n){var e=n.mounted,t=n.setup,i=t.disabled,r=t.velocityAnimation,o=n.transformState.scale,l=r.disabled,h=!l||o>1||!i||e;return!!h},oO=function(n){var e=n.mounted,t=n.velocity,i=n.bounds,r=n.setup,o=r.disabled,l=r.velocityAnimation,h=n.transformState.scale,g=l.disabled,p=!g||h>1||!o||e;return!(!p||!t||!i)};function aO(n,e){var t=n.setup.velocityAnimation,i=t.equalToMove,r=t.animationTime,o=t.sensitivity;return i?r*e*o:r}function E_(n,e,t,i,r,o,l,h,g,p){if(r){if(e>l&&t>l){var x=l+(n-l)*p;return x>g?g:x<l?l:x}if(e<o&&t<o){var x=o+(n-o)*p;return x<h?h:x>o?o:x}}return i?e:jE(n,o,l,r)}function lO(n,e){var t=1;return e?Math.min(t,n.offsetWidth/window.innerWidth):t}function cO(n,e){var t=sO(n);if(t){var i=n.lastMousePosition,r=n.velocityTime,o=n.setup,l=n.wrapperComponent,h=o.velocityAnimation.equalToMove,g=Date.now();if(i&&r&&l){var p=lO(l,h),x=e.x-i.x,y=e.y-i.y,v=x/p,C=y/p,R=g-r,I=x*x+y*y,O=Math.sqrt(I)/R;n.velocity={velocityX:v,velocityY:C,total:O}}n.lastMousePosition=e,n.velocityTime=g}}function uO(n){var e=n.velocity,t=n.bounds,i=n.setup,r=n.wrapperComponent,o=oO(n);if(!(!o||!e||!t||!r)){var l=e.velocityX,h=e.velocityY,g=e.total,p=t.maxPositionX,x=t.minPositionX,y=t.maxPositionY,v=t.minPositionY,C=i.limitToBounds,R=i.alignmentAnimation,I=i.zoomAnimation,O=i.panning,_=O.lockAxisY,N=O.lockAxisX,k=I.animationType,B=R.sizeX,z=R.sizeY,H=R.velocityAlignmentTime,F=H,Y=aO(n,g),W=Math.max(Y,F),Z=Ql(n,B),te=Ql(n,z),ee=Z*r.offsetWidth/100,le=te*r.offsetHeight/100,ce=p+ee,$=x-ee,oe=y+le,ne=v-le,ie=n.transformState,ge=new Date().getTime();NN(n,k,W,function(ye){var Me=n.transformState,we=Me.scale,me=Me.positionX,Le=Me.positionY,dt=new Date().getTime()-ge,xe=dt/F,He=TN[R.animationType],st=1-He(Math.min(1,xe)),yn=1-ye,bt=me+l*yn,De=Le+h*yn,Cn=E_(bt,ie.positionX,me,N,C,x,p,$,ce,st),Te=E_(De,ie.positionY,Le,_,C,v,y,ne,oe,st);(me!==bt||Le!==De)&&n.setTransformState(we,Cn,Te)})}}function C_(n,e){var t=n.transformState.scale;Rs(n),Qu(n,t),window.TouchEvent!==void 0&&e instanceof TouchEvent?nO(n,e):tO(n,e)}function oS(n,e){var t=n.transformState.scale,i=n.setup,r=i.minScale,o=i.alignmentAnimation,l=o.disabled,h=o.sizeX,g=o.sizeY,p=o.animationTime,x=o.animationType,y=l||t<r||!h&&!g;if(!y){var v=iO(n);v&&nc(n,v,e??p,x)}}function S_(n,e,t){var i=n.startCoords,r=n.setup,o=r.alignmentAnimation,l=o.sizeX,h=o.sizeY;if(i){var g=rO(n,e,t),p=g.x,x=g.y,y=Ql(n,l),v=Ql(n,h);cO(n,{x:p,y:x}),RN(n,p,x,y,v)}}function hO(n){if(n.isPanning){var e=n.setup.panning.velocityDisabled,t=n.velocity,i=n.wrapperComponent,r=n.contentComponent;n.isPanning=!1,n.animate=!1,n.animation=null;var o=i==null?void 0:i.getBoundingClientRect(),l=r==null?void 0:r.getBoundingClientRect(),h=(o==null?void 0:o.width)||0,g=(o==null?void 0:o.height)||0,p=(l==null?void 0:l.width)||0,x=(l==null?void 0:l.height)||0,y=h<p||g<x,v=!e&&t&&(t==null?void 0:t.total)>.1&&y;v?uO(n):oS(n)}}function aS(n,e,t,i){var r=n.setup,o=r.minScale,l=r.maxScale,h=r.limitToBounds,g=Um(ns(e,2),o,l,0,!1),p=Qu(n,g),x=gA(n,t,i,g,p,h),y=x.x,v=x.y;return{scale:g,positionX:y,positionY:v}}function kN(n,e,t){var i=n.transformState.scale,r=n.wrapperComponent,o=n.setup,l=o.minScale,h=o.limitToBounds,g=o.zoomAnimation,p=g.disabled,x=g.animationTime,y=g.animationType,v=p||i>=l;if((i>=1||h)&&oS(n),!(v||!r||!n.mounted)){var C=e||r.offsetWidth/2,R=t||r.offsetHeight/2,I=aS(n,l,C,R);I&&nc(n,I,x,y)}}var Yl=function(){return Yl=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Yl.apply(this,arguments)};function __(n,e,t){if(t||arguments.length===2)for(var i=0,r=e.length,o;i<r;i++)(o||!(i in e))&&(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return n.concat(o||Array.prototype.slice.call(e))}var vx={previousScale:1,scale:1,positionX:0,positionY:0},V0={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},zE={wrapperClass:"react-transform-wrapper",contentClass:"react-transform-component"},PN=function(n){var e,t,i,r;return{previousScale:(e=n.initialScale)!==null&&e!==void 0?e:vx.scale,scale:(t=n.initialScale)!==null&&t!==void 0?t:vx.scale,positionX:(i=n.initialPositionX)!==null&&i!==void 0?i:vx.positionX,positionY:(r=n.initialPositionY)!==null&&r!==void 0?r:vx.positionY}},T_=function(n){var e=Yl({},V0);return Object.keys(n).forEach(function(t){var i=typeof n[t]<"u",r=typeof V0[t]<"u";if(r&&i){var o=Object.prototype.toString.call(V0[t]),l=o==="[object Object]",h=o==="[object Array]";l?e[t]=Yl(Yl({},V0[t]),n[t]):h?e[t]=__(__([],V0[t],!0),n[t],!0):e[t]=n[t]}}),e},DN=function(n,e,t){var i=n.transformState.scale,r=n.wrapperComponent,o=n.setup,l=o.maxScale,h=o.minScale,g=o.zoomAnimation,p=o.smooth,x=g.size;if(!r)throw new Error("Wrapper is not mounted");var y=p?i*Math.exp(e*t):i+e*t,v=Um(ns(y,3),h,l,x,!1);return v};function MN(n,e,t,i,r){var o=n.wrapperComponent,l=n.transformState,h=l.scale,g=l.positionX,p=l.positionY;if(!o)return console.error("No WrapperComponent found");var x=o.offsetWidth,y=o.offsetHeight,v=(x/2-g)/h,C=(y/2-p)/h,R=DN(n,e,t),I=aS(n,R,v,C);if(!I)return console.error("Error during zoom event. New transformation state was not calculated.");nc(n,I,i,r)}function ON(n,e,t,i){var r=n.setup,o=n.wrapperComponent,l=r.limitToBounds,h=PN(n.props),g=n.transformState,p=g.scale,x=g.positionX,y=g.positionY;if(o){var v=sS(n,h.scale),C=Fm(h.positionX,h.positionY,v,l,0,0,o),R={scale:h.scale,positionX:C.x,positionY:C.y};p===h.scale&&x===h.positionX&&y===h.positionY||(i==null||i(),nc(n,R,e,t))}}function dO(n,e,t,i){var r=n.getBoundingClientRect(),o=e.getBoundingClientRect(),l=t.getBoundingClientRect(),h=o.x*i.scale,g=o.y*i.scale;return{x:(r.x-l.x+h)/i.scale,y:(r.y-l.y+g)/i.scale}}function fO(n,e,t){var i=n.wrapperComponent,r=n.contentComponent,o=n.transformState,l=n.setup,h=l.limitToBounds,g=l.minScale,p=l.maxScale;if(!i||!r)return o;var x=i.getBoundingClientRect(),y=e.getBoundingClientRect(),v=dO(e,i,r,o),C=v.x,R=v.y,I=y.width/o.scale,O=y.height/o.scale,_=i.offsetWidth/I,N=i.offsetHeight/O,k=Um(t||Math.min(_,N),g,p,0,!1),B=(x.width-I*k)/2,z=(x.height-O*k)/2,H=(x.left-C)*k+B,F=(x.top-R)*k+z,Y=sS(n,k),W=Fm(H,F,Y,h,0,0,i),Z=W.x,te=W.y;return{positionX:Z,positionY:te,scale:k}}var gO=function(n){return function(e,t,i){e===void 0&&(e=.5),t===void 0&&(t=300),i===void 0&&(i="easeOut"),MN(n,1,e,t,i)}},pO=function(n){return function(e,t,i){e===void 0&&(e=.5),t===void 0&&(t=300),i===void 0&&(i="easeOut"),MN(n,-1,e,t,i)}},mO=function(n){return function(e,t,i,r,o){r===void 0&&(r=300),o===void 0&&(o="easeOut");var l=n.transformState,h=l.positionX,g=l.positionY,p=l.scale,x=n.wrapperComponent,y=n.contentComponent,v=n.setup.disabled;if(!(v||!x||!y)){var C={positionX:Number.isNaN(e)?h:e,positionY:Number.isNaN(t)?g:t,scale:Number.isNaN(i)?p:i};nc(n,C,r,o)}}},xO=function(n){return function(e,t){e===void 0&&(e=200),t===void 0&&(t="easeOut"),ON(n,e,t)}},wO=function(n){return function(e,t,i){t===void 0&&(t=200),i===void 0&&(i="easeOut");var r=n.transformState,o=n.wrapperComponent,l=n.contentComponent;if(o&&l){var h=LN(e||r.scale,o,l);nc(n,h,t,i)}}},yO=function(n){return function(e,t,i,r){i===void 0&&(i=600),r===void 0&&(r="easeOut"),Rs(n);var o=n.wrapperComponent,l=typeof e=="string"?document.getElementById(e):e;if(o&&l&&o.contains(l)){var h=fO(n,l,t);nc(n,h,i,r)}}},HE=function(n){return{instance:n,zoomIn:gO(n),zoomOut:pO(n),setTransform:mO(n),resetTransform:xO(n),centerView:wO(n),zoomToElement:yO(n)}},AO=function(n){return{instance:n,state:n.transformState}},Pt=function(n){var e={};return Object.assign(e,AO(n)),Object.assign(e,HE(n)),e},yv=!1;function Av(){try{var n={get passive(){return yv=!0,!1}};return n}catch{return yv=!1,yv}}var bx=".".concat(zE.wrapperClass),pA=function(n,e){return e.some(function(t){return n.matches("".concat(bx," ").concat(t,", ").concat(bx," .").concat(t,", ").concat(bx," ").concat(t," *, ").concat(bx," .").concat(t," *"))})},VE=function(n){n&&clearTimeout(n)},vO=function(n,e,t){return"translate(".concat(n,"px, ").concat(e,"px) scale(").concat(t,")")},LN=function(n,e,t){var i=t.offsetWidth*n,r=t.offsetHeight*n,o=(e.offsetWidth-i)/2,l=(e.offsetHeight-r)/2;return{scale:n,positionX:o,positionY:l}};function bO(n){return function(e){n.forEach(function(t){typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var EO=function(n,e){var t=n.setup.wheel,i=t.disabled,r=t.wheelDisabled,o=t.touchPadDisabled,l=t.excluded,h=n.isInitialized,g=n.isPanning,p=e.target,x=h&&!g&&!i&&p;if(!x||r&&!e.ctrlKey||o&&e.ctrlKey)return!1;var y=pA(p,l);return!y},CO=function(n){return n?n.deltaY<0?1:-1:0};function SO(n,e){var t=CO(n),i=BM(e,t);return i}function BN(n,e,t){var i=e.getBoundingClientRect(),r=0,o=0;if("clientX"in n)r=(n.clientX-i.left)/t,o=(n.clientY-i.top)/t;else{var l=n.touches[0];r=(l.clientX-i.left)/t,o=(l.clientY-i.top)/t}return(Number.isNaN(r)||Number.isNaN(o))&&console.error("No mouse or touch offset found"),{x:r,y:o}}var _O=function(n,e,t,i,r){var o=n.transformState.scale,l=n.wrapperComponent,h=n.setup,g=h.maxScale,p=h.minScale,x=h.zoomAnimation,y=h.disablePadding,v=x.size,C=x.disabled;if(!l)throw new Error("Wrapper is not mounted");var R=o+e*t;if(r)return R;var I=i?!1:!C,O=Um(ns(R,3),p,g,v,I&&!y);return O},TO=function(n,e){var t=n.previousWheelEvent,i=n.transformState.scale,r=n.setup,o=r.maxScale,l=r.minScale;return t?i<o||i>l||Math.sign(t.deltaY)!==Math.sign(e.deltaY)||t.deltaY>0&&t.deltaY<e.deltaY||t.deltaY<0&&t.deltaY>e.deltaY||Math.sign(t.deltaY)!==Math.sign(e.deltaY):!1},IO=function(n,e){var t=n.setup.pinch,i=t.disabled,r=t.excluded,o=n.isInitialized,l=e.target,h=o&&!i&&l;if(!h)return!1;var g=pA(l,r);return!g},NO=function(n){var e=n.setup.pinch.disabled,t=n.isInitialized,i=n.pinchStartDistance,r=t&&!e&&i;return!!r},RO=function(n,e,t){var i=t.getBoundingClientRect(),r=n.touches,o=ns(r[0].clientX-i.left,5),l=ns(r[0].clientY-i.top,5),h=ns(r[1].clientX-i.left,5),g=ns(r[1].clientY-i.top,5);return{x:(o+h)/2/e,y:(l+g)/2/e}},FN=function(n){return Math.sqrt(Math.pow(n.touches[0].pageX-n.touches[1].pageX,2)+Math.pow(n.touches[0].pageY-n.touches[1].pageY,2))},kO=function(n,e){var t=n.pinchStartScale,i=n.pinchStartDistance,r=n.setup,o=r.maxScale,l=r.minScale,h=r.zoomAnimation,g=r.disablePadding,p=h.size,x=h.disabled;if(!t||i===null||!e)throw new Error("Pinch touches distance was not provided");if(e<0)return n.transformState.scale;var y=e/i,v=y*t;return Um(ns(v,2),l,o,p,!x&&!g)},PO=160,DO=100,MO=function(n,e){var t=n.props,i=t.onWheelStart,r=t.onZoomStart;n.wheelStopEventTimer||(Rs(n),Wt(Pt(n),e,i),Wt(Pt(n),e,r))},OO=function(n,e){var t=n.props,i=t.onWheel,r=t.onZoom,o=n.contentComponent,l=n.setup,h=n.transformState,g=h.scale,p=l.limitToBounds,x=l.centerZoomedOut,y=l.zoomAnimation,v=l.wheel,C=l.disablePadding,R=l.smooth,I=y.size,O=y.disabled,_=v.step,N=v.smoothStep;if(!o)throw new Error("Component not mounted");e.preventDefault(),e.stopPropagation();var k=SO(e,null),B=R?N*Math.abs(e.deltaY):_,z=_O(n,k,B,!e.ctrlKey);if(g!==z){var H=Qu(n,z),F=BN(e,o,g),Y=O||I===0||x||C,W=p&&Y,Z=gA(n,F.x,F.y,z,H,W),te=Z.x,ee=Z.y;n.previousWheelEvent=e,n.setTransformState(z,te,ee),Wt(Pt(n),e,i),Wt(Pt(n),e,r)}},LO=function(n,e){var t=n.props,i=t.onWheelStop,r=t.onZoomStop;VE(n.wheelAnimationTimer),n.wheelAnimationTimer=setTimeout(function(){n.mounted&&(kN(n,e.x,e.y),n.wheelAnimationTimer=null)},DO);var o=TO(n,e);o&&(VE(n.wheelStopEventTimer),n.wheelStopEventTimer=setTimeout(function(){n.mounted&&(n.wheelStopEventTimer=null,Wt(Pt(n),e,i),Wt(Pt(n),e,r))},PO))},UN=function(n){for(var e=0,t=0,i=0;i<2;i+=1)e+=n.touches[i].clientX,t+=n.touches[i].clientY;var r=e/2,o=t/2;return{x:r,y:o}},BO=function(n,e){var t=FN(e);n.pinchStartDistance=t,n.lastDistance=t,n.pinchStartScale=n.transformState.scale,n.isPanning=!1;var i=UN(e);n.pinchLastCenterX=i.x,n.pinchLastCenterY=i.y,Rs(n)},FO=function(n,e){var t=n.contentComponent,i=n.pinchStartDistance,r=n.wrapperComponent,o=n.transformState.scale,l=n.setup,h=l.limitToBounds,g=l.centerZoomedOut,p=l.zoomAnimation,x=l.alignmentAnimation,y=p.disabled,v=p.size;if(!(i===null||!t)){var C=RO(e,o,t);if(!(!Number.isFinite(C.x)||!Number.isFinite(C.y))){var R=FN(e),I=kO(n,R),O=UN(e),_=O.x-(n.pinchLastCenterX||0),N=O.y-(n.pinchLastCenterY||0);if(!(I===o&&_===0&&N===0)){n.pinchLastCenterX=O.x,n.pinchLastCenterY=O.y;var k=Qu(n,I),B=y||v===0||g,z=h&&B,H=gA(n,C.x,C.y,I,k,z),F=H.x,Y=H.y;n.pinchMidpoint=C,n.lastDistance=R;var W=x.sizeX,Z=x.sizeY,te=Ql(n,W),ee=Ql(n,Z),le=F+_,ce=Y+N,$=Fm(le,ce,k,h,te,ee,r),oe=$.x,ne=$.y;n.setTransformState(I,oe,ne)}}}},UO=function(n){var e=n.pinchMidpoint;n.velocity=null,n.lastDistance=null,n.pinchMidpoint=null,n.pinchStartScale=null,n.pinchStartDistance=null,kN(n,e==null?void 0:e.x,e==null?void 0:e.y)},jN=function(n,e){var t=n.props.onZoomStop,i=n.setup.doubleClick.animationTime;VE(n.doubleClickStopEventTimer),n.doubleClickStopEventTimer=setTimeout(function(){n.doubleClickStopEventTimer=null,Wt(Pt(n),e,t)},i)},jO=function(n,e){var t=n.props,i=t.onZoomStart,r=t.onZoom,o=n.setup.doubleClick,l=o.animationTime,h=o.animationType;Wt(Pt(n),e,i),ON(n,l,h,function(){return Wt(Pt(n),e,r)}),jN(n,e)};function zO(n,e){return n==="toggle"?e===1?1:-1:n==="zoomOut"?-1:1}function HO(n,e){var t=n.setup,i=n.doubleClickStopEventTimer,r=n.transformState,o=n.contentComponent,l=r.scale,h=n.props,g=h.onZoomStart,p=h.onZoom,x=t.doubleClick,y=x.disabled,v=x.mode,C=x.step,R=x.animationTime,I=x.animationType;if(!y&&!i){if(v==="reset")return jO(n,e);if(!o)return console.error("No ContentComponent found");var O=zO(v,n.transformState.scale),_=DN(n,O,C);if(l!==_){Wt(Pt(n),e,g);var N=BN(e,o,l),k=aS(n,_,N.x,N.y);if(!k)return console.error("Error during zoom event. New transformation state was not calculated.");Wt(Pt(n),e,p),nc(n,k,R,I),jN(n,e)}}}var VO=function(n,e){var t=n.isInitialized,i=n.setup,r=n.wrapperComponent,o=i.doubleClick,l=o.disabled,h=o.excluded,g=e.target,p=r==null?void 0:r.contains(g),x=t&&g&&p&&!l;if(!x)return!1;var y=pA(g,h);return!y},WO=function(){function n(e){var t=this;this.mounted=!0,this.pinchLastCenterX=null,this.pinchLastCenterY=null,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){t.initializeWindowEvents()},this.unmount=function(){t.cleanupWindowEvents()},this.update=function(i){t.props=i,Qu(t,t.transformState.scale),t.setup=T_(i)},this.initializeWindowEvents=function(){var i,r,o=Av(),l=(i=t.wrapperComponent)===null||i===void 0?void 0:i.ownerDocument,h=l==null?void 0:l.defaultView;(r=t.wrapperComponent)===null||r===void 0||r.addEventListener("wheel",t.onWheelPanning,o),h==null||h.addEventListener("mousedown",t.onPanningStart,o),h==null||h.addEventListener("mousemove",t.onPanning,o),h==null||h.addEventListener("mouseup",t.onPanningStop,o),l==null||l.addEventListener("mouseleave",t.clearPanning,o),h==null||h.addEventListener("keyup",t.setKeyUnPressed,o),h==null||h.addEventListener("keydown",t.setKeyPressed,o)},this.cleanupWindowEvents=function(){var i,r,o=Av(),l=(i=t.wrapperComponent)===null||i===void 0?void 0:i.ownerDocument,h=l==null?void 0:l.defaultView;h==null||h.removeEventListener("mousedown",t.onPanningStart,o),h==null||h.removeEventListener("mousemove",t.onPanning,o),h==null||h.removeEventListener("mouseup",t.onPanningStop,o),l==null||l.removeEventListener("mouseleave",t.clearPanning,o),h==null||h.removeEventListener("keyup",t.setKeyUnPressed,o),h==null||h.removeEventListener("keydown",t.setKeyPressed,o),document.removeEventListener("mouseleave",t.clearPanning,o),Rs(t),(r=t.observer)===null||r===void 0||r.disconnect()},this.handleInitializeWrapperEvents=function(i){var r=Av();i.addEventListener("wheel",t.onWheelZoom,r),i.addEventListener("dblclick",t.onDoubleClick,r),i.addEventListener("touchstart",t.onTouchPanningStart,r),i.addEventListener("touchmove",t.onTouchPanning,r),i.addEventListener("touchend",t.onTouchPanningStop,r)},this.handleInitialize=function(i,r){var o=!1,l=t.setup.centerOnInit,h=function(g,p){for(var x=0,y=g;x<y.length;x++){var v=y[x];if(v.target===p)return!0}return!1};t.applyTransformation(),t.onInitCallbacks.forEach(function(g){g(Pt(t))}),t.observer=new ResizeObserver(function(g){if(h(g,i)||h(g,r))if(l&&!o){var p=r.offsetWidth,x=r.offsetHeight;(p>0||x>0)&&(o=!0,t.setCenter())}else Rs(t),Qu(t,t.transformState.scale),oS(t,0)}),t.observer.observe(i),t.observer.observe(r)},this.onWheelZoom=function(i){var r=t.setup.disabled;if(!r){var o=EO(t,i);if(o){var l=t.isPressingKeys(t.setup.wheel.activationKeys);l&&(MO(t,i),OO(t,i),LO(t,i))}}},this.onWheelPanning=function(i){var r=t.setup,o=r.disabled,l=r.wheel,h=r.panning;if(!(!t.wrapperComponent||!t.contentComponent||o||!l.wheelDisabled||h.disabled||!h.wheelPanning||i.ctrlKey)){i.preventDefault(),i.stopPropagation();var g=t.transformState,p=g.positionX,x=g.positionY,y=p-i.deltaX,v=x-i.deltaY,C=h.lockAxisX?p:y,R=h.lockAxisY?x:v,I=t.setup.alignmentAnimation,O=I.sizeX,_=I.sizeY,N=Ql(t,O),k=Ql(t,_);C===p&&R===x||RN(t,C,R,N,k)}},this.onPanningStart=function(i){var r=t.setup.disabled,o=t.props.onPanningStart;if(!r){var l=v_(t,i);if(l){var h=t.isPressingKeys(t.setup.panning.activationKeys);h&&(i.button===0&&!t.setup.panning.allowLeftClickPan||i.button===1&&!t.setup.panning.allowMiddleClickPan||i.button===2&&!t.setup.panning.allowRightClickPan||(i.preventDefault(),i.stopPropagation(),Rs(t),C_(t,i),Wt(Pt(t),i,o)))}}},this.onPanning=function(i){var r=t.setup.disabled,o=t.props.onPanning;if(!r){var l=b_(t);if(l){var h=t.isPressingKeys(t.setup.panning.activationKeys);h&&(i.preventDefault(),i.stopPropagation(),S_(t,i.clientX,i.clientY),Wt(Pt(t),i,o))}}},this.onPanningStop=function(i){var r=t.props.onPanningStop;t.isPanning&&(hO(t),Wt(Pt(t),i,r))},this.onPinchStart=function(i){var r=t.setup.disabled,o=t.props,l=o.onPinchingStart,h=o.onZoomStart;if(!r){var g=IO(t,i);g&&(BO(t,i),Rs(t),Wt(Pt(t),i,l),Wt(Pt(t),i,h))}},this.onPinch=function(i){var r=t.setup.disabled,o=t.props,l=o.onPinching,h=o.onZoom;if(!r){var g=NO(t);g&&(i.preventDefault(),i.stopPropagation(),FO(t,i),Wt(Pt(t),i,l),Wt(Pt(t),i,h))}},this.onPinchStop=function(i){var r=t.props,o=r.onPinchingStop,l=r.onZoomStop;t.pinchStartScale&&(UO(t),Wt(Pt(t),i,o),Wt(Pt(t),i,l))},this.onTouchPanningStart=function(i){var r=t.setup.disabled,o=t.props.onPanningStart;if(!r){var l=v_(t,i);if(l){var h=t.lastTouch&&+new Date-t.lastTouch<200&&i.touches.length===1;if(!h){t.lastTouch=+new Date,Rs(t);var g=i.touches,p=g.length===1,x=g.length===2;p&&(Rs(t),C_(t,i),Wt(Pt(t),i,o)),x&&t.onPinchStart(i)}}}},this.onTouchPanning=function(i){var r=t.setup.disabled,o=t.props.onPanning;if(t.isPanning&&i.touches.length===1){if(r)return;var l=b_(t);if(!l)return;i.preventDefault(),i.stopPropagation();var h=i.touches[0];S_(t,h.clientX,h.clientY),Wt(Pt(t),i,o)}else i.touches.length>1&&t.onPinch(i)},this.onTouchPanningStop=function(i){t.onPanningStop(i),t.onPinchStop(i)},this.onDoubleClick=function(i){var r=t.setup.disabled;if(!r){var o=VO(t,i);o&&HO(t,i)}},this.clearPanning=function(i){t.isPanning&&t.onPanningStop(i)},this.setKeyPressed=function(i){t.pressedKeys[i.key]=!0},this.setKeyUnPressed=function(i){t.pressedKeys[i.key]=!1},this.isPressingKeys=function(i){return i.length?!!i.find(function(r){return t.pressedKeys[r]}):!0},this.setTransformState=function(i,r,o){var l=t.props.onTransformed;if(!Number.isNaN(i)&&!Number.isNaN(r)&&!Number.isNaN(o)){i!==t.transformState.scale&&(t.transformState.previousScale=t.transformState.scale,t.transformState.scale=i),t.transformState.positionX=r,t.transformState.positionY=o,t.applyTransformation();var h=Pt(t);t.onChangeCallbacks.forEach(function(g){return g(h)}),Wt(h,{scale:i,positionX:r,positionY:o},l)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(t.wrapperComponent&&t.contentComponent){var i=LN(t.transformState.scale,t.wrapperComponent,t.contentComponent);t.setTransformState(i.scale,i.positionX,i.positionY)}},this.handleTransformStyles=function(i,r,o){return t.props.customTransform?t.props.customTransform(i,r,o):vO(i,r,o)},this.applyTransformation=function(){if(!(!t.mounted||!t.contentComponent)){var i=t.transformState,r=i.scale,o=i.positionX,l=i.positionY,h=t.handleTransformStyles(o,l,r);t.contentComponent.style.transform=h}},this.getContext=function(){return Pt(t)},this.onChange=function(i){return t.onChangeCallbacks.has(i)||t.onChangeCallbacks.add(i),function(){t.onChangeCallbacks.delete(i)}},this.onInit=function(i){return t.onInitCallbacks.has(i)||t.onInitCallbacks.add(i),function(){t.onInitCallbacks.delete(i)}},this.init=function(i,r){t.cleanupWindowEvents(),t.wrapperComponent=i,t.contentComponent=r,Qu(t,t.transformState.scale),t.handleInitializeWrapperEvents(i),t.handleInitialize(i,r),t.initializeWindowEvents(),t.isInitialized=!0;var o=Pt(t);Wt(o,void 0,t.props.onInit)},this.props=e,this.setup=T_(this.props),this.transformState=PN(this.props)}return n}(),lS=ma.createContext(null),GO=function(n,e){return typeof n=="function"?n(e):n},XO=ma.forwardRef(function(n,e){var t=re.useRef(new WO(n)).current,i=GO(n.children,HE(t));return re.useImperativeHandle(e,function(){return HE(t)},[t]),re.useEffect(function(){t.update(n)},[t,n]),ma.createElement(lS.Provider,{value:t},i)});ma.forwardRef(function(n,e){var t=re.useRef(null),i=re.useContext(lS);return re.useEffect(function(){return i.onChange(function(r){if(t.current){var o=0,l=0;t.current.style.transform=i.handleTransformStyles(o,l,1/r.instance.transformState.scale)}})},[i]),ma.createElement("div",Yl({},n,{ref:bO([t,e])}))});function YO(n,e){e===void 0&&(e={});var t=e.insertAt;if(!(!n||typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=n:r.appendChild(document.createTextNode(n))}}var $O=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
  transform: translate3d(0, 0, 0);
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,I_={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};YO($O);var KO=function(n){var e=n.children,t=n.wrapperClass,i=t===void 0?"":t,r=n.contentClass,o=r===void 0?"":r,l=n.wrapperStyle,h=n.contentStyle,g=n.wrapperProps,p=g===void 0?{}:g,x=n.contentProps,y=x===void 0?{}:x,v=re.useContext(lS),C=v.init,R=v.cleanupWindowEvents,I=re.useRef(null),O=re.useRef(null);return re.useEffect(function(){var _=I.current,N=O.current;return _!==null&&N!==null&&C&&(C==null||C(_,N)),function(){R==null||R()}},[]),ma.createElement("div",Yl({},p,{ref:I,className:"".concat(zE.wrapperClass," ").concat(I_.wrapper," ").concat(i),style:l}),ma.createElement("div",Yl({},y,{ref:O,className:"".concat(zE.contentClass," ").concat(I_.content," ").concat(o),style:h}),e))},Ee;(function(n){n[n.QR_CODE=0]="QR_CODE",n[n.AZTEC=1]="AZTEC",n[n.CODABAR=2]="CODABAR",n[n.CODE_39=3]="CODE_39",n[n.CODE_93=4]="CODE_93",n[n.CODE_128=5]="CODE_128",n[n.DATA_MATRIX=6]="DATA_MATRIX",n[n.MAXICODE=7]="MAXICODE",n[n.ITF=8]="ITF",n[n.EAN_13=9]="EAN_13",n[n.EAN_8=10]="EAN_8",n[n.PDF_417=11]="PDF_417",n[n.RSS_14=12]="RSS_14",n[n.RSS_EXPANDED=13]="RSS_EXPANDED",n[n.UPC_A=14]="UPC_A",n[n.UPC_E=15]="UPC_E",n[n.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Ee||(Ee={}));var N_=new Map([[Ee.QR_CODE,"QR_CODE"],[Ee.AZTEC,"AZTEC"],[Ee.CODABAR,"CODABAR"],[Ee.CODE_39,"CODE_39"],[Ee.CODE_93,"CODE_93"],[Ee.CODE_128,"CODE_128"],[Ee.DATA_MATRIX,"DATA_MATRIX"],[Ee.MAXICODE,"MAXICODE"],[Ee.ITF,"ITF"],[Ee.EAN_13,"EAN_13"],[Ee.EAN_8,"EAN_8"],[Ee.PDF_417,"PDF_417"],[Ee.RSS_14,"RSS_14"],[Ee.RSS_EXPANDED,"RSS_EXPANDED"],[Ee.UPC_A,"UPC_A"],[Ee.UPC_E,"UPC_E"],[Ee.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),R_;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.URL=1]="URL"})(R_||(R_={}));function qO(n){return Object.values(Ee).includes(n)}var K2;(function(n){n[n.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",n[n.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(K2||(K2={}));var ZO=function(){function n(){}return n.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",n.SCAN_DEFAULT_FPS=2,n.DEFAULT_DISABLE_FLIP=!1,n.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,n.DEFAULT_SUPPORTED_SCAN_TYPE=[K2.SCAN_TYPE_CAMERA,K2.SCAN_TYPE_FILE],n}(),zN=function(){function n(e,t){this.format=e,this.formatName=t}return n.prototype.toString=function(){return this.formatName},n.create=function(e){if(!N_.has(e))throw"".concat(e," not in html5QrcodeSupportedFormatsTextMap");return new n(e,N_.get(e))},n}(),k_=function(){function n(){}return n.createFromText=function(e){var t={text:e};return{decodedText:e,result:t}},n.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}},n}(),WE;(function(n){n[n.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",n[n.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",n[n.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(WE||(WE={}));var QO=function(){function n(){}return n.createFrom=function(e){return{errorMessage:e,type:WE.UNKWOWN_ERROR}},n}(),JO=function(){function n(e){this.verbose=e}return n.prototype.log=function(e){this.verbose&&console.log(e)},n.prototype.warn=function(e){this.verbose&&console.warn(e)},n.prototype.logError=function(e,t){(this.verbose||t===!0)&&console.error(e)},n.prototype.logErrors=function(e){if(e.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(e)},n}();function So(n){return typeof n>"u"||n===null}var Xh=function(){function n(){}return n.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},n.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},n.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},n.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},n.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},n.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},n.scannerPaused=function(){return"Scanner paused"},n}(),HN=function(){function n(){}return n.isMediaStreamConstraintsValid=function(e,t){if(typeof e!="object"){var i=typeof e;return t.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(i,"."),!0),!1}for(var r=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],o=new Set(r),l=Object.keys(e),h=0,g=l;h<g.length;h++){var p=g[h];if(o.has(p))return t.logError("".concat(p," is not supported videoConstaints."),!0),!1}return!0},n}(),GE={exports:{}};(function(n,e){(function(t,i){i(e)})(R0,function(t){function i(D){return D==null}var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(D,s){D.__proto__=s}||function(D,s){for(var a in s)s.hasOwnProperty(a)&&(D[a]=s[a])};function o(D,s){r(D,s);function a(){this.constructor=D}D.prototype=s===null?Object.create(s):(a.prototype=s.prototype,new a)}function l(D,s){var a=Object.setPrototypeOf;a?a(D,s):D.__proto__=s}function h(D,s){s===void 0&&(s=D.constructor);var a=Error.captureStackTrace;a&&a(D,s)}var g=function(D){o(s,D);function s(a){var c=this.constructor,d=D.call(this,a)||this;return Object.defineProperty(d,"name",{value:c.name,enumerable:!1}),l(d,c.prototype),h(d),d}return s}(Error);class p extends g{constructor(s=void 0){super(s),this.message=s}getKind(){return this.constructor.kind}}p.kind="Exception";class x extends p{}x.kind="ArgumentException";class y extends p{}y.kind="IllegalArgumentException";class v{constructor(s){if(this.binarizer=s,s===null)throw new y("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(s,a){return this.binarizer.getBlackRow(s,a)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(s,a,c,d){const f=this.binarizer.getLuminanceSource().crop(s,a,c,d);return new v(this.binarizer.createBinarizer(f))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const s=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new v(this.binarizer.createBinarizer(s))}rotateCounterClockwise45(){const s=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new v(this.binarizer.createBinarizer(s))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class C extends p{static getChecksumInstance(){return new C}}C.kind="ChecksumException";class R{constructor(s){this.source=s}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class I{static arraycopy(s,a,c,d,f){for(;f--;)c[d++]=s[a++]}static currentTimeMillis(){return Date.now()}}class O extends p{}O.kind="IndexOutOfBoundsException";class _ extends O{constructor(s=void 0,a=void 0){super(a),this.index=s,this.message=a}}_.kind="ArrayIndexOutOfBoundsException";class N{static fill(s,a){for(let c=0,d=s.length;c<d;c++)s[c]=a}static fillWithin(s,a,c,d){N.rangeCheck(s.length,a,c);for(let f=a;f<c;f++)s[f]=d}static rangeCheck(s,a,c){if(a>c)throw new y("fromIndex("+a+") > toIndex("+c+")");if(a<0)throw new _(a);if(c>s)throw new _(c)}static asList(...s){return s}static create(s,a,c){return Array.from({length:s}).map(f=>Array.from({length:a}).fill(c))}static createInt32Array(s,a,c){return Array.from({length:s}).map(f=>Int32Array.from({length:a}).fill(c))}static equals(s,a){if(!s||!a||!s.length||!a.length||s.length!==a.length)return!1;for(let c=0,d=s.length;c<d;c++)if(s[c]!==a[c])return!1;return!0}static hashCode(s){if(s===null)return 0;let a=1;for(const c of s)a=31*a+c;return a}static fillUint8Array(s,a){for(let c=0;c!==s.length;c++)s[c]=a}static copyOf(s,a){return s.slice(0,a)}static copyOfUint8Array(s,a){if(s.length<=a){const c=new Uint8Array(a);return c.set(s),c}return s.slice(0,a)}static copyOfRange(s,a,c){const d=c-a,f=new Int32Array(d);return I.arraycopy(s,a,f,0,d),f}static binarySearch(s,a,c){c===void 0&&(c=N.numberComparator);let d=0,f=s.length-1;for(;d<=f;){const m=f+d>>1,w=c(a,s[m]);if(w>0)d=m+1;else if(w<0)f=m-1;else return m}return-d-1}static numberComparator(s,a){return s-a}}class k{static numberOfTrailingZeros(s){let a;if(s===0)return 32;let c=31;return a=s<<16,a!==0&&(c-=16,s=a),a=s<<8,a!==0&&(c-=8,s=a),a=s<<4,a!==0&&(c-=4,s=a),a=s<<2,a!==0&&(c-=2,s=a),c-(s<<1>>>31)}static numberOfLeadingZeros(s){if(s===0)return 32;let a=1;return s>>>16||(a+=16,s<<=16),s>>>24||(a+=8,s<<=8),s>>>28||(a+=4,s<<=4),s>>>30||(a+=2,s<<=2),a-=s>>>31,a}static toHexString(s){return s.toString(16)}static toBinaryString(s){return String(parseInt(String(s),2))}static bitCount(s){return s=s-(s>>>1&1431655765),s=(s&858993459)+(s>>>2&858993459),s=s+(s>>>4)&252645135,s=s+(s>>>8),s=s+(s>>>16),s&63}static truncDivision(s,a){return Math.trunc(s/a)}static parseInt(s,a=void 0){return parseInt(s,a)}}k.MIN_VALUE_32_BITS=-2147483648,k.MAX_VALUE=Number.MAX_SAFE_INTEGER;class B{constructor(s,a){s===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=s,a==null?this.bits=B.makeArray(s):this.bits=a)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(s){if(s>this.bits.length*32){const a=B.makeArray(s);I.arraycopy(this.bits,0,a,0,this.bits.length),this.bits=a}}get(s){return(this.bits[Math.floor(s/32)]&1<<(s&31))!==0}set(s){this.bits[Math.floor(s/32)]|=1<<(s&31)}flip(s){this.bits[Math.floor(s/32)]^=1<<(s&31)}getNextSet(s){const a=this.size;if(s>=a)return a;const c=this.bits;let d=Math.floor(s/32),f=c[d];f&=~((1<<(s&31))-1);const m=c.length;for(;f===0;){if(++d===m)return a;f=c[d]}const w=d*32+k.numberOfTrailingZeros(f);return w>a?a:w}getNextUnset(s){const a=this.size;if(s>=a)return a;const c=this.bits;let d=Math.floor(s/32),f=~c[d];f&=~((1<<(s&31))-1);const m=c.length;for(;f===0;){if(++d===m)return a;f=~c[d]}const w=d*32+k.numberOfTrailingZeros(f);return w>a?a:w}setBulk(s,a){this.bits[Math.floor(s/32)]=a}setRange(s,a){if(a<s||s<0||a>this.size)throw new y;if(a===s)return;a--;const c=Math.floor(s/32),d=Math.floor(a/32),f=this.bits;for(let m=c;m<=d;m++){const w=m>c?0:s&31,b=(2<<(m<d?31:a&31))-(1<<w);f[m]|=b}}clear(){const s=this.bits.length,a=this.bits;for(let c=0;c<s;c++)a[c]=0}isRange(s,a,c){if(a<s||s<0||a>this.size)throw new y;if(a===s)return!0;a--;const d=Math.floor(s/32),f=Math.floor(a/32),m=this.bits;for(let w=d;w<=f;w++){const A=w>d?0:s&31,T=(2<<(w<f?31:a&31))-(1<<A)&4294967295;if((m[w]&T)!==(c?T:0))return!1}return!0}appendBit(s){this.ensureCapacity(this.size+1),s&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(s,a){if(a<0||a>32)throw new y("Num bits must be between 0 and 32");this.ensureCapacity(this.size+a);for(let c=a;c>0;c--)this.appendBit((s>>c-1&1)===1)}appendBitArray(s){const a=s.size;this.ensureCapacity(this.size+a);for(let c=0;c<a;c++)this.appendBit(s.get(c))}xor(s){if(this.size!==s.size)throw new y("Sizes don't match");const a=this.bits;for(let c=0,d=a.length;c<d;c++)a[c]^=s.bits[c]}toBytes(s,a,c,d){for(let f=0;f<d;f++){let m=0;for(let w=0;w<8;w++)this.get(s)&&(m|=1<<7-w),s++;a[c+f]=m}}getBitArray(){return this.bits}reverse(){const s=new Int32Array(this.bits.length),a=Math.floor((this.size-1)/32),c=a+1,d=this.bits;for(let f=0;f<c;f++){let m=d[f];m=m>>1&1431655765|(m&1431655765)<<1,m=m>>2&858993459|(m&858993459)<<2,m=m>>4&252645135|(m&252645135)<<4,m=m>>8&16711935|(m&16711935)<<8,m=m>>16&65535|(m&65535)<<16,s[a-f]=m}if(this.size!==c*32){const f=c*32-this.size;let m=s[0]>>>f;for(let w=1;w<c;w++){const A=s[w];m|=A<<32-f,s[w-1]=m,m=A>>>f}s[c-1]=m}this.bits=s}static makeArray(s){return new Int32Array(Math.floor((s+31)/32))}equals(s){if(!(s instanceof B))return!1;const a=s;return this.size===a.size&&N.equals(this.bits,a.bits)}hashCode(){return 31*this.size+N.hashCode(this.bits)}toString(){let s="";for(let a=0,c=this.size;a<c;a++)a&7||(s+=" "),s+=this.get(a)?"X":".";return s}clone(){return new B(this.size,this.bits.slice())}}var z;(function(D){D[D.OTHER=0]="OTHER",D[D.PURE_BARCODE=1]="PURE_BARCODE",D[D.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",D[D.TRY_HARDER=3]="TRY_HARDER",D[D.CHARACTER_SET=4]="CHARACTER_SET",D[D.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",D[D.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",D[D.ASSUME_GS1=7]="ASSUME_GS1",D[D.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",D[D.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",D[D.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(z||(z={}));var H=z;class F extends p{static getFormatInstance(){return new F}}F.kind="FormatException";var Y;(function(D){D[D.Cp437=0]="Cp437",D[D.ISO8859_1=1]="ISO8859_1",D[D.ISO8859_2=2]="ISO8859_2",D[D.ISO8859_3=3]="ISO8859_3",D[D.ISO8859_4=4]="ISO8859_4",D[D.ISO8859_5=5]="ISO8859_5",D[D.ISO8859_6=6]="ISO8859_6",D[D.ISO8859_7=7]="ISO8859_7",D[D.ISO8859_8=8]="ISO8859_8",D[D.ISO8859_9=9]="ISO8859_9",D[D.ISO8859_10=10]="ISO8859_10",D[D.ISO8859_11=11]="ISO8859_11",D[D.ISO8859_13=12]="ISO8859_13",D[D.ISO8859_14=13]="ISO8859_14",D[D.ISO8859_15=14]="ISO8859_15",D[D.ISO8859_16=15]="ISO8859_16",D[D.SJIS=16]="SJIS",D[D.Cp1250=17]="Cp1250",D[D.Cp1251=18]="Cp1251",D[D.Cp1252=19]="Cp1252",D[D.Cp1256=20]="Cp1256",D[D.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",D[D.UTF8=22]="UTF8",D[D.ASCII=23]="ASCII",D[D.Big5=24]="Big5",D[D.GB18030=25]="GB18030",D[D.EUC_KR=26]="EUC_KR"})(Y||(Y={}));class W{constructor(s,a,c,...d){this.valueIdentifier=s,this.name=c,typeof a=="number"?this.values=Int32Array.from([a]):this.values=a,this.otherEncodingNames=d,W.VALUE_IDENTIFIER_TO_ECI.set(s,this),W.NAME_TO_ECI.set(c,this);const f=this.values;for(let m=0,w=f.length;m!==w;m++){const A=f[m];W.VALUES_TO_ECI.set(A,this)}for(const m of d)W.NAME_TO_ECI.set(m,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(s){if(s<0||s>=900)throw new F("incorect value");const a=W.VALUES_TO_ECI.get(s);if(a===void 0)throw new F("incorect value");return a}static getCharacterSetECIByName(s){const a=W.NAME_TO_ECI.get(s);if(a===void 0)throw new F("incorect value");return a}equals(s){if(!(s instanceof W))return!1;const a=s;return this.getName()===a.getName()}}W.VALUE_IDENTIFIER_TO_ECI=new Map,W.VALUES_TO_ECI=new Map,W.NAME_TO_ECI=new Map,W.Cp437=new W(Y.Cp437,Int32Array.from([0,2]),"Cp437"),W.ISO8859_1=new W(Y.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),W.ISO8859_2=new W(Y.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),W.ISO8859_3=new W(Y.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),W.ISO8859_4=new W(Y.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),W.ISO8859_5=new W(Y.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),W.ISO8859_6=new W(Y.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),W.ISO8859_7=new W(Y.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),W.ISO8859_8=new W(Y.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),W.ISO8859_9=new W(Y.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),W.ISO8859_10=new W(Y.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),W.ISO8859_11=new W(Y.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),W.ISO8859_13=new W(Y.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),W.ISO8859_14=new W(Y.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),W.ISO8859_15=new W(Y.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),W.ISO8859_16=new W(Y.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),W.SJIS=new W(Y.SJIS,20,"SJIS","Shift_JIS"),W.Cp1250=new W(Y.Cp1250,21,"Cp1250","windows-1250"),W.Cp1251=new W(Y.Cp1251,22,"Cp1251","windows-1251"),W.Cp1252=new W(Y.Cp1252,23,"Cp1252","windows-1252"),W.Cp1256=new W(Y.Cp1256,24,"Cp1256","windows-1256"),W.UnicodeBigUnmarked=new W(Y.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),W.UTF8=new W(Y.UTF8,26,"UTF8","UTF-8"),W.ASCII=new W(Y.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),W.Big5=new W(Y.Big5,28,"Big5"),W.GB18030=new W(Y.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),W.EUC_KR=new W(Y.EUC_KR,30,"EUC_KR","EUC-KR");class Z extends p{}Z.kind="UnsupportedOperationException";class te{static decode(s,a){const c=this.encodingName(a);return this.customDecoder?this.customDecoder(s,c):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(c)?this.decodeFallback(s,c):new TextDecoder(c).decode(s)}static shouldDecodeOnFallback(s){return!te.isBrowser()&&s==="ISO-8859-1"}static encode(s,a){const c=this.encodingName(a);return this.customEncoder?this.customEncoder(s,c):typeof TextEncoder>"u"?this.encodeFallback(s):new TextEncoder().encode(s)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(s){return typeof s=="string"?s:s.getName()}static encodingCharacterSet(s){return s instanceof W?s:W.getCharacterSetECIByName(s)}static decodeFallback(s,a){const c=this.encodingCharacterSet(a);if(te.isDecodeFallbackSupported(c)){let d="";for(let f=0,m=s.length;f<m;f++){let w=s[f].toString(16);w.length<2&&(w="0"+w),d+="%"+w}return decodeURIComponent(d)}if(c.equals(W.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(s.buffer));throw new Z(`Encoding ${this.encodingName(a)} not supported by fallback.`)}static isDecodeFallbackSupported(s){return s.equals(W.UTF8)||s.equals(W.ISO8859_1)||s.equals(W.ASCII)}static encodeFallback(s){const c=btoa(unescape(encodeURIComponent(s))).split(""),d=[];for(let f=0;f<c.length;f++)d.push(c[f].charCodeAt(0));return new Uint8Array(d)}}class ee{static castAsNonUtf8Char(s,a=null){const c=a?a.getName():this.ISO88591;return te.decode(new Uint8Array([s]),c)}static guessEncoding(s,a){if(a!=null&&a.get(H.CHARACTER_SET)!==void 0)return a.get(H.CHARACTER_SET).toString();const c=s.length;let d=!0,f=!0,m=!0,w=0,A=0,b=0,T=0,M=0,L=0,V=0,G=0,X=0,K=0,J=0;const de=s.length>3&&s[0]===239&&s[1]===187&&s[2]===191;for(let fe=0;fe<c&&(d||f||m);fe++){const ae=s[fe]&255;m&&(w>0?ae&128?w--:m=!1:ae&128&&(ae&64?(w++,ae&32?(w++,ae&16?(w++,ae&8?m=!1:T++):b++):A++):m=!1)),d&&(ae>127&&ae<160?d=!1:ae>159&&(ae<192||ae===215||ae===247)&&J++),f&&(M>0?ae<64||ae===127||ae>252?f=!1:M--:ae===128||ae===160||ae>239?f=!1:ae>160&&ae<224?(L++,G=0,V++,V>X&&(X=V)):ae>127?(M++,V=0,G++,G>K&&(K=G)):(V=0,G=0))}return m&&w>0&&(m=!1),f&&M>0&&(f=!1),m&&(de||A+b+T>0)?ee.UTF8:f&&(ee.ASSUME_SHIFT_JIS||X>=3||K>=3)?ee.SHIFT_JIS:d&&f?X===2&&L===2||J*10>=c?ee.SHIFT_JIS:ee.ISO88591:d?ee.ISO88591:f?ee.SHIFT_JIS:m?ee.UTF8:ee.PLATFORM_DEFAULT_ENCODING}static format(s,...a){let c=-1;function d(m,w,A,b,T,M){if(m==="%%")return"%";if(a[++c]===void 0)return;m=b?parseInt(b.substr(1)):void 0;let L=T?parseInt(T.substr(1)):void 0,V;switch(M){case"s":V=a[c];break;case"c":V=a[c][0];break;case"f":V=parseFloat(a[c]).toFixed(m);break;case"p":V=parseFloat(a[c]).toPrecision(m);break;case"e":V=parseFloat(a[c]).toExponential(m);break;case"x":V=parseInt(a[c]).toString(L||16);break;case"d":V=parseFloat(parseInt(a[c],L||10).toPrecision(m)).toFixed(0);break}V=typeof V=="object"?JSON.stringify(V):(+V).toString(L);let G=parseInt(A),X=A&&A[0]+""=="0"?"0":" ";for(;V.length<G;)V=w!==void 0?V+X:X+V;return V}let f=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return s.replace(f,d)}static getBytes(s,a){return te.encode(s,a)}static getCharCode(s,a=0){return s.charCodeAt(a)}static getCharAt(s){return String.fromCharCode(s)}}ee.SHIFT_JIS=W.SJIS.getName(),ee.GB2312="GB2312",ee.ISO88591=W.ISO8859_1.getName(),ee.EUC_JP="EUC_JP",ee.UTF8=W.UTF8.getName(),ee.PLATFORM_DEFAULT_ENCODING=ee.UTF8,ee.ASSUME_SHIFT_JIS=!1;class le{constructor(s=""){this.value=s}enableDecoding(s){return this.encoding=s,this}append(s){return typeof s=="string"?this.value+=s.toString():this.encoding?this.value+=ee.castAsNonUtf8Char(s,this.encoding):this.value+=String.fromCharCode(s),this}appendChars(s,a,c){for(let d=a;a<a+c;d++)this.append(s[d]);return this}length(){return this.value.length}charAt(s){return this.value.charAt(s)}deleteCharAt(s){this.value=this.value.substr(0,s)+this.value.substring(s+1)}setCharAt(s,a){this.value=this.value.substr(0,s)+a+this.value.substr(s+1)}substring(s,a){return this.value.substring(s,a)}setLengthToZero(){this.value=""}toString(){return this.value}insert(s,a){this.value=this.value.substr(0,s)+a+this.value.substr(s+a.length)}}class ce{constructor(s,a,c,d){if(this.width=s,this.height=a,this.rowSize=c,this.bits=d,a==null&&(a=s),this.height=a,s<1||a<1)throw new y("Both dimensions must be greater than 0");c==null&&(c=Math.floor((s+31)/32)),this.rowSize=c,d==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(s){const a=s.length,c=s[0].length,d=new ce(c,a);for(let f=0;f<a;f++){const m=s[f];for(let w=0;w<c;w++)m[w]&&d.set(w,f)}return d}static parseFromString(s,a,c){if(s===null)throw new y("stringRepresentation cannot be null");const d=new Array(s.length);let f=0,m=0,w=-1,A=0,b=0;for(;b<s.length;)if(s.charAt(b)===`
`||s.charAt(b)==="\r"){if(f>m){if(w===-1)w=f-m;else if(f-m!==w)throw new y("row lengths do not match");m=f,A++}b++}else if(s.substring(b,b+a.length)===a)b+=a.length,d[f]=!0,f++;else if(s.substring(b,b+c.length)===c)b+=c.length,d[f]=!1,f++;else throw new y("illegal character encountered: "+s.substring(b));if(f>m){if(w===-1)w=f-m;else if(f-m!==w)throw new y("row lengths do not match");A++}const T=new ce(w,A);for(let M=0;M<f;M++)d[M]&&T.set(Math.floor(M%w),Math.floor(M/w));return T}get(s,a){const c=a*this.rowSize+Math.floor(s/32);return(this.bits[c]>>>(s&31)&1)!==0}set(s,a){const c=a*this.rowSize+Math.floor(s/32);this.bits[c]|=1<<(s&31)&4294967295}unset(s,a){const c=a*this.rowSize+Math.floor(s/32);this.bits[c]&=~(1<<(s&31)&4294967295)}flip(s,a){const c=a*this.rowSize+Math.floor(s/32);this.bits[c]^=1<<(s&31)&4294967295}xor(s){if(this.width!==s.getWidth()||this.height!==s.getHeight()||this.rowSize!==s.getRowSize())throw new y("input matrix dimensions do not match");const a=new B(Math.floor(this.width/32)+1),c=this.rowSize,d=this.bits;for(let f=0,m=this.height;f<m;f++){const w=f*c,A=s.getRow(f,a).getBitArray();for(let b=0;b<c;b++)d[w+b]^=A[b]}}clear(){const s=this.bits,a=s.length;for(let c=0;c<a;c++)s[c]=0}setRegion(s,a,c,d){if(a<0||s<0)throw new y("Left and top must be nonnegative");if(d<1||c<1)throw new y("Height and width must be at least 1");const f=s+c,m=a+d;if(m>this.height||f>this.width)throw new y("The region must fit inside the matrix");const w=this.rowSize,A=this.bits;for(let b=a;b<m;b++){const T=b*w;for(let M=s;M<f;M++)A[T+Math.floor(M/32)]|=1<<(M&31)&4294967295}}getRow(s,a){a==null||a.getSize()<this.width?a=new B(this.width):a.clear();const c=this.rowSize,d=this.bits,f=s*c;for(let m=0;m<c;m++)a.setBulk(m*32,d[f+m]);return a}setRow(s,a){I.arraycopy(a.getBitArray(),0,this.bits,s*this.rowSize,this.rowSize)}rotate180(){const s=this.getWidth(),a=this.getHeight();let c=new B(s),d=new B(s);for(let f=0,m=Math.floor((a+1)/2);f<m;f++)c=this.getRow(f,c),d=this.getRow(a-1-f,d),c.reverse(),d.reverse(),this.setRow(f,d),this.setRow(a-1-f,c)}getEnclosingRectangle(){const s=this.width,a=this.height,c=this.rowSize,d=this.bits;let f=s,m=a,w=-1,A=-1;for(let b=0;b<a;b++)for(let T=0;T<c;T++){const M=d[b*c+T];if(M!==0){if(b<m&&(m=b),b>A&&(A=b),T*32<f){let L=0;for(;!(M<<31-L&4294967295);)L++;T*32+L<f&&(f=T*32+L)}if(T*32+31>w){let L=31;for(;!(M>>>L);)L--;T*32+L>w&&(w=T*32+L)}}}return w<f||A<m?null:Int32Array.from([f,m,w-f+1,A-m+1])}getTopLeftOnBit(){const s=this.rowSize,a=this.bits;let c=0;for(;c<a.length&&a[c]===0;)c++;if(c===a.length)return null;const d=c/s;let f=c%s*32;const m=a[c];let w=0;for(;!(m<<31-w&4294967295);)w++;return f+=w,Int32Array.from([f,d])}getBottomRightOnBit(){const s=this.rowSize,a=this.bits;let c=a.length-1;for(;c>=0&&a[c]===0;)c--;if(c<0)return null;const d=Math.floor(c/s);let f=Math.floor(c%s)*32;const m=a[c];let w=31;for(;!(m>>>w);)w--;return f+=w,Int32Array.from([f,d])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(s){if(!(s instanceof ce))return!1;const a=s;return this.width===a.width&&this.height===a.height&&this.rowSize===a.rowSize&&N.equals(this.bits,a.bits)}hashCode(){let s=this.width;return s=31*s+this.width,s=31*s+this.height,s=31*s+this.rowSize,s=31*s+N.hashCode(this.bits),s}toString(s="X ",a="  ",c=`
`){return this.buildToString(s,a,c)}buildToString(s,a,c){let d=new le;for(let f=0,m=this.height;f<m;f++){for(let w=0,A=this.width;w<A;w++)d.append(this.get(w,f)?s:a);d.append(c)}return d.toString()}clone(){return new ce(this.width,this.height,this.rowSize,this.bits.slice())}}class $ extends p{static getNotFoundInstance(){return new $}}$.kind="NotFoundException";class oe extends R{constructor(s){super(s),this.luminances=oe.EMPTY,this.buckets=new Int32Array(oe.LUMINANCE_BUCKETS)}getBlackRow(s,a){const c=this.getLuminanceSource(),d=c.getWidth();a==null||a.getSize()<d?a=new B(d):a.clear(),this.initArrays(d);const f=c.getRow(s,this.luminances),m=this.buckets;for(let A=0;A<d;A++)m[(f[A]&255)>>oe.LUMINANCE_SHIFT]++;const w=oe.estimateBlackPoint(m);if(d<3)for(let A=0;A<d;A++)(f[A]&255)<w&&a.set(A);else{let A=f[0]&255,b=f[1]&255;for(let T=1;T<d-1;T++){const M=f[T+1]&255;(b*4-A-M)/2<w&&a.set(T),A=b,b=M}}return a}getBlackMatrix(){const s=this.getLuminanceSource(),a=s.getWidth(),c=s.getHeight(),d=new ce(a,c);this.initArrays(a);const f=this.buckets;for(let A=1;A<5;A++){const b=Math.floor(c*A/5),T=s.getRow(b,this.luminances),M=Math.floor(a*4/5);for(let L=Math.floor(a/5);L<M;L++){const V=T[L]&255;f[V>>oe.LUMINANCE_SHIFT]++}}const m=oe.estimateBlackPoint(f),w=s.getMatrix();for(let A=0;A<c;A++){const b=A*a;for(let T=0;T<a;T++)(w[b+T]&255)<m&&d.set(T,A)}return d}createBinarizer(s){return new oe(s)}initArrays(s){this.luminances.length<s&&(this.luminances=new Uint8ClampedArray(s));const a=this.buckets;for(let c=0;c<oe.LUMINANCE_BUCKETS;c++)a[c]=0}static estimateBlackPoint(s){const a=s.length;let c=0,d=0,f=0;for(let T=0;T<a;T++)s[T]>f&&(d=T,f=s[T]),s[T]>c&&(c=s[T]);let m=0,w=0;for(let T=0;T<a;T++){const M=T-d,L=s[T]*M*M;L>w&&(m=T,w=L)}if(d>m){const T=d;d=m,m=T}if(m-d<=a/16)throw new $;let A=m-1,b=-1;for(let T=m-1;T>d;T--){const M=T-d,L=M*M*(m-T)*(c-s[T]);L>b&&(A=T,b=L)}return A<<oe.LUMINANCE_SHIFT}}oe.LUMINANCE_BITS=5,oe.LUMINANCE_SHIFT=8-oe.LUMINANCE_BITS,oe.LUMINANCE_BUCKETS=1<<oe.LUMINANCE_BITS,oe.EMPTY=Uint8ClampedArray.from([0]);class ne extends oe{constructor(s){super(s),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const s=this.getLuminanceSource(),a=s.getWidth(),c=s.getHeight();if(a>=ne.MINIMUM_DIMENSION&&c>=ne.MINIMUM_DIMENSION){const d=s.getMatrix();let f=a>>ne.BLOCK_SIZE_POWER;a&ne.BLOCK_SIZE_MASK&&f++;let m=c>>ne.BLOCK_SIZE_POWER;c&ne.BLOCK_SIZE_MASK&&m++;const w=ne.calculateBlackPoints(d,f,m,a,c),A=new ce(a,c);ne.calculateThresholdForBlock(d,f,m,a,c,w,A),this.matrix=A}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(s){return new ne(s)}static calculateThresholdForBlock(s,a,c,d,f,m,w){const A=f-ne.BLOCK_SIZE,b=d-ne.BLOCK_SIZE;for(let T=0;T<c;T++){let M=T<<ne.BLOCK_SIZE_POWER;M>A&&(M=A);const L=ne.cap(T,2,c-3);for(let V=0;V<a;V++){let G=V<<ne.BLOCK_SIZE_POWER;G>b&&(G=b);const X=ne.cap(V,2,a-3);let K=0;for(let de=-2;de<=2;de++){const fe=m[L+de];K+=fe[X-2]+fe[X-1]+fe[X]+fe[X+1]+fe[X+2]}const J=K/25;ne.thresholdBlock(s,G,M,J,d,w)}}}static cap(s,a,c){return s<a?a:s>c?c:s}static thresholdBlock(s,a,c,d,f,m){for(let w=0,A=c*f+a;w<ne.BLOCK_SIZE;w++,A+=f)for(let b=0;b<ne.BLOCK_SIZE;b++)(s[A+b]&255)<=d&&m.set(a+b,c+w)}static calculateBlackPoints(s,a,c,d,f){const m=f-ne.BLOCK_SIZE,w=d-ne.BLOCK_SIZE,A=new Array(c);for(let b=0;b<c;b++){A[b]=new Int32Array(a);let T=b<<ne.BLOCK_SIZE_POWER;T>m&&(T=m);for(let M=0;M<a;M++){let L=M<<ne.BLOCK_SIZE_POWER;L>w&&(L=w);let V=0,G=255,X=0;for(let J=0,de=T*d+L;J<ne.BLOCK_SIZE;J++,de+=d){for(let fe=0;fe<ne.BLOCK_SIZE;fe++){const ae=s[de+fe]&255;V+=ae,ae<G&&(G=ae),ae>X&&(X=ae)}if(X-G>ne.MIN_DYNAMIC_RANGE)for(J++,de+=d;J<ne.BLOCK_SIZE;J++,de+=d)for(let fe=0;fe<ne.BLOCK_SIZE;fe++)V+=s[de+fe]&255}let K=V>>ne.BLOCK_SIZE_POWER*2;if(X-G<=ne.MIN_DYNAMIC_RANGE&&(K=G/2,b>0&&M>0)){const J=(A[b-1][M]+2*A[b][M-1]+A[b-1][M-1])/4;G<J&&(K=J)}A[b][M]=K}}return A}}ne.BLOCK_SIZE_POWER=3,ne.BLOCK_SIZE=1<<ne.BLOCK_SIZE_POWER,ne.BLOCK_SIZE_MASK=ne.BLOCK_SIZE-1,ne.MINIMUM_DIMENSION=ne.BLOCK_SIZE*5,ne.MIN_DYNAMIC_RANGE=24;class ie{constructor(s,a){this.width=s,this.height=a}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(s,a,c,d){throw new Z("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new Z("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new Z("This luminance source does not support rotation by 45 degrees.")}toString(){const s=new Uint8ClampedArray(this.width);let a=new le;for(let c=0;c<this.height;c++){const d=this.getRow(c,s);for(let f=0;f<this.width;f++){const m=d[f]&255;let w;m<64?w="#":m<128?w="+":m<192?w=".":w=" ",a.append(w)}a.append(`
`)}return a.toString()}}class ge extends ie{constructor(s){super(s.getWidth(),s.getHeight()),this.delegate=s}getRow(s,a){const c=this.delegate.getRow(s,a),d=this.getWidth();for(let f=0;f<d;f++)c[f]=255-(c[f]&255);return c}getMatrix(){const s=this.delegate.getMatrix(),a=this.getWidth()*this.getHeight(),c=new Uint8ClampedArray(a);for(let d=0;d<a;d++)c[d]=255-(s[d]&255);return c}isCropSupported(){return this.delegate.isCropSupported()}crop(s,a,c,d){return new ge(this.delegate.crop(s,a,c,d))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new ge(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new ge(this.delegate.rotateCounterClockwise45())}}class ye extends ie{constructor(s){super(s.width,s.height),this.canvas=s,this.tempCanvasElement=null,this.buffer=ye.makeBufferFromCanvasImageData(s)}static makeBufferFromCanvasImageData(s){const a=s.getContext("2d").getImageData(0,0,s.width,s.height);return ye.toGrayscaleBuffer(a.data,s.width,s.height)}static toGrayscaleBuffer(s,a,c){const d=new Uint8ClampedArray(a*c);for(let f=0,m=0,w=s.length;f<w;f+=4,m++){let A;if(s[f+3]===0)A=255;else{const T=s[f],M=s[f+1],L=s[f+2];A=306*T+601*M+117*L+512>>10}d[m]=A}return d}getRow(s,a){if(s<0||s>=this.getHeight())throw new y("Requested row is outside the image: "+s);const c=this.getWidth(),d=s*c;return a===null?a=this.buffer.slice(d,d+c):(a.length<c&&(a=new Uint8ClampedArray(c)),a.set(this.buffer.slice(d,d+c))),a}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(s,a,c,d){return super.crop(s,a,c,d),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const s=this.canvas.ownerDocument.createElement("canvas");s.width=this.canvas.width,s.height=this.canvas.height,this.tempCanvasElement=s}return this.tempCanvasElement}rotate(s){const a=this.getTempCanvasElement(),c=a.getContext("2d"),d=s*ye.DEGREE_TO_RADIANS,f=this.canvas.width,m=this.canvas.height,w=Math.ceil(Math.abs(Math.cos(d))*f+Math.abs(Math.sin(d))*m),A=Math.ceil(Math.abs(Math.sin(d))*f+Math.abs(Math.cos(d))*m);return a.width=w,a.height=A,c.translate(w/2,A/2),c.rotate(d),c.drawImage(this.canvas,f/-2,m/-2),this.buffer=ye.makeBufferFromCanvasImageData(a),this}invert(){return new ge(this)}}ye.DEGREE_TO_RADIANS=Math.PI/180;class Me{constructor(s,a,c){this.deviceId=s,this.label=a,this.kind="videoinput",this.groupId=c||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var we=(globalThis||R0||self||window||void 0)&&(globalThis||R0||self||window||void 0).__awaiter||function(D,s,a,c){function d(f){return f instanceof a?f:new a(function(m){m(f)})}return new(a||(a=Promise))(function(f,m){function w(T){try{b(c.next(T))}catch(M){m(M)}}function A(T){try{b(c.throw(T))}catch(M){m(M)}}function b(T){T.done?f(T.value):d(T.value).then(w,A)}b((c=c.apply(D,s||[])).next())})};class me{constructor(s,a=500,c){this.reader=s,this.timeBetweenScansMillis=a,this._hints=c,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(s){this._timeBetweenDecodingAttempts=s<0?0:s}set hints(s){this._hints=s||null}get hints(){return this._hints}listVideoInputDevices(){return we(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const s=yield navigator.mediaDevices.enumerateDevices(),a=[];for(const c of s){const d=c.kind==="video"?"videoinput":c.kind;if(d!=="videoinput")continue;const f=c.deviceId||c.id,m=c.label||`Video device ${a.length+1}`,w=c.groupId,A={deviceId:f,label:m,kind:d,groupId:w};a.push(A)}return a})}getVideoInputDevices(){return we(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(a=>new Me(a.deviceId,a.label))})}findDeviceById(s){return we(this,void 0,void 0,function*(){const a=yield this.listVideoInputDevices();return a?a.find(c=>c.deviceId===s):null})}decodeFromInputVideoDevice(s,a){return we(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(s,a)})}decodeOnceFromVideoDevice(s,a){return we(this,void 0,void 0,function*(){this.reset();let c;s?c={deviceId:{exact:s}}:c={facingMode:"environment"};const d={video:c};return yield this.decodeOnceFromConstraints(d,a)})}decodeOnceFromConstraints(s,a){return we(this,void 0,void 0,function*(){const c=yield navigator.mediaDevices.getUserMedia(s);return yield this.decodeOnceFromStream(c,a)})}decodeOnceFromStream(s,a){return we(this,void 0,void 0,function*(){this.reset();const c=yield this.attachStreamToVideo(s,a);return yield this.decodeOnce(c)})}decodeFromInputVideoDeviceContinuously(s,a,c){return we(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(s,a,c)})}decodeFromVideoDevice(s,a,c){return we(this,void 0,void 0,function*(){let d;s?d={deviceId:{exact:s}}:d={facingMode:"environment"};const f={video:d};return yield this.decodeFromConstraints(f,a,c)})}decodeFromConstraints(s,a,c){return we(this,void 0,void 0,function*(){const d=yield navigator.mediaDevices.getUserMedia(s);return yield this.decodeFromStream(d,a,c)})}decodeFromStream(s,a,c){return we(this,void 0,void 0,function*(){this.reset();const d=yield this.attachStreamToVideo(s,a);return yield this.decodeContinuously(d,c)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(s,a){return we(this,void 0,void 0,function*(){const c=this.prepareVideoElement(a);return this.addVideoSource(c,s),this.videoElement=c,this.stream=s,yield this.playVideoOnLoadAsync(c),c})}playVideoOnLoadAsync(s){return new Promise((a,c)=>this.playVideoOnLoad(s,()=>a()))}playVideoOnLoad(s,a){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(s),s.addEventListener("ended",this.videoEndedListener),s.addEventListener("canplay",this.videoCanPlayListener),s.addEventListener("playing",a),this.tryPlayVideo(s)}isVideoPlaying(s){return s.currentTime>0&&!s.paused&&!s.ended&&s.readyState>2}tryPlayVideo(s){return we(this,void 0,void 0,function*(){if(this.isVideoPlaying(s)){console.warn("Trying to play video that is already playing.");return}try{yield s.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(s,a){const c=document.getElementById(s);if(!c)throw new x(`element with id '${s}' not found`);if(c.nodeName.toLowerCase()!==a.toLowerCase())throw new x(`element with id '${s}' must be an ${a} element`);return c}decodeFromImage(s,a){if(!s&&!a)throw new x("either imageElement with a src set or an url must be provided");return a&&!s?this.decodeFromImageUrl(a):this.decodeFromImageElement(s)}decodeFromVideo(s,a){if(!s&&!a)throw new x("Either an element with a src set or an URL must be provided");return a&&!s?this.decodeFromVideoUrl(a):this.decodeFromVideoElement(s)}decodeFromVideoContinuously(s,a,c){if(s===void 0&&a===void 0)throw new x("Either an element with a src set or an URL must be provided");return a&&!s?this.decodeFromVideoUrlContinuously(a,c):this.decodeFromVideoElementContinuously(s,c)}decodeFromImageElement(s){if(!s)throw new x("An image element must be provided.");this.reset();const a=this.prepareImageElement(s);this.imageElement=a;let c;return this.isImageLoaded(a)?c=this.decodeOnce(a,!1,!0):c=this._decodeOnLoadImage(a),c}decodeFromVideoElement(s){const a=this._decodeFromVideoElementSetup(s);return this._decodeOnLoadVideo(a)}decodeFromVideoElementContinuously(s,a){const c=this._decodeFromVideoElementSetup(s);return this._decodeOnLoadVideoContinuously(c,a)}_decodeFromVideoElementSetup(s){if(!s)throw new x("A video element must be provided.");this.reset();const a=this.prepareVideoElement(s);return this.videoElement=a,a}decodeFromImageUrl(s){if(!s)throw new x("An URL must be provided.");this.reset();const a=this.prepareImageElement();this.imageElement=a;const c=this._decodeOnLoadImage(a);return a.src=s,c}decodeFromVideoUrl(s){if(!s)throw new x("An URL must be provided.");this.reset();const a=this.prepareVideoElement(),c=this.decodeFromVideoElement(a);return a.src=s,c}decodeFromVideoUrlContinuously(s,a){if(!s)throw new x("An URL must be provided.");this.reset();const c=this.prepareVideoElement(),d=this.decodeFromVideoElementContinuously(c,a);return c.src=s,d}_decodeOnLoadImage(s){return new Promise((a,c)=>{this.imageLoadedListener=()=>this.decodeOnce(s,!1,!0).then(a,c),s.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(s){return we(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(s),yield this.decodeOnce(s)})}_decodeOnLoadVideoContinuously(s,a){return we(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(s),this.decodeContinuously(s,a)})}isImageLoaded(s){return!(!s.complete||s.naturalWidth===0)}prepareImageElement(s){let a;return typeof s>"u"&&(a=document.createElement("img"),a.width=200,a.height=200),typeof s=="string"&&(a=this.getMediaElement(s,"img")),s instanceof HTMLImageElement&&(a=s),a}prepareVideoElement(s){let a;return!s&&typeof document<"u"&&(a=document.createElement("video"),a.width=200,a.height=200),typeof s=="string"&&(a=this.getMediaElement(s,"video")),s instanceof HTMLVideoElement&&(a=s),a.setAttribute("autoplay","true"),a.setAttribute("muted","true"),a.setAttribute("playsinline","true"),a}decodeOnce(s,a=!0,c=!0){this._stopAsyncDecode=!1;const d=(f,m)=>{if(this._stopAsyncDecode){m(new $("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const w=this.decode(s);f(w)}catch(w){const A=a&&w instanceof $,T=(w instanceof C||w instanceof F)&&c;if(A||T)return setTimeout(d,this._timeBetweenDecodingAttempts,f,m);m(w)}};return new Promise((f,m)=>d(f,m))}decodeContinuously(s,a){this._stopContinuousDecode=!1;const c=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const d=this.decode(s);a(d,null),setTimeout(c,this.timeBetweenScansMillis)}catch(d){a(null,d);const f=d instanceof C||d instanceof F,m=d instanceof $;(f||m)&&setTimeout(c,this._timeBetweenDecodingAttempts)}};c()}decode(s){const a=this.createBinaryBitmap(s);return this.decodeBitmap(a)}_isHTMLVideoElement(s){return s.videoWidth!==0}drawFrameOnCanvas(s,a,c){a||(a={sx:0,sy:0,sWidth:s.videoWidth,sHeight:s.videoHeight,dx:0,dy:0,dWidth:s.videoWidth,dHeight:s.videoHeight}),c||(c=this.captureCanvasContext),c.drawImage(s,a.sx,a.sy,a.sWidth,a.sHeight,a.dx,a.dy,a.dWidth,a.dHeight)}drawImageOnCanvas(s,a,c=this.captureCanvasContext){a||(a={sx:0,sy:0,sWidth:s.naturalWidth,sHeight:s.naturalHeight,dx:0,dy:0,dWidth:s.naturalWidth,dHeight:s.naturalHeight}),c||(c=this.captureCanvasContext),c.drawImage(s,a.sx,a.sy,a.sWidth,a.sHeight,a.dx,a.dy,a.dWidth,a.dHeight)}createBinaryBitmap(s){this.getCaptureCanvasContext(s),this._isHTMLVideoElement(s)?this.drawFrameOnCanvas(s):this.drawImageOnCanvas(s);const a=this.getCaptureCanvas(s),c=new ye(a),d=new ne(c);return new v(d)}getCaptureCanvasContext(s){if(!this.captureCanvasContext){const c=this.getCaptureCanvas(s).getContext("2d");this.captureCanvasContext=c}return this.captureCanvasContext}getCaptureCanvas(s){if(!this.captureCanvas){const a=this.createCaptureCanvas(s);this.captureCanvas=a}return this.captureCanvas}decodeBitmap(s){return this.reader.decode(s,this._hints)}createCaptureCanvas(s){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const a=document.createElement("canvas");let c,d;return typeof s<"u"&&(s instanceof HTMLVideoElement?(c=s.videoWidth,d=s.videoHeight):s instanceof HTMLImageElement&&(c=s.naturalWidth||s.width,d=s.naturalHeight||s.height)),a.style.width=c+"px",a.style.height=d+"px",a.width=c,a.height=d,a}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(s=>s.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(s,a){try{s.srcObject=a}catch{s.src=URL.createObjectURL(a)}}cleanVideoSource(s){try{s.srcObject=null}catch{s.src=""}this.videoElement.removeAttribute("src")}}class Le{constructor(s,a,c=a==null?0:8*a.length,d,f,m=I.currentTimeMillis()){this.text=s,this.rawBytes=a,this.numBits=c,this.resultPoints=d,this.format=f,this.timestamp=m,this.text=s,this.rawBytes=a,c==null?this.numBits=a==null?0:8*a.length:this.numBits=c,this.resultPoints=d,this.format=f,this.resultMetadata=null,m==null?this.timestamp=I.currentTimeMillis():this.timestamp=m}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(s,a){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(s,a)}putAllMetadata(s){s!==null&&(this.resultMetadata===null?this.resultMetadata=s:this.resultMetadata=new Map(s))}addResultPoints(s){const a=this.resultPoints;if(a===null)this.resultPoints=s;else if(s!==null&&s.length>0){const c=new Array(a.length+s.length);I.arraycopy(a,0,c,0,a.length),I.arraycopy(s,0,c,a.length,s.length),this.resultPoints=c}}getTimestamp(){return this.timestamp}toString(){return this.text}}var dt;(function(D){D[D.AZTEC=0]="AZTEC",D[D.CODABAR=1]="CODABAR",D[D.CODE_39=2]="CODE_39",D[D.CODE_93=3]="CODE_93",D[D.CODE_128=4]="CODE_128",D[D.DATA_MATRIX=5]="DATA_MATRIX",D[D.EAN_8=6]="EAN_8",D[D.EAN_13=7]="EAN_13",D[D.ITF=8]="ITF",D[D.MAXICODE=9]="MAXICODE",D[D.PDF_417=10]="PDF_417",D[D.QR_CODE=11]="QR_CODE",D[D.RSS_14=12]="RSS_14",D[D.RSS_EXPANDED=13]="RSS_EXPANDED",D[D.UPC_A=14]="UPC_A",D[D.UPC_E=15]="UPC_E",D[D.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(dt||(dt={}));var xe=dt,He;(function(D){D[D.OTHER=0]="OTHER",D[D.ORIENTATION=1]="ORIENTATION",D[D.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",D[D.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",D[D.ISSUE_NUMBER=4]="ISSUE_NUMBER",D[D.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",D[D.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",D[D.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",D[D.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",D[D.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",D[D.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(He||(He={}));var st=He;class yn{constructor(s,a,c,d,f=-1,m=-1){this.rawBytes=s,this.text=a,this.byteSegments=c,this.ecLevel=d,this.structuredAppendSequenceNumber=f,this.structuredAppendParity=m,this.numBits=s==null?0:8*s.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(s){this.numBits=s}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(s){this.errorsCorrected=s}getErasures(){return this.erasures}setErasures(s){this.erasures=s}getOther(){return this.other}setOther(s){this.other=s}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class bt{exp(s){return this.expTable[s]}log(s){if(s===0)throw new y;return this.logTable[s]}static addOrSubtract(s,a){return s^a}}class De{constructor(s,a){if(a.length===0)throw new y;this.field=s;const c=a.length;if(c>1&&a[0]===0){let d=1;for(;d<c&&a[d]===0;)d++;d===c?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(c-d),I.arraycopy(a,d,this.coefficients,0,this.coefficients.length))}else this.coefficients=a}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(s){return this.coefficients[this.coefficients.length-1-s]}evaluateAt(s){if(s===0)return this.getCoefficient(0);const a=this.coefficients;let c;if(s===1){c=0;for(let m=0,w=a.length;m!==w;m++){const A=a[m];c=bt.addOrSubtract(c,A)}return c}c=a[0];const d=a.length,f=this.field;for(let m=1;m<d;m++)c=bt.addOrSubtract(f.multiply(s,c),a[m]);return c}addOrSubtract(s){if(!this.field.equals(s.field))throw new y("GenericGFPolys do not have same GenericGF field");if(this.isZero())return s;if(s.isZero())return this;let a=this.coefficients,c=s.coefficients;if(a.length>c.length){const m=a;a=c,c=m}let d=new Int32Array(c.length);const f=c.length-a.length;I.arraycopy(c,0,d,0,f);for(let m=f;m<c.length;m++)d[m]=bt.addOrSubtract(a[m-f],c[m]);return new De(this.field,d)}multiply(s){if(!this.field.equals(s.field))throw new y("GenericGFPolys do not have same GenericGF field");if(this.isZero()||s.isZero())return this.field.getZero();const a=this.coefficients,c=a.length,d=s.coefficients,f=d.length,m=new Int32Array(c+f-1),w=this.field;for(let A=0;A<c;A++){const b=a[A];for(let T=0;T<f;T++)m[A+T]=bt.addOrSubtract(m[A+T],w.multiply(b,d[T]))}return new De(w,m)}multiplyScalar(s){if(s===0)return this.field.getZero();if(s===1)return this;const a=this.coefficients.length,c=this.field,d=new Int32Array(a),f=this.coefficients;for(let m=0;m<a;m++)d[m]=c.multiply(f[m],s);return new De(c,d)}multiplyByMonomial(s,a){if(s<0)throw new y;if(a===0)return this.field.getZero();const c=this.coefficients,d=c.length,f=new Int32Array(d+s),m=this.field;for(let w=0;w<d;w++)f[w]=m.multiply(c[w],a);return new De(m,f)}divide(s){if(!this.field.equals(s.field))throw new y("GenericGFPolys do not have same GenericGF field");if(s.isZero())throw new y("Divide by 0");const a=this.field;let c=a.getZero(),d=this;const f=s.getCoefficient(s.getDegree()),m=a.inverse(f);for(;d.getDegree()>=s.getDegree()&&!d.isZero();){const w=d.getDegree()-s.getDegree(),A=a.multiply(d.getCoefficient(d.getDegree()),m),b=s.multiplyByMonomial(w,A),T=a.buildMonomial(w,A);c=c.addOrSubtract(T),d=d.addOrSubtract(b)}return[c,d]}toString(){let s="";for(let a=this.getDegree();a>=0;a--){let c=this.getCoefficient(a);if(c!==0){if(c<0?(s+=" - ",c=-c):s.length>0&&(s+=" + "),a===0||c!==1){const d=this.field.log(c);d===0?s+="1":d===1?s+="a":(s+="a^",s+=d)}a!==0&&(a===1?s+="x":(s+="x^",s+=a))}}return s}}class Cn extends p{}Cn.kind="ArithmeticException";class Te extends bt{constructor(s,a,c){super(),this.primitive=s,this.size=a,this.generatorBase=c;const d=new Int32Array(a);let f=1;for(let w=0;w<a;w++)d[w]=f,f*=2,f>=a&&(f^=s,f&=a-1);this.expTable=d;const m=new Int32Array(a);for(let w=0;w<a-1;w++)m[d[w]]=w;this.logTable=m,this.zero=new De(this,Int32Array.from([0])),this.one=new De(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(s,a){if(s<0)throw new y;if(a===0)return this.zero;const c=new Int32Array(s+1);return c[0]=a,new De(this,c)}inverse(s){if(s===0)throw new Cn;return this.expTable[this.size-this.logTable[s]-1]}multiply(s,a){return s===0||a===0?0:this.expTable[(this.logTable[s]+this.logTable[a])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+k.toHexString(this.primitive)+","+this.size+")"}equals(s){return s===this}}Te.AZTEC_DATA_12=new Te(4201,4096,1),Te.AZTEC_DATA_10=new Te(1033,1024,1),Te.AZTEC_DATA_6=new Te(67,64,1),Te.AZTEC_PARAM=new Te(19,16,1),Te.QR_CODE_FIELD_256=new Te(285,256,0),Te.DATA_MATRIX_FIELD_256=new Te(301,256,1),Te.AZTEC_DATA_8=Te.DATA_MATRIX_FIELD_256,Te.MAXICODE_FIELD_64=Te.AZTEC_DATA_6;class Qe extends p{}Qe.kind="ReedSolomonException";class rt extends p{}rt.kind="IllegalStateException";class tn{constructor(s){this.field=s}decode(s,a){const c=this.field,d=new De(c,s),f=new Int32Array(a);let m=!0;for(let V=0;V<a;V++){const G=d.evaluateAt(c.exp(V+c.getGeneratorBase()));f[f.length-1-V]=G,G!==0&&(m=!1)}if(m)return;const w=new De(c,f),A=this.runEuclideanAlgorithm(c.buildMonomial(a,1),w,a),b=A[0],T=A[1],M=this.findErrorLocations(b),L=this.findErrorMagnitudes(T,M);for(let V=0;V<M.length;V++){const G=s.length-1-c.log(M[V]);if(G<0)throw new Qe("Bad error location");s[G]=Te.addOrSubtract(s[G],L[V])}}runEuclideanAlgorithm(s,a,c){if(s.getDegree()<a.getDegree()){const V=s;s=a,a=V}const d=this.field;let f=s,m=a,w=d.getZero(),A=d.getOne();for(;m.getDegree()>=(c/2|0);){let V=f,G=w;if(f=m,w=A,f.isZero())throw new Qe("r_{i-1} was zero");m=V;let X=d.getZero();const K=f.getCoefficient(f.getDegree()),J=d.inverse(K);for(;m.getDegree()>=f.getDegree()&&!m.isZero();){const de=m.getDegree()-f.getDegree(),fe=d.multiply(m.getCoefficient(m.getDegree()),J);X=X.addOrSubtract(d.buildMonomial(de,fe)),m=m.addOrSubtract(f.multiplyByMonomial(de,fe))}if(A=X.multiply(w).addOrSubtract(G),m.getDegree()>=f.getDegree())throw new rt("Division algorithm failed to reduce polynomial?")}const b=A.getCoefficient(0);if(b===0)throw new Qe("sigmaTilde(0) was zero");const T=d.inverse(b),M=A.multiplyScalar(T),L=m.multiplyScalar(T);return[M,L]}findErrorLocations(s){const a=s.getDegree();if(a===1)return Int32Array.from([s.getCoefficient(1)]);const c=new Int32Array(a);let d=0;const f=this.field;for(let m=1;m<f.getSize()&&d<a;m++)s.evaluateAt(m)===0&&(c[d]=f.inverse(m),d++);if(d!==a)throw new Qe("Error locator degree does not match number of roots");return c}findErrorMagnitudes(s,a){const c=a.length,d=new Int32Array(c),f=this.field;for(let m=0;m<c;m++){const w=f.inverse(a[m]);let A=1;for(let b=0;b<c;b++)if(m!==b){const T=f.multiply(a[b],w),M=T&1?T&-2:T|1;A=f.multiply(A,M)}d[m]=f.multiply(s.evaluateAt(w),f.inverse(A)),f.getGeneratorBase()!==0&&(d[m]=f.multiply(d[m],w))}return d}}var Xe;(function(D){D[D.UPPER=0]="UPPER",D[D.LOWER=1]="LOWER",D[D.MIXED=2]="MIXED",D[D.DIGIT=3]="DIGIT",D[D.PUNCT=4]="PUNCT",D[D.BINARY=5]="BINARY"})(Xe||(Xe={}));class ut{decode(s){this.ddata=s;let a=s.getBits(),c=this.extractBits(a),d=this.correctBits(c),f=ut.convertBoolArrayToByteArray(d),m=ut.getEncodedData(d),w=new yn(f,m,null,null);return w.setNumBits(d.length),w}static highLevelDecode(s){return this.getEncodedData(s)}static getEncodedData(s){let a=s.length,c=Xe.UPPER,d=Xe.UPPER,f="",m=0;for(;m<a;)if(d===Xe.BINARY){if(a-m<5)break;let w=ut.readCode(s,m,5);if(m+=5,w===0){if(a-m<11)break;w=ut.readCode(s,m,11)+31,m+=11}for(let A=0;A<w;A++){if(a-m<8){m=a;break}const b=ut.readCode(s,m,8);f+=ee.castAsNonUtf8Char(b),m+=8}d=c}else{let w=d===Xe.DIGIT?4:5;if(a-m<w)break;let A=ut.readCode(s,m,w);m+=w;let b=ut.getCharacter(d,A);b.startsWith("CTRL_")?(c=d,d=ut.getTable(b.charAt(5)),b.charAt(6)==="L"&&(c=d)):(f+=b,d=c)}return f}static getTable(s){switch(s){case"L":return Xe.LOWER;case"P":return Xe.PUNCT;case"M":return Xe.MIXED;case"D":return Xe.DIGIT;case"B":return Xe.BINARY;case"U":default:return Xe.UPPER}}static getCharacter(s,a){switch(s){case Xe.UPPER:return ut.UPPER_TABLE[a];case Xe.LOWER:return ut.LOWER_TABLE[a];case Xe.MIXED:return ut.MIXED_TABLE[a];case Xe.PUNCT:return ut.PUNCT_TABLE[a];case Xe.DIGIT:return ut.DIGIT_TABLE[a];default:throw new rt("Bad table")}}correctBits(s){let a,c;this.ddata.getNbLayers()<=2?(c=6,a=Te.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(c=8,a=Te.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(c=10,a=Te.AZTEC_DATA_10):(c=12,a=Te.AZTEC_DATA_12);let d=this.ddata.getNbDatablocks(),f=s.length/c;if(f<d)throw new F;let m=s.length%c,w=new Int32Array(f);for(let L=0;L<f;L++,m+=c)w[L]=ut.readCode(s,m,c);try{new tn(a).decode(w,f-d)}catch(L){throw new F(L)}let A=(1<<c)-1,b=0;for(let L=0;L<d;L++){let V=w[L];if(V===0||V===A)throw new F;(V===1||V===A-1)&&b++}let T=new Array(d*c-b),M=0;for(let L=0;L<d;L++){let V=w[L];if(V===1||V===A-1)T.fill(V>1,M,M+c-1),M+=c-1;else for(let G=c-1;G>=0;--G)T[M++]=(V&1<<G)!==0}return T}extractBits(s){let a=this.ddata.isCompact(),c=this.ddata.getNbLayers(),d=(a?11:14)+c*4,f=new Int32Array(d),m=new Array(this.totalBitsInLayer(c,a));if(a)for(let w=0;w<f.length;w++)f[w]=w;else{let w=d+1+2*k.truncDivision(k.truncDivision(d,2)-1,15),A=d/2,b=k.truncDivision(w,2);for(let T=0;T<A;T++){let M=T+k.truncDivision(T,15);f[A-T-1]=b-M-1,f[A+T]=b+M+1}}for(let w=0,A=0;w<c;w++){let b=(c-w)*4+(a?9:12),T=w*2,M=d-1-T;for(let L=0;L<b;L++){let V=L*2;for(let G=0;G<2;G++)m[A+V+G]=s.get(f[T+G],f[T+L]),m[A+2*b+V+G]=s.get(f[T+L],f[M-G]),m[A+4*b+V+G]=s.get(f[M-G],f[M-L]),m[A+6*b+V+G]=s.get(f[M-L],f[T+G])}A+=b*8}return m}static readCode(s,a,c){let d=0;for(let f=a;f<a+c;f++)d<<=1,s[f]&&(d|=1);return d}static readByte(s,a){let c=s.length-a;return c>=8?ut.readCode(s,a,8):ut.readCode(s,a,c)<<8-c}static convertBoolArrayToByteArray(s){let a=new Uint8Array((s.length+7)/8);for(let c=0;c<a.length;c++)a[c]=ut.readByte(s,8*c);return a}totalBitsInLayer(s,a){return((a?88:112)+16*s)*s}}ut.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],ut.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],ut.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],ut.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],ut.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class $e{constructor(){}static round(s){return s===NaN?0:s<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:s>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:s+(s<0?-.5:.5)|0}static distance(s,a,c,d){const f=s-c,m=a-d;return Math.sqrt(f*f+m*m)}static sum(s){let a=0;for(let c=0,d=s.length;c!==d;c++){const f=s[c];a+=f}return a}}class Os{static floatToIntBits(s){return s}}Os.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Se{constructor(s,a){this.x=s,this.y=a}getX(){return this.x}getY(){return this.y}equals(s){if(s instanceof Se){const a=s;return this.x===a.x&&this.y===a.y}return!1}hashCode(){return 31*Os.floatToIntBits(this.x)+Os.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(s){const a=this.distance(s[0],s[1]),c=this.distance(s[1],s[2]),d=this.distance(s[0],s[2]);let f,m,w;if(c>=a&&c>=d?(m=s[0],f=s[1],w=s[2]):d>=c&&d>=a?(m=s[1],f=s[0],w=s[2]):(m=s[2],f=s[0],w=s[1]),this.crossProductZ(f,m,w)<0){const A=f;f=w,w=A}s[0]=f,s[1]=m,s[2]=w}static distance(s,a){return $e.distance(s.x,s.y,a.x,a.y)}static crossProductZ(s,a,c){const d=a.x,f=a.y;return(c.x-d)*(s.y-f)-(c.y-f)*(s.x-d)}}class os{constructor(s,a){this.bits=s,this.points=a}getBits(){return this.bits}getPoints(){return this.points}}class Ca extends os{constructor(s,a,c,d,f){super(s,a),this.compact=c,this.nbDatablocks=d,this.nbLayers=f}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Di{constructor(s,a,c,d){this.image=s,this.height=s.getHeight(),this.width=s.getWidth(),a==null&&(a=Di.INIT_SIZE),c==null&&(c=s.getWidth()/2|0),d==null&&(d=s.getHeight()/2|0);const f=a/2|0;if(this.leftInit=c-f,this.rightInit=c+f,this.upInit=d-f,this.downInit=d+f,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new $}detect(){let s=this.leftInit,a=this.rightInit,c=this.upInit,d=this.downInit,f=!1,m=!0,w=!1,A=!1,b=!1,T=!1,M=!1;const L=this.width,V=this.height;for(;m;){m=!1;let G=!0;for(;(G||!A)&&a<L;)G=this.containsBlackPoint(c,d,a,!1),G?(a++,m=!0,A=!0):A||a++;if(a>=L){f=!0;break}let X=!0;for(;(X||!b)&&d<V;)X=this.containsBlackPoint(s,a,d,!0),X?(d++,m=!0,b=!0):b||d++;if(d>=V){f=!0;break}let K=!0;for(;(K||!T)&&s>=0;)K=this.containsBlackPoint(c,d,s,!1),K?(s--,m=!0,T=!0):T||s--;if(s<0){f=!0;break}let J=!0;for(;(J||!M)&&c>=0;)J=this.containsBlackPoint(s,a,c,!0),J?(c--,m=!0,M=!0):M||c--;if(c<0){f=!0;break}m&&(w=!0)}if(!f&&w){const G=a-s;let X=null;for(let fe=1;X===null&&fe<G;fe++)X=this.getBlackPointOnSegment(s,d-fe,s+fe,d);if(X==null)throw new $;let K=null;for(let fe=1;K===null&&fe<G;fe++)K=this.getBlackPointOnSegment(s,c+fe,s+fe,c);if(K==null)throw new $;let J=null;for(let fe=1;J===null&&fe<G;fe++)J=this.getBlackPointOnSegment(a,c+fe,a-fe,c);if(J==null)throw new $;let de=null;for(let fe=1;de===null&&fe<G;fe++)de=this.getBlackPointOnSegment(a,d-fe,a-fe,d);if(de==null)throw new $;return this.centerEdges(de,X,J,K)}else throw new $}getBlackPointOnSegment(s,a,c,d){const f=$e.round($e.distance(s,a,c,d)),m=(c-s)/f,w=(d-a)/f,A=this.image;for(let b=0;b<f;b++){const T=$e.round(s+b*m),M=$e.round(a+b*w);if(A.get(T,M))return new Se(T,M)}return null}centerEdges(s,a,c,d){const f=s.getX(),m=s.getY(),w=a.getX(),A=a.getY(),b=c.getX(),T=c.getY(),M=d.getX(),L=d.getY(),V=Di.CORR;return f<this.width/2?[new Se(M-V,L+V),new Se(w+V,A+V),new Se(b-V,T-V),new Se(f+V,m-V)]:[new Se(M+V,L+V),new Se(w+V,A-V),new Se(b-V,T+V),new Se(f-V,m-V)]}containsBlackPoint(s,a,c,d){const f=this.image;if(d){for(let m=s;m<=a;m++)if(f.get(m,c))return!0}else for(let m=s;m<=a;m++)if(f.get(c,m))return!0;return!1}}Di.INIT_SIZE=10,Di.CORR=1;class Ls{static checkAndNudgePoints(s,a){const c=s.getWidth(),d=s.getHeight();let f=!0;for(let m=0;m<a.length&&f;m+=2){const w=Math.floor(a[m]),A=Math.floor(a[m+1]);if(w<-1||w>c||A<-1||A>d)throw new $;f=!1,w===-1?(a[m]=0,f=!0):w===c&&(a[m]=c-1,f=!0),A===-1?(a[m+1]=0,f=!0):A===d&&(a[m+1]=d-1,f=!0)}f=!0;for(let m=a.length-2;m>=0&&f;m-=2){const w=Math.floor(a[m]),A=Math.floor(a[m+1]);if(w<-1||w>c||A<-1||A>d)throw new $;f=!1,w===-1?(a[m]=0,f=!0):w===c&&(a[m]=c-1,f=!0),A===-1?(a[m+1]=0,f=!0):A===d&&(a[m+1]=d-1,f=!0)}}}class vi{constructor(s,a,c,d,f,m,w,A,b){this.a11=s,this.a21=a,this.a31=c,this.a12=d,this.a22=f,this.a32=m,this.a13=w,this.a23=A,this.a33=b}static quadrilateralToQuadrilateral(s,a,c,d,f,m,w,A,b,T,M,L,V,G,X,K){const J=vi.quadrilateralToSquare(s,a,c,d,f,m,w,A);return vi.squareToQuadrilateral(b,T,M,L,V,G,X,K).times(J)}transformPoints(s){const a=s.length,c=this.a11,d=this.a12,f=this.a13,m=this.a21,w=this.a22,A=this.a23,b=this.a31,T=this.a32,M=this.a33;for(let L=0;L<a;L+=2){const V=s[L],G=s[L+1],X=f*V+A*G+M;s[L]=(c*V+m*G+b)/X,s[L+1]=(d*V+w*G+T)/X}}transformPointsWithValues(s,a){const c=this.a11,d=this.a12,f=this.a13,m=this.a21,w=this.a22,A=this.a23,b=this.a31,T=this.a32,M=this.a33,L=s.length;for(let V=0;V<L;V++){const G=s[V],X=a[V],K=f*G+A*X+M;s[V]=(c*G+m*X+b)/K,a[V]=(d*G+w*X+T)/K}}static squareToQuadrilateral(s,a,c,d,f,m,w,A){const b=s-c+f-w,T=a-d+m-A;if(b===0&&T===0)return new vi(c-s,f-c,s,d-a,m-d,a,0,0,1);{const M=c-f,L=w-f,V=d-m,G=A-m,X=M*G-L*V,K=(b*G-L*T)/X,J=(M*T-b*V)/X;return new vi(c-s+K*c,w-s+J*w,s,d-a+K*d,A-a+J*A,a,K,J,1)}}static quadrilateralToSquare(s,a,c,d,f,m,w,A){return vi.squareToQuadrilateral(s,a,c,d,f,m,w,A).buildAdjoint()}buildAdjoint(){return new vi(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(s){return new vi(this.a11*s.a11+this.a21*s.a12+this.a31*s.a13,this.a11*s.a21+this.a21*s.a22+this.a31*s.a23,this.a11*s.a31+this.a21*s.a32+this.a31*s.a33,this.a12*s.a11+this.a22*s.a12+this.a32*s.a13,this.a12*s.a21+this.a22*s.a22+this.a32*s.a23,this.a12*s.a31+this.a22*s.a32+this.a32*s.a33,this.a13*s.a11+this.a23*s.a12+this.a33*s.a13,this.a13*s.a21+this.a23*s.a22+this.a33*s.a23,this.a13*s.a31+this.a23*s.a32+this.a33*s.a33)}}class Je extends Ls{sampleGrid(s,a,c,d,f,m,w,A,b,T,M,L,V,G,X,K,J,de,fe){const ae=vi.quadrilateralToQuadrilateral(d,f,m,w,A,b,T,M,L,V,G,X,K,J,de,fe);return this.sampleGridWithTransform(s,a,c,ae)}sampleGridWithTransform(s,a,c,d){if(a<=0||c<=0)throw new $;const f=new ce(a,c),m=new Float32Array(2*a);for(let w=0;w<c;w++){const A=m.length,b=w+.5;for(let T=0;T<A;T+=2)m[T]=T/2+.5,m[T+1]=b;d.transformPoints(m),Ls.checkAndNudgePoints(s,m);try{for(let T=0;T<A;T+=2)s.get(Math.floor(m[T]),Math.floor(m[T+1]))&&f.set(T/2,w)}catch{throw new $}}return f}}class ke{static setGridSampler(s){ke.gridSampler=s}static getInstance(){return ke.gridSampler}}ke.gridSampler=new Je;class et{constructor(s,a){this.x=s,this.y=a}toResultPoint(){return new Se(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class hn{constructor(s){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=s}detect(){return this.detectMirror(!1)}detectMirror(s){let a=this.getMatrixCenter(),c=this.getBullsEyeCorners(a);if(s){let m=c[0];c[0]=c[2],c[2]=m}this.extractParameters(c);let d=this.sampleGrid(this.image,c[this.shift%4],c[(this.shift+1)%4],c[(this.shift+2)%4],c[(this.shift+3)%4]),f=this.getMatrixCornerPoints(c);return new Ca(d,f,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(s){if(!this.isValidPoint(s[0])||!this.isValidPoint(s[1])||!this.isValidPoint(s[2])||!this.isValidPoint(s[3]))throw new $;let a=2*this.nbCenterLayers,c=new Int32Array([this.sampleLine(s[0],s[1],a),this.sampleLine(s[1],s[2],a),this.sampleLine(s[2],s[3],a),this.sampleLine(s[3],s[0],a)]);this.shift=this.getRotation(c,a);let d=0;for(let m=0;m<4;m++){let w=c[(this.shift+m)%4];this.compact?(d<<=7,d+=w>>1&127):(d<<=10,d+=(w>>2&992)+(w>>1&31))}let f=this.getCorrectedParameterData(d,this.compact);this.compact?(this.nbLayers=(f>>6)+1,this.nbDataBlocks=(f&63)+1):(this.nbLayers=(f>>11)+1,this.nbDataBlocks=(f&2047)+1)}getRotation(s,a){let c=0;s.forEach((d,f,m)=>{let w=(d>>a-2<<1)+(d&1);c=(c<<3)+w}),c=((c&1)<<11)+(c>>1);for(let d=0;d<4;d++)if(k.bitCount(c^this.EXPECTED_CORNER_BITS[d])<=2)return d;throw new $}getCorrectedParameterData(s,a){let c,d;a?(c=7,d=2):(c=10,d=4);let f=c-d,m=new Int32Array(c);for(let A=c-1;A>=0;--A)m[A]=s&15,s>>=4;try{new tn(Te.AZTEC_PARAM).decode(m,f)}catch{throw new $}let w=0;for(let A=0;A<d;A++)w=(w<<4)+m[A];return w}getBullsEyeCorners(s){let a=s,c=s,d=s,f=s,m=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let M=this.getFirstDifferent(a,m,1,-1),L=this.getFirstDifferent(c,m,1,1),V=this.getFirstDifferent(d,m,-1,1),G=this.getFirstDifferent(f,m,-1,-1);if(this.nbCenterLayers>2){let X=this.distancePoint(G,M)*this.nbCenterLayers/(this.distancePoint(f,a)*(this.nbCenterLayers+2));if(X<.75||X>1.25||!this.isWhiteOrBlackRectangle(M,L,V,G))break}a=M,c=L,d=V,f=G,m=!m}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new $;this.compact=this.nbCenterLayers===5;let w=new Se(a.getX()+.5,a.getY()-.5),A=new Se(c.getX()+.5,c.getY()+.5),b=new Se(d.getX()-.5,d.getY()+.5),T=new Se(f.getX()-.5,f.getY()-.5);return this.expandSquare([w,A,b,T],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let s,a,c,d;try{let w=new Di(this.image).detect();s=w[0],a=w[1],c=w[2],d=w[3]}catch{let A=this.image.getWidth()/2,b=this.image.getHeight()/2;s=this.getFirstDifferent(new et(A+7,b-7),!1,1,-1).toResultPoint(),a=this.getFirstDifferent(new et(A+7,b+7),!1,1,1).toResultPoint(),c=this.getFirstDifferent(new et(A-7,b+7),!1,-1,1).toResultPoint(),d=this.getFirstDifferent(new et(A-7,b-7),!1,-1,-1).toResultPoint()}let f=$e.round((s.getX()+d.getX()+a.getX()+c.getX())/4),m=$e.round((s.getY()+d.getY()+a.getY()+c.getY())/4);try{let w=new Di(this.image,15,f,m).detect();s=w[0],a=w[1],c=w[2],d=w[3]}catch{s=this.getFirstDifferent(new et(f+7,m-7),!1,1,-1).toResultPoint(),a=this.getFirstDifferent(new et(f+7,m+7),!1,1,1).toResultPoint(),c=this.getFirstDifferent(new et(f-7,m+7),!1,-1,1).toResultPoint(),d=this.getFirstDifferent(new et(f-7,m-7),!1,-1,-1).toResultPoint()}return f=$e.round((s.getX()+d.getX()+a.getX()+c.getX())/4),m=$e.round((s.getY()+d.getY()+a.getY()+c.getY())/4),new et(f,m)}getMatrixCornerPoints(s){return this.expandSquare(s,2*this.nbCenterLayers,this.getDimension())}sampleGrid(s,a,c,d,f){let m=ke.getInstance(),w=this.getDimension(),A=w/2-this.nbCenterLayers,b=w/2+this.nbCenterLayers;return m.sampleGrid(s,w,w,A,A,b,A,b,b,A,b,a.getX(),a.getY(),c.getX(),c.getY(),d.getX(),d.getY(),f.getX(),f.getY())}sampleLine(s,a,c){let d=0,f=this.distanceResultPoint(s,a),m=f/c,w=s.getX(),A=s.getY(),b=m*(a.getX()-s.getX())/f,T=m*(a.getY()-s.getY())/f;for(let M=0;M<c;M++)this.image.get($e.round(w+M*b),$e.round(A+M*T))&&(d|=1<<c-M-1);return d}isWhiteOrBlackRectangle(s,a,c,d){let f=3;s=new et(s.getX()-f,s.getY()+f),a=new et(a.getX()-f,a.getY()-f),c=new et(c.getX()+f,c.getY()-f),d=new et(d.getX()+f,d.getY()+f);let m=this.getColor(d,s);if(m===0)return!1;let w=this.getColor(s,a);return w!==m||(w=this.getColor(a,c),w!==m)?!1:(w=this.getColor(c,d),w===m)}getColor(s,a){let c=this.distancePoint(s,a),d=(a.getX()-s.getX())/c,f=(a.getY()-s.getY())/c,m=0,w=s.getX(),A=s.getY(),b=this.image.get(s.getX(),s.getY()),T=Math.ceil(c);for(let L=0;L<T;L++)w+=d,A+=f,this.image.get($e.round(w),$e.round(A))!==b&&m++;let M=m/c;return M>.1&&M<.9?0:M<=.1===b?1:-1}getFirstDifferent(s,a,c,d){let f=s.getX()+c,m=s.getY()+d;for(;this.isValid(f,m)&&this.image.get(f,m)===a;)f+=c,m+=d;for(f-=c,m-=d;this.isValid(f,m)&&this.image.get(f,m)===a;)f+=c;for(f-=c;this.isValid(f,m)&&this.image.get(f,m)===a;)m+=d;return m-=d,new et(f,m)}expandSquare(s,a,c){let d=c/(2*a),f=s[0].getX()-s[2].getX(),m=s[0].getY()-s[2].getY(),w=(s[0].getX()+s[2].getX())/2,A=(s[0].getY()+s[2].getY())/2,b=new Se(w+d*f,A+d*m),T=new Se(w-d*f,A-d*m);f=s[1].getX()-s[3].getX(),m=s[1].getY()-s[3].getY(),w=(s[1].getX()+s[3].getX())/2,A=(s[1].getY()+s[3].getY())/2;let M=new Se(w+d*f,A+d*m),L=new Se(w-d*f,A-d*m);return[b,M,T,L]}isValid(s,a){return s>=0&&s<this.image.getWidth()&&a>0&&a<this.image.getHeight()}isValidPoint(s){let a=$e.round(s.getX()),c=$e.round(s.getY());return this.isValid(a,c)}distancePoint(s,a){return $e.distance(s.getX(),s.getY(),a.getX(),a.getY())}distanceResultPoint(s,a){return $e.distance(s.getX(),s.getY(),a.getX(),a.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(k.truncDivision(this.nbLayers-4,8)+1)+15}}class oi{decode(s,a=null){let c=null,d=new hn(s.getBlackMatrix()),f=null,m=null;try{let T=d.detectMirror(!1);f=T.getPoints(),this.reportFoundResultPoints(a,f),m=new ut().decode(T)}catch(T){c=T}if(m==null)try{let T=d.detectMirror(!0);f=T.getPoints(),this.reportFoundResultPoints(a,f),m=new ut().decode(T)}catch(T){throw c??T}let w=new Le(m.getText(),m.getRawBytes(),m.getNumBits(),f,xe.AZTEC,I.currentTimeMillis()),A=m.getByteSegments();A!=null&&w.putMetadata(st.BYTE_SEGMENTS,A);let b=m.getECLevel();return b!=null&&w.putMetadata(st.ERROR_CORRECTION_LEVEL,b),w}reportFoundResultPoints(s,a){if(s!=null){let c=s.get(H.NEED_RESULT_POINT_CALLBACK);c!=null&&a.forEach((d,f,m)=>{c.foundPossibleResultPoint(d)})}}reset(){}}class mA extends me{constructor(s=500){super(new oi,s)}}class nn{decode(s,a){try{return this.doDecode(s,a)}catch{if(a&&a.get(H.TRY_HARDER)===!0&&s.isRotateSupported()){const f=s.rotateCounterClockwise(),m=this.doDecode(f,a),w=m.getResultMetadata();let A=270;w!==null&&w.get(st.ORIENTATION)===!0&&(A=A+w.get(st.ORIENTATION)%360),m.putMetadata(st.ORIENTATION,A);const b=m.getResultPoints();if(b!==null){const T=f.getHeight();for(let M=0;M<b.length;M++)b[M]=new Se(T-b[M].getY()-1,b[M].getX())}return m}else throw new $}}reset(){}doDecode(s,a){const c=s.getWidth(),d=s.getHeight();let f=new B(c);const m=a&&a.get(H.TRY_HARDER)===!0,w=Math.max(1,d>>(m?8:5));let A;m?A=d:A=15;const b=Math.trunc(d/2);for(let T=0;T<A;T++){const M=Math.trunc((T+1)/2),L=(T&1)===0,V=b+w*(L?M:-M);if(V<0||V>=d)break;try{f=s.getBlackRow(V,f)}catch{continue}for(let G=0;G<2;G++){if(G===1&&(f.reverse(),a&&a.get(H.NEED_RESULT_POINT_CALLBACK)===!0)){const X=new Map;a.forEach((K,J)=>X.set(J,K)),X.delete(H.NEED_RESULT_POINT_CALLBACK),a=X}try{const X=this.decodeRow(V,f,a);if(G===1){X.putMetadata(st.ORIENTATION,180);const K=X.getResultPoints();K!==null&&(K[0]=new Se(c-K[0].getX()-1,K[0].getY()),K[1]=new Se(c-K[1].getX()-1,K[1].getY()))}return X}catch{}}}throw new $}static recordPattern(s,a,c){const d=c.length;for(let b=0;b<d;b++)c[b]=0;const f=s.getSize();if(a>=f)throw new $;let m=!s.get(a),w=0,A=a;for(;A<f;){if(s.get(A)!==m)c[w]++;else{if(++w===d)break;c[w]=1,m=!m}A++}if(!(w===d||w===d-1&&A===f))throw new $}static recordPatternInReverse(s,a,c){let d=c.length,f=s.get(a);for(;a>0&&d>=0;)s.get(--a)!==f&&(d--,f=!f);if(d>=0)throw new $;nn.recordPattern(s,a+1,c)}static patternMatchVariance(s,a,c){const d=s.length;let f=0,m=0;for(let b=0;b<d;b++)f+=s[b],m+=a[b];if(f<m)return Number.POSITIVE_INFINITY;const w=f/m;c*=w;let A=0;for(let b=0;b<d;b++){const T=s[b],M=a[b]*w,L=T>M?T-M:M-T;if(L>c)return Number.POSITIVE_INFINITY;A+=L}return A/f}}class pe extends nn{static findStartPattern(s){const a=s.getSize(),c=s.getNextSet(0);let d=0,f=Int32Array.from([0,0,0,0,0,0]),m=c,w=!1;const A=6;for(let b=c;b<a;b++)if(s.get(b)!==w)f[d]++;else{if(d===A-1){let T=pe.MAX_AVG_VARIANCE,M=-1;for(let L=pe.CODE_START_A;L<=pe.CODE_START_C;L++){const V=nn.patternMatchVariance(f,pe.CODE_PATTERNS[L],pe.MAX_INDIVIDUAL_VARIANCE);V<T&&(T=V,M=L)}if(M>=0&&s.isRange(Math.max(0,m-(b-m)/2),m,!1))return Int32Array.from([m,b,M]);m+=f[0]+f[1],f=f.slice(2,f.length-1),f[d-1]=0,f[d]=0,d--}else d++;f[d]=1,w=!w}throw new $}static decodeCode(s,a,c){nn.recordPattern(s,c,a);let d=pe.MAX_AVG_VARIANCE,f=-1;for(let m=0;m<pe.CODE_PATTERNS.length;m++){const w=pe.CODE_PATTERNS[m],A=this.patternMatchVariance(a,w,pe.MAX_INDIVIDUAL_VARIANCE);A<d&&(d=A,f=m)}if(f>=0)return f;throw new $}decodeRow(s,a,c){const d=c&&c.get(H.ASSUME_GS1)===!0,f=pe.findStartPattern(a),m=f[2];let w=0;const A=new Uint8Array(20);A[w++]=m;let b;switch(m){case pe.CODE_START_A:b=pe.CODE_CODE_A;break;case pe.CODE_START_B:b=pe.CODE_CODE_B;break;case pe.CODE_START_C:b=pe.CODE_CODE_C;break;default:throw new F}let T=!1,M=!1,L="",V=f[0],G=f[1];const X=Int32Array.from([0,0,0,0,0,0]);let K=0,J=0,de=m,fe=0,ae=!0,qe=!1,je=!1;for(;!T;){const vh=M;switch(M=!1,K=J,J=pe.decodeCode(a,X,G),A[w++]=J,J!==pe.CODE_STOP&&(ae=!0),J!==pe.CODE_STOP&&(fe++,de+=fe*J),V=G,G+=X.reduce((wR,yR)=>wR+yR,0),J){case pe.CODE_START_A:case pe.CODE_START_B:case pe.CODE_START_C:throw new F}switch(b){case pe.CODE_CODE_A:if(J<64)je===qe?L+=String.fromCharCode(" ".charCodeAt(0)+J):L+=String.fromCharCode(" ".charCodeAt(0)+J+128),je=!1;else if(J<96)je===qe?L+=String.fromCharCode(J-64):L+=String.fromCharCode(J+64),je=!1;else switch(J!==pe.CODE_STOP&&(ae=!1),J){case pe.CODE_FNC_1:d&&(L.length===0?L+="]C1":L+=String.fromCharCode(29));break;case pe.CODE_FNC_2:case pe.CODE_FNC_3:break;case pe.CODE_FNC_4_A:!qe&&je?(qe=!0,je=!1):qe&&je?(qe=!1,je=!1):je=!0;break;case pe.CODE_SHIFT:M=!0,b=pe.CODE_CODE_B;break;case pe.CODE_CODE_B:b=pe.CODE_CODE_B;break;case pe.CODE_CODE_C:b=pe.CODE_CODE_C;break;case pe.CODE_STOP:T=!0;break}break;case pe.CODE_CODE_B:if(J<96)je===qe?L+=String.fromCharCode(" ".charCodeAt(0)+J):L+=String.fromCharCode(" ".charCodeAt(0)+J+128),je=!1;else switch(J!==pe.CODE_STOP&&(ae=!1),J){case pe.CODE_FNC_1:d&&(L.length===0?L+="]C1":L+=String.fromCharCode(29));break;case pe.CODE_FNC_2:case pe.CODE_FNC_3:break;case pe.CODE_FNC_4_B:!qe&&je?(qe=!0,je=!1):qe&&je?(qe=!1,je=!1):je=!0;break;case pe.CODE_SHIFT:M=!0,b=pe.CODE_CODE_A;break;case pe.CODE_CODE_A:b=pe.CODE_CODE_A;break;case pe.CODE_CODE_C:b=pe.CODE_CODE_C;break;case pe.CODE_STOP:T=!0;break}break;case pe.CODE_CODE_C:if(J<100)J<10&&(L+="0"),L+=J;else switch(J!==pe.CODE_STOP&&(ae=!1),J){case pe.CODE_FNC_1:d&&(L.length===0?L+="]C1":L+=String.fromCharCode(29));break;case pe.CODE_CODE_A:b=pe.CODE_CODE_A;break;case pe.CODE_CODE_B:b=pe.CODE_CODE_B;break;case pe.CODE_STOP:T=!0;break}break}vh&&(b=b===pe.CODE_CODE_A?pe.CODE_CODE_B:pe.CODE_CODE_A)}const Ui=G-V;if(G=a.getNextUnset(G),!a.isRange(G,Math.min(a.getSize(),G+(G-V)/2),!1))throw new $;if(de-=fe*K,de%103!==K)throw new C;const cs=L.length;if(cs===0)throw new $;cs>0&&ae&&(b===pe.CODE_CODE_C?L=L.substring(0,cs-2):L=L.substring(0,cs-1));const ji=(f[1]+f[0])/2,Ct=V+Ui/2,$n=A.length,ir=new Uint8Array($n);for(let vh=0;vh<$n;vh++)ir[vh]=A[vh];const Ah=[new Se(ji,s),new Se(Ct,s)];return new Le(L,ir,0,Ah,xe.CODE_128,new Date().getTime())}}pe.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],pe.MAX_AVG_VARIANCE=.25,pe.MAX_INDIVIDUAL_VARIANCE=.7,pe.CODE_SHIFT=98,pe.CODE_CODE_C=99,pe.CODE_CODE_B=100,pe.CODE_CODE_A=101,pe.CODE_FNC_1=102,pe.CODE_FNC_2=97,pe.CODE_FNC_3=96,pe.CODE_FNC_4_A=101,pe.CODE_FNC_4_B=100,pe.CODE_START_A=103,pe.CODE_START_B=104,pe.CODE_START_C=105,pe.CODE_STOP=106;class dn extends nn{constructor(s=!1,a=!1){super(),this.usingCheckDigit=s,this.extendedMode=a,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(s,a,c){let d=this.counters;d.fill(0),this.decodeRowResult="";let f=dn.findAsteriskPattern(a,d),m=a.getNextSet(f[1]),w=a.getSize(),A,b;do{dn.recordPattern(a,m,d);let X=dn.toNarrowWidePattern(d);if(X<0)throw new $;A=dn.patternToChar(X),this.decodeRowResult+=A,b=m;for(let K of d)m+=K;m=a.getNextSet(m)}while(A!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let T=0;for(let X of d)T+=X;let M=m-b-T;if(m!==w&&M*2<T)throw new $;if(this.usingCheckDigit){let X=this.decodeRowResult.length-1,K=0;for(let J=0;J<X;J++)K+=dn.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(J));if(this.decodeRowResult.charAt(X)!==dn.ALPHABET_STRING.charAt(K%43))throw new C;this.decodeRowResult=this.decodeRowResult.substring(0,X)}if(this.decodeRowResult.length===0)throw new $;let L;this.extendedMode?L=dn.decodeExtended(this.decodeRowResult):L=this.decodeRowResult;let V=(f[1]+f[0])/2,G=b+T/2;return new Le(L,null,0,[new Se(V,s),new Se(G,s)],xe.CODE_39,new Date().getTime())}static findAsteriskPattern(s,a){let c=s.getSize(),d=s.getNextSet(0),f=0,m=d,w=!1,A=a.length;for(let b=d;b<c;b++)if(s.get(b)!==w)a[f]++;else{if(f===A-1){if(this.toNarrowWidePattern(a)===dn.ASTERISK_ENCODING&&s.isRange(Math.max(0,m-Math.floor((b-m)/2)),m,!1))return[m,b];m+=a[0]+a[1],a.copyWithin(0,2,2+f-1),a[f-1]=0,a[f]=0,f--}else f++;a[f]=1,w=!w}throw new $}static toNarrowWidePattern(s){let a=s.length,c=0,d;do{let f=2147483647;for(let A of s)A<f&&A>c&&(f=A);c=f,d=0;let m=0,w=0;for(let A=0;A<a;A++){let b=s[A];b>c&&(w|=1<<a-1-A,d++,m+=b)}if(d===3){for(let A=0;A<a&&d>0;A++){let b=s[A];if(b>c&&(d--,b*2>=m))return-1}return w}}while(d>3);return-1}static patternToChar(s){for(let a=0;a<dn.CHARACTER_ENCODINGS.length;a++)if(dn.CHARACTER_ENCODINGS[a]===s)return dn.ALPHABET_STRING.charAt(a);if(s===dn.ASTERISK_ENCODING)return"*";throw new $}static decodeExtended(s){let a=s.length,c="";for(let d=0;d<a;d++){let f=s.charAt(d);if(f==="+"||f==="$"||f==="%"||f==="/"){let m=s.charAt(d+1),w="\0";switch(f){case"+":if(m>="A"&&m<="Z")w=String.fromCharCode(m.charCodeAt(0)+32);else throw new F;break;case"$":if(m>="A"&&m<="Z")w=String.fromCharCode(m.charCodeAt(0)-64);else throw new F;break;case"%":if(m>="A"&&m<="E")w=String.fromCharCode(m.charCodeAt(0)-38);else if(m>="F"&&m<="J")w=String.fromCharCode(m.charCodeAt(0)-11);else if(m>="K"&&m<="O")w=String.fromCharCode(m.charCodeAt(0)+16);else if(m>="P"&&m<="T")w=String.fromCharCode(m.charCodeAt(0)+43);else if(m==="U")w="\0";else if(m==="V")w="@";else if(m==="W")w="`";else if(m==="X"||m==="Y"||m==="Z")w="";else throw new F;break;case"/":if(m>="A"&&m<="O")w=String.fromCharCode(m.charCodeAt(0)-32);else if(m==="Z")w=":";else throw new F;break}c+=w,d++}else c+=f}return c}}dn.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",dn.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],dn.ASTERISK_ENCODING=148;class ft extends nn{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(s,a,c){let d=this.decodeStart(a),f=this.decodeEnd(a),m=new le;ft.decodeMiddle(a,d[1],f[0],m);let w=m.toString(),A=null;c!=null&&(A=c.get(H.ALLOWED_LENGTHS)),A==null&&(A=ft.DEFAULT_ALLOWED_LENGTHS);let b=w.length,T=!1,M=0;for(let G of A){if(b===G){T=!0;break}G>M&&(M=G)}if(!T&&b>M&&(T=!0),!T)throw new F;const L=[new Se(d[1],s),new Se(f[0],s)];return new Le(w,null,0,L,xe.ITF,new Date().getTime())}static decodeMiddle(s,a,c,d){let f=new Int32Array(10),m=new Int32Array(5),w=new Int32Array(5);for(f.fill(0),m.fill(0),w.fill(0);a<c;){nn.recordPattern(s,a,f);for(let b=0;b<5;b++){let T=2*b;m[b]=f[T],w[b]=f[T+1]}let A=ft.decodeDigit(m);d.append(A.toString()),A=this.decodeDigit(w),d.append(A.toString()),f.forEach(function(b){a+=b})}}decodeStart(s){let a=ft.skipWhiteSpace(s),c=ft.findGuardPattern(s,a,ft.START_PATTERN);return this.narrowLineWidth=(c[1]-c[0])/4,this.validateQuietZone(s,c[0]),c}validateQuietZone(s,a){let c=this.narrowLineWidth*10;c=c<a?c:a;for(let d=a-1;c>0&&d>=0&&!s.get(d);d--)c--;if(c!==0)throw new $}static skipWhiteSpace(s){const a=s.getSize(),c=s.getNextSet(0);if(c===a)throw new $;return c}decodeEnd(s){s.reverse();try{let a=ft.skipWhiteSpace(s),c;try{c=ft.findGuardPattern(s,a,ft.END_PATTERN_REVERSED[0])}catch(f){f instanceof $&&(c=ft.findGuardPattern(s,a,ft.END_PATTERN_REVERSED[1]))}this.validateQuietZone(s,c[0]);let d=c[0];return c[0]=s.getSize()-c[1],c[1]=s.getSize()-d,c}finally{s.reverse()}}static findGuardPattern(s,a,c){let d=c.length,f=new Int32Array(d),m=s.getSize(),w=!1,A=0,b=a;f.fill(0);for(let T=a;T<m;T++)if(s.get(T)!==w)f[A]++;else{if(A===d-1){if(nn.patternMatchVariance(f,c,ft.MAX_INDIVIDUAL_VARIANCE)<ft.MAX_AVG_VARIANCE)return[b,T];b+=f[0]+f[1],I.arraycopy(f,2,f,0,A-1),f[A-1]=0,f[A]=0,A--}else A++;f[A]=1,w=!w}throw new $}static decodeDigit(s){let a=ft.MAX_AVG_VARIANCE,c=-1,d=ft.PATTERNS.length;for(let f=0;f<d;f++){let m=ft.PATTERNS[f],w=nn.patternMatchVariance(s,m,ft.MAX_INDIVIDUAL_VARIANCE);w<a?(a=w,c=f):w===a&&(c=-1)}if(c>=0)return c%10;throw new $}}ft.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],ft.MAX_AVG_VARIANCE=.38,ft.MAX_INDIVIDUAL_VARIANCE=.5,ft.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],ft.START_PATTERN=Int32Array.from([1,1,1,1]),ft.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Ut extends nn{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(s){let a=!1,c,d=0,f=Int32Array.from([0,0,0]);for(;!a;){f=Int32Array.from([0,0,0]),c=Ut.findGuardPattern(s,d,!1,this.START_END_PATTERN,f);let m=c[0];d=c[1];let w=m-(d-m);w>=0&&(a=s.isRange(w,m,!1))}return c}static checkChecksum(s){return Ut.checkStandardUPCEANChecksum(s)}static checkStandardUPCEANChecksum(s){let a=s.length;if(a===0)return!1;let c=parseInt(s.charAt(a-1),10);return Ut.getStandardUPCEANChecksum(s.substring(0,a-1))===c}static getStandardUPCEANChecksum(s){let a=s.length,c=0;for(let d=a-1;d>=0;d-=2){let f=s.charAt(d).charCodeAt(0)-"0".charCodeAt(0);if(f<0||f>9)throw new F;c+=f}c*=3;for(let d=a-2;d>=0;d-=2){let f=s.charAt(d).charCodeAt(0)-"0".charCodeAt(0);if(f<0||f>9)throw new F;c+=f}return(1e3-c)%10}static decodeEnd(s,a){return Ut.findGuardPattern(s,a,!1,Ut.START_END_PATTERN,new Int32Array(Ut.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(s,a,c,d){return this.findGuardPattern(s,a,c,d,new Int32Array(d.length))}static findGuardPattern(s,a,c,d,f){let m=s.getSize();a=c?s.getNextUnset(a):s.getNextSet(a);let w=0,A=a,b=d.length,T=c;for(let M=a;M<m;M++)if(s.get(M)!==T)f[w]++;else{if(w===b-1){if(nn.patternMatchVariance(f,d,Ut.MAX_INDIVIDUAL_VARIANCE)<Ut.MAX_AVG_VARIANCE)return Int32Array.from([A,M]);A+=f[0]+f[1];let L=f.slice(2,f.length-1);for(let V=0;V<w-1;V++)f[V]=L[V];f[w-1]=0,f[w]=0,w--}else w++;f[w]=1,T=!T}throw new $}static decodeDigit(s,a,c,d){this.recordPattern(s,c,a);let f=this.MAX_AVG_VARIANCE,m=-1,w=d.length;for(let A=0;A<w;A++){let b=d[A],T=nn.patternMatchVariance(a,b,Ut.MAX_INDIVIDUAL_VARIANCE);T<f&&(f=T,m=A)}if(m>=0)return m;throw new $}}Ut.MAX_AVG_VARIANCE=.48,Ut.MAX_INDIVIDUAL_VARIANCE=.7,Ut.START_END_PATTERN=Int32Array.from([1,1,1]),Ut.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Ut.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Ut.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class ic{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(s,a,c){let d=this.decodeRowStringBuffer,f=this.decodeMiddle(a,c,d),m=d.toString(),w=ic.parseExtensionString(m),A=[new Se((c[0]+c[1])/2,s),new Se(f,s)],b=new Le(m,null,0,A,xe.UPC_EAN_EXTENSION,new Date().getTime());return w!=null&&b.putAllMetadata(w),b}decodeMiddle(s,a,c){let d=this.decodeMiddleCounters;d[0]=0,d[1]=0,d[2]=0,d[3]=0;let f=s.getSize(),m=a[1],w=0;for(let b=0;b<5&&m<f;b++){let T=Ut.decodeDigit(s,d,m,Ut.L_AND_G_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+T%10);for(let M of d)m+=M;T>=10&&(w|=1<<4-b),b!==4&&(m=s.getNextSet(m),m=s.getNextUnset(m))}if(c.length!==5)throw new $;let A=this.determineCheckDigit(w);if(ic.extensionChecksum(c.toString())!==A)throw new $;return m}static extensionChecksum(s){let a=s.length,c=0;for(let d=a-2;d>=0;d-=2)c+=s.charAt(d).charCodeAt(0)-"0".charCodeAt(0);c*=3;for(let d=a-1;d>=0;d-=2)c+=s.charAt(d).charCodeAt(0)-"0".charCodeAt(0);return c*=3,c%10}determineCheckDigit(s){for(let a=0;a<10;a++)if(s===this.CHECK_DIGIT_ENCODINGS[a])return a;throw new $}static parseExtensionString(s){if(s.length!==5)return null;let a=ic.parseExtension5String(s);return a==null?null:new Map([[st.SUGGESTED_PRICE,a]])}static parseExtension5String(s){let a;switch(s.charAt(0)){case"0":a="";break;case"5":a="$";break;case"9":switch(s){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}a="";break;default:a="";break}let c=parseInt(s.substring(1)),d=(c/100).toString(),f=c%100,m=f<10?"0"+f:f.toString();return a+d+"."+m}}class rc{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(s,a,c){let d=this.decodeRowStringBuffer,f=this.decodeMiddle(a,c,d),m=d.toString(),w=rc.parseExtensionString(m),A=[new Se((c[0]+c[1])/2,s),new Se(f,s)],b=new Le(m,null,0,A,xe.UPC_EAN_EXTENSION,new Date().getTime());return w!=null&&b.putAllMetadata(w),b}decodeMiddle(s,a,c){let d=this.decodeMiddleCounters;d[0]=0,d[1]=0,d[2]=0,d[3]=0;let f=s.getSize(),m=a[1],w=0;for(let A=0;A<2&&m<f;A++){let b=Ut.decodeDigit(s,d,m,Ut.L_AND_G_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+b%10);for(let T of d)m+=T;b>=10&&(w|=1<<1-A),A!==1&&(m=s.getNextSet(m),m=s.getNextUnset(m))}if(c.length!==2)throw new $;if(parseInt(c.toString())%4!==w)throw new $;return m}static parseExtensionString(s){return s.length!==2?null:new Map([[st.ISSUE_NUMBER,parseInt(s)]])}}class hh{static decodeRow(s,a,c){let d=Ut.findGuardPattern(a,c,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new ic().decodeRow(s,a,d)}catch{return new rc().decodeRow(s,a,d)}}}hh.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class tt extends Ut{constructor(){super(),this.decodeRowStringBuffer="",tt.L_AND_G_PATTERNS=tt.L_PATTERNS.map(s=>Int32Array.from(s));for(let s=10;s<20;s++){let a=tt.L_PATTERNS[s-10],c=new Int32Array(a.length);for(let d=0;d<a.length;d++)c[d]=a[a.length-d-1];tt.L_AND_G_PATTERNS[s]=c}}decodeRow(s,a,c){let d=tt.findStartGuardPattern(a),f=c==null?null:c.get(H.NEED_RESULT_POINT_CALLBACK);if(f!=null){const ae=new Se((d[0]+d[1])/2,s);f.foundPossibleResultPoint(ae)}let m=this.decodeMiddle(a,d,this.decodeRowStringBuffer),w=m.rowOffset,A=m.resultString;if(f!=null){const ae=new Se(w,s);f.foundPossibleResultPoint(ae)}let b=this.decodeEnd(a,w);if(f!=null){const ae=new Se((b[0]+b[1])/2,s);f.foundPossibleResultPoint(ae)}let T=b[1],M=T+(T-b[0]);if(M>=a.getSize()||!a.isRange(T,M,!1))throw new $;let L=A.toString();if(L.length<8)throw new F;if(!tt.checkChecksum(L))throw new C;let V=(d[1]+d[0])/2,G=(b[1]+b[0])/2,X=this.getBarcodeFormat(),K=[new Se(V,s),new Se(G,s)],J=new Le(L,null,0,K,X,new Date().getTime()),de=0;try{let ae=hh.decodeRow(s,a,b[1]);J.putMetadata(st.UPC_EAN_EXTENSION,ae.getText()),J.putAllMetadata(ae.getResultMetadata()),J.addResultPoints(ae.getResultPoints()),de=ae.getText().length}catch{}let fe=c==null?null:c.get(H.ALLOWED_EAN_EXTENSIONS);if(fe!=null){let ae=!1;for(let qe in fe)if(de.toString()===qe){ae=!0;break}if(!ae)throw new $}return J}decodeEnd(s,a){return tt.findGuardPattern(s,a,!1,tt.START_END_PATTERN,new Int32Array(tt.START_END_PATTERN.length).fill(0))}static checkChecksum(s){return tt.checkStandardUPCEANChecksum(s)}static checkStandardUPCEANChecksum(s){let a=s.length;if(a===0)return!1;let c=parseInt(s.charAt(a-1),10);return tt.getStandardUPCEANChecksum(s.substring(0,a-1))===c}static getStandardUPCEANChecksum(s){let a=s.length,c=0;for(let d=a-1;d>=0;d-=2){let f=s.charAt(d).charCodeAt(0)-"0".charCodeAt(0);if(f<0||f>9)throw new F;c+=f}c*=3;for(let d=a-2;d>=0;d-=2){let f=s.charAt(d).charCodeAt(0)-"0".charCodeAt(0);if(f<0||f>9)throw new F;c+=f}return(1e3-c)%10}}class as extends tt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(s,a,c){let d=this.decodeMiddleCounters;d[0]=0,d[1]=0,d[2]=0,d[3]=0;let f=s.getSize(),m=a[1],w=0;for(let b=0;b<6&&m<f;b++){let T=tt.decodeDigit(s,d,m,tt.L_AND_G_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+T%10);for(let M of d)m+=M;T>=10&&(w|=1<<5-b)}c=as.determineFirstDigit(c,w),m=tt.findGuardPattern(s,m,!0,tt.MIDDLE_PATTERN,new Int32Array(tt.MIDDLE_PATTERN.length).fill(0))[1];for(let b=0;b<6&&m<f;b++){let T=tt.decodeDigit(s,d,m,tt.L_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+T);for(let M of d)m+=M}return{rowOffset:m,resultString:c}}getBarcodeFormat(){return xe.EAN_13}static determineFirstDigit(s,a){for(let c=0;c<10;c++)if(a===this.FIRST_DIGIT_ENCODINGS[c])return s=String.fromCharCode("0".charCodeAt(0)+c)+s,s;throw new $}}as.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class dh extends tt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(s,a,c){const d=this.decodeMiddleCounters;d[0]=0,d[1]=0,d[2]=0,d[3]=0;let f=s.getSize(),m=a[1];for(let A=0;A<4&&m<f;A++){let b=tt.decodeDigit(s,d,m,tt.L_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+b);for(let T of d)m+=T}m=tt.findGuardPattern(s,m,!0,tt.MIDDLE_PATTERN,new Int32Array(tt.MIDDLE_PATTERN.length).fill(0))[1];for(let A=0;A<4&&m<f;A++){let b=tt.decodeDigit(s,d,m,tt.L_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+b);for(let T of d)m+=T}return{rowOffset:m,resultString:c}}getBarcodeFormat(){return xe.EAN_8}}class v0 extends tt{constructor(){super(...arguments),this.ean13Reader=new as}getBarcodeFormat(){return xe.UPC_A}decode(s,a){return this.maybeReturnResult(this.ean13Reader.decode(s))}decodeRow(s,a,c){return this.maybeReturnResult(this.ean13Reader.decodeRow(s,a,c))}decodeMiddle(s,a,c){return this.ean13Reader.decodeMiddle(s,a,c)}maybeReturnResult(s){let a=s.getText();if(a.charAt(0)==="0"){let c=new Le(a.substring(1),null,null,s.getResultPoints(),xe.UPC_A);return s.getResultMetadata()!=null&&c.putAllMetadata(s.getResultMetadata()),c}else throw new $}reset(){this.ean13Reader.reset()}}class Mi extends tt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(s,a,c){const d=this.decodeMiddleCounters.map(b=>b);d[0]=0,d[1]=0,d[2]=0,d[3]=0;const f=s.getSize();let m=a[1],w=0;for(let b=0;b<6&&m<f;b++){const T=Mi.decodeDigit(s,d,m,Mi.L_AND_G_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+T%10);for(let M of d)m+=M;T>=10&&(w|=1<<5-b)}let A=Mi.determineNumSysAndCheckDigit(c,w);return{rowOffset:m,resultString:A}}decodeEnd(s,a){return Mi.findGuardPatternWithoutCounters(s,a,!0,Mi.MIDDLE_END_PATTERN)}checkChecksum(s){return tt.checkChecksum(Mi.convertUPCEtoUPCA(s))}static determineNumSysAndCheckDigit(s,a){for(let c=0;c<=1;c++)for(let d=0;d<10;d++)if(a===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[c][d]){let f=String.fromCharCode("0".charCodeAt(0)+c),m=String.fromCharCode("0".charCodeAt(0)+d);return f+s+m}throw $.getNotFoundInstance()}getBarcodeFormat(){return xe.UPC_E}static convertUPCEtoUPCA(s){const a=s.slice(1,7).split("").map(f=>f.charCodeAt(0)),c=new le;c.append(s.charAt(0));let d=a[5];switch(d){case 0:case 1:case 2:c.appendChars(a,0,2),c.append(d),c.append("0000"),c.appendChars(a,2,3);break;case 3:c.appendChars(a,0,3),c.append("00000"),c.appendChars(a,3,2);break;case 4:c.appendChars(a,0,4),c.append("00000"),c.append(a[4]);break;default:c.appendChars(a,0,5),c.append("0000"),c.append(d);break}return s.length>=8&&c.append(s.charAt(7)),c.toString()}}Mi.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Mi.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class nr extends nn{constructor(s){super();let a=s==null?null:s.get(H.POSSIBLE_FORMATS),c=[];i(a)?(c.push(new as),c.push(new v0),c.push(new dh),c.push(new Mi)):(a.indexOf(xe.EAN_13)>-1&&c.push(new as),a.indexOf(xe.UPC_A)>-1&&c.push(new v0),a.indexOf(xe.EAN_8)>-1&&c.push(new dh),a.indexOf(xe.UPC_E)>-1&&c.push(new Mi)),this.readers=c}decodeRow(s,a,c){for(let d of this.readers)try{const f=d.decodeRow(s,a,c),m=f.getBarcodeFormat()===xe.EAN_13&&f.getText().charAt(0)==="0",w=c==null?null:c.get(H.POSSIBLE_FORMATS),A=w==null||w.includes(xe.UPC_A);if(m&&A){const b=f.getRawBytes(),T=new Le(f.getText().substring(1),b,b?b.length:null,f.getResultPoints(),xe.UPC_A);return T.putAllMetadata(f.getResultMetadata()),T}return f}catch{}throw new $}reset(){for(let s of this.readers)s.reset()}}class fn extends nn{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(s,a){for(let c=0;c<a.length;c++)if(nn.patternMatchVariance(s,a[c],fn.MAX_INDIVIDUAL_VARIANCE)<fn.MAX_AVG_VARIANCE)return c;throw new $}static count(s){return $e.sum(new Int32Array(s))}static increment(s,a){let c=0,d=a[0];for(let f=1;f<s.length;f++)a[f]>d&&(d=a[f],c=f);s[c]++}static decrement(s,a){let c=0,d=a[0];for(let f=1;f<s.length;f++)a[f]<d&&(d=a[f],c=f);s[c]--}static isFinderPattern(s){let a=s[0]+s[1],c=a+s[2]+s[3],d=a/c;if(d>=fn.MIN_FINDER_PATTERN_RATIO&&d<=fn.MAX_FINDER_PATTERN_RATIO){let f=Number.MAX_SAFE_INTEGER,m=Number.MIN_SAFE_INTEGER;for(let w of s)w>m&&(m=w),w<f&&(f=w);return m<10*f}return!1}}fn.MAX_AVG_VARIANCE=.2,fn.MAX_INDIVIDUAL_VARIANCE=.45,fn.MIN_FINDER_PATTERN_RATIO=9.5/12,fn.MAX_FINDER_PATTERN_RATIO=12.5/14;class Dr{constructor(s,a){this.value=s,this.checksumPortion=a}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(s){if(!(s instanceof Dr))return!1;const a=s;return this.value===a.value&&this.checksumPortion===a.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class fh{constructor(s,a,c,d,f){this.value=s,this.startEnd=a,this.value=s,this.startEnd=a,this.resultPoints=new Array,this.resultPoints.push(new Se(c,f)),this.resultPoints.push(new Se(d,f))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(s){if(!(s instanceof fh))return!1;const a=s;return this.value===a.value}hashCode(){return this.value}}class Oi{constructor(){}static getRSSvalue(s,a,c){let d=0;for(let A of s)d+=A;let f=0,m=0,w=s.length;for(let A=0;A<w-1;A++){let b;for(b=1,m|=1<<A;b<s[A];b++,m&=~(1<<A)){let T=Oi.combins(d-b-1,w-A-2);if(c&&m===0&&d-b-(w-A-1)>=w-A-1&&(T-=Oi.combins(d-b-(w-A),w-A-2)),w-A-1>1){let M=0;for(let L=d-b-(w-A-2);L>a;L--)M+=Oi.combins(d-b-L-1,w-A-3);T-=M*(w-1-A)}else d-b>a&&T--;f+=T}d-=b}return f}static combins(s,a){let c,d;s-a>a?(d=a,c=s-a):(d=s-a,c=a);let f=1,m=1;for(let w=s;w>c;w--)f*=w,m<=d&&(f/=m,m++);for(;m<=d;)f/=m,m++;return f}}class ls{static buildBitArray(s){let a=s.length*2-1;s[s.length-1].getRightChar()==null&&(a-=1);let c=12*a,d=new B(c),f=0,w=s[0].getRightChar().getValue();for(let A=11;A>=0;--A)w&1<<A&&d.set(f),f++;for(let A=1;A<s.length;++A){let b=s[A],T=b.getLeftChar().getValue();for(let M=11;M>=0;--M)T&1<<M&&d.set(f),f++;if(b.getRightChar()!=null){let M=b.getRightChar().getValue();for(let L=11;L>=0;--L)M&1<<L&&d.set(f),f++}}return d}}class sc{constructor(s,a){a?this.decodedInformation=null:(this.finished=s,this.decodedInformation=a)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class xA{constructor(s){this.newPosition=s}getNewPosition(){return this.newPosition}}class Li extends xA{constructor(s,a){super(s),this.value=a}getValue(){return this.value}isFNC1(){return this.value===Li.FNC1}}Li.FNC1="$";class oc extends xA{constructor(s,a,c){super(s),c?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=a}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Mr extends xA{constructor(s,a,c){if(super(s),a<0||a>10||c<0||c>10)throw new F;this.firstDigit=a,this.secondDigit=c}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Mr.FNC1}isSecondDigitFNC1(){return this.secondDigit===Mr.FNC1}isAnyFNC1(){return this.firstDigit===Mr.FNC1||this.secondDigit===Mr.FNC1}}Mr.FNC1=10;class ve{constructor(){}static parseFieldsInGeneralPurpose(s){if(!s)return null;if(s.length<2)throw new $;let a=s.substring(0,2);for(let f of ve.TWO_DIGIT_DATA_LENGTH)if(f[0]===a)return f[1]===ve.VARIABLE_LENGTH?ve.processVariableAI(2,f[2],s):ve.processFixedAI(2,f[1],s);if(s.length<3)throw new $;let c=s.substring(0,3);for(let f of ve.THREE_DIGIT_DATA_LENGTH)if(f[0]===c)return f[1]===ve.VARIABLE_LENGTH?ve.processVariableAI(3,f[2],s):ve.processFixedAI(3,f[1],s);for(let f of ve.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(f[0]===c)return f[1]===ve.VARIABLE_LENGTH?ve.processVariableAI(4,f[2],s):ve.processFixedAI(4,f[1],s);if(s.length<4)throw new $;let d=s.substring(0,4);for(let f of ve.FOUR_DIGIT_DATA_LENGTH)if(f[0]===d)return f[1]===ve.VARIABLE_LENGTH?ve.processVariableAI(4,f[2],s):ve.processFixedAI(4,f[1],s);throw new $}static processFixedAI(s,a,c){if(c.length<s)throw new $;let d=c.substring(0,s);if(c.length<s+a)throw new $;let f=c.substring(s,s+a),m=c.substring(s+a),w="("+d+")"+f,A=ve.parseFieldsInGeneralPurpose(m);return A==null?w:w+A}static processVariableAI(s,a,c){let d=c.substring(0,s),f;c.length<s+a?f=c.length:f=s+a;let m=c.substring(s,f),w=c.substring(f),A="("+d+")"+m,b=ve.parseFieldsInGeneralPurpose(w);return b==null?A:A+b}}ve.VARIABLE_LENGTH=[],ve.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",ve.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",ve.VARIABLE_LENGTH,20],["22",ve.VARIABLE_LENGTH,29],["30",ve.VARIABLE_LENGTH,8],["37",ve.VARIABLE_LENGTH,8],["90",ve.VARIABLE_LENGTH,30],["91",ve.VARIABLE_LENGTH,30],["92",ve.VARIABLE_LENGTH,30],["93",ve.VARIABLE_LENGTH,30],["94",ve.VARIABLE_LENGTH,30],["95",ve.VARIABLE_LENGTH,30],["96",ve.VARIABLE_LENGTH,30],["97",ve.VARIABLE_LENGTH,3],["98",ve.VARIABLE_LENGTH,30],["99",ve.VARIABLE_LENGTH,30]],ve.THREE_DIGIT_DATA_LENGTH=[["240",ve.VARIABLE_LENGTH,30],["241",ve.VARIABLE_LENGTH,30],["242",ve.VARIABLE_LENGTH,6],["250",ve.VARIABLE_LENGTH,30],["251",ve.VARIABLE_LENGTH,30],["253",ve.VARIABLE_LENGTH,17],["254",ve.VARIABLE_LENGTH,20],["400",ve.VARIABLE_LENGTH,30],["401",ve.VARIABLE_LENGTH,30],["402",17],["403",ve.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",ve.VARIABLE_LENGTH,20],["421",ve.VARIABLE_LENGTH,15],["422",3],["423",ve.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],ve.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",ve.VARIABLE_LENGTH,15],["391",ve.VARIABLE_LENGTH,18],["392",ve.VARIABLE_LENGTH,15],["393",ve.VARIABLE_LENGTH,18],["703",ve.VARIABLE_LENGTH,30]],ve.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",ve.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",ve.VARIABLE_LENGTH,20],["8003",ve.VARIABLE_LENGTH,30],["8004",ve.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",ve.VARIABLE_LENGTH,30],["8008",ve.VARIABLE_LENGTH,12],["8018",18],["8020",ve.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",ve.VARIABLE_LENGTH,70],["8200",ve.VARIABLE_LENGTH,70]];class gh{constructor(s){this.buffer=new le,this.information=s}decodeAllCodes(s,a){let c=a,d=null;do{let f=this.decodeGeneralPurposeField(c,d),m=ve.parseFieldsInGeneralPurpose(f.getNewString());if(m!=null&&s.append(m),f.isRemaining()?d=""+f.getRemainingValue():d=null,c===f.getNewPosition())break;c=f.getNewPosition()}while(!0);return s.toString()}isStillNumeric(s){if(s+7>this.information.getSize())return s+4<=this.information.getSize();for(let a=s;a<s+3;++a)if(this.information.get(a))return!0;return this.information.get(s+3)}decodeNumeric(s){if(s+7>this.information.getSize()){let f=this.extractNumericValueFromBitArray(s,4);return f===0?new Mr(this.information.getSize(),Mr.FNC1,Mr.FNC1):new Mr(this.information.getSize(),f-1,Mr.FNC1)}let a=this.extractNumericValueFromBitArray(s,7),c=(a-8)/11,d=(a-8)%11;return new Mr(s+7,c,d)}extractNumericValueFromBitArray(s,a){return gh.extractNumericValueFromBitArray(this.information,s,a)}static extractNumericValueFromBitArray(s,a,c){let d=0;for(let f=0;f<c;++f)s.get(a+f)&&(d|=1<<c-f-1);return d}decodeGeneralPurposeField(s,a){this.buffer.setLengthToZero(),a!=null&&this.buffer.append(a),this.current.setPosition(s);let c=this.parseBlocks();return c!=null&&c.isRemaining()?new oc(this.current.getPosition(),this.buffer.toString(),c.getRemainingValue()):new oc(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let s,a;do{let c=this.current.getPosition();if(this.current.isAlpha()?(a=this.parseAlphaBlock(),s=a.isFinished()):this.current.isIsoIec646()?(a=this.parseIsoIec646Block(),s=a.isFinished()):(a=this.parseNumericBlock(),s=a.isFinished()),!(c!==this.current.getPosition())&&!s)break}while(!s);return a.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let s=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(s.getNewPosition()),s.isFirstDigitFNC1()){let a;return s.isSecondDigitFNC1()?a=new oc(this.current.getPosition(),this.buffer.toString()):a=new oc(this.current.getPosition(),this.buffer.toString(),s.getSecondDigit()),new sc(!0,a)}if(this.buffer.append(s.getFirstDigit()),s.isSecondDigitFNC1()){let a=new oc(this.current.getPosition(),this.buffer.toString());return new sc(!0,a)}this.buffer.append(s.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new sc(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let s=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(s.getNewPosition()),s.isFNC1()){let a=new oc(this.current.getPosition(),this.buffer.toString());return new sc(!0,a)}this.buffer.append(s.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new sc(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let s=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(s.getNewPosition()),s.isFNC1()){let a=new oc(this.current.getPosition(),this.buffer.toString());return new sc(!0,a)}this.buffer.append(s.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new sc(!1)}isStillIsoIec646(s){if(s+5>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(s,5);if(a>=5&&a<16)return!0;if(s+7>this.information.getSize())return!1;let c=this.extractNumericValueFromBitArray(s,7);if(c>=64&&c<116)return!0;if(s+8>this.information.getSize())return!1;let d=this.extractNumericValueFromBitArray(s,8);return d>=232&&d<253}decodeIsoIec646(s){let a=this.extractNumericValueFromBitArray(s,5);if(a===15)return new Li(s+5,Li.FNC1);if(a>=5&&a<15)return new Li(s+5,"0"+(a-5));let c=this.extractNumericValueFromBitArray(s,7);if(c>=64&&c<90)return new Li(s+7,""+(c+1));if(c>=90&&c<116)return new Li(s+7,""+(c+7));let d=this.extractNumericValueFromBitArray(s,8),f;switch(d){case 232:f="!";break;case 233:f='"';break;case 234:f="%";break;case 235:f="&";break;case 236:f="'";break;case 237:f="(";break;case 238:f=")";break;case 239:f="*";break;case 240:f="+";break;case 241:f=",";break;case 242:f="-";break;case 243:f=".";break;case 244:f="/";break;case 245:f=":";break;case 246:f=";";break;case 247:f="<";break;case 248:f="=";break;case 249:f=">";break;case 250:f="?";break;case 251:f="_";break;case 252:f=" ";break;default:throw new F}return new Li(s+8,f)}isStillAlpha(s){if(s+5>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(s,5);if(a>=5&&a<16)return!0;if(s+6>this.information.getSize())return!1;let c=this.extractNumericValueFromBitArray(s,6);return c>=16&&c<63}decodeAlphanumeric(s){let a=this.extractNumericValueFromBitArray(s,5);if(a===15)return new Li(s+5,Li.FNC1);if(a>=5&&a<15)return new Li(s+5,"0"+(a-5));let c=this.extractNumericValueFromBitArray(s,6);if(c>=32&&c<58)return new Li(s+6,""+(c+33));let d;switch(c){case 58:d="*";break;case 59:d=",";break;case 60:d="-";break;case 61:d=".";break;case 62:d="/";break;default:throw new rt("Decoding invalid alphanumeric value: "+c)}return new Li(s+6,d)}isAlphaTo646ToAlphaLatch(s){if(s+1>this.information.getSize())return!1;for(let a=0;a<5&&a+s<this.information.getSize();++a)if(a===2){if(!this.information.get(s+2))return!1}else if(this.information.get(s+a))return!1;return!0}isAlphaOr646ToNumericLatch(s){if(s+3>this.information.getSize())return!1;for(let a=s;a<s+3;++a)if(this.information.get(a))return!1;return!0}isNumericToAlphaNumericLatch(s){if(s+1>this.information.getSize())return!1;for(let a=0;a<4&&a+s<this.information.getSize();++a)if(this.information.get(s+a))return!1;return!0}}class wA{constructor(s){this.information=s,this.generalDecoder=new gh(s)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Bi extends wA{constructor(s){super(s)}encodeCompressedGtin(s,a){s.append("(01)");let c=s.length();s.append("9"),this.encodeCompressedGtinWithoutAI(s,a,c)}encodeCompressedGtinWithoutAI(s,a,c){for(let d=0;d<4;++d){let f=this.getGeneralDecoder().extractNumericValueFromBitArray(a+10*d,10);f/100===0&&s.append("0"),f/10===0&&s.append("0"),s.append(f)}Bi.appendCheckDigit(s,c)}static appendCheckDigit(s,a){let c=0;for(let d=0;d<13;d++){let f=s.charAt(d+a).charCodeAt(0)-"0".charCodeAt(0);c+=d&1?f:3*f}c=10-c%10,c===10&&(c=0),s.append(c)}}Bi.GTIN_SIZE=40;class ph extends Bi{constructor(s){super(s)}parseInformation(){let s=new le;s.append("(01)");let a=s.length(),c=this.getGeneralDecoder().extractNumericValueFromBitArray(ph.HEADER_SIZE,4);return s.append(c),this.encodeCompressedGtinWithoutAI(s,ph.HEADER_SIZE+4,a),this.getGeneralDecoder().decodeAllCodes(s,ph.HEADER_SIZE+44)}}ph.HEADER_SIZE=1+1+2;class jm extends wA{constructor(s){super(s)}parseInformation(){let s=new le;return this.getGeneralDecoder().decodeAllCodes(s,jm.HEADER_SIZE)}}jm.HEADER_SIZE=2+1+2;class zm extends Bi{constructor(s){super(s)}encodeCompressedWeight(s,a,c){let d=this.getGeneralDecoder().extractNumericValueFromBitArray(a,c);this.addWeightCode(s,d);let f=this.checkWeight(d),m=1e5;for(let w=0;w<5;++w)f/m===0&&s.append("0"),m/=10;s.append(f)}}class Bs extends zm{constructor(s){super(s)}parseInformation(){if(this.getInformation().getSize()!=Bs.HEADER_SIZE+zm.GTIN_SIZE+Bs.WEIGHT_SIZE)throw new $;let s=new le;return this.encodeCompressedGtin(s,Bs.HEADER_SIZE),this.encodeCompressedWeight(s,Bs.HEADER_SIZE+zm.GTIN_SIZE,Bs.WEIGHT_SIZE),s.toString()}}Bs.HEADER_SIZE=4+1,Bs.WEIGHT_SIZE=15;class GN extends Bs{constructor(s){super(s)}addWeightCode(s,a){s.append("(3103)")}checkWeight(s){return s}}class XN extends Bs{constructor(s){super(s)}addWeightCode(s,a){a<1e4?s.append("(3202)"):s.append("(3203)")}checkWeight(s){return s<1e4?s:s-1e4}}class Fs extends Bi{constructor(s){super(s)}parseInformation(){if(this.getInformation().getSize()<Fs.HEADER_SIZE+Bi.GTIN_SIZE)throw new $;let s=new le;this.encodeCompressedGtin(s,Fs.HEADER_SIZE);let a=this.getGeneralDecoder().extractNumericValueFromBitArray(Fs.HEADER_SIZE+Bi.GTIN_SIZE,Fs.LAST_DIGIT_SIZE);s.append("(392"),s.append(a),s.append(")");let c=this.getGeneralDecoder().decodeGeneralPurposeField(Fs.HEADER_SIZE+Bi.GTIN_SIZE+Fs.LAST_DIGIT_SIZE,null);return s.append(c.getNewString()),s.toString()}}Fs.HEADER_SIZE=5+1+2,Fs.LAST_DIGIT_SIZE=2;class bi extends Bi{constructor(s){super(s)}parseInformation(){if(this.getInformation().getSize()<bi.HEADER_SIZE+Bi.GTIN_SIZE)throw new $;let s=new le;this.encodeCompressedGtin(s,bi.HEADER_SIZE);let a=this.getGeneralDecoder().extractNumericValueFromBitArray(bi.HEADER_SIZE+Bi.GTIN_SIZE,bi.LAST_DIGIT_SIZE);s.append("(393"),s.append(a),s.append(")");let c=this.getGeneralDecoder().extractNumericValueFromBitArray(bi.HEADER_SIZE+Bi.GTIN_SIZE+bi.LAST_DIGIT_SIZE,bi.FIRST_THREE_DIGITS_SIZE);c/100==0&&s.append("0"),c/10==0&&s.append("0"),s.append(c);let d=this.getGeneralDecoder().decodeGeneralPurposeField(bi.HEADER_SIZE+Bi.GTIN_SIZE+bi.LAST_DIGIT_SIZE+bi.FIRST_THREE_DIGITS_SIZE,null);return s.append(d.getNewString()),s.toString()}}bi.HEADER_SIZE=5+1+2,bi.LAST_DIGIT_SIZE=2,bi.FIRST_THREE_DIGITS_SIZE=10;class jt extends zm{constructor(s,a,c){super(s),this.dateCode=c,this.firstAIdigits=a}parseInformation(){if(this.getInformation().getSize()!=jt.HEADER_SIZE+jt.GTIN_SIZE+jt.WEIGHT_SIZE+jt.DATE_SIZE)throw new $;let s=new le;return this.encodeCompressedGtin(s,jt.HEADER_SIZE),this.encodeCompressedWeight(s,jt.HEADER_SIZE+jt.GTIN_SIZE,jt.WEIGHT_SIZE),this.encodeCompressedDate(s,jt.HEADER_SIZE+jt.GTIN_SIZE+jt.WEIGHT_SIZE),s.toString()}encodeCompressedDate(s,a){let c=this.getGeneralDecoder().extractNumericValueFromBitArray(a,jt.DATE_SIZE);if(c==38400)return;s.append("("),s.append(this.dateCode),s.append(")");let d=c%32;c/=32;let f=c%12+1;c/=12;let m=c;m/10==0&&s.append("0"),s.append(m),f/10==0&&s.append("0"),s.append(f),d/10==0&&s.append("0"),s.append(d)}addWeightCode(s,a){s.append("("),s.append(this.firstAIdigits),s.append(a/1e5),s.append(")")}checkWeight(s){return s%1e5}}jt.HEADER_SIZE=7+1,jt.WEIGHT_SIZE=20,jt.DATE_SIZE=16;function pS(D){try{if(D.get(1))return new ph(D);if(!D.get(2))return new jm(D);switch(gh.extractNumericValueFromBitArray(D,1,4)){case 4:return new GN(D);case 5:return new XN(D)}switch(gh.extractNumericValueFromBitArray(D,1,5)){case 12:return new Fs(D);case 13:return new bi(D)}switch(gh.extractNumericValueFromBitArray(D,1,7)){case 56:return new jt(D,"310","11");case 57:return new jt(D,"320","11");case 58:return new jt(D,"310","13");case 59:return new jt(D,"320","13");case 60:return new jt(D,"310","15");case 61:return new jt(D,"320","15");case 62:return new jt(D,"310","17");case 63:return new jt(D,"320","17")}}catch(s){throw console.log(s),new rt("unknown decoder: "+D)}}class Sa{constructor(s,a,c,d){this.leftchar=s,this.rightchar=a,this.finderpattern=c,this.maybeLast=d}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(s,a){return s instanceof Sa?Sa.equalsOrNull(s.leftchar,a.leftchar)&&Sa.equalsOrNull(s.rightchar,a.rightchar)&&Sa.equalsOrNull(s.finderpattern,a.finderpattern):!1}static equalsOrNull(s,a){return s===null?a===null:Sa.equals(s,a)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class yA{constructor(s,a,c){this.pairs=s,this.rowNumber=a,this.wasReversed=c}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(s){return this.checkEqualitity(this,s)}toString(){return"{ "+this.pairs+" }"}equals(s,a){return s instanceof yA?this.checkEqualitity(s,a)&&s.wasReversed===a.wasReversed:!1}checkEqualitity(s,a){if(!s||!a)return;let c;return s.forEach((d,f)=>{a.forEach(m=>{d.getLeftChar().getValue()===m.getLeftChar().getValue()&&d.getRightChar().getValue()===m.getRightChar().getValue()&&d.getFinderPatter().getValue()===m.getFinderPatter().getValue()&&(c=!0)})}),c}}class se extends fn{constructor(s){super(...arguments),this.pairs=new Array(se.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=s===!0}decodeRow(s,a,c){this.pairs.length=0,this.startFromEven=!1;try{return se.constructResult(this.decodeRow2pairs(s,a))}catch(d){this.verbose&&console.log(d)}return this.pairs.length=0,this.startFromEven=!0,se.constructResult(this.decodeRow2pairs(s,a))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(s,a){let c=!1;for(;!c;)try{this.pairs.push(this.retrieveNextPair(a,this.pairs,s))}catch(f){if(f instanceof $){if(!this.pairs.length)throw new $;c=!0}}if(this.checkChecksum())return this.pairs;let d;if(this.rows.length?d=!0:d=!1,this.storeRow(s,!1),d){let f=this.checkRowsBoolean(!1);if(f!=null||(f=this.checkRowsBoolean(!0),f!=null))return f}throw new $}checkRowsBoolean(s){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,s&&(this.rows=this.rows.reverse());let a=null;try{a=this.checkRows(new Array,0)}catch(c){this.verbose&&console.log(c)}return s&&(this.rows=this.rows.reverse()),a}checkRows(s,a){for(let c=a;c<this.rows.length;c++){let d=this.rows[c];this.pairs.length=0;for(let m of s)this.pairs.push(m.getPairs());if(this.pairs.push(d.getPairs()),!se.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let f=new Array(s);f.push(d);try{return this.checkRows(f,c+1)}catch(m){this.verbose&&console.log(m)}}throw new $}static isValidSequence(s){for(let a of se.FINDER_PATTERN_SEQUENCES){if(s.length>a.length)continue;let c=!0;for(let d=0;d<s.length;d++)if(s[d].getFinderPattern().getValue()!=a[d]){c=!1;break}if(c)return!0}return!1}storeRow(s,a){let c=0,d=!1,f=!1;for(;c<this.rows.length;){let m=this.rows[c];if(m.getRowNumber()>s){f=m.isEquivalent(this.pairs);break}d=m.isEquivalent(this.pairs),c++}f||d||se.isPartialRow(this.pairs,this.rows)||(this.rows.push(c,new yA(this.pairs,s,a)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(s,a){for(let c of a)if(c.getPairs().length!==s.length){for(let d of c.getPairs())for(let f of s)if(Sa.equals(d,f))break}}static isPartialRow(s,a){for(let c of a){let d=!0;for(let f of s){let m=!1;for(let w of c.getPairs())if(f.equals(w)){m=!0;break}if(!m){d=!1;break}}if(d)return!0}return!1}getRows(){return this.rows}static constructResult(s){let a=ls.buildBitArray(s),d=pS(a).parseInformation(),f=s[0].getFinderPattern().getResultPoints(),m=s[s.length-1].getFinderPattern().getResultPoints(),w=[f[0],f[1],m[0],m[1]];return new Le(d,null,null,w,xe.RSS_EXPANDED,null)}checkChecksum(){let s=this.pairs.get(0),a=s.getLeftChar(),c=s.getRightChar();if(c==null)return!1;let d=c.getChecksumPortion(),f=2;for(let w=1;w<this.pairs.size();++w){let A=this.pairs.get(w);d+=A.getLeftChar().getChecksumPortion(),f++;let b=A.getRightChar();b!=null&&(d+=b.getChecksumPortion(),f++)}return d%=211,211*(f-4)+d==a.getValue()}static getNextSecondBar(s,a){let c;return s.get(a)?(c=s.getNextUnset(a),c=s.getNextSet(c)):(c=s.getNextSet(a),c=s.getNextUnset(c)),c}retrieveNextPair(s,a,c){let d=a.length%2==0;this.startFromEven&&(d=!d);let f,m=!0,w=-1;do this.findNextPair(s,a,w),f=this.parseFoundFinderPattern(s,c,d),f==null?w=se.getNextSecondBar(s,this.startEnd[0]):m=!1;while(m);let A=this.decodeDataCharacter(s,f,d,!0);if(!this.isEmptyPair(a)&&a[a.length-1].mustBeLast())throw new $;let b;try{b=this.decodeDataCharacter(s,f,d,!1)}catch(T){b=null,this.verbose&&console.log(T)}return new Sa(A,b,f,!0)}isEmptyPair(s){return s.length===0}findNextPair(s,a,c){let d=this.getDecodeFinderCounters();d[0]=0,d[1]=0,d[2]=0,d[3]=0;let f=s.getSize(),m;c>=0?m=c:this.isEmptyPair(a)?m=0:m=a[a.length-1].getFinderPattern().getStartEnd()[1];let w=a.length%2!=0;this.startFromEven&&(w=!w);let A=!1;for(;m<f&&(A=!s.get(m),!!A);)m++;let b=0,T=m;for(let M=m;M<f;M++)if(s.get(M)!=A)d[b]++;else{if(b==3){if(w&&se.reverseCounters(d),se.isFinderPattern(d)){this.startEnd[0]=T,this.startEnd[1]=M;return}w&&se.reverseCounters(d),T+=d[0]+d[1],d[0]=d[2],d[1]=d[3],d[2]=0,d[3]=0,b--}else b++;d[b]=1,A=!A}throw new $}static reverseCounters(s){let a=s.length;for(let c=0;c<a/2;++c){let d=s[c];s[c]=s[a-c-1],s[a-c-1]=d}}parseFoundFinderPattern(s,a,c){let d,f,m;if(c){let b=this.startEnd[0]-1;for(;b>=0&&!s.get(b);)b--;b++,d=this.startEnd[0]-b,f=b,m=this.startEnd[1]}else f=this.startEnd[0],m=s.getNextUnset(this.startEnd[1]+1),d=m-this.startEnd[1];let w=this.getDecodeFinderCounters();I.arraycopy(w,0,w,1,w.length-1),w[0]=d;let A;try{A=this.parseFinderValue(w,se.FINDER_PATTERNS)}catch{return null}return new fh(A,[f,m],f,m,a)}decodeDataCharacter(s,a,c,d){let f=this.getDataCharacterCounters();for(let Ct=0;Ct<f.length;Ct++)f[Ct]=0;if(d)se.recordPatternInReverse(s,a.getStartEnd()[0],f);else{se.recordPattern(s,a.getStartEnd()[1],f);for(let Ct=0,$n=f.length-1;Ct<$n;Ct++,$n--){let ir=f[Ct];f[Ct]=f[$n],f[$n]=ir}}let m=17,w=$e.sum(new Int32Array(f))/m,A=(a.getStartEnd()[1]-a.getStartEnd()[0])/15;if(Math.abs(w-A)/A>.3)throw new $;let b=this.getOddCounts(),T=this.getEvenCounts(),M=this.getOddRoundingErrors(),L=this.getEvenRoundingErrors();for(let Ct=0;Ct<f.length;Ct++){let $n=1*f[Ct]/w,ir=$n+.5;if(ir<1){if($n<.3)throw new $;ir=1}else if(ir>8){if($n>8.7)throw new $;ir=8}let Ah=Ct/2;Ct&1?(T[Ah]=ir,L[Ah]=$n-ir):(b[Ah]=ir,M[Ah]=$n-ir)}this.adjustOddEvenCounts(m);let V=4*a.getValue()+(c?0:2)+(d?0:1)-1,G=0,X=0;for(let Ct=b.length-1;Ct>=0;Ct--){if(se.isNotA1left(a,c,d)){let $n=se.WEIGHTS[V][2*Ct];X+=b[Ct]*$n}G+=b[Ct]}let K=0;for(let Ct=T.length-1;Ct>=0;Ct--)if(se.isNotA1left(a,c,d)){let $n=se.WEIGHTS[V][2*Ct+1];K+=T[Ct]*$n}let J=X+K;if(G&1||G>13||G<4)throw new $;let de=(13-G)/2,fe=se.SYMBOL_WIDEST[de],ae=9-fe,qe=Oi.getRSSvalue(b,fe,!0),je=Oi.getRSSvalue(T,ae,!1),Ui=se.EVEN_TOTAL_SUBSET[de],cs=se.GSUM[de],ji=qe*Ui+je+cs;return new Dr(ji,J)}static isNotA1left(s,a,c){return!(s.getValue()==0&&a&&c)}adjustOddEvenCounts(s){let a=$e.sum(new Int32Array(this.getOddCounts())),c=$e.sum(new Int32Array(this.getEvenCounts())),d=!1,f=!1;a>13?f=!0:a<4&&(d=!0);let m=!1,w=!1;c>13?w=!0:c<4&&(m=!0);let A=a+c-s,b=(a&1)==1,T=(c&1)==0;if(A==1)if(b){if(T)throw new $;f=!0}else{if(!T)throw new $;w=!0}else if(A==-1)if(b){if(T)throw new $;d=!0}else{if(!T)throw new $;m=!0}else if(A==0){if(b){if(!T)throw new $;a<c?(d=!0,w=!0):(f=!0,m=!0)}else if(T)throw new $}else throw new $;if(d){if(f)throw new $;se.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(f&&se.decrement(this.getOddCounts(),this.getOddRoundingErrors()),m){if(w)throw new $;se.increment(this.getEvenCounts(),this.getOddRoundingErrors())}w&&se.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}se.SYMBOL_WIDEST=[7,5,4,3,1],se.EVEN_TOTAL_SUBSET=[4,20,52,104,204],se.GSUM=[0,348,1388,2948,3988],se.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],se.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],se.FINDER_PAT_A=0,se.FINDER_PAT_B=1,se.FINDER_PAT_C=2,se.FINDER_PAT_D=3,se.FINDER_PAT_E=4,se.FINDER_PAT_F=5,se.FINDER_PATTERN_SEQUENCES=[[se.FINDER_PAT_A,se.FINDER_PAT_A],[se.FINDER_PAT_A,se.FINDER_PAT_B,se.FINDER_PAT_B],[se.FINDER_PAT_A,se.FINDER_PAT_C,se.FINDER_PAT_B,se.FINDER_PAT_D],[se.FINDER_PAT_A,se.FINDER_PAT_E,se.FINDER_PAT_B,se.FINDER_PAT_D,se.FINDER_PAT_C],[se.FINDER_PAT_A,se.FINDER_PAT_E,se.FINDER_PAT_B,se.FINDER_PAT_D,se.FINDER_PAT_D,se.FINDER_PAT_F],[se.FINDER_PAT_A,se.FINDER_PAT_E,se.FINDER_PAT_B,se.FINDER_PAT_D,se.FINDER_PAT_E,se.FINDER_PAT_F,se.FINDER_PAT_F],[se.FINDER_PAT_A,se.FINDER_PAT_A,se.FINDER_PAT_B,se.FINDER_PAT_B,se.FINDER_PAT_C,se.FINDER_PAT_C,se.FINDER_PAT_D,se.FINDER_PAT_D],[se.FINDER_PAT_A,se.FINDER_PAT_A,se.FINDER_PAT_B,se.FINDER_PAT_B,se.FINDER_PAT_C,se.FINDER_PAT_C,se.FINDER_PAT_D,se.FINDER_PAT_E,se.FINDER_PAT_E],[se.FINDER_PAT_A,se.FINDER_PAT_A,se.FINDER_PAT_B,se.FINDER_PAT_B,se.FINDER_PAT_C,se.FINDER_PAT_C,se.FINDER_PAT_D,se.FINDER_PAT_E,se.FINDER_PAT_F,se.FINDER_PAT_F],[se.FINDER_PAT_A,se.FINDER_PAT_A,se.FINDER_PAT_B,se.FINDER_PAT_B,se.FINDER_PAT_C,se.FINDER_PAT_D,se.FINDER_PAT_D,se.FINDER_PAT_E,se.FINDER_PAT_E,se.FINDER_PAT_F,se.FINDER_PAT_F]],se.MAX_PAIRS=11;class YN extends Dr{constructor(s,a,c){super(s,a),this.count=0,this.finderPattern=c}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class rn extends fn{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(s,a,c){const d=this.decodePair(a,!1,s,c);rn.addOrTally(this.possibleLeftPairs,d),a.reverse();let f=this.decodePair(a,!0,s,c);rn.addOrTally(this.possibleRightPairs,f),a.reverse();for(let m of this.possibleLeftPairs)if(m.getCount()>1){for(let w of this.possibleRightPairs)if(w.getCount()>1&&rn.checkChecksum(m,w))return rn.constructResult(m,w)}throw new $}static addOrTally(s,a){if(a==null)return;let c=!1;for(let d of s)if(d.getValue()===a.getValue()){d.incrementCount(),c=!0;break}c||s.push(a)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(s,a){let c=4537077*s.getValue()+a.getValue(),d=new String(c).toString(),f=new le;for(let b=13-d.length;b>0;b--)f.append("0");f.append(d);let m=0;for(let b=0;b<13;b++){let T=f.charAt(b).charCodeAt(0)-"0".charCodeAt(0);m+=b&1?T:3*T}m=10-m%10,m===10&&(m=0),f.append(m.toString());let w=s.getFinderPattern().getResultPoints(),A=a.getFinderPattern().getResultPoints();return new Le(f.toString(),null,0,[w[0],w[1],A[0],A[1]],xe.RSS_14,new Date().getTime())}static checkChecksum(s,a){let c=(s.getChecksumPortion()+16*a.getChecksumPortion())%79,d=9*s.getFinderPattern().getValue()+a.getFinderPattern().getValue();return d>72&&d--,d>8&&d--,c===d}decodePair(s,a,c,d){try{let f=this.findFinderPattern(s,a),m=this.parseFoundFinderPattern(s,c,a,f),w=d==null?null:d.get(H.NEED_RESULT_POINT_CALLBACK);if(w!=null){let T=(f[0]+f[1])/2;a&&(T=s.getSize()-1-T),w.foundPossibleResultPoint(new Se(T,c))}let A=this.decodeDataCharacter(s,m,!0),b=this.decodeDataCharacter(s,m,!1);return new YN(1597*A.getValue()+b.getValue(),A.getChecksumPortion()+4*b.getChecksumPortion(),m)}catch{return null}}decodeDataCharacter(s,a,c){let d=this.getDataCharacterCounters();for(let K=0;K<d.length;K++)d[K]=0;if(c)nn.recordPatternInReverse(s,a.getStartEnd()[0],d);else{nn.recordPattern(s,a.getStartEnd()[1]+1,d);for(let K=0,J=d.length-1;K<J;K++,J--){let de=d[K];d[K]=d[J],d[J]=de}}let f=c?16:15,m=$e.sum(new Int32Array(d))/f,w=this.getOddCounts(),A=this.getEvenCounts(),b=this.getOddRoundingErrors(),T=this.getEvenRoundingErrors();for(let K=0;K<d.length;K++){let J=d[K]/m,de=Math.floor(J+.5);de<1?de=1:de>8&&(de=8);let fe=Math.floor(K/2);K&1?(A[fe]=de,T[fe]=J-de):(w[fe]=de,b[fe]=J-de)}this.adjustOddEvenCounts(c,f);let M=0,L=0;for(let K=w.length-1;K>=0;K--)L*=9,L+=w[K],M+=w[K];let V=0,G=0;for(let K=A.length-1;K>=0;K--)V*=9,V+=A[K],G+=A[K];let X=L+3*V;if(c){if(M&1||M>12||M<4)throw new $;let K=(12-M)/2,J=rn.OUTSIDE_ODD_WIDEST[K],de=9-J,fe=Oi.getRSSvalue(w,J,!1),ae=Oi.getRSSvalue(A,de,!0),qe=rn.OUTSIDE_EVEN_TOTAL_SUBSET[K],je=rn.OUTSIDE_GSUM[K];return new Dr(fe*qe+ae+je,X)}else{if(G&1||G>10||G<4)throw new $;let K=(10-G)/2,J=rn.INSIDE_ODD_WIDEST[K],de=9-J,fe=Oi.getRSSvalue(w,J,!0),ae=Oi.getRSSvalue(A,de,!1),qe=rn.INSIDE_ODD_TOTAL_SUBSET[K],je=rn.INSIDE_GSUM[K];return new Dr(ae*qe+fe+je,X)}}findFinderPattern(s,a){let c=this.getDecodeFinderCounters();c[0]=0,c[1]=0,c[2]=0,c[3]=0;let d=s.getSize(),f=!1,m=0;for(;m<d&&(f=!s.get(m),a!==f);)m++;let w=0,A=m;for(let b=m;b<d;b++)if(s.get(b)!==f)c[w]++;else{if(w===3){if(fn.isFinderPattern(c))return[A,b];A+=c[0]+c[1],c[0]=c[2],c[1]=c[3],c[2]=0,c[3]=0,w--}else w++;c[w]=1,f=!f}throw new $}parseFoundFinderPattern(s,a,c,d){let f=s.get(d[0]),m=d[0]-1;for(;m>=0&&f!==s.get(m);)m--;m++;const w=d[0]-m,A=this.getDecodeFinderCounters(),b=new Int32Array(A.length);I.arraycopy(A,0,b,1,A.length-1),b[0]=w;const T=this.parseFinderValue(b,rn.FINDER_PATTERNS);let M=m,L=d[1];return c&&(M=s.getSize()-1-M,L=s.getSize()-1-L),new fh(T,[m,d[1]],M,L,a)}adjustOddEvenCounts(s,a){let c=$e.sum(new Int32Array(this.getOddCounts())),d=$e.sum(new Int32Array(this.getEvenCounts())),f=!1,m=!1,w=!1,A=!1;s?(c>12?m=!0:c<4&&(f=!0),d>12?A=!0:d<4&&(w=!0)):(c>11?m=!0:c<5&&(f=!0),d>10?A=!0:d<4&&(w=!0));let b=c+d-a,T=(c&1)===(s?1:0),M=(d&1)===1;if(b===1)if(T){if(M)throw new $;m=!0}else{if(!M)throw new $;A=!0}else if(b===-1)if(T){if(M)throw new $;f=!0}else{if(!M)throw new $;w=!0}else if(b===0){if(T){if(!M)throw new $;c<d?(f=!0,A=!0):(m=!0,w=!0)}else if(M)throw new $}else throw new $;if(f){if(m)throw new $;fn.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(m&&fn.decrement(this.getOddCounts(),this.getOddRoundingErrors()),w){if(A)throw new $;fn.increment(this.getEvenCounts(),this.getOddRoundingErrors())}A&&fn.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}rn.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],rn.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],rn.OUTSIDE_GSUM=[0,161,961,2015,2715],rn.INSIDE_GSUM=[0,336,1036,1516],rn.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],rn.INSIDE_ODD_WIDEST=[2,4,6,8],rn.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class mh extends nn{constructor(s,a){super(),this.readers=[],this.verbose=a===!0;const c=s?s.get(H.POSSIBLE_FORMATS):null,d=s&&s.get(H.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;c?((c.includes(xe.EAN_13)||c.includes(xe.UPC_A)||c.includes(xe.EAN_8)||c.includes(xe.UPC_E))&&this.readers.push(new nr(s)),c.includes(xe.CODE_39)&&this.readers.push(new dn(d)),c.includes(xe.CODE_128)&&this.readers.push(new pe),c.includes(xe.ITF)&&this.readers.push(new ft),c.includes(xe.RSS_14)&&this.readers.push(new rn),c.includes(xe.RSS_EXPANDED)&&this.readers.push(new se(this.verbose))):(this.readers.push(new nr(s)),this.readers.push(new dn),this.readers.push(new nr(s)),this.readers.push(new pe),this.readers.push(new ft),this.readers.push(new rn),this.readers.push(new se(this.verbose)))}decodeRow(s,a,c){for(let d=0;d<this.readers.length;d++)try{return this.readers[d].decodeRow(s,a,c)}catch{}throw new $}reset(){this.readers.forEach(s=>s.reset())}}class $N extends me{constructor(s=500,a){super(new mh(a),s,a)}}class ht{constructor(s,a,c){this.ecCodewords=s,this.ecBlocks=[a],c&&this.ecBlocks.push(c)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class ct{constructor(s,a){this.count=s,this.dataCodewords=a}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class nt{constructor(s,a,c,d,f,m){this.versionNumber=s,this.symbolSizeRows=a,this.symbolSizeColumns=c,this.dataRegionSizeRows=d,this.dataRegionSizeColumns=f,this.ecBlocks=m;let w=0;const A=m.getECCodewords(),b=m.getECBlocks();for(let T of b)w+=T.getCount()*(T.getDataCodewords()+A);this.totalCodewords=w}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(s,a){if(s&1||a&1)throw new F;for(let c of nt.VERSIONS)if(c.symbolSizeRows===s&&c.symbolSizeColumns===a)return c;throw new F}toString(){return""+this.versionNumber}static buildVersions(){return[new nt(1,10,10,8,8,new ht(5,new ct(1,3))),new nt(2,12,12,10,10,new ht(7,new ct(1,5))),new nt(3,14,14,12,12,new ht(10,new ct(1,8))),new nt(4,16,16,14,14,new ht(12,new ct(1,12))),new nt(5,18,18,16,16,new ht(14,new ct(1,18))),new nt(6,20,20,18,18,new ht(18,new ct(1,22))),new nt(7,22,22,20,20,new ht(20,new ct(1,30))),new nt(8,24,24,22,22,new ht(24,new ct(1,36))),new nt(9,26,26,24,24,new ht(28,new ct(1,44))),new nt(10,32,32,14,14,new ht(36,new ct(1,62))),new nt(11,36,36,16,16,new ht(42,new ct(1,86))),new nt(12,40,40,18,18,new ht(48,new ct(1,114))),new nt(13,44,44,20,20,new ht(56,new ct(1,144))),new nt(14,48,48,22,22,new ht(68,new ct(1,174))),new nt(15,52,52,24,24,new ht(42,new ct(2,102))),new nt(16,64,64,14,14,new ht(56,new ct(2,140))),new nt(17,72,72,16,16,new ht(36,new ct(4,92))),new nt(18,80,80,18,18,new ht(48,new ct(4,114))),new nt(19,88,88,20,20,new ht(56,new ct(4,144))),new nt(20,96,96,22,22,new ht(68,new ct(4,174))),new nt(21,104,104,24,24,new ht(56,new ct(6,136))),new nt(22,120,120,18,18,new ht(68,new ct(6,175))),new nt(23,132,132,20,20,new ht(62,new ct(8,163))),new nt(24,144,144,22,22,new ht(62,new ct(8,156),new ct(2,155))),new nt(25,8,18,6,16,new ht(7,new ct(1,5))),new nt(26,8,32,6,14,new ht(11,new ct(1,10))),new nt(27,12,26,10,24,new ht(14,new ct(1,16))),new nt(28,12,36,10,16,new ht(18,new ct(1,22))),new nt(29,16,36,14,16,new ht(24,new ct(1,32))),new nt(30,16,48,14,22,new ht(28,new ct(1,49)))]}}nt.VERSIONS=nt.buildVersions();class AA{constructor(s){const a=s.getHeight();if(a<8||a>144||a&1)throw new F;this.version=AA.readVersion(s),this.mappingBitMatrix=this.extractDataRegion(s),this.readMappingMatrix=new ce(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(s){const a=s.getHeight(),c=s.getWidth();return nt.getVersionForDimensions(a,c)}readCodewords(){const s=new Int8Array(this.version.getTotalCodewords());let a=0,c=4,d=0;const f=this.mappingBitMatrix.getHeight(),m=this.mappingBitMatrix.getWidth();let w=!1,A=!1,b=!1,T=!1;do if(c===f&&d===0&&!w)s[a++]=this.readCorner1(f,m)&255,c-=2,d+=2,w=!0;else if(c===f-2&&d===0&&m&3&&!A)s[a++]=this.readCorner2(f,m)&255,c-=2,d+=2,A=!0;else if(c===f+4&&d===2&&!(m&7)&&!b)s[a++]=this.readCorner3(f,m)&255,c-=2,d+=2,b=!0;else if(c===f-2&&d===0&&(m&7)===4&&!T)s[a++]=this.readCorner4(f,m)&255,c-=2,d+=2,T=!0;else{do c<f&&d>=0&&!this.readMappingMatrix.get(d,c)&&(s[a++]=this.readUtah(c,d,f,m)&255),c-=2,d+=2;while(c>=0&&d<m);c+=1,d+=3;do c>=0&&d<m&&!this.readMappingMatrix.get(d,c)&&(s[a++]=this.readUtah(c,d,f,m)&255),c+=2,d-=2;while(c<f&&d>=0);c+=3,d+=1}while(c<f||d<m);if(a!==this.version.getTotalCodewords())throw new F;return s}readModule(s,a,c,d){return s<0&&(s+=c,a+=4-(c+4&7)),a<0&&(a+=d,s+=4-(d+4&7)),this.readMappingMatrix.set(a,s),this.mappingBitMatrix.get(a,s)}readUtah(s,a,c,d){let f=0;return this.readModule(s-2,a-2,c,d)&&(f|=1),f<<=1,this.readModule(s-2,a-1,c,d)&&(f|=1),f<<=1,this.readModule(s-1,a-2,c,d)&&(f|=1),f<<=1,this.readModule(s-1,a-1,c,d)&&(f|=1),f<<=1,this.readModule(s-1,a,c,d)&&(f|=1),f<<=1,this.readModule(s,a-2,c,d)&&(f|=1),f<<=1,this.readModule(s,a-1,c,d)&&(f|=1),f<<=1,this.readModule(s,a,c,d)&&(f|=1),f}readCorner1(s,a){let c=0;return this.readModule(s-1,0,s,a)&&(c|=1),c<<=1,this.readModule(s-1,1,s,a)&&(c|=1),c<<=1,this.readModule(s-1,2,s,a)&&(c|=1),c<<=1,this.readModule(0,a-2,s,a)&&(c|=1),c<<=1,this.readModule(0,a-1,s,a)&&(c|=1),c<<=1,this.readModule(1,a-1,s,a)&&(c|=1),c<<=1,this.readModule(2,a-1,s,a)&&(c|=1),c<<=1,this.readModule(3,a-1,s,a)&&(c|=1),c}readCorner2(s,a){let c=0;return this.readModule(s-3,0,s,a)&&(c|=1),c<<=1,this.readModule(s-2,0,s,a)&&(c|=1),c<<=1,this.readModule(s-1,0,s,a)&&(c|=1),c<<=1,this.readModule(0,a-4,s,a)&&(c|=1),c<<=1,this.readModule(0,a-3,s,a)&&(c|=1),c<<=1,this.readModule(0,a-2,s,a)&&(c|=1),c<<=1,this.readModule(0,a-1,s,a)&&(c|=1),c<<=1,this.readModule(1,a-1,s,a)&&(c|=1),c}readCorner3(s,a){let c=0;return this.readModule(s-1,0,s,a)&&(c|=1),c<<=1,this.readModule(s-1,a-1,s,a)&&(c|=1),c<<=1,this.readModule(0,a-3,s,a)&&(c|=1),c<<=1,this.readModule(0,a-2,s,a)&&(c|=1),c<<=1,this.readModule(0,a-1,s,a)&&(c|=1),c<<=1,this.readModule(1,a-3,s,a)&&(c|=1),c<<=1,this.readModule(1,a-2,s,a)&&(c|=1),c<<=1,this.readModule(1,a-1,s,a)&&(c|=1),c}readCorner4(s,a){let c=0;return this.readModule(s-3,0,s,a)&&(c|=1),c<<=1,this.readModule(s-2,0,s,a)&&(c|=1),c<<=1,this.readModule(s-1,0,s,a)&&(c|=1),c<<=1,this.readModule(0,a-2,s,a)&&(c|=1),c<<=1,this.readModule(0,a-1,s,a)&&(c|=1),c<<=1,this.readModule(1,a-1,s,a)&&(c|=1),c<<=1,this.readModule(2,a-1,s,a)&&(c|=1),c<<=1,this.readModule(3,a-1,s,a)&&(c|=1),c}extractDataRegion(s){const a=this.version.getSymbolSizeRows(),c=this.version.getSymbolSizeColumns();if(s.getHeight()!==a)throw new y("Dimension of bitMatrix must match the version size");const d=this.version.getDataRegionSizeRows(),f=this.version.getDataRegionSizeColumns(),m=a/d|0,w=c/f|0,A=m*d,b=w*f,T=new ce(b,A);for(let M=0;M<m;++M){const L=M*d;for(let V=0;V<w;++V){const G=V*f;for(let X=0;X<d;++X){const K=M*(d+2)+1+X,J=L+X;for(let de=0;de<f;++de){const fe=V*(f+2)+1+de;if(s.get(fe,K)){const ae=G+de;T.set(ae,J)}}}}}return T}}class vA{constructor(s,a){this.numDataCodewords=s,this.codewords=a}static getDataBlocks(s,a){const c=a.getECBlocks();let d=0;const f=c.getECBlocks();for(let X of f)d+=X.getCount();const m=new Array(d);let w=0;for(let X of f)for(let K=0;K<X.getCount();K++){const J=X.getDataCodewords(),de=c.getECCodewords()+J;m[w++]=new vA(J,new Uint8Array(de))}const b=m[0].codewords.length-c.getECCodewords(),T=b-1;let M=0;for(let X=0;X<T;X++)for(let K=0;K<w;K++)m[K].codewords[X]=s[M++];const L=a.getVersionNumber()===24,V=L?8:w;for(let X=0;X<V;X++)m[X].codewords[b-1]=s[M++];const G=m[0].codewords.length;for(let X=b;X<G;X++)for(let K=0;K<w;K++){const J=L?(K+8)%w:K,de=L&&J>7?X-1:X;m[J].codewords[de]=s[M++]}if(M!==s.length)throw new y;return m}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class bA{constructor(s){this.bytes=s,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(s){if(s<1||s>32||s>this.available())throw new y(""+s);let a=0,c=this.bitOffset,d=this.byteOffset;const f=this.bytes;if(c>0){const m=8-c,w=s<m?s:m,A=m-w,b=255>>8-w<<A;a=(f[d]&b)>>A,s-=w,c+=w,c===8&&(c=0,d++)}if(s>0){for(;s>=8;)a=a<<8|f[d]&255,d++,s-=8;if(s>0){const m=8-s,w=255>>m<<m;a=a<<s|(f[d]&w)>>m,c+=s}}return this.bitOffset=c,this.byteOffset=d,a}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Sn;(function(D){D[D.PAD_ENCODE=0]="PAD_ENCODE",D[D.ASCII_ENCODE=1]="ASCII_ENCODE",D[D.C40_ENCODE=2]="C40_ENCODE",D[D.TEXT_ENCODE=3]="TEXT_ENCODE",D[D.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",D[D.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",D[D.BASE256_ENCODE=6]="BASE256_ENCODE"})(Sn||(Sn={}));class _a{static decode(s){const a=new bA(s),c=new le,d=new le,f=new Array;let m=Sn.ASCII_ENCODE;do if(m===Sn.ASCII_ENCODE)m=this.decodeAsciiSegment(a,c,d);else{switch(m){case Sn.C40_ENCODE:this.decodeC40Segment(a,c);break;case Sn.TEXT_ENCODE:this.decodeTextSegment(a,c);break;case Sn.ANSIX12_ENCODE:this.decodeAnsiX12Segment(a,c);break;case Sn.EDIFACT_ENCODE:this.decodeEdifactSegment(a,c);break;case Sn.BASE256_ENCODE:this.decodeBase256Segment(a,c,f);break;default:throw new F}m=Sn.ASCII_ENCODE}while(m!==Sn.PAD_ENCODE&&a.available()>0);return d.length()>0&&c.append(d.toString()),new yn(s,c.toString(),f.length===0?null:f,null)}static decodeAsciiSegment(s,a,c){let d=!1;do{let f=s.readBits(8);if(f===0)throw new F;if(f<=128)return d&&(f+=128),a.append(String.fromCharCode(f-1)),Sn.ASCII_ENCODE;if(f===129)return Sn.PAD_ENCODE;if(f<=229){const m=f-130;m<10&&a.append("0"),a.append(""+m)}else switch(f){case 230:return Sn.C40_ENCODE;case 231:return Sn.BASE256_ENCODE;case 232:a.append(String.fromCharCode(29));break;case 233:case 234:break;case 235:d=!0;break;case 236:a.append("[)>05"),c.insert(0,"");break;case 237:a.append("[)>06"),c.insert(0,"");break;case 238:return Sn.ANSIX12_ENCODE;case 239:return Sn.TEXT_ENCODE;case 240:return Sn.EDIFACT_ENCODE;case 241:break;default:if(f!==254||s.available()!==0)throw new F;break}}while(s.available()>0);return Sn.ASCII_ENCODE}static decodeC40Segment(s,a){let c=!1;const d=[];let f=0;do{if(s.available()===8)return;const m=s.readBits(8);if(m===254)return;this.parseTwoBytes(m,s.readBits(8),d);for(let w=0;w<3;w++){const A=d[w];switch(f){case 0:if(A<3)f=A+1;else if(A<this.C40_BASIC_SET_CHARS.length){const b=this.C40_BASIC_SET_CHARS[A];c?(a.append(String.fromCharCode(b.charCodeAt(0)+128)),c=!1):a.append(b)}else throw new F;break;case 1:c?(a.append(String.fromCharCode(A+128)),c=!1):a.append(String.fromCharCode(A)),f=0;break;case 2:if(A<this.C40_SHIFT2_SET_CHARS.length){const b=this.C40_SHIFT2_SET_CHARS[A];c?(a.append(String.fromCharCode(b.charCodeAt(0)+128)),c=!1):a.append(b)}else switch(A){case 27:a.append(String.fromCharCode(29));break;case 30:c=!0;break;default:throw new F}f=0;break;case 3:c?(a.append(String.fromCharCode(A+224)),c=!1):a.append(String.fromCharCode(A+96)),f=0;break;default:throw new F}}}while(s.available()>0)}static decodeTextSegment(s,a){let c=!1,d=[],f=0;do{if(s.available()===8)return;const m=s.readBits(8);if(m===254)return;this.parseTwoBytes(m,s.readBits(8),d);for(let w=0;w<3;w++){const A=d[w];switch(f){case 0:if(A<3)f=A+1;else if(A<this.TEXT_BASIC_SET_CHARS.length){const b=this.TEXT_BASIC_SET_CHARS[A];c?(a.append(String.fromCharCode(b.charCodeAt(0)+128)),c=!1):a.append(b)}else throw new F;break;case 1:c?(a.append(String.fromCharCode(A+128)),c=!1):a.append(String.fromCharCode(A)),f=0;break;case 2:if(A<this.TEXT_SHIFT2_SET_CHARS.length){const b=this.TEXT_SHIFT2_SET_CHARS[A];c?(a.append(String.fromCharCode(b.charCodeAt(0)+128)),c=!1):a.append(b)}else switch(A){case 27:a.append(String.fromCharCode(29));break;case 30:c=!0;break;default:throw new F}f=0;break;case 3:if(A<this.TEXT_SHIFT3_SET_CHARS.length){const b=this.TEXT_SHIFT3_SET_CHARS[A];c?(a.append(String.fromCharCode(b.charCodeAt(0)+128)),c=!1):a.append(b),f=0}else throw new F;break;default:throw new F}}}while(s.available()>0)}static decodeAnsiX12Segment(s,a){const c=[];do{if(s.available()===8)return;const d=s.readBits(8);if(d===254)return;this.parseTwoBytes(d,s.readBits(8),c);for(let f=0;f<3;f++){const m=c[f];switch(m){case 0:a.append("\r");break;case 1:a.append("*");break;case 2:a.append(">");break;case 3:a.append(" ");break;default:if(m<14)a.append(String.fromCharCode(m+44));else if(m<40)a.append(String.fromCharCode(m+51));else throw new F;break}}}while(s.available()>0)}static parseTwoBytes(s,a,c){let d=(s<<8)+a-1,f=Math.floor(d/1600);c[0]=f,d-=f*1600,f=Math.floor(d/40),c[1]=f,c[2]=d-f*40}static decodeEdifactSegment(s,a){do{if(s.available()<=16)return;for(let c=0;c<4;c++){let d=s.readBits(6);if(d===31){const f=8-s.getBitOffset();f!==8&&s.readBits(f);return}d&32||(d|=64),a.append(String.fromCharCode(d))}}while(s.available()>0)}static decodeBase256Segment(s,a,c){let d=1+s.getByteOffset();const f=this.unrandomize255State(s.readBits(8),d++);let m;if(f===0?m=s.available()/8|0:f<250?m=f:m=250*(f-249)+this.unrandomize255State(s.readBits(8),d++),m<0)throw new F;const w=new Uint8Array(m);for(let A=0;A<m;A++){if(s.available()<8)throw new F;w[A]=this.unrandomize255State(s.readBits(8),d++)}c.push(w);try{a.append(te.decode(w,ee.ISO88591))}catch(A){throw new rt("Platform does not support required encoding: "+A.message)}}static unrandomize255State(s,a){const c=149*a%255+1,d=s-c;return d>=0?d:d+256}}_a.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_a.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],_a.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],_a.TEXT_SHIFT2_SET_CHARS=_a.C40_SHIFT2_SET_CHARS,_a.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",String.fromCharCode(127)];class KN{constructor(){this.rsDecoder=new tn(Te.DATA_MATRIX_FIELD_256)}decode(s){const a=new AA(s),c=a.getVersion(),d=a.readCodewords(),f=vA.getDataBlocks(d,c);let m=0;for(let b of f)m+=b.getNumDataCodewords();const w=new Uint8Array(m),A=f.length;for(let b=0;b<A;b++){const T=f[b],M=T.getCodewords(),L=T.getNumDataCodewords();this.correctErrors(M,L);for(let V=0;V<L;V++)w[V*A+b]=M[V]}return _a.decode(w)}correctErrors(s,a){const c=new Int32Array(s);try{this.rsDecoder.decode(c,s.length-a)}catch{throw new C}for(let d=0;d<a;d++)s[d]=c[d]}}class gn{constructor(s){this.image=s,this.rectangleDetector=new Di(this.image)}detect(){const s=this.rectangleDetector.detect();let a=this.detectSolid1(s);if(a=this.detectSolid2(a),a[3]=this.correctTopRight(a),!a[3])throw new $;a=this.shiftToModuleCenter(a);const c=a[0],d=a[1],f=a[2],m=a[3];let w=this.transitionsBetween(c,m)+1,A=this.transitionsBetween(f,m)+1;(w&1)===1&&(w+=1),(A&1)===1&&(A+=1),4*w<7*A&&4*A<7*w&&(w=A=Math.max(w,A));let b=gn.sampleGrid(this.image,c,d,f,m,w,A);return new os(b,[c,d,f,m])}static shiftPoint(s,a,c){let d=(a.getX()-s.getX())/(c+1),f=(a.getY()-s.getY())/(c+1);return new Se(s.getX()+d,s.getY()+f)}static moveAway(s,a,c){let d=s.getX(),f=s.getY();return d<a?d-=1:d+=1,f<c?f-=1:f+=1,new Se(d,f)}detectSolid1(s){let a=s[0],c=s[1],d=s[3],f=s[2],m=this.transitionsBetween(a,c),w=this.transitionsBetween(c,d),A=this.transitionsBetween(d,f),b=this.transitionsBetween(f,a),T=m,M=[f,a,c,d];return T>w&&(T=w,M[0]=a,M[1]=c,M[2]=d,M[3]=f),T>A&&(T=A,M[0]=c,M[1]=d,M[2]=f,M[3]=a),T>b&&(M[0]=d,M[1]=f,M[2]=a,M[3]=c),M}detectSolid2(s){let a=s[0],c=s[1],d=s[2],f=s[3],m=this.transitionsBetween(a,f),w=gn.shiftPoint(c,d,(m+1)*4),A=gn.shiftPoint(d,c,(m+1)*4),b=this.transitionsBetween(w,a),T=this.transitionsBetween(A,f);return b<T?(s[0]=a,s[1]=c,s[2]=d,s[3]=f):(s[0]=c,s[1]=d,s[2]=f,s[3]=a),s}correctTopRight(s){let a=s[0],c=s[1],d=s[2],f=s[3],m=this.transitionsBetween(a,f),w=this.transitionsBetween(c,f),A=gn.shiftPoint(a,c,(w+1)*4),b=gn.shiftPoint(d,c,(m+1)*4);m=this.transitionsBetween(A,f),w=this.transitionsBetween(b,f);let T=new Se(f.getX()+(d.getX()-c.getX())/(m+1),f.getY()+(d.getY()-c.getY())/(m+1)),M=new Se(f.getX()+(a.getX()-c.getX())/(w+1),f.getY()+(a.getY()-c.getY())/(w+1));if(!this.isValid(T))return this.isValid(M)?M:null;if(!this.isValid(M))return T;let L=this.transitionsBetween(A,T)+this.transitionsBetween(b,T),V=this.transitionsBetween(A,M)+this.transitionsBetween(b,M);return L>V?T:M}shiftToModuleCenter(s){let a=s[0],c=s[1],d=s[2],f=s[3],m=this.transitionsBetween(a,f)+1,w=this.transitionsBetween(d,f)+1,A=gn.shiftPoint(a,c,w*4),b=gn.shiftPoint(d,c,m*4);m=this.transitionsBetween(A,f)+1,w=this.transitionsBetween(b,f)+1,(m&1)===1&&(m+=1),(w&1)===1&&(w+=1);let T=(a.getX()+c.getX()+d.getX()+f.getX())/4,M=(a.getY()+c.getY()+d.getY()+f.getY())/4;a=gn.moveAway(a,T,M),c=gn.moveAway(c,T,M),d=gn.moveAway(d,T,M),f=gn.moveAway(f,T,M);let L,V;return A=gn.shiftPoint(a,c,w*4),A=gn.shiftPoint(A,f,m*4),L=gn.shiftPoint(c,a,w*4),L=gn.shiftPoint(L,d,m*4),b=gn.shiftPoint(d,f,w*4),b=gn.shiftPoint(b,c,m*4),V=gn.shiftPoint(f,d,w*4),V=gn.shiftPoint(V,a,m*4),[A,L,b,V]}isValid(s){return s.getX()>=0&&s.getX()<this.image.getWidth()&&s.getY()>0&&s.getY()<this.image.getHeight()}static sampleGrid(s,a,c,d,f,m,w){return ke.getInstance().sampleGrid(s,m,w,.5,.5,m-.5,.5,m-.5,w-.5,.5,w-.5,a.getX(),a.getY(),f.getX(),f.getY(),d.getX(),d.getY(),c.getX(),c.getY())}transitionsBetween(s,a){let c=Math.trunc(s.getX()),d=Math.trunc(s.getY()),f=Math.trunc(a.getX()),m=Math.trunc(a.getY()),w=Math.abs(m-d)>Math.abs(f-c);if(w){let X=c;c=d,d=X,X=f,f=m,m=X}let A=Math.abs(f-c),b=Math.abs(m-d),T=-A/2,M=d<m?1:-1,L=c<f?1:-1,V=0,G=this.image.get(w?d:c,w?c:d);for(let X=c,K=d;X!==f;X+=L){let J=this.image.get(w?K:X,w?X:K);if(J!==G&&(V++,G=J),T+=b,T>0){if(K===m)break;K+=M,T-=A}}return V}}class Ta{constructor(){this.decoder=new KN}decode(s,a=null){let c,d;if(a!=null&&a.has(H.PURE_BARCODE)){const b=Ta.extractPureBits(s.getBlackMatrix());c=this.decoder.decode(b),d=Ta.NO_POINTS}else{const b=new gn(s.getBlackMatrix()).detect();c=this.decoder.decode(b.getBits()),d=b.getPoints()}const f=c.getRawBytes(),m=new Le(c.getText(),f,8*f.length,d,xe.DATA_MATRIX,I.currentTimeMillis()),w=c.getByteSegments();w!=null&&m.putMetadata(st.BYTE_SEGMENTS,w);const A=c.getECLevel();return A!=null&&m.putMetadata(st.ERROR_CORRECTION_LEVEL,A),m}reset(){}static extractPureBits(s){const a=s.getTopLeftOnBit(),c=s.getBottomRightOnBit();if(a==null||c==null)throw new $;const d=this.moduleSize(a,s);let f=a[1];const m=c[1];let w=a[0];const b=(c[0]-w+1)/d,T=(m-f+1)/d;if(b<=0||T<=0)throw new $;const M=d/2;f+=M,w+=M;const L=new ce(b,T);for(let V=0;V<T;V++){const G=f+V*d;for(let X=0;X<b;X++)s.get(w+X*d,G)&&L.set(X,V)}return L}static moduleSize(s,a){const c=a.getWidth();let d=s[0];const f=s[1];for(;d<c&&a.get(d,f);)d++;if(d===c)throw new $;const m=d-s[0];if(m===0)throw new $;return m}}Ta.NO_POINTS=[];class qN extends me{constructor(s=500){super(new Ta,s)}}var xh;(function(D){D[D.L=0]="L",D[D.M=1]="M",D[D.Q=2]="Q",D[D.H=3]="H"})(xh||(xh={}));class Nt{constructor(s,a,c){this.value=s,this.stringValue=a,this.bits=c,Nt.FOR_BITS.set(c,this),Nt.FOR_VALUE.set(s,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(s){switch(s){case"L":return Nt.L;case"M":return Nt.M;case"Q":return Nt.Q;case"H":return Nt.H;default:throw new x(s+"not available")}}toString(){return this.stringValue}equals(s){if(!(s instanceof Nt))return!1;const a=s;return this.value===a.value}static forBits(s){if(s<0||s>=Nt.FOR_BITS.size)throw new y;return Nt.FOR_BITS.get(s)}}Nt.FOR_BITS=new Map,Nt.FOR_VALUE=new Map,Nt.L=new Nt(xh.L,"L",1),Nt.M=new Nt(xh.M,"M",0),Nt.Q=new Nt(xh.Q,"Q",3),Nt.H=new Nt(xh.H,"H",2);class ai{constructor(s){this.errorCorrectionLevel=Nt.forBits(s>>3&3),this.dataMask=s&7}static numBitsDiffering(s,a){return k.bitCount(s^a)}static decodeFormatInformation(s,a){const c=ai.doDecodeFormatInformation(s,a);return c!==null?c:ai.doDecodeFormatInformation(s^ai.FORMAT_INFO_MASK_QR,a^ai.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(s,a){let c=Number.MAX_SAFE_INTEGER,d=0;for(const f of ai.FORMAT_INFO_DECODE_LOOKUP){const m=f[0];if(m===s||m===a)return new ai(f[1]);let w=ai.numBitsDiffering(s,m);w<c&&(d=f[1],c=w),s!==a&&(w=ai.numBitsDiffering(a,m),w<c&&(d=f[1],c=w))}return c<=3?new ai(d):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(s){if(!(s instanceof ai))return!1;const a=s;return this.errorCorrectionLevel===a.errorCorrectionLevel&&this.dataMask===a.dataMask}}ai.FORMAT_INFO_MASK_QR=21522,ai.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class q{constructor(s,...a){this.ecCodewordsPerBlock=s,this.ecBlocks=a}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let s=0;const a=this.ecBlocks;for(const c of a)s+=c.getCount();return s}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class j{constructor(s,a){this.count=s,this.dataCodewords=a}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Ne{constructor(s,a,...c){this.versionNumber=s,this.alignmentPatternCenters=a,this.ecBlocks=c;let d=0;const f=c[0].getECCodewordsPerBlock(),m=c[0].getECBlocks();for(const w of m)d+=w.getCount()*(w.getDataCodewords()+f);this.totalCodewords=d}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(s){return this.ecBlocks[s.getValue()]}static getProvisionalVersionForDimension(s){if(s%4!==1)throw new F;try{return this.getVersionForNumber((s-17)/4)}catch{throw new F}}static getVersionForNumber(s){if(s<1||s>40)throw new y;return Ne.VERSIONS[s-1]}static decodeVersionInformation(s){let a=Number.MAX_SAFE_INTEGER,c=0;for(let d=0;d<Ne.VERSION_DECODE_INFO.length;d++){const f=Ne.VERSION_DECODE_INFO[d];if(f===s)return Ne.getVersionForNumber(d+7);const m=ai.numBitsDiffering(s,f);m<a&&(c=d+7,a=m)}return a<=3?Ne.getVersionForNumber(c):null}buildFunctionPattern(){const s=this.getDimensionForVersion(),a=new ce(s);a.setRegion(0,0,9,9),a.setRegion(s-8,0,8,9),a.setRegion(0,s-8,9,8);const c=this.alignmentPatternCenters.length;for(let d=0;d<c;d++){const f=this.alignmentPatternCenters[d]-2;for(let m=0;m<c;m++)d===0&&(m===0||m===c-1)||d===c-1&&m===0||a.setRegion(this.alignmentPatternCenters[m]-2,f,5,5)}return a.setRegion(6,9,1,s-17),a.setRegion(9,6,s-17,1),this.versionNumber>6&&(a.setRegion(s-11,0,3,6),a.setRegion(0,s-11,6,3)),a}toString(){return""+this.versionNumber}}Ne.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Ne.VERSIONS=[new Ne(1,new Int32Array(0),new q(7,new j(1,19)),new q(10,new j(1,16)),new q(13,new j(1,13)),new q(17,new j(1,9))),new Ne(2,Int32Array.from([6,18]),new q(10,new j(1,34)),new q(16,new j(1,28)),new q(22,new j(1,22)),new q(28,new j(1,16))),new Ne(3,Int32Array.from([6,22]),new q(15,new j(1,55)),new q(26,new j(1,44)),new q(18,new j(2,17)),new q(22,new j(2,13))),new Ne(4,Int32Array.from([6,26]),new q(20,new j(1,80)),new q(18,new j(2,32)),new q(26,new j(2,24)),new q(16,new j(4,9))),new Ne(5,Int32Array.from([6,30]),new q(26,new j(1,108)),new q(24,new j(2,43)),new q(18,new j(2,15),new j(2,16)),new q(22,new j(2,11),new j(2,12))),new Ne(6,Int32Array.from([6,34]),new q(18,new j(2,68)),new q(16,new j(4,27)),new q(24,new j(4,19)),new q(28,new j(4,15))),new Ne(7,Int32Array.from([6,22,38]),new q(20,new j(2,78)),new q(18,new j(4,31)),new q(18,new j(2,14),new j(4,15)),new q(26,new j(4,13),new j(1,14))),new Ne(8,Int32Array.from([6,24,42]),new q(24,new j(2,97)),new q(22,new j(2,38),new j(2,39)),new q(22,new j(4,18),new j(2,19)),new q(26,new j(4,14),new j(2,15))),new Ne(9,Int32Array.from([6,26,46]),new q(30,new j(2,116)),new q(22,new j(3,36),new j(2,37)),new q(20,new j(4,16),new j(4,17)),new q(24,new j(4,12),new j(4,13))),new Ne(10,Int32Array.from([6,28,50]),new q(18,new j(2,68),new j(2,69)),new q(26,new j(4,43),new j(1,44)),new q(24,new j(6,19),new j(2,20)),new q(28,new j(6,15),new j(2,16))),new Ne(11,Int32Array.from([6,30,54]),new q(20,new j(4,81)),new q(30,new j(1,50),new j(4,51)),new q(28,new j(4,22),new j(4,23)),new q(24,new j(3,12),new j(8,13))),new Ne(12,Int32Array.from([6,32,58]),new q(24,new j(2,92),new j(2,93)),new q(22,new j(6,36),new j(2,37)),new q(26,new j(4,20),new j(6,21)),new q(28,new j(7,14),new j(4,15))),new Ne(13,Int32Array.from([6,34,62]),new q(26,new j(4,107)),new q(22,new j(8,37),new j(1,38)),new q(24,new j(8,20),new j(4,21)),new q(22,new j(12,11),new j(4,12))),new Ne(14,Int32Array.from([6,26,46,66]),new q(30,new j(3,115),new j(1,116)),new q(24,new j(4,40),new j(5,41)),new q(20,new j(11,16),new j(5,17)),new q(24,new j(11,12),new j(5,13))),new Ne(15,Int32Array.from([6,26,48,70]),new q(22,new j(5,87),new j(1,88)),new q(24,new j(5,41),new j(5,42)),new q(30,new j(5,24),new j(7,25)),new q(24,new j(11,12),new j(7,13))),new Ne(16,Int32Array.from([6,26,50,74]),new q(24,new j(5,98),new j(1,99)),new q(28,new j(7,45),new j(3,46)),new q(24,new j(15,19),new j(2,20)),new q(30,new j(3,15),new j(13,16))),new Ne(17,Int32Array.from([6,30,54,78]),new q(28,new j(1,107),new j(5,108)),new q(28,new j(10,46),new j(1,47)),new q(28,new j(1,22),new j(15,23)),new q(28,new j(2,14),new j(17,15))),new Ne(18,Int32Array.from([6,30,56,82]),new q(30,new j(5,120),new j(1,121)),new q(26,new j(9,43),new j(4,44)),new q(28,new j(17,22),new j(1,23)),new q(28,new j(2,14),new j(19,15))),new Ne(19,Int32Array.from([6,30,58,86]),new q(28,new j(3,113),new j(4,114)),new q(26,new j(3,44),new j(11,45)),new q(26,new j(17,21),new j(4,22)),new q(26,new j(9,13),new j(16,14))),new Ne(20,Int32Array.from([6,34,62,90]),new q(28,new j(3,107),new j(5,108)),new q(26,new j(3,41),new j(13,42)),new q(30,new j(15,24),new j(5,25)),new q(28,new j(15,15),new j(10,16))),new Ne(21,Int32Array.from([6,28,50,72,94]),new q(28,new j(4,116),new j(4,117)),new q(26,new j(17,42)),new q(28,new j(17,22),new j(6,23)),new q(30,new j(19,16),new j(6,17))),new Ne(22,Int32Array.from([6,26,50,74,98]),new q(28,new j(2,111),new j(7,112)),new q(28,new j(17,46)),new q(30,new j(7,24),new j(16,25)),new q(24,new j(34,13))),new Ne(23,Int32Array.from([6,30,54,78,102]),new q(30,new j(4,121),new j(5,122)),new q(28,new j(4,47),new j(14,48)),new q(30,new j(11,24),new j(14,25)),new q(30,new j(16,15),new j(14,16))),new Ne(24,Int32Array.from([6,28,54,80,106]),new q(30,new j(6,117),new j(4,118)),new q(28,new j(6,45),new j(14,46)),new q(30,new j(11,24),new j(16,25)),new q(30,new j(30,16),new j(2,17))),new Ne(25,Int32Array.from([6,32,58,84,110]),new q(26,new j(8,106),new j(4,107)),new q(28,new j(8,47),new j(13,48)),new q(30,new j(7,24),new j(22,25)),new q(30,new j(22,15),new j(13,16))),new Ne(26,Int32Array.from([6,30,58,86,114]),new q(28,new j(10,114),new j(2,115)),new q(28,new j(19,46),new j(4,47)),new q(28,new j(28,22),new j(6,23)),new q(30,new j(33,16),new j(4,17))),new Ne(27,Int32Array.from([6,34,62,90,118]),new q(30,new j(8,122),new j(4,123)),new q(28,new j(22,45),new j(3,46)),new q(30,new j(8,23),new j(26,24)),new q(30,new j(12,15),new j(28,16))),new Ne(28,Int32Array.from([6,26,50,74,98,122]),new q(30,new j(3,117),new j(10,118)),new q(28,new j(3,45),new j(23,46)),new q(30,new j(4,24),new j(31,25)),new q(30,new j(11,15),new j(31,16))),new Ne(29,Int32Array.from([6,30,54,78,102,126]),new q(30,new j(7,116),new j(7,117)),new q(28,new j(21,45),new j(7,46)),new q(30,new j(1,23),new j(37,24)),new q(30,new j(19,15),new j(26,16))),new Ne(30,Int32Array.from([6,26,52,78,104,130]),new q(30,new j(5,115),new j(10,116)),new q(28,new j(19,47),new j(10,48)),new q(30,new j(15,24),new j(25,25)),new q(30,new j(23,15),new j(25,16))),new Ne(31,Int32Array.from([6,30,56,82,108,134]),new q(30,new j(13,115),new j(3,116)),new q(28,new j(2,46),new j(29,47)),new q(30,new j(42,24),new j(1,25)),new q(30,new j(23,15),new j(28,16))),new Ne(32,Int32Array.from([6,34,60,86,112,138]),new q(30,new j(17,115)),new q(28,new j(10,46),new j(23,47)),new q(30,new j(10,24),new j(35,25)),new q(30,new j(19,15),new j(35,16))),new Ne(33,Int32Array.from([6,30,58,86,114,142]),new q(30,new j(17,115),new j(1,116)),new q(28,new j(14,46),new j(21,47)),new q(30,new j(29,24),new j(19,25)),new q(30,new j(11,15),new j(46,16))),new Ne(34,Int32Array.from([6,34,62,90,118,146]),new q(30,new j(13,115),new j(6,116)),new q(28,new j(14,46),new j(23,47)),new q(30,new j(44,24),new j(7,25)),new q(30,new j(59,16),new j(1,17))),new Ne(35,Int32Array.from([6,30,54,78,102,126,150]),new q(30,new j(12,121),new j(7,122)),new q(28,new j(12,47),new j(26,48)),new q(30,new j(39,24),new j(14,25)),new q(30,new j(22,15),new j(41,16))),new Ne(36,Int32Array.from([6,24,50,76,102,128,154]),new q(30,new j(6,121),new j(14,122)),new q(28,new j(6,47),new j(34,48)),new q(30,new j(46,24),new j(10,25)),new q(30,new j(2,15),new j(64,16))),new Ne(37,Int32Array.from([6,28,54,80,106,132,158]),new q(30,new j(17,122),new j(4,123)),new q(28,new j(29,46),new j(14,47)),new q(30,new j(49,24),new j(10,25)),new q(30,new j(24,15),new j(46,16))),new Ne(38,Int32Array.from([6,32,58,84,110,136,162]),new q(30,new j(4,122),new j(18,123)),new q(28,new j(13,46),new j(32,47)),new q(30,new j(48,24),new j(14,25)),new q(30,new j(42,15),new j(32,16))),new Ne(39,Int32Array.from([6,26,54,82,110,138,166]),new q(30,new j(20,117),new j(4,118)),new q(28,new j(40,47),new j(7,48)),new q(30,new j(43,24),new j(22,25)),new q(30,new j(10,15),new j(67,16))),new Ne(40,Int32Array.from([6,30,58,86,114,142,170]),new q(30,new j(19,118),new j(6,119)),new q(28,new j(18,47),new j(31,48)),new q(30,new j(34,24),new j(34,25)),new q(30,new j(20,15),new j(61,16)))];var Dn;(function(D){D[D.DATA_MASK_000=0]="DATA_MASK_000",D[D.DATA_MASK_001=1]="DATA_MASK_001",D[D.DATA_MASK_010=2]="DATA_MASK_010",D[D.DATA_MASK_011=3]="DATA_MASK_011",D[D.DATA_MASK_100=4]="DATA_MASK_100",D[D.DATA_MASK_101=5]="DATA_MASK_101",D[D.DATA_MASK_110=6]="DATA_MASK_110",D[D.DATA_MASK_111=7]="DATA_MASK_111"})(Dn||(Dn={}));class Or{constructor(s,a){this.value=s,this.isMasked=a}unmaskBitMatrix(s,a){for(let c=0;c<a;c++)for(let d=0;d<a;d++)this.isMasked(c,d)&&s.flip(d,c)}}Or.values=new Map([[Dn.DATA_MASK_000,new Or(Dn.DATA_MASK_000,(D,s)=>(D+s&1)===0)],[Dn.DATA_MASK_001,new Or(Dn.DATA_MASK_001,(D,s)=>(D&1)===0)],[Dn.DATA_MASK_010,new Or(Dn.DATA_MASK_010,(D,s)=>s%3===0)],[Dn.DATA_MASK_011,new Or(Dn.DATA_MASK_011,(D,s)=>(D+s)%3===0)],[Dn.DATA_MASK_100,new Or(Dn.DATA_MASK_100,(D,s)=>(Math.floor(D/2)+Math.floor(s/3)&1)===0)],[Dn.DATA_MASK_101,new Or(Dn.DATA_MASK_101,(D,s)=>D*s%6===0)],[Dn.DATA_MASK_110,new Or(Dn.DATA_MASK_110,(D,s)=>D*s%6<3)],[Dn.DATA_MASK_111,new Or(Dn.DATA_MASK_111,(D,s)=>(D+s+D*s%3&1)===0)]]);class ZN{constructor(s){const a=s.getHeight();if(a<21||(a&3)!==1)throw new F;this.bitMatrix=s}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let s=0;for(let f=0;f<6;f++)s=this.copyBit(f,8,s);s=this.copyBit(7,8,s),s=this.copyBit(8,8,s),s=this.copyBit(8,7,s);for(let f=5;f>=0;f--)s=this.copyBit(8,f,s);const a=this.bitMatrix.getHeight();let c=0;const d=a-7;for(let f=a-1;f>=d;f--)c=this.copyBit(8,f,c);for(let f=a-8;f<a;f++)c=this.copyBit(f,8,c);if(this.parsedFormatInfo=ai.decodeFormatInformation(s,c),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new F}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const s=this.bitMatrix.getHeight(),a=Math.floor((s-17)/4);if(a<=6)return Ne.getVersionForNumber(a);let c=0;const d=s-11;for(let m=5;m>=0;m--)for(let w=s-9;w>=d;w--)c=this.copyBit(w,m,c);let f=Ne.decodeVersionInformation(c);if(f!==null&&f.getDimensionForVersion()===s)return this.parsedVersion=f,f;c=0;for(let m=5;m>=0;m--)for(let w=s-9;w>=d;w--)c=this.copyBit(m,w,c);if(f=Ne.decodeVersionInformation(c),f!==null&&f.getDimensionForVersion()===s)return this.parsedVersion=f,f;throw new F}copyBit(s,a,c){return(this.isMirror?this.bitMatrix.get(a,s):this.bitMatrix.get(s,a))?c<<1|1:c<<1}readCodewords(){const s=this.readFormatInformation(),a=this.readVersion(),c=Or.values.get(s.getDataMask()),d=this.bitMatrix.getHeight();c.unmaskBitMatrix(this.bitMatrix,d);const f=a.buildFunctionPattern();let m=!0;const w=new Uint8Array(a.getTotalCodewords());let A=0,b=0,T=0;for(let M=d-1;M>0;M-=2){M===6&&M--;for(let L=0;L<d;L++){const V=m?d-1-L:L;for(let G=0;G<2;G++)f.get(M-G,V)||(T++,b<<=1,this.bitMatrix.get(M-G,V)&&(b|=1),T===8&&(w[A++]=b,T=0,b=0))}m=!m}if(A!==a.getTotalCodewords())throw new F;return w}remask(){if(this.parsedFormatInfo===null)return;const s=Or.values[this.parsedFormatInfo.getDataMask()],a=this.bitMatrix.getHeight();s.unmaskBitMatrix(this.bitMatrix,a)}setMirror(s){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=s}mirror(){const s=this.bitMatrix;for(let a=0,c=s.getWidth();a<c;a++)for(let d=a+1,f=s.getHeight();d<f;d++)s.get(a,d)!==s.get(d,a)&&(s.flip(d,a),s.flip(a,d))}}class EA{constructor(s,a){this.numDataCodewords=s,this.codewords=a}static getDataBlocks(s,a,c){if(s.length!==a.getTotalCodewords())throw new y;const d=a.getECBlocksForLevel(c);let f=0;const m=d.getECBlocks();for(const G of m)f+=G.getCount();const w=new Array(f);let A=0;for(const G of m)for(let X=0;X<G.getCount();X++){const K=G.getDataCodewords(),J=d.getECCodewordsPerBlock()+K;w[A++]=new EA(K,new Uint8Array(J))}const b=w[0].codewords.length;let T=w.length-1;for(;T>=0&&w[T].codewords.length!==b;)T--;T++;const M=b-d.getECCodewordsPerBlock();let L=0;for(let G=0;G<M;G++)for(let X=0;X<A;X++)w[X].codewords[G]=s[L++];for(let G=T;G<A;G++)w[G].codewords[M]=s[L++];const V=w[0].codewords.length;for(let G=M;G<V;G++)for(let X=0;X<A;X++){const K=X<T?G:G+1;w[X].codewords[K]=s[L++]}return w}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Lr;(function(D){D[D.TERMINATOR=0]="TERMINATOR",D[D.NUMERIC=1]="NUMERIC",D[D.ALPHANUMERIC=2]="ALPHANUMERIC",D[D.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",D[D.BYTE=4]="BYTE",D[D.ECI=5]="ECI",D[D.KANJI=6]="KANJI",D[D.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",D[D.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",D[D.HANZI=9]="HANZI"})(Lr||(Lr={}));class Re{constructor(s,a,c,d){this.value=s,this.stringValue=a,this.characterCountBitsForVersions=c,this.bits=d,Re.FOR_BITS.set(d,this),Re.FOR_VALUE.set(s,this)}static forBits(s){const a=Re.FOR_BITS.get(s);if(a===void 0)throw new y;return a}getCharacterCountBits(s){const a=s.getVersionNumber();let c;return a<=9?c=0:a<=26?c=1:c=2,this.characterCountBitsForVersions[c]}getValue(){return this.value}getBits(){return this.bits}equals(s){if(!(s instanceof Re))return!1;const a=s;return this.value===a.value}toString(){return this.stringValue}}Re.FOR_BITS=new Map,Re.FOR_VALUE=new Map,Re.TERMINATOR=new Re(Lr.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Re.NUMERIC=new Re(Lr.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Re.ALPHANUMERIC=new Re(Lr.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Re.STRUCTURED_APPEND=new Re(Lr.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Re.BYTE=new Re(Lr.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Re.ECI=new Re(Lr.ECI,"ECI",Int32Array.from([0,0,0]),7),Re.KANJI=new Re(Lr.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Re.FNC1_FIRST_POSITION=new Re(Lr.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Re.FNC1_SECOND_POSITION=new Re(Lr.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Re.HANZI=new Re(Lr.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Yt{static decode(s,a,c,d){const f=new bA(s);let m=new le;const w=new Array;let A=-1,b=-1;try{let T=null,M=!1,L;do{if(f.available()<4)L=Re.TERMINATOR;else{const V=f.readBits(4);L=Re.forBits(V)}switch(L){case Re.TERMINATOR:break;case Re.FNC1_FIRST_POSITION:case Re.FNC1_SECOND_POSITION:M=!0;break;case Re.STRUCTURED_APPEND:if(f.available()<16)throw new F;A=f.readBits(8),b=f.readBits(8);break;case Re.ECI:const V=Yt.parseECIValue(f);if(T=W.getCharacterSetECIByValue(V),T===null)throw new F;break;case Re.HANZI:const G=f.readBits(4),X=f.readBits(L.getCharacterCountBits(a));G===Yt.GB2312_SUBSET&&Yt.decodeHanziSegment(f,m,X);break;default:const K=f.readBits(L.getCharacterCountBits(a));switch(L){case Re.NUMERIC:Yt.decodeNumericSegment(f,m,K);break;case Re.ALPHANUMERIC:Yt.decodeAlphanumericSegment(f,m,K,M);break;case Re.BYTE:Yt.decodeByteSegment(f,m,K,T,w,d);break;case Re.KANJI:Yt.decodeKanjiSegment(f,m,K);break;default:throw new F}break}}while(L!==Re.TERMINATOR)}catch{throw new F}return new yn(s,m.toString(),w.length===0?null:w,c===null?null:c.toString(),A,b)}static decodeHanziSegment(s,a,c){if(c*13>s.available())throw new F;const d=new Uint8Array(2*c);let f=0;for(;c>0;){const m=s.readBits(13);let w=m/96<<8&4294967295|m%96;w<959?w+=41377:w+=42657,d[f]=w>>8&255,d[f+1]=w&255,f+=2,c--}try{a.append(te.decode(d,ee.GB2312))}catch(m){throw new F(m)}}static decodeKanjiSegment(s,a,c){if(c*13>s.available())throw new F;const d=new Uint8Array(2*c);let f=0;for(;c>0;){const m=s.readBits(13);let w=m/192<<8&4294967295|m%192;w<7936?w+=33088:w+=49472,d[f]=w>>8,d[f+1]=w,f+=2,c--}try{a.append(te.decode(d,ee.SHIFT_JIS))}catch(m){throw new F(m)}}static decodeByteSegment(s,a,c,d,f,m){if(8*c>s.available())throw new F;const w=new Uint8Array(c);for(let b=0;b<c;b++)w[b]=s.readBits(8);let A;d===null?A=ee.guessEncoding(w,m):A=d.getName();try{a.append(te.decode(w,A))}catch(b){throw new F(b)}f.push(w)}static toAlphaNumericChar(s){if(s>=Yt.ALPHANUMERIC_CHARS.length)throw new F;return Yt.ALPHANUMERIC_CHARS[s]}static decodeAlphanumericSegment(s,a,c,d){const f=a.length();for(;c>1;){if(s.available()<11)throw new F;const m=s.readBits(11);a.append(Yt.toAlphaNumericChar(Math.floor(m/45))),a.append(Yt.toAlphaNumericChar(m%45)),c-=2}if(c===1){if(s.available()<6)throw new F;a.append(Yt.toAlphaNumericChar(s.readBits(6)))}if(d)for(let m=f;m<a.length();m++)a.charAt(m)==="%"&&(m<a.length()-1&&a.charAt(m+1)==="%"?a.deleteCharAt(m+1):a.setCharAt(m,String.fromCharCode(29)))}static decodeNumericSegment(s,a,c){for(;c>=3;){if(s.available()<10)throw new F;const d=s.readBits(10);if(d>=1e3)throw new F;a.append(Yt.toAlphaNumericChar(Math.floor(d/100))),a.append(Yt.toAlphaNumericChar(Math.floor(d/10)%10)),a.append(Yt.toAlphaNumericChar(d%10)),c-=3}if(c===2){if(s.available()<7)throw new F;const d=s.readBits(7);if(d>=100)throw new F;a.append(Yt.toAlphaNumericChar(Math.floor(d/10))),a.append(Yt.toAlphaNumericChar(d%10))}else if(c===1){if(s.available()<4)throw new F;const d=s.readBits(4);if(d>=10)throw new F;a.append(Yt.toAlphaNumericChar(d))}}static parseECIValue(s){const a=s.readBits(8);if(!(a&128))return a&127;if((a&192)===128){const c=s.readBits(8);return(a&63)<<8&4294967295|c}if((a&224)===192){const c=s.readBits(16);return(a&31)<<16&4294967295|c}throw new F}}Yt.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Yt.GB2312_SUBSET=1;class mS{constructor(s){this.mirrored=s}isMirrored(){return this.mirrored}applyMirroredCorrection(s){if(!this.mirrored||s===null||s.length<3)return;const a=s[0];s[0]=s[2],s[2]=a}}class QN{constructor(){this.rsDecoder=new tn(Te.QR_CODE_FIELD_256)}decodeBooleanArray(s,a){return this.decodeBitMatrix(ce.parseFromBooleanArray(s),a)}decodeBitMatrix(s,a){const c=new ZN(s);let d=null;try{return this.decodeBitMatrixParser(c,a)}catch(f){d=f}try{c.remask(),c.setMirror(!0),c.readVersion(),c.readFormatInformation(),c.mirror();const f=this.decodeBitMatrixParser(c,a);return f.setOther(new mS(!0)),f}catch(f){throw d!==null?d:f}}decodeBitMatrixParser(s,a){const c=s.readVersion(),d=s.readFormatInformation().getErrorCorrectionLevel(),f=s.readCodewords(),m=EA.getDataBlocks(f,c,d);let w=0;for(const T of m)w+=T.getNumDataCodewords();const A=new Uint8Array(w);let b=0;for(const T of m){const M=T.getCodewords(),L=T.getNumDataCodewords();this.correctErrors(M,L);for(let V=0;V<L;V++)A[b++]=M[V]}return Yt.decode(A,c,d,a)}correctErrors(s,a){const c=new Int32Array(s);try{this.rsDecoder.decode(c,s.length-a)}catch{throw new C}for(let d=0;d<a;d++)s[d]=c[d]}}class CA extends Se{constructor(s,a,c){super(s,a),this.estimatedModuleSize=c}aboutEquals(s,a,c){if(Math.abs(a-this.getY())<=s&&Math.abs(c-this.getX())<=s){const d=Math.abs(s-this.estimatedModuleSize);return d<=1||d<=this.estimatedModuleSize}return!1}combineEstimate(s,a,c){const d=(this.getX()+a)/2,f=(this.getY()+s)/2,m=(this.estimatedModuleSize+c)/2;return new CA(d,f,m)}}class Hm{constructor(s,a,c,d,f,m,w){this.image=s,this.startX=a,this.startY=c,this.width=d,this.height=f,this.moduleSize=m,this.resultPointCallback=w,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const s=this.startX,a=this.height,c=this.width,d=s+c,f=this.startY+a/2,m=new Int32Array(3),w=this.image;for(let A=0;A<a;A++){const b=f+(A&1?-Math.floor((A+1)/2):Math.floor((A+1)/2));m[0]=0,m[1]=0,m[2]=0;let T=s;for(;T<d&&!w.get(T,b);)T++;let M=0;for(;T<d;){if(w.get(T,b))if(M===1)m[1]++;else if(M===2){if(this.foundPatternCross(m)){const L=this.handlePossibleCenter(m,b,T);if(L!==null)return L}m[0]=m[2],m[1]=1,m[2]=0,M=1}else m[++M]++;else M===1&&M++,m[M]++;T++}if(this.foundPatternCross(m)){const L=this.handlePossibleCenter(m,b,d);if(L!==null)return L}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new $}static centerFromEnd(s,a){return a-s[2]-s[1]/2}foundPatternCross(s){const a=this.moduleSize,c=a/2;for(let d=0;d<3;d++)if(Math.abs(a-s[d])>=c)return!1;return!0}crossCheckVertical(s,a,c,d){const f=this.image,m=f.getHeight(),w=this.crossCheckStateCount;w[0]=0,w[1]=0,w[2]=0;let A=s;for(;A>=0&&f.get(a,A)&&w[1]<=c;)w[1]++,A--;if(A<0||w[1]>c)return NaN;for(;A>=0&&!f.get(a,A)&&w[0]<=c;)w[0]++,A--;if(w[0]>c)return NaN;for(A=s+1;A<m&&f.get(a,A)&&w[1]<=c;)w[1]++,A++;if(A===m||w[1]>c)return NaN;for(;A<m&&!f.get(a,A)&&w[2]<=c;)w[2]++,A++;if(w[2]>c)return NaN;const b=w[0]+w[1]+w[2];return 5*Math.abs(b-d)>=2*d?NaN:this.foundPatternCross(w)?Hm.centerFromEnd(w,A):NaN}handlePossibleCenter(s,a,c){const d=s[0]+s[1]+s[2],f=Hm.centerFromEnd(s,c),m=this.crossCheckVertical(a,f,2*s[1],d);if(!isNaN(m)){const w=(s[0]+s[1]+s[2])/3;for(const b of this.possibleCenters)if(b.aboutEquals(w,m,f))return b.combineEstimate(m,f,w);const A=new CA(f,m,w);this.possibleCenters.push(A),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(A)}return null}}class SA extends Se{constructor(s,a,c,d){super(s,a),this.estimatedModuleSize=c,this.count=d,d===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(s,a,c){if(Math.abs(a-this.getY())<=s&&Math.abs(c-this.getX())<=s){const d=Math.abs(s-this.estimatedModuleSize);return d<=1||d<=this.estimatedModuleSize}return!1}combineEstimate(s,a,c){const d=this.count+1,f=(this.count*this.getX()+a)/d,m=(this.count*this.getY()+s)/d,w=(this.count*this.estimatedModuleSize+c)/d;return new SA(f,m,w,d)}}class JN{constructor(s){this.bottomLeft=s[0],this.topLeft=s[1],this.topRight=s[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Mn{constructor(s,a){this.image=s,this.resultPointCallback=a,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=a}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(s){const a=s!=null&&s.get(H.TRY_HARDER)!==void 0,c=s!=null&&s.get(H.PURE_BARCODE)!==void 0,d=this.image,f=d.getHeight(),m=d.getWidth();let w=Math.floor(3*f/(4*Mn.MAX_MODULES));(w<Mn.MIN_SKIP||a)&&(w=Mn.MIN_SKIP);let A=!1;const b=new Int32Array(5);for(let M=w-1;M<f&&!A;M+=w){b[0]=0,b[1]=0,b[2]=0,b[3]=0,b[4]=0;let L=0;for(let V=0;V<m;V++)if(d.get(V,M))(L&1)===1&&L++,b[L]++;else if(L&1)b[L]++;else if(L===4)if(Mn.foundPatternCross(b)){if(this.handlePossibleCenter(b,M,V,c)===!0)if(w=2,this.hasSkipped===!0)A=this.haveMultiplyConfirmedCenters();else{const X=this.findRowSkip();X>b[2]&&(M+=X-b[2]-w,V=m-1)}else{b[0]=b[2],b[1]=b[3],b[2]=b[4],b[3]=1,b[4]=0,L=3;continue}L=0,b[0]=0,b[1]=0,b[2]=0,b[3]=0,b[4]=0}else b[0]=b[2],b[1]=b[3],b[2]=b[4],b[3]=1,b[4]=0,L=3;else b[++L]++;Mn.foundPatternCross(b)&&this.handlePossibleCenter(b,M,m,c)===!0&&(w=b[0],this.hasSkipped&&(A=this.haveMultiplyConfirmedCenters()))}const T=this.selectBestPatterns();return Se.orderBestPatterns(T),new JN(T)}static centerFromEnd(s,a){return a-s[4]-s[3]-s[2]/2}static foundPatternCross(s){let a=0;for(let f=0;f<5;f++){const m=s[f];if(m===0)return!1;a+=m}if(a<7)return!1;const c=a/7,d=c/2;return Math.abs(c-s[0])<d&&Math.abs(c-s[1])<d&&Math.abs(3*c-s[2])<3*d&&Math.abs(c-s[3])<d&&Math.abs(c-s[4])<d}getCrossCheckStateCount(){const s=this.crossCheckStateCount;return s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s}crossCheckDiagonal(s,a,c,d){const f=this.getCrossCheckStateCount();let m=0;const w=this.image;for(;s>=m&&a>=m&&w.get(a-m,s-m);)f[2]++,m++;if(s<m||a<m)return!1;for(;s>=m&&a>=m&&!w.get(a-m,s-m)&&f[1]<=c;)f[1]++,m++;if(s<m||a<m||f[1]>c)return!1;for(;s>=m&&a>=m&&w.get(a-m,s-m)&&f[0]<=c;)f[0]++,m++;if(f[0]>c)return!1;const A=w.getHeight(),b=w.getWidth();for(m=1;s+m<A&&a+m<b&&w.get(a+m,s+m);)f[2]++,m++;if(s+m>=A||a+m>=b)return!1;for(;s+m<A&&a+m<b&&!w.get(a+m,s+m)&&f[3]<c;)f[3]++,m++;if(s+m>=A||a+m>=b||f[3]>=c)return!1;for(;s+m<A&&a+m<b&&w.get(a+m,s+m)&&f[4]<c;)f[4]++,m++;if(f[4]>=c)return!1;const T=f[0]+f[1]+f[2]+f[3]+f[4];return Math.abs(T-d)<2*d&&Mn.foundPatternCross(f)}crossCheckVertical(s,a,c,d){const f=this.image,m=f.getHeight(),w=this.getCrossCheckStateCount();let A=s;for(;A>=0&&f.get(a,A);)w[2]++,A--;if(A<0)return NaN;for(;A>=0&&!f.get(a,A)&&w[1]<=c;)w[1]++,A--;if(A<0||w[1]>c)return NaN;for(;A>=0&&f.get(a,A)&&w[0]<=c;)w[0]++,A--;if(w[0]>c)return NaN;for(A=s+1;A<m&&f.get(a,A);)w[2]++,A++;if(A===m)return NaN;for(;A<m&&!f.get(a,A)&&w[3]<c;)w[3]++,A++;if(A===m||w[3]>=c)return NaN;for(;A<m&&f.get(a,A)&&w[4]<c;)w[4]++,A++;if(w[4]>=c)return NaN;const b=w[0]+w[1]+w[2]+w[3]+w[4];return 5*Math.abs(b-d)>=2*d?NaN:Mn.foundPatternCross(w)?Mn.centerFromEnd(w,A):NaN}crossCheckHorizontal(s,a,c,d){const f=this.image,m=f.getWidth(),w=this.getCrossCheckStateCount();let A=s;for(;A>=0&&f.get(A,a);)w[2]++,A--;if(A<0)return NaN;for(;A>=0&&!f.get(A,a)&&w[1]<=c;)w[1]++,A--;if(A<0||w[1]>c)return NaN;for(;A>=0&&f.get(A,a)&&w[0]<=c;)w[0]++,A--;if(w[0]>c)return NaN;for(A=s+1;A<m&&f.get(A,a);)w[2]++,A++;if(A===m)return NaN;for(;A<m&&!f.get(A,a)&&w[3]<c;)w[3]++,A++;if(A===m||w[3]>=c)return NaN;for(;A<m&&f.get(A,a)&&w[4]<c;)w[4]++,A++;if(w[4]>=c)return NaN;const b=w[0]+w[1]+w[2]+w[3]+w[4];return 5*Math.abs(b-d)>=d?NaN:Mn.foundPatternCross(w)?Mn.centerFromEnd(w,A):NaN}handlePossibleCenter(s,a,c,d){const f=s[0]+s[1]+s[2]+s[3]+s[4];let m=Mn.centerFromEnd(s,c),w=this.crossCheckVertical(a,Math.floor(m),s[2],f);if(!isNaN(w)&&(m=this.crossCheckHorizontal(Math.floor(m),Math.floor(w),s[2],f),!isNaN(m)&&(!d||this.crossCheckDiagonal(Math.floor(w),Math.floor(m),s[2],f)))){const A=f/7;let b=!1;const T=this.possibleCenters;for(let M=0,L=T.length;M<L;M++){const V=T[M];if(V.aboutEquals(A,w,m)){T[M]=V.combineEstimate(w,m,A),b=!0;break}}if(!b){const M=new SA(m,w,A);T.push(M),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(M)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let a=null;for(const c of this.possibleCenters)if(c.getCount()>=Mn.CENTER_QUORUM)if(a==null)a=c;else return this.hasSkipped=!0,Math.floor((Math.abs(a.getX()-c.getX())-Math.abs(a.getY()-c.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let s=0,a=0;const c=this.possibleCenters.length;for(const m of this.possibleCenters)m.getCount()>=Mn.CENTER_QUORUM&&(s++,a+=m.getEstimatedModuleSize());if(s<3)return!1;const d=a/c;let f=0;for(const m of this.possibleCenters)f+=Math.abs(m.getEstimatedModuleSize()-d);return f<=.05*a}selectBestPatterns(){const s=this.possibleCenters.length;if(s<3)throw new $;const a=this.possibleCenters;let c;if(s>3){let d=0,f=0;for(const A of this.possibleCenters){const b=A.getEstimatedModuleSize();d+=b,f+=b*b}c=d/s;let m=Math.sqrt(f/s-c*c);a.sort((A,b)=>{const T=Math.abs(b.getEstimatedModuleSize()-c),M=Math.abs(A.getEstimatedModuleSize()-c);return T<M?-1:T>M?1:0});const w=Math.max(.2*c,m);for(let A=0;A<a.length&&a.length>3;A++){const b=a[A];Math.abs(b.getEstimatedModuleSize()-c)>w&&(a.splice(A,1),A--)}}if(a.length>3){let d=0;for(const f of a)d+=f.getEstimatedModuleSize();c=d/a.length,a.sort((f,m)=>{if(m.getCount()===f.getCount()){const w=Math.abs(m.getEstimatedModuleSize()-c),A=Math.abs(f.getEstimatedModuleSize()-c);return w<A?1:w>A?-1:0}else return m.getCount()-f.getCount()}),a.splice(3)}return[a[0],a[1],a[2]]}}Mn.CENTER_QUORUM=2,Mn.MIN_SKIP=3,Mn.MAX_MODULES=57;class b0{constructor(s){this.image=s}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(s){this.resultPointCallback=s==null?null:s.get(H.NEED_RESULT_POINT_CALLBACK);const c=new Mn(this.image,this.resultPointCallback).find(s);return this.processFinderPatternInfo(c)}processFinderPatternInfo(s){const a=s.getTopLeft(),c=s.getTopRight(),d=s.getBottomLeft(),f=this.calculateModuleSize(a,c,d);if(f<1)throw new $("No pattern found in proccess finder.");const m=b0.computeDimension(a,c,d,f),w=Ne.getProvisionalVersionForDimension(m),A=w.getDimensionForVersion()-7;let b=null;if(w.getAlignmentPatternCenters().length>0){const V=c.getX()-a.getX()+d.getX(),G=c.getY()-a.getY()+d.getY(),X=1-3/A,K=Math.floor(a.getX()+X*(V-a.getX())),J=Math.floor(a.getY()+X*(G-a.getY()));for(let de=4;de<=16;de<<=1)try{b=this.findAlignmentInRegion(f,K,J,de);break}catch(fe){if(!(fe instanceof $))throw fe}}const T=b0.createTransform(a,c,d,b,m),M=b0.sampleGrid(this.image,T,m);let L;return b===null?L=[d,a,c]:L=[d,a,c,b],new os(M,L)}static createTransform(s,a,c,d,f){const m=f-3.5;let w,A,b,T;return d!==null?(w=d.getX(),A=d.getY(),b=m-3,T=b):(w=a.getX()-s.getX()+c.getX(),A=a.getY()-s.getY()+c.getY(),b=m,T=m),vi.quadrilateralToQuadrilateral(3.5,3.5,m,3.5,b,T,3.5,m,s.getX(),s.getY(),a.getX(),a.getY(),w,A,c.getX(),c.getY())}static sampleGrid(s,a,c){return ke.getInstance().sampleGridWithTransform(s,c,c,a)}static computeDimension(s,a,c,d){const f=$e.round(Se.distance(s,a)/d),m=$e.round(Se.distance(s,c)/d);let w=Math.floor((f+m)/2)+7;switch(w&3){case 0:w++;break;case 2:w--;break;case 3:throw new $("Dimensions could be not found.")}return w}calculateModuleSize(s,a,c){return(this.calculateModuleSizeOneWay(s,a)+this.calculateModuleSizeOneWay(s,c))/2}calculateModuleSizeOneWay(s,a){const c=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(s.getX()),Math.floor(s.getY()),Math.floor(a.getX()),Math.floor(a.getY())),d=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(a.getX()),Math.floor(a.getY()),Math.floor(s.getX()),Math.floor(s.getY()));return isNaN(c)?d/7:isNaN(d)?c/7:(c+d)/14}sizeOfBlackWhiteBlackRunBothWays(s,a,c,d){let f=this.sizeOfBlackWhiteBlackRun(s,a,c,d),m=1,w=s-(c-s);w<0?(m=s/(s-w),w=0):w>=this.image.getWidth()&&(m=(this.image.getWidth()-1-s)/(w-s),w=this.image.getWidth()-1);let A=Math.floor(a-(d-a)*m);return m=1,A<0?(m=a/(a-A),A=0):A>=this.image.getHeight()&&(m=(this.image.getHeight()-1-a)/(A-a),A=this.image.getHeight()-1),w=Math.floor(s+(w-s)*m),f+=this.sizeOfBlackWhiteBlackRun(s,a,w,A),f-1}sizeOfBlackWhiteBlackRun(s,a,c,d){const f=Math.abs(d-a)>Math.abs(c-s);if(f){let V=s;s=a,a=V,V=c,c=d,d=V}const m=Math.abs(c-s),w=Math.abs(d-a);let A=-m/2;const b=s<c?1:-1,T=a<d?1:-1;let M=0;const L=c+b;for(let V=s,G=a;V!==L;V+=b){const X=f?G:V,K=f?V:G;if(M===1===this.image.get(X,K)){if(M===2)return $e.distance(V,G,s,a);M++}if(A+=w,A>0){if(G===d)break;G+=T,A-=m}}return M===2?$e.distance(c+b,d,s,a):NaN}findAlignmentInRegion(s,a,c,d){const f=Math.floor(d*s),m=Math.max(0,a-f),w=Math.min(this.image.getWidth()-1,a+f);if(w-m<s*3)throw new $("Alignment top exceeds estimated module size.");const A=Math.max(0,c-f),b=Math.min(this.image.getHeight()-1,c+f);if(b-A<s*3)throw new $("Alignment bottom exceeds estimated module size.");return new Hm(this.image,m,A,w-m,b-A,s,this.resultPointCallback).find()}}class Ia{constructor(){this.decoder=new QN}getDecoder(){return this.decoder}decode(s,a){let c,d;if(a!=null&&a.get(H.PURE_BARCODE)!==void 0){const A=Ia.extractPureBits(s.getBlackMatrix());c=this.decoder.decodeBitMatrix(A,a),d=Ia.NO_POINTS}else{const A=new b0(s.getBlackMatrix()).detect(a);c=this.decoder.decodeBitMatrix(A.getBits(),a),d=A.getPoints()}c.getOther()instanceof mS&&c.getOther().applyMirroredCorrection(d);const f=new Le(c.getText(),c.getRawBytes(),void 0,d,xe.QR_CODE,void 0),m=c.getByteSegments();m!==null&&f.putMetadata(st.BYTE_SEGMENTS,m);const w=c.getECLevel();return w!==null&&f.putMetadata(st.ERROR_CORRECTION_LEVEL,w),c.hasStructuredAppend()&&(f.putMetadata(st.STRUCTURED_APPEND_SEQUENCE,c.getStructuredAppendSequenceNumber()),f.putMetadata(st.STRUCTURED_APPEND_PARITY,c.getStructuredAppendParity())),f}reset(){}static extractPureBits(s){const a=s.getTopLeftOnBit(),c=s.getBottomRightOnBit();if(a===null||c===null)throw new $;const d=this.moduleSize(a,s);let f=a[1],m=c[1],w=a[0],A=c[0];if(w>=A||f>=m)throw new $;if(m-f!==A-w&&(A=w+(m-f),A>=s.getWidth()))throw new $;const b=Math.round((A-w+1)/d),T=Math.round((m-f+1)/d);if(b<=0||T<=0)throw new $;if(T!==b)throw new $;const M=Math.floor(d/2);f+=M,w+=M;const L=w+Math.floor((b-1)*d)-A;if(L>0){if(L>M)throw new $;w-=L}const V=f+Math.floor((T-1)*d)-m;if(V>0){if(V>M)throw new $;f-=V}const G=new ce(b,T);for(let X=0;X<T;X++){const K=f+Math.floor(X*d);for(let J=0;J<b;J++)s.get(w+Math.floor(J*d),K)&&G.set(J,X)}return G}static moduleSize(s,a){const c=a.getHeight(),d=a.getWidth();let f=s[0],m=s[1],w=!0,A=0;for(;f<d&&m<c;){if(w!==a.get(f,m)){if(++A===5)break;w=!w}f++,m++}if(f===d||m===c)throw new $;return(f-s[0])/7}}Ia.NO_POINTS=new Array;class Oe{PDF417Common(){}static getBitCountSum(s){return $e.sum(s)}static toIntArray(s){if(s==null||!s.length)return Oe.EMPTY_INT_ARRAY;const a=new Int32Array(s.length);let c=0;for(const d of s)a[c++]=d;return a}static getCodeword(s){const a=N.binarySearch(Oe.SYMBOL_TABLE,s&262143);return a<0?-1:(Oe.CODEWORD_TABLE[a]-1)%Oe.NUMBER_OF_CODEWORDS}}Oe.NUMBER_OF_CODEWORDS=929,Oe.MAX_CODEWORDS_IN_BARCODE=Oe.NUMBER_OF_CODEWORDS-1,Oe.MIN_ROWS_IN_BARCODE=3,Oe.MAX_ROWS_IN_BARCODE=90,Oe.MODULES_IN_CODEWORD=17,Oe.MODULES_IN_STOP_PATTERN=18,Oe.BARS_IN_MODULE=8,Oe.EMPTY_INT_ARRAY=new Int32Array([]),Oe.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Oe.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class eR{constructor(s,a){this.bits=s,this.points=a}getBits(){return this.bits}getPoints(){return this.points}}class We{static detectMultiple(s,a,c){let d=s.getBlackMatrix(),f=We.detect(c,d);return f.length||(d=d.clone(),d.rotate180(),f=We.detect(c,d)),new eR(d,f)}static detect(s,a){const c=new Array;let d=0,f=0,m=!1;for(;d<a.getHeight();){const w=We.findVertices(a,d,f);if(w[0]==null&&w[3]==null){if(!m)break;m=!1,f=0;for(const A of c)A[1]!=null&&(d=Math.trunc(Math.max(d,A[1].getY()))),A[3]!=null&&(d=Math.max(d,Math.trunc(A[3].getY())));d+=We.ROW_STEP;continue}if(m=!0,c.push(w),!s)break;w[2]!=null?(f=Math.trunc(w[2].getX()),d=Math.trunc(w[2].getY())):(f=Math.trunc(w[4].getX()),d=Math.trunc(w[4].getY()))}return c}static findVertices(s,a,c){const d=s.getHeight(),f=s.getWidth(),m=new Array(8);return We.copyToResult(m,We.findRowsWithPattern(s,d,f,a,c,We.START_PATTERN),We.INDEXES_START_PATTERN),m[4]!=null&&(c=Math.trunc(m[4].getX()),a=Math.trunc(m[4].getY())),We.copyToResult(m,We.findRowsWithPattern(s,d,f,a,c,We.STOP_PATTERN),We.INDEXES_STOP_PATTERN),m}static copyToResult(s,a,c){for(let d=0;d<c.length;d++)s[c[d]]=a[d]}static findRowsWithPattern(s,a,c,d,f,m){const w=new Array(4);let A=!1;const b=new Int32Array(m.length);for(;d<a;d+=We.ROW_STEP){let M=We.findGuardPattern(s,f,d,c,!1,m,b);if(M!=null){for(;d>0;){const L=We.findGuardPattern(s,f,--d,c,!1,m,b);if(L!=null)M=L;else{d++;break}}w[0]=new Se(M[0],d),w[1]=new Se(M[1],d),A=!0;break}}let T=d+1;if(A){let M=0,L=Int32Array.from([Math.trunc(w[0].getX()),Math.trunc(w[1].getX())]);for(;T<a;T++){const V=We.findGuardPattern(s,L[0],T,c,!1,m,b);if(V!=null&&Math.abs(L[0]-V[0])<We.MAX_PATTERN_DRIFT&&Math.abs(L[1]-V[1])<We.MAX_PATTERN_DRIFT)L=V,M=0;else{if(M>We.SKIPPED_ROW_COUNT_MAX)break;M++}}T-=M+1,w[2]=new Se(L[0],T),w[3]=new Se(L[1],T)}return T-d<We.BARCODE_MIN_HEIGHT&&N.fill(w,null),w}static findGuardPattern(s,a,c,d,f,m,w){N.fillWithin(w,0,w.length,0);let A=a,b=0;for(;s.get(A,c)&&A>0&&b++<We.MAX_PIXEL_DRIFT;)A--;let T=A,M=0,L=m.length;for(let V=f;T<d;T++)if(s.get(T,c)!==V)w[M]++;else{if(M===L-1){if(We.patternMatchVariance(w,m,We.MAX_INDIVIDUAL_VARIANCE)<We.MAX_AVG_VARIANCE)return new Int32Array([A,T]);A+=w[0]+w[1],I.arraycopy(w,2,w,0,M-1),w[M-1]=0,w[M]=0,M--}else M++;w[M]=1,V=!V}return M===L-1&&We.patternMatchVariance(w,m,We.MAX_INDIVIDUAL_VARIANCE)<We.MAX_AVG_VARIANCE?new Int32Array([A,T-1]):null}static patternMatchVariance(s,a,c){let d=s.length,f=0,m=0;for(let b=0;b<d;b++)f+=s[b],m+=a[b];if(f<m)return 1/0;let w=f/m;c*=w;let A=0;for(let b=0;b<d;b++){let T=s[b],M=a[b]*w,L=T>M?T-M:M-T;if(L>c)return 1/0;A+=L}return A/f}}We.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),We.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),We.MAX_AVG_VARIANCE=.42,We.MAX_INDIVIDUAL_VARIANCE=.8,We.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),We.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),We.MAX_PIXEL_DRIFT=3,We.MAX_PATTERN_DRIFT=5,We.SKIPPED_ROW_COUNT_MAX=25,We.ROW_STEP=5,We.BARCODE_MIN_HEIGHT=10;class Xn{constructor(s,a){if(a.length===0)throw new y;this.field=s;let c=a.length;if(c>1&&a[0]===0){let d=1;for(;d<c&&a[d]===0;)d++;d===c?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(c-d),I.arraycopy(a,d,this.coefficients,0,this.coefficients.length))}else this.coefficients=a}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(s){return this.coefficients[this.coefficients.length-1-s]}evaluateAt(s){if(s===0)return this.getCoefficient(0);if(s===1){let d=0;for(let f of this.coefficients)d=this.field.add(d,f);return d}let a=this.coefficients[0],c=this.coefficients.length;for(let d=1;d<c;d++)a=this.field.add(this.field.multiply(s,a),this.coefficients[d]);return a}add(s){if(!this.field.equals(s.field))throw new y("ModulusPolys do not have same ModulusGF field");if(this.isZero())return s;if(s.isZero())return this;let a=this.coefficients,c=s.coefficients;if(a.length>c.length){let m=a;a=c,c=m}let d=new Int32Array(c.length),f=c.length-a.length;I.arraycopy(c,0,d,0,f);for(let m=f;m<c.length;m++)d[m]=this.field.add(a[m-f],c[m]);return new Xn(this.field,d)}subtract(s){if(!this.field.equals(s.field))throw new y("ModulusPolys do not have same ModulusGF field");return s.isZero()?this:this.add(s.negative())}multiply(s){return s instanceof Xn?this.multiplyOther(s):this.multiplyScalar(s)}multiplyOther(s){if(!this.field.equals(s.field))throw new y("ModulusPolys do not have same ModulusGF field");if(this.isZero()||s.isZero())return new Xn(this.field,new Int32Array([0]));let a=this.coefficients,c=a.length,d=s.coefficients,f=d.length,m=new Int32Array(c+f-1);for(let w=0;w<c;w++){let A=a[w];for(let b=0;b<f;b++)m[w+b]=this.field.add(m[w+b],this.field.multiply(A,d[b]))}return new Xn(this.field,m)}negative(){let s=this.coefficients.length,a=new Int32Array(s);for(let c=0;c<s;c++)a[c]=this.field.subtract(0,this.coefficients[c]);return new Xn(this.field,a)}multiplyScalar(s){if(s===0)return new Xn(this.field,new Int32Array([0]));if(s===1)return this;let a=this.coefficients.length,c=new Int32Array(a);for(let d=0;d<a;d++)c[d]=this.field.multiply(this.coefficients[d],s);return new Xn(this.field,c)}multiplyByMonomial(s,a){if(s<0)throw new y;if(a===0)return new Xn(this.field,new Int32Array([0]));let c=this.coefficients.length,d=new Int32Array(c+s);for(let f=0;f<c;f++)d[f]=this.field.multiply(this.coefficients[f],a);return new Xn(this.field,d)}toString(){let s=new le;for(let a=this.getDegree();a>=0;a--){let c=this.getCoefficient(a);c!==0&&(c<0?(s.append(" - "),c=-c):s.length()>0&&s.append(" + "),(a===0||c!==1)&&s.append(c),a!==0&&(a===1?s.append("x"):(s.append("x^"),s.append(a))))}return s.toString()}}class tR{add(s,a){return(s+a)%this.modulus}subtract(s,a){return(this.modulus+s-a)%this.modulus}exp(s){return this.expTable[s]}log(s){if(s===0)throw new y;return this.logTable[s]}inverse(s){if(s===0)throw new Cn;return this.expTable[this.modulus-this.logTable[s]-1]}multiply(s,a){return s===0||a===0?0:this.expTable[(this.logTable[s]+this.logTable[a])%(this.modulus-1)]}getSize(){return this.modulus}equals(s){return s===this}}class _A extends tR{constructor(s,a){super(),this.modulus=s,this.expTable=new Int32Array(s),this.logTable=new Int32Array(s);let c=1;for(let d=0;d<s;d++)this.expTable[d]=c,c=c*a%s;for(let d=0;d<s-1;d++)this.logTable[this.expTable[d]]=d;this.zero=new Xn(this,new Int32Array([0])),this.one=new Xn(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(s,a){if(s<0)throw new y;if(a===0)return this.zero;let c=new Int32Array(s+1);return c[0]=a,new Xn(this,c)}}_A.PDF417_GF=new _A(Oe.NUMBER_OF_CODEWORDS,3);class xS{constructor(){this.field=_A.PDF417_GF}decode(s,a,c){let d=new Xn(this.field,s),f=new Int32Array(a),m=!1;for(let G=a;G>0;G--){let X=d.evaluateAt(this.field.exp(G));f[a-G]=X,X!==0&&(m=!0)}if(!m)return 0;let w=this.field.getOne();if(c!=null)for(const G of c){let X=this.field.exp(s.length-1-G),K=new Xn(this.field,new Int32Array([this.field.subtract(0,X),1]));w=w.multiply(K)}let A=new Xn(this.field,f),b=this.runEuclideanAlgorithm(this.field.buildMonomial(a,1),A,a),T=b[0],M=b[1],L=this.findErrorLocations(T),V=this.findErrorMagnitudes(M,T,L);for(let G=0;G<L.length;G++){let X=s.length-1-this.field.log(L[G]);if(X<0)throw C.getChecksumInstance();s[X]=this.field.subtract(s[X],V[G])}return L.length}runEuclideanAlgorithm(s,a,c){if(s.getDegree()<a.getDegree()){let L=s;s=a,a=L}let d=s,f=a,m=this.field.getZero(),w=this.field.getOne();for(;f.getDegree()>=Math.round(c/2);){let L=d,V=m;if(d=f,m=w,d.isZero())throw C.getChecksumInstance();f=L;let G=this.field.getZero(),X=d.getCoefficient(d.getDegree()),K=this.field.inverse(X);for(;f.getDegree()>=d.getDegree()&&!f.isZero();){let J=f.getDegree()-d.getDegree(),de=this.field.multiply(f.getCoefficient(f.getDegree()),K);G=G.add(this.field.buildMonomial(J,de)),f=f.subtract(d.multiplyByMonomial(J,de))}w=G.multiply(m).subtract(V).negative()}let A=w.getCoefficient(0);if(A===0)throw C.getChecksumInstance();let b=this.field.inverse(A),T=w.multiply(b),M=f.multiply(b);return[T,M]}findErrorLocations(s){let a=s.getDegree(),c=new Int32Array(a),d=0;for(let f=1;f<this.field.getSize()&&d<a;f++)s.evaluateAt(f)===0&&(c[d]=this.field.inverse(f),d++);if(d!==a)throw C.getChecksumInstance();return c}findErrorMagnitudes(s,a,c){let d=a.getDegree(),f=new Int32Array(d);for(let b=1;b<=d;b++)f[d-b]=this.field.multiply(b,a.getCoefficient(b));let m=new Xn(this.field,f),w=c.length,A=new Int32Array(w);for(let b=0;b<w;b++){let T=this.field.inverse(c[b]),M=this.field.subtract(0,s.evaluateAt(T)),L=this.field.inverse(m.evaluateAt(T));A[b]=this.field.multiply(M,L)}return A}}class ac{constructor(s,a,c,d,f){s instanceof ac?this.constructor_2(s):this.constructor_1(s,a,c,d,f)}constructor_1(s,a,c,d,f){const m=a==null||c==null,w=d==null||f==null;if(m&&w)throw new $;m?(a=new Se(0,d.getY()),c=new Se(0,f.getY())):w&&(d=new Se(s.getWidth()-1,a.getY()),f=new Se(s.getWidth()-1,c.getY())),this.image=s,this.topLeft=a,this.bottomLeft=c,this.topRight=d,this.bottomRight=f,this.minX=Math.trunc(Math.min(a.getX(),c.getX())),this.maxX=Math.trunc(Math.max(d.getX(),f.getX())),this.minY=Math.trunc(Math.min(a.getY(),d.getY())),this.maxY=Math.trunc(Math.max(c.getY(),f.getY()))}constructor_2(s){this.image=s.image,this.topLeft=s.getTopLeft(),this.bottomLeft=s.getBottomLeft(),this.topRight=s.getTopRight(),this.bottomRight=s.getBottomRight(),this.minX=s.getMinX(),this.maxX=s.getMaxX(),this.minY=s.getMinY(),this.maxY=s.getMaxY()}static merge(s,a){return s==null?a:a==null?s:new ac(s.image,s.topLeft,s.bottomLeft,a.topRight,a.bottomRight)}addMissingRows(s,a,c){let d=this.topLeft,f=this.bottomLeft,m=this.topRight,w=this.bottomRight;if(s>0){let A=c?this.topLeft:this.topRight,b=Math.trunc(A.getY()-s);b<0&&(b=0);let T=new Se(A.getX(),b);c?d=T:m=T}if(a>0){let A=c?this.bottomLeft:this.bottomRight,b=Math.trunc(A.getY()+a);b>=this.image.getHeight()&&(b=this.image.getHeight()-1);let T=new Se(A.getX(),b);c?f=T:w=T}return new ac(this.image,d,f,m,w)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class nR{constructor(s,a,c,d){this.columnCount=s,this.errorCorrectionLevel=d,this.rowCountUpperPart=a,this.rowCountLowerPart=c,this.rowCount=a+c}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class E0{constructor(){this.buffer=""}static form(s,a){let c=-1;function d(m,w,A,b,T,M){if(m==="%%")return"%";if(a[++c]===void 0)return;m=b?parseInt(b.substr(1)):void 0;let L=T?parseInt(T.substr(1)):void 0,V;switch(M){case"s":V=a[c];break;case"c":V=a[c][0];break;case"f":V=parseFloat(a[c]).toFixed(m);break;case"p":V=parseFloat(a[c]).toPrecision(m);break;case"e":V=parseFloat(a[c]).toExponential(m);break;case"x":V=parseInt(a[c]).toString(L||16);break;case"d":V=parseFloat(parseInt(a[c],L||10).toPrecision(m)).toFixed(0);break}V=typeof V=="object"?JSON.stringify(V):(+V).toString(L);let G=parseInt(A),X=A&&A[0]+""=="0"?"0":" ";for(;V.length<G;)V=w!==void 0?V+X:X+V;return V}let f=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return s.replace(f,d)}format(s,...a){this.buffer+=E0.form(s,a)}toString(){return this.buffer}}class C0{constructor(s){this.boundingBox=new ac(s),this.codewords=new Array(s.getMaxY()-s.getMinY()+1)}getCodewordNearby(s){let a=this.getCodeword(s);if(a!=null)return a;for(let c=1;c<C0.MAX_NEARBY_DISTANCE;c++){let d=this.imageRowToCodewordIndex(s)-c;if(d>=0&&(a=this.codewords[d],a!=null)||(d=this.imageRowToCodewordIndex(s)+c,d<this.codewords.length&&(a=this.codewords[d],a!=null)))return a}return null}imageRowToCodewordIndex(s){return s-this.boundingBox.getMinY()}setCodeword(s,a){this.codewords[this.imageRowToCodewordIndex(s)]=a}getCodeword(s){return this.codewords[this.imageRowToCodewordIndex(s)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const s=new E0;let a=0;for(const c of this.codewords){if(c==null){s.format("%3d:    |   %n",a++);continue}s.format("%3d: %3d|%3d%n",a++,c.getRowNumber(),c.getValue())}return s.toString()}}C0.MAX_NEARBY_DISTANCE=5;class S0{constructor(){this.values=new Map}setValue(s){s=Math.trunc(s);let a=this.values.get(s);a==null&&(a=0),a++,this.values.set(s,a)}getValue(){let s=-1,a=new Array;for(const[c,d]of this.values.entries()){const f={getKey:()=>c,getValue:()=>d};f.getValue()>s?(s=f.getValue(),a=[],a.push(f.getKey())):f.getValue()===s&&a.push(f.getKey())}return Oe.toIntArray(a)}getConfidence(s){return this.values.get(s)}}class wS extends C0{constructor(s,a){super(s),this._isLeft=a}setRowNumbers(){for(let s of this.getCodewords())s!=null&&s.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(s){let a=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(a,s);let c=this.getBoundingBox(),d=this._isLeft?c.getTopLeft():c.getTopRight(),f=this._isLeft?c.getBottomLeft():c.getBottomRight(),m=this.imageRowToCodewordIndex(Math.trunc(d.getY())),w=this.imageRowToCodewordIndex(Math.trunc(f.getY())),A=-1,b=1,T=0;for(let M=m;M<w;M++){if(a[M]==null)continue;let L=a[M],V=L.getRowNumber()-A;if(V===0)T++;else if(V===1)b=Math.max(b,T),T=1,A=L.getRowNumber();else if(V<0||L.getRowNumber()>=s.getRowCount()||V>M)a[M]=null;else{let G;b>2?G=(b-2)*V:G=V;let X=G>=M;for(let K=1;K<=G&&!X;K++)X=a[M-K]!=null;X?a[M]=null:(A=L.getRowNumber(),T=1)}}}getRowHeights(){let s=this.getBarcodeMetadata();if(s==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(s);let a=new Int32Array(s.getRowCount());for(let c of this.getCodewords())if(c!=null){let d=c.getRowNumber();if(d>=a.length)continue;a[d]++}return a}adjustIncompleteIndicatorColumnRowNumbers(s){let a=this.getBoundingBox(),c=this._isLeft?a.getTopLeft():a.getTopRight(),d=this._isLeft?a.getBottomLeft():a.getBottomRight(),f=this.imageRowToCodewordIndex(Math.trunc(c.getY())),m=this.imageRowToCodewordIndex(Math.trunc(d.getY())),w=this.getCodewords(),A=-1;for(let b=f;b<m;b++){if(w[b]==null)continue;let T=w[b];T.setRowNumberAsRowIndicatorColumn();let M=T.getRowNumber()-A;M===0||(M===1?A=T.getRowNumber():T.getRowNumber()>=s.getRowCount()?w[b]=null:A=T.getRowNumber())}}getBarcodeMetadata(){let s=this.getCodewords(),a=new S0,c=new S0,d=new S0,f=new S0;for(let w of s){if(w==null)continue;w.setRowNumberAsRowIndicatorColumn();let A=w.getValue()%30,b=w.getRowNumber();switch(this._isLeft||(b+=2),b%3){case 0:c.setValue(A*3+1);break;case 1:f.setValue(A/3),d.setValue(A%3);break;case 2:a.setValue(A+1);break}}if(a.getValue().length===0||c.getValue().length===0||d.getValue().length===0||f.getValue().length===0||a.getValue()[0]<1||c.getValue()[0]+d.getValue()[0]<Oe.MIN_ROWS_IN_BARCODE||c.getValue()[0]+d.getValue()[0]>Oe.MAX_ROWS_IN_BARCODE)return null;let m=new nR(a.getValue()[0],c.getValue()[0],d.getValue()[0],f.getValue()[0]);return this.removeIncorrectCodewords(s,m),m}removeIncorrectCodewords(s,a){for(let c=0;c<s.length;c++){let d=s[c];if(s[c]==null)continue;let f=d.getValue()%30,m=d.getRowNumber();if(m>a.getRowCount()){s[c]=null;continue}switch(this._isLeft||(m+=2),m%3){case 0:f*3+1!==a.getRowCountUpperPart()&&(s[c]=null);break;case 1:(Math.trunc(f/3)!==a.getErrorCorrectionLevel()||f%3!==a.getRowCountLowerPart())&&(s[c]=null);break;case 2:f+1!==a.getColumnCount()&&(s[c]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class _0{constructor(s,a){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=s,this.barcodeColumnCount=s.getColumnCount(),this.boundingBox=a,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let s=Oe.MAX_CODEWORDS_IN_BARCODE,a;do a=s,s=this.adjustRowNumbersAndGetCount();while(s>0&&s<a);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(s){s!=null&&s.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let s=this.adjustRowNumbersByRow();if(s===0)return 0;for(let a=1;a<this.barcodeColumnCount+1;a++){let c=this.detectionResultColumns[a].getCodewords();for(let d=0;d<c.length;d++)c[d]!=null&&(c[d].hasValidRowNumber()||this.adjustRowNumbers(a,d,c))}return s}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let s=this.detectionResultColumns[0].getCodewords(),a=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let c=0;c<s.length;c++)if(s[c]!=null&&a[c]!=null&&s[c].getRowNumber()===a[c].getRowNumber())for(let d=1;d<=this.barcodeColumnCount;d++){let f=this.detectionResultColumns[d].getCodewords()[c];f!=null&&(f.setRowNumber(s[c].getRowNumber()),f.hasValidRowNumber()||(this.detectionResultColumns[d].getCodewords()[c]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let s=0,a=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let c=0;c<a.length;c++){if(a[c]==null)continue;let d=a[c].getRowNumber(),f=0;for(let m=this.barcodeColumnCount+1;m>0&&f<this.ADJUST_ROW_NUMBER_SKIP;m--){let w=this.detectionResultColumns[m].getCodewords()[c];w!=null&&(f=_0.adjustRowNumberIfValid(d,f,w),w.hasValidRowNumber()||s++)}}return s}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let s=0,a=this.detectionResultColumns[0].getCodewords();for(let c=0;c<a.length;c++){if(a[c]==null)continue;let d=a[c].getRowNumber(),f=0;for(let m=1;m<this.barcodeColumnCount+1&&f<this.ADJUST_ROW_NUMBER_SKIP;m++){let w=this.detectionResultColumns[m].getCodewords()[c];w!=null&&(f=_0.adjustRowNumberIfValid(d,f,w),w.hasValidRowNumber()||s++)}}return s}static adjustRowNumberIfValid(s,a,c){return c==null||c.hasValidRowNumber()||(c.isValidRowNumber(s)?(c.setRowNumber(s),a=0):++a),a}adjustRowNumbers(s,a,c){if(!this.detectionResultColumns[s-1])return;let d=c[a],f=this.detectionResultColumns[s-1].getCodewords(),m=f;this.detectionResultColumns[s+1]!=null&&(m=this.detectionResultColumns[s+1].getCodewords());let w=new Array(14);w[2]=f[a],w[3]=m[a],a>0&&(w[0]=c[a-1],w[4]=f[a-1],w[5]=m[a-1]),a>1&&(w[8]=c[a-2],w[10]=f[a-2],w[11]=m[a-2]),a<c.length-1&&(w[1]=c[a+1],w[6]=f[a+1],w[7]=m[a+1]),a<c.length-2&&(w[9]=c[a+2],w[12]=f[a+2],w[13]=m[a+2]);for(let A of w)if(_0.adjustRowNumber(d,A))return}static adjustRowNumber(s,a){return a==null?!1:a.hasValidRowNumber()&&a.getBucket()===s.getBucket()?(s.setRowNumber(a.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(s){this.boundingBox=s}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(s,a){this.detectionResultColumns[s]=a}getDetectionResultColumn(s){return this.detectionResultColumns[s]}toString(){let s=this.detectionResultColumns[0];s==null&&(s=this.detectionResultColumns[this.barcodeColumnCount+1]);let a=new E0;for(let c=0;c<s.getCodewords().length;c++){a.format("CW %3d:",c);for(let d=0;d<this.barcodeColumnCount+2;d++){if(this.detectionResultColumns[d]==null){a.format("    |   ");continue}let f=this.detectionResultColumns[d].getCodewords()[c];if(f==null){a.format("    |   ");continue}a.format(" %3d|%3d",f.getRowNumber(),f.getValue())}a.format("%n")}return a.toString()}}class T0{constructor(s,a,c,d){this.rowNumber=T0.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(s),this.endX=Math.trunc(a),this.bucket=Math.trunc(c),this.value=Math.trunc(d)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(s){return s!==T0.BARCODE_ROW_UNKNOWN&&this.bucket===s%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(s){this.rowNumber=s}toString(){return this.rowNumber+"|"+this.value}}T0.BARCODE_ROW_UNKNOWN=-1;class Fi{static initialize(){for(let s=0;s<Oe.SYMBOL_TABLE.length;s++){let a=Oe.SYMBOL_TABLE[s],c=a&1;for(let d=0;d<Oe.BARS_IN_MODULE;d++){let f=0;for(;(a&1)===c;)f+=1,a>>=1;c=a&1,Fi.RATIOS_TABLE[s]||(Fi.RATIOS_TABLE[s]=new Array(Oe.BARS_IN_MODULE)),Fi.RATIOS_TABLE[s][Oe.BARS_IN_MODULE-d-1]=Math.fround(f/Oe.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(s){let a=Fi.getDecodedCodewordValue(Fi.sampleBitCounts(s));return a!==-1?a:Fi.getClosestDecodedValue(s)}static sampleBitCounts(s){let a=$e.sum(s),c=new Int32Array(Oe.BARS_IN_MODULE),d=0,f=0;for(let m=0;m<Oe.MODULES_IN_CODEWORD;m++){let w=a/(2*Oe.MODULES_IN_CODEWORD)+m*a/Oe.MODULES_IN_CODEWORD;f+s[d]<=w&&(f+=s[d],d++),c[d]++}return c}static getDecodedCodewordValue(s){let a=Fi.getBitValue(s);return Oe.getCodeword(a)===-1?-1:a}static getBitValue(s){let a=0;for(let c=0;c<s.length;c++)for(let d=0;d<s[c];d++)a=a<<1|(c%2===0?1:0);return Math.trunc(a)}static getClosestDecodedValue(s){let a=$e.sum(s),c=new Array(Oe.BARS_IN_MODULE);if(a>1)for(let m=0;m<c.length;m++)c[m]=Math.fround(s[m]/a);let d=Os.MAX_VALUE,f=-1;this.bSymbolTableReady||Fi.initialize();for(let m=0;m<Fi.RATIOS_TABLE.length;m++){let w=0,A=Fi.RATIOS_TABLE[m];for(let b=0;b<Oe.BARS_IN_MODULE;b++){let T=Math.fround(A[b]-c[b]);if(w+=Math.fround(T*T),w>=d)break}w<d&&(d=w,f=Oe.SYMBOL_TABLE[m])}return f}}Fi.bSymbolTableReady=!1,Fi.RATIOS_TABLE=new Array(Oe.SYMBOL_TABLE.length).map(D=>new Array(Oe.BARS_IN_MODULE));class yS{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(s){this.segmentIndex=s}getFileId(){return this.fileId}setFileId(s){this.fileId=s}getOptionalData(){return this.optionalData}setOptionalData(s){this.optionalData=s}isLastSegment(){return this.lastSegment}setLastSegment(s){this.lastSegment=s}getSegmentCount(){return this.segmentCount}setSegmentCount(s){this.segmentCount=s}getSender(){return this.sender||null}setSender(s){this.sender=s}getAddressee(){return this.addressee||null}setAddressee(s){this.addressee=s}getFileName(){return this.fileName}setFileName(s){this.fileName=s}getFileSize(){return this.fileSize}setFileSize(s){this.fileSize=s}getChecksum(){return this.checksum}setChecksum(s){this.checksum=s}getTimestamp(){return this.timestamp}setTimestamp(s){this.timestamp=s}}class AS{static parseLong(s,a=void 0){return parseInt(s,a)}}class vS extends p{}vS.kind="NullPointerException";class iR{writeBytes(s){this.writeBytesOffset(s,0,s.length)}writeBytesOffset(s,a,c){if(s==null)throw new vS;if(a<0||a>s.length||c<0||a+c>s.length||a+c<0)throw new O;if(c===0)return;for(let d=0;d<c;d++)this.write(s[a+d])}flush(){}close(){}}class rR extends p{}class sR extends iR{constructor(s=32){if(super(),this.count=0,s<0)throw new y("Negative initial size: "+s);this.buf=new Uint8Array(s)}ensureCapacity(s){s-this.buf.length>0&&this.grow(s)}grow(s){let c=this.buf.length<<1;if(c-s<0&&(c=s),c<0){if(s<0)throw new rR;c=k.MAX_VALUE}this.buf=N.copyOfUint8Array(this.buf,c)}write(s){this.ensureCapacity(this.count+1),this.buf[this.count]=s,this.count+=1}writeBytesOffset(s,a,c){if(a<0||a>s.length||c<0||a+c-s.length>0)throw new O;this.ensureCapacity(this.count+c),I.arraycopy(s,a,this.buf,this.count,c),this.count+=c}writeTo(s){s.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return N.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(s){return s?typeof s=="string"?this.toString_string(s):this.toString_number(s):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(s){return new String(this.buf).toString()}toString_number(s){return new String(this.buf).toString()}close(){}}var xt;(function(D){D[D.ALPHA=0]="ALPHA",D[D.LOWER=1]="LOWER",D[D.MIXED=2]="MIXED",D[D.PUNCT=3]="PUNCT",D[D.ALPHA_SHIFT=4]="ALPHA_SHIFT",D[D.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(xt||(xt={}));function bS(){if(typeof window<"u")return window.BigInt||null;if(typeof R0<"u")return R0.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Vm;function Na(D){if(typeof Vm>"u"&&(Vm=bS()),Vm===null)throw new Error("BigInt is not supported!");return Vm(D)}function oR(){let D=[];D[0]=Na(1);let s=Na(900);D[1]=s;for(let a=2;a<16;a++)D[a]=D[a-1]*s;return D}class Q{static decode(s,a){let c=new le(""),d=W.ISO8859_1;c.enableDecoding(d);let f=1,m=s[f++],w=new yS;for(;f<s[0];){switch(m){case Q.TEXT_COMPACTION_MODE_LATCH:f=Q.textCompaction(s,f,c);break;case Q.BYTE_COMPACTION_MODE_LATCH:case Q.BYTE_COMPACTION_MODE_LATCH_6:f=Q.byteCompaction(m,s,d,f,c);break;case Q.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(s[f++]);break;case Q.NUMERIC_COMPACTION_MODE_LATCH:f=Q.numericCompaction(s,f,c);break;case Q.ECI_CHARSET:W.getCharacterSetECIByValue(s[f++]);break;case Q.ECI_GENERAL_PURPOSE:f+=2;break;case Q.ECI_USER_DEFINED:f++;break;case Q.BEGIN_MACRO_PDF417_CONTROL_BLOCK:f=Q.decodeMacroBlock(s,f,w);break;case Q.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Q.MACRO_PDF417_TERMINATOR:throw new F;default:f--,f=Q.textCompaction(s,f,c);break}if(f<s.length)m=s[f++];else throw F.getFormatInstance()}if(c.length()===0)throw F.getFormatInstance();let A=new yn(null,c.toString(),null,a);return A.setOther(w),A}static decodeMacroBlock(s,a,c){if(a+Q.NUMBER_OF_SEQUENCE_CODEWORDS>s[0])throw F.getFormatInstance();let d=new Int32Array(Q.NUMBER_OF_SEQUENCE_CODEWORDS);for(let w=0;w<Q.NUMBER_OF_SEQUENCE_CODEWORDS;w++,a++)d[w]=s[a];c.setSegmentIndex(k.parseInt(Q.decodeBase900toBase10(d,Q.NUMBER_OF_SEQUENCE_CODEWORDS)));let f=new le;a=Q.textCompaction(s,a,f),c.setFileId(f.toString());let m=-1;for(s[a]===Q.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(m=a+1);a<s[0];)switch(s[a]){case Q.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(a++,s[a]){case Q.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let w=new le;a=Q.textCompaction(s,a+1,w),c.setFileName(w.toString());break;case Q.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let A=new le;a=Q.textCompaction(s,a+1,A),c.setSender(A.toString());break;case Q.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let b=new le;a=Q.textCompaction(s,a+1,b),c.setAddressee(b.toString());break;case Q.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let T=new le;a=Q.numericCompaction(s,a+1,T),c.setSegmentCount(k.parseInt(T.toString()));break;case Q.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let M=new le;a=Q.numericCompaction(s,a+1,M),c.setTimestamp(AS.parseLong(M.toString()));break;case Q.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let L=new le;a=Q.numericCompaction(s,a+1,L),c.setChecksum(k.parseInt(L.toString()));break;case Q.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let V=new le;a=Q.numericCompaction(s,a+1,V),c.setFileSize(AS.parseLong(V.toString()));break;default:throw F.getFormatInstance()}break;case Q.MACRO_PDF417_TERMINATOR:a++,c.setLastSegment(!0);break;default:throw F.getFormatInstance()}if(m!==-1){let w=a-m;c.isLastSegment()&&w--,c.setOptionalData(N.copyOfRange(s,m,m+w))}return a}static textCompaction(s,a,c){let d=new Int32Array((s[0]-a)*2),f=new Int32Array((s[0]-a)*2),m=0,w=!1;for(;a<s[0]&&!w;){let A=s[a++];if(A<Q.TEXT_COMPACTION_MODE_LATCH)d[m]=A/30,d[m+1]=A%30,m+=2;else switch(A){case Q.TEXT_COMPACTION_MODE_LATCH:d[m++]=Q.TEXT_COMPACTION_MODE_LATCH;break;case Q.BYTE_COMPACTION_MODE_LATCH:case Q.BYTE_COMPACTION_MODE_LATCH_6:case Q.NUMERIC_COMPACTION_MODE_LATCH:case Q.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Q.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Q.MACRO_PDF417_TERMINATOR:a--,w=!0;break;case Q.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d[m]=Q.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,A=s[a++],f[m]=A,m++;break}}return Q.decodeTextCompaction(d,f,m,c),a}static decodeTextCompaction(s,a,c,d){let f=xt.ALPHA,m=xt.ALPHA,w=0;for(;w<c;){let A=s[w],b="";switch(f){case xt.ALPHA:if(A<26)b=String.fromCharCode(65+A);else switch(A){case 26:b=" ";break;case Q.LL:f=xt.LOWER;break;case Q.ML:f=xt.MIXED;break;case Q.PS:m=f,f=xt.PUNCT_SHIFT;break;case Q.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d.append(a[w]);break;case Q.TEXT_COMPACTION_MODE_LATCH:f=xt.ALPHA;break}break;case xt.LOWER:if(A<26)b=String.fromCharCode(97+A);else switch(A){case 26:b=" ";break;case Q.AS:m=f,f=xt.ALPHA_SHIFT;break;case Q.ML:f=xt.MIXED;break;case Q.PS:m=f,f=xt.PUNCT_SHIFT;break;case Q.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d.append(a[w]);break;case Q.TEXT_COMPACTION_MODE_LATCH:f=xt.ALPHA;break}break;case xt.MIXED:if(A<Q.PL)b=Q.MIXED_CHARS[A];else switch(A){case Q.PL:f=xt.PUNCT;break;case 26:b=" ";break;case Q.LL:f=xt.LOWER;break;case Q.AL:f=xt.ALPHA;break;case Q.PS:m=f,f=xt.PUNCT_SHIFT;break;case Q.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d.append(a[w]);break;case Q.TEXT_COMPACTION_MODE_LATCH:f=xt.ALPHA;break}break;case xt.PUNCT:if(A<Q.PAL)b=Q.PUNCT_CHARS[A];else switch(A){case Q.PAL:f=xt.ALPHA;break;case Q.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d.append(a[w]);break;case Q.TEXT_COMPACTION_MODE_LATCH:f=xt.ALPHA;break}break;case xt.ALPHA_SHIFT:if(f=m,A<26)b=String.fromCharCode(65+A);else switch(A){case 26:b=" ";break;case Q.TEXT_COMPACTION_MODE_LATCH:f=xt.ALPHA;break}break;case xt.PUNCT_SHIFT:if(f=m,A<Q.PAL)b=Q.PUNCT_CHARS[A];else switch(A){case Q.PAL:f=xt.ALPHA;break;case Q.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d.append(a[w]);break;case Q.TEXT_COMPACTION_MODE_LATCH:f=xt.ALPHA;break}break}b!==""&&d.append(b),w++}}static byteCompaction(s,a,c,d,f){let m=new sR,w=0,A=0,b=!1;switch(s){case Q.BYTE_COMPACTION_MODE_LATCH:let T=new Int32Array(6),M=a[d++];for(;d<a[0]&&!b;)switch(T[w++]=M,A=900*A+M,M=a[d++],M){case Q.TEXT_COMPACTION_MODE_LATCH:case Q.BYTE_COMPACTION_MODE_LATCH:case Q.NUMERIC_COMPACTION_MODE_LATCH:case Q.BYTE_COMPACTION_MODE_LATCH_6:case Q.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Q.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Q.MACRO_PDF417_TERMINATOR:d--,b=!0;break;default:if(w%5===0&&w>0){for(let L=0;L<6;++L)m.write(Number(Na(A)>>Na(8*(5-L))));A=0,w=0}break}d===a[0]&&M<Q.TEXT_COMPACTION_MODE_LATCH&&(T[w++]=M);for(let L=0;L<w;L++)m.write(T[L]);break;case Q.BYTE_COMPACTION_MODE_LATCH_6:for(;d<a[0]&&!b;){let L=a[d++];if(L<Q.TEXT_COMPACTION_MODE_LATCH)w++,A=900*A+L;else switch(L){case Q.TEXT_COMPACTION_MODE_LATCH:case Q.BYTE_COMPACTION_MODE_LATCH:case Q.NUMERIC_COMPACTION_MODE_LATCH:case Q.BYTE_COMPACTION_MODE_LATCH_6:case Q.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Q.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Q.MACRO_PDF417_TERMINATOR:d--,b=!0;break}if(w%5===0&&w>0){for(let V=0;V<6;++V)m.write(Number(Na(A)>>Na(8*(5-V))));A=0,w=0}}break}return f.append(te.decode(m.toByteArray(),c)),d}static numericCompaction(s,a,c){let d=0,f=!1,m=new Int32Array(Q.MAX_NUMERIC_CODEWORDS);for(;a<s[0]&&!f;){let w=s[a++];if(a===s[0]&&(f=!0),w<Q.TEXT_COMPACTION_MODE_LATCH)m[d]=w,d++;else switch(w){case Q.TEXT_COMPACTION_MODE_LATCH:case Q.BYTE_COMPACTION_MODE_LATCH:case Q.BYTE_COMPACTION_MODE_LATCH_6:case Q.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Q.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Q.MACRO_PDF417_TERMINATOR:a--,f=!0;break}(d%Q.MAX_NUMERIC_CODEWORDS===0||w===Q.NUMERIC_COMPACTION_MODE_LATCH||f)&&d>0&&(c.append(Q.decodeBase900toBase10(m,d)),d=0)}return a}static decodeBase900toBase10(s,a){let c=Na(0);for(let f=0;f<a;f++)c+=Q.EXP900[a-f-1]*Na(s[f]);let d=c.toString();if(d.charAt(0)!=="1")throw new F;return d.substring(1)}}Q.TEXT_COMPACTION_MODE_LATCH=900,Q.BYTE_COMPACTION_MODE_LATCH=901,Q.NUMERIC_COMPACTION_MODE_LATCH=902,Q.BYTE_COMPACTION_MODE_LATCH_6=924,Q.ECI_USER_DEFINED=925,Q.ECI_GENERAL_PURPOSE=926,Q.ECI_CHARSET=927,Q.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,Q.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,Q.MACRO_PDF417_TERMINATOR=922,Q.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,Q.MAX_NUMERIC_CODEWORDS=15,Q.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,Q.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,Q.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,Q.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,Q.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,Q.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,Q.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,Q.PL=25,Q.LL=27,Q.AS=27,Q.ML=28,Q.AL=28,Q.PS=29,Q.PAL=29,Q.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,Q.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",Q.EXP900=bS()?oR():[],Q.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Ge{constructor(){}static decode(s,a,c,d,f,m,w){let A=new ac(s,a,c,d,f),b=null,T=null,M;for(let G=!0;;G=!1){if(a!=null&&(b=Ge.getRowIndicatorColumn(s,A,a,!0,m,w)),d!=null&&(T=Ge.getRowIndicatorColumn(s,A,d,!1,m,w)),M=Ge.merge(b,T),M==null)throw $.getNotFoundInstance();let X=M.getBoundingBox();if(G&&X!=null&&(X.getMinY()<A.getMinY()||X.getMaxY()>A.getMaxY()))A=X;else break}M.setBoundingBox(A);let L=M.getBarcodeColumnCount()+1;M.setDetectionResultColumn(0,b),M.setDetectionResultColumn(L,T);let V=b!=null;for(let G=1;G<=L;G++){let X=V?G:L-G;if(M.getDetectionResultColumn(X)!==void 0)continue;let K;X===0||X===L?K=new wS(A,X===0):K=new C0(A),M.setDetectionResultColumn(X,K);let J=-1,de=J;for(let fe=A.getMinY();fe<=A.getMaxY();fe++){if(J=Ge.getStartColumn(M,X,fe,V),J<0||J>A.getMaxX()){if(de===-1)continue;J=de}let ae=Ge.detectCodeword(s,A.getMinX(),A.getMaxX(),V,J,fe,m,w);ae!=null&&(K.setCodeword(fe,ae),de=J,m=Math.min(m,ae.getWidth()),w=Math.max(w,ae.getWidth()))}}return Ge.createDecoderResult(M)}static merge(s,a){if(s==null&&a==null)return null;let c=Ge.getBarcodeMetadata(s,a);if(c==null)return null;let d=ac.merge(Ge.adjustBoundingBox(s),Ge.adjustBoundingBox(a));return new _0(c,d)}static adjustBoundingBox(s){if(s==null)return null;let a=s.getRowHeights();if(a==null)return null;let c=Ge.getMax(a),d=0;for(let w of a)if(d+=c-w,w>0)break;let f=s.getCodewords();for(let w=0;d>0&&f[w]==null;w++)d--;let m=0;for(let w=a.length-1;w>=0&&(m+=c-a[w],!(a[w]>0));w--);for(let w=f.length-1;m>0&&f[w]==null;w--)m--;return s.getBoundingBox().addMissingRows(d,m,s.isLeft())}static getMax(s){let a=-1;for(let c of s)a=Math.max(a,c);return a}static getBarcodeMetadata(s,a){let c;if(s==null||(c=s.getBarcodeMetadata())==null)return a==null?null:a.getBarcodeMetadata();let d;return a==null||(d=a.getBarcodeMetadata())==null?c:c.getColumnCount()!==d.getColumnCount()&&c.getErrorCorrectionLevel()!==d.getErrorCorrectionLevel()&&c.getRowCount()!==d.getRowCount()?null:c}static getRowIndicatorColumn(s,a,c,d,f,m){let w=new wS(a,d);for(let A=0;A<2;A++){let b=A===0?1:-1,T=Math.trunc(Math.trunc(c.getX()));for(let M=Math.trunc(Math.trunc(c.getY()));M<=a.getMaxY()&&M>=a.getMinY();M+=b){let L=Ge.detectCodeword(s,0,s.getWidth(),d,T,M,f,m);L!=null&&(w.setCodeword(M,L),d?T=L.getStartX():T=L.getEndX())}}return w}static adjustCodewordCount(s,a){let c=a[0][1],d=c.getValue(),f=s.getBarcodeColumnCount()*s.getBarcodeRowCount()-Ge.getNumberOfECCodeWords(s.getBarcodeECLevel());if(d.length===0){if(f<1||f>Oe.MAX_CODEWORDS_IN_BARCODE)throw $.getNotFoundInstance();c.setValue(f)}else d[0]!==f&&c.setValue(f)}static createDecoderResult(s){let a=Ge.createBarcodeMatrix(s);Ge.adjustCodewordCount(s,a);let c=new Array,d=new Int32Array(s.getBarcodeRowCount()*s.getBarcodeColumnCount()),f=[],m=new Array;for(let A=0;A<s.getBarcodeRowCount();A++)for(let b=0;b<s.getBarcodeColumnCount();b++){let T=a[A][b+1].getValue(),M=A*s.getBarcodeColumnCount()+b;T.length===0?c.push(M):T.length===1?d[M]=T[0]:(m.push(M),f.push(T))}let w=new Array(f.length);for(let A=0;A<w.length;A++)w[A]=f[A];return Ge.createDecoderResultFromAmbiguousValues(s.getBarcodeECLevel(),d,Oe.toIntArray(c),Oe.toIntArray(m),w)}static createDecoderResultFromAmbiguousValues(s,a,c,d,f){let m=new Int32Array(d.length),w=100;for(;w-- >0;){for(let A=0;A<m.length;A++)a[d[A]]=f[A][m[A]];try{return Ge.decodeCodewords(a,s,c)}catch(A){if(!(A instanceof C))throw A}if(m.length===0)throw C.getChecksumInstance();for(let A=0;A<m.length;A++)if(m[A]<f[A].length-1){m[A]++;break}else if(m[A]=0,A===m.length-1)throw C.getChecksumInstance()}throw C.getChecksumInstance()}static createBarcodeMatrix(s){let a=Array.from({length:s.getBarcodeRowCount()},()=>new Array(s.getBarcodeColumnCount()+2));for(let d=0;d<a.length;d++)for(let f=0;f<a[d].length;f++)a[d][f]=new S0;let c=0;for(let d of s.getDetectionResultColumns()){if(d!=null){for(let f of d.getCodewords())if(f!=null){let m=f.getRowNumber();if(m>=0){if(m>=a.length)continue;a[m][c].setValue(f.getValue())}}}c++}return a}static isValidBarcodeColumn(s,a){return a>=0&&a<=s.getBarcodeColumnCount()+1}static getStartColumn(s,a,c,d){let f=d?1:-1,m=null;if(Ge.isValidBarcodeColumn(s,a-f)&&(m=s.getDetectionResultColumn(a-f).getCodeword(c)),m!=null)return d?m.getEndX():m.getStartX();if(m=s.getDetectionResultColumn(a).getCodewordNearby(c),m!=null)return d?m.getStartX():m.getEndX();if(Ge.isValidBarcodeColumn(s,a-f)&&(m=s.getDetectionResultColumn(a-f).getCodewordNearby(c)),m!=null)return d?m.getEndX():m.getStartX();let w=0;for(;Ge.isValidBarcodeColumn(s,a-f);){a-=f;for(let A of s.getDetectionResultColumn(a).getCodewords())if(A!=null)return(d?A.getEndX():A.getStartX())+f*w*(A.getEndX()-A.getStartX());w++}return d?s.getBoundingBox().getMinX():s.getBoundingBox().getMaxX()}static detectCodeword(s,a,c,d,f,m,w,A){f=Ge.adjustCodewordStartColumn(s,a,c,d,f,m);let b=Ge.getModuleBitCount(s,a,c,d,f,m);if(b==null)return null;let T,M=$e.sum(b);if(d)T=f+M;else{for(let G=0;G<b.length/2;G++){let X=b[G];b[G]=b[b.length-1-G],b[b.length-1-G]=X}T=f,f=T-M}if(!Ge.checkCodewordSkew(M,w,A))return null;let L=Fi.getDecodedValue(b),V=Oe.getCodeword(L);return V===-1?null:new T0(f,T,Ge.getCodewordBucketNumber(L),V)}static getModuleBitCount(s,a,c,d,f,m){let w=f,A=new Int32Array(8),b=0,T=d?1:-1,M=d;for(;(d?w<c:w>=a)&&b<A.length;)s.get(w,m)===M?(A[b]++,w+=T):(b++,M=!M);return b===A.length||w===(d?c:a)&&b===A.length-1?A:null}static getNumberOfECCodeWords(s){return 2<<s}static adjustCodewordStartColumn(s,a,c,d,f,m){let w=f,A=d?-1:1;for(let b=0;b<2;b++){for(;(d?w>=a:w<c)&&d===s.get(w,m);){if(Math.abs(f-w)>Ge.CODEWORD_SKEW_SIZE)return f;w+=A}A=-A,d=!d}return w}static checkCodewordSkew(s,a,c){return a-Ge.CODEWORD_SKEW_SIZE<=s&&s<=c+Ge.CODEWORD_SKEW_SIZE}static decodeCodewords(s,a,c){if(s.length===0)throw F.getFormatInstance();let d=1<<a+1,f=Ge.correctErrors(s,c,d);Ge.verifyCodewordCount(s,d);let m=Q.decode(s,""+a);return m.setErrorsCorrected(f),m.setErasures(c.length),m}static correctErrors(s,a,c){if(a!=null&&a.length>c/2+Ge.MAX_ERRORS||c<0||c>Ge.MAX_EC_CODEWORDS)throw C.getChecksumInstance();return Ge.errorCorrection.decode(s,c,a)}static verifyCodewordCount(s,a){if(s.length<4)throw F.getFormatInstance();let c=s[0];if(c>s.length)throw F.getFormatInstance();if(c===0)if(a<s.length)s[0]=s.length-a;else throw F.getFormatInstance()}static getBitCountForCodeword(s){let a=new Int32Array(8),c=0,d=a.length-1;for(;!((s&1)!==c&&(c=s&1,d--,d<0));)a[d]++,s>>=1;return a}static getCodewordBucketNumber(s){return s instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(s):this.getCodewordBucketNumber_number(s)}static getCodewordBucketNumber_number(s){return Ge.getCodewordBucketNumber(Ge.getBitCountForCodeword(s))}static getCodewordBucketNumber_Int32Array(s){return(s[0]-s[2]+s[4]-s[6]+9)%9}static toString(s){let a=new E0;for(let c=0;c<s.length;c++){a.format("Row %2d: ",c);for(let d=0;d<s[c].length;d++){let f=s[c][d];f.getValue().length===0?a.format("        ",null):a.format("%4d(%2d)",f.getValue()[0],f.getConfidence(f.getValue()[0]))}a.format("%n")}return a.toString()}}Ge.CODEWORD_SKEW_SIZE=2,Ge.MAX_ERRORS=3,Ge.MAX_EC_CODEWORDS=512,Ge.errorCorrection=new xS;class Yn{decode(s,a=null){let c=Yn.decode(s,a,!1);if(c==null||c.length===0||c[0]==null)throw $.getNotFoundInstance();return c[0]}decodeMultiple(s,a=null){try{return Yn.decode(s,a,!0)}catch(c){throw c instanceof F||c instanceof C?$.getNotFoundInstance():c}}static decode(s,a,c){const d=new Array,f=We.detectMultiple(s,a,c);for(const m of f.getPoints()){const w=Ge.decode(f.getBits(),m[4],m[5],m[6],m[7],Yn.getMinCodewordWidth(m),Yn.getMaxCodewordWidth(m)),A=new Le(w.getText(),w.getRawBytes(),void 0,m,xe.PDF_417);A.putMetadata(st.ERROR_CORRECTION_LEVEL,w.getECLevel());const b=w.getOther();b!=null&&A.putMetadata(st.PDF417_EXTRA_METADATA,b),d.push(A)}return d.map(m=>m)}static getMaxWidth(s,a){return s==null||a==null?0:Math.trunc(Math.abs(s.getX()-a.getX()))}static getMinWidth(s,a){return s==null||a==null?k.MAX_VALUE:Math.trunc(Math.abs(s.getX()-a.getX()))}static getMaxCodewordWidth(s){return Math.floor(Math.max(Math.max(Yn.getMaxWidth(s[0],s[4]),Yn.getMaxWidth(s[6],s[2])*Oe.MODULES_IN_CODEWORD/Oe.MODULES_IN_STOP_PATTERN),Math.max(Yn.getMaxWidth(s[1],s[5]),Yn.getMaxWidth(s[7],s[3])*Oe.MODULES_IN_CODEWORD/Oe.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(s){return Math.floor(Math.min(Math.min(Yn.getMinWidth(s[0],s[4]),Yn.getMinWidth(s[6],s[2])*Oe.MODULES_IN_CODEWORD/Oe.MODULES_IN_STOP_PATTERN),Math.min(Yn.getMinWidth(s[1],s[5]),Yn.getMinWidth(s[7],s[3])*Oe.MODULES_IN_CODEWORD/Oe.MODULES_IN_STOP_PATTERN)))}reset(){}}class Wm extends p{}Wm.kind="ReaderException";class ES{constructor(s,a){this.verbose=s===!0,a&&this.setHints(a)}decode(s,a){return a&&this.setHints(a),this.decodeInternal(s)}decodeWithState(s){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(s)}setHints(s){this.hints=s;const a=!i(s)&&s.get(H.TRY_HARDER)===!0,c=i(s)?null:s.get(H.POSSIBLE_FORMATS),d=new Array;if(!i(c)){const f=c.some(m=>m===xe.UPC_A||m===xe.UPC_E||m===xe.EAN_13||m===xe.EAN_8||m===xe.CODABAR||m===xe.CODE_39||m===xe.CODE_93||m===xe.CODE_128||m===xe.ITF||m===xe.RSS_14||m===xe.RSS_EXPANDED);f&&!a&&d.push(new mh(s,this.verbose)),c.includes(xe.QR_CODE)&&d.push(new Ia),c.includes(xe.DATA_MATRIX)&&d.push(new Ta),c.includes(xe.AZTEC)&&d.push(new oi),c.includes(xe.PDF_417)&&d.push(new Yn),f&&a&&d.push(new mh(s,this.verbose))}d.length===0&&(a||d.push(new mh(s,this.verbose)),d.push(new Ia),d.push(new Ta),d.push(new oi),d.push(new Yn),a&&d.push(new mh(s,this.verbose))),this.readers=d}reset(){if(this.readers!==null)for(const s of this.readers)s.reset()}decodeInternal(s){if(this.readers===null)throw new Wm("No readers where selected, nothing can be read.");for(const a of this.readers)try{return a.decode(s,this.hints)}catch(c){if(c instanceof Wm)continue}throw new $("No MultiFormat Readers were able to detect the code.")}}class aR extends me{constructor(s=null,a=500){const c=new ES;c.setHints(s),super(c,a)}decodeBitmap(s){return this.reader.decodeWithState(s)}}class lR extends me{constructor(s=500){super(new Yn,s)}}class cR extends me{constructor(s=500){super(new Ia,s)}}var TA;(function(D){D[D.ERROR_CORRECTION=0]="ERROR_CORRECTION",D[D.CHARACTER_SET=1]="CHARACTER_SET",D[D.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",D[D.MIN_SIZE=3]="MIN_SIZE",D[D.MAX_SIZE=4]="MAX_SIZE",D[D.MARGIN=5]="MARGIN",D[D.PDF417_COMPACT=6]="PDF417_COMPACT",D[D.PDF417_COMPACTION=7]="PDF417_COMPACTION",D[D.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",D[D.AZTEC_LAYERS=9]="AZTEC_LAYERS",D[D.QR_VERSION=10]="QR_VERSION"})(TA||(TA={}));var _n=TA;class IA{constructor(s){this.field=s,this.cachedGenerators=[],this.cachedGenerators.push(new De(s,Int32Array.from([1])))}buildGenerator(s){const a=this.cachedGenerators;if(s>=a.length){let c=a[a.length-1];const d=this.field;for(let f=a.length;f<=s;f++){const m=c.multiply(new De(d,Int32Array.from([1,d.exp(f-1+d.getGeneratorBase())])));a.push(m),c=m}}return a[s]}encode(s,a){if(a===0)throw new y("No error correction bytes");const c=s.length-a;if(c<=0)throw new y("No data bytes provided");const d=this.buildGenerator(a),f=new Int32Array(c);I.arraycopy(s,0,f,0,c);let m=new De(this.field,f);m=m.multiplyByMonomial(a,1);const A=m.divide(d)[1].getCoefficients(),b=a-A.length;for(let T=0;T<b;T++)s[c+T]=0;I.arraycopy(A,0,s,c+b,A.length)}}class sn{constructor(){}static applyMaskPenaltyRule1(s){return sn.applyMaskPenaltyRule1Internal(s,!0)+sn.applyMaskPenaltyRule1Internal(s,!1)}static applyMaskPenaltyRule2(s){let a=0;const c=s.getArray(),d=s.getWidth(),f=s.getHeight();for(let m=0;m<f-1;m++){const w=c[m];for(let A=0;A<d-1;A++){const b=w[A];b===w[A+1]&&b===c[m+1][A]&&b===c[m+1][A+1]&&a++}}return sn.N2*a}static applyMaskPenaltyRule3(s){let a=0;const c=s.getArray(),d=s.getWidth(),f=s.getHeight();for(let m=0;m<f;m++)for(let w=0;w<d;w++){const A=c[m];w+6<d&&A[w]===1&&A[w+1]===0&&A[w+2]===1&&A[w+3]===1&&A[w+4]===1&&A[w+5]===0&&A[w+6]===1&&(sn.isWhiteHorizontal(A,w-4,w)||sn.isWhiteHorizontal(A,w+7,w+11))&&a++,m+6<f&&c[m][w]===1&&c[m+1][w]===0&&c[m+2][w]===1&&c[m+3][w]===1&&c[m+4][w]===1&&c[m+5][w]===0&&c[m+6][w]===1&&(sn.isWhiteVertical(c,w,m-4,m)||sn.isWhiteVertical(c,w,m+7,m+11))&&a++}return a*sn.N3}static isWhiteHorizontal(s,a,c){a=Math.max(a,0),c=Math.min(c,s.length);for(let d=a;d<c;d++)if(s[d]===1)return!1;return!0}static isWhiteVertical(s,a,c,d){c=Math.max(c,0),d=Math.min(d,s.length);for(let f=c;f<d;f++)if(s[f][a]===1)return!1;return!0}static applyMaskPenaltyRule4(s){let a=0;const c=s.getArray(),d=s.getWidth(),f=s.getHeight();for(let A=0;A<f;A++){const b=c[A];for(let T=0;T<d;T++)b[T]===1&&a++}const m=s.getHeight()*s.getWidth();return Math.floor(Math.abs(a*2-m)*10/m)*sn.N4}static getDataMaskBit(s,a,c){let d,f;switch(s){case 0:d=c+a&1;break;case 1:d=c&1;break;case 2:d=a%3;break;case 3:d=(c+a)%3;break;case 4:d=Math.floor(c/2)+Math.floor(a/3)&1;break;case 5:f=c*a,d=(f&1)+f%3;break;case 6:f=c*a,d=(f&1)+f%3&1;break;case 7:f=c*a,d=f%3+(c+a&1)&1;break;default:throw new y("Invalid mask pattern: "+s)}return d===0}static applyMaskPenaltyRule1Internal(s,a){let c=0;const d=a?s.getHeight():s.getWidth(),f=a?s.getWidth():s.getHeight(),m=s.getArray();for(let w=0;w<d;w++){let A=0,b=-1;for(let T=0;T<f;T++){const M=a?m[w][T]:m[T][w];M===b?A++:(A>=5&&(c+=sn.N1+(A-5)),A=1,b=M)}A>=5&&(c+=sn.N1+(A-5))}return c}}sn.N1=3,sn.N2=3,sn.N3=40,sn.N4=10;class Gm{constructor(s,a){this.width=s,this.height=a;const c=new Array(a);for(let d=0;d!==a;d++)c[d]=new Uint8Array(s);this.bytes=c}getHeight(){return this.height}getWidth(){return this.width}get(s,a){return this.bytes[a][s]}getArray(){return this.bytes}setNumber(s,a,c){this.bytes[a][s]=c}setBoolean(s,a,c){this.bytes[a][s]=c?1:0}clear(s){for(const a of this.bytes)N.fill(a,s)}equals(s){if(!(s instanceof Gm))return!1;const a=s;if(this.width!==a.width||this.height!==a.height)return!1;for(let c=0,d=this.height;c<d;++c){const f=this.bytes[c],m=a.bytes[c];for(let w=0,A=this.width;w<A;++w)if(f[w]!==m[w])return!1}return!0}toString(){const s=new le;for(let a=0,c=this.height;a<c;++a){const d=this.bytes[a];for(let f=0,m=this.width;f<m;++f)switch(d[f]){case 0:s.append(" 0");break;case 1:s.append(" 1");break;default:s.append("  ");break}s.append(`
`)}return s.toString()}}class lc{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const s=new le;return s.append(`<<
`),s.append(" mode: "),s.append(this.mode?this.mode.toString():"null"),s.append(`
 ecLevel: `),s.append(this.ecLevel?this.ecLevel.toString():"null"),s.append(`
 version: `),s.append(this.version?this.version.toString():"null"),s.append(`
 maskPattern: `),s.append(this.maskPattern.toString()),this.matrix?(s.append(`
 matrix:
`),s.append(this.matrix.toString())):s.append(`
 matrix: null
`),s.append(`>>
`),s.toString()}setMode(s){this.mode=s}setECLevel(s){this.ecLevel=s}setVersion(s){this.version=s}setMaskPattern(s){this.maskPattern=s}setMatrix(s){this.matrix=s}static isValidMaskPattern(s){return s>=0&&s<lc.NUM_MASK_PATTERNS}}lc.NUM_MASK_PATTERNS=8;class Et extends p{}Et.kind="WriterException";class Pe{constructor(){}static clearMatrix(s){s.clear(255)}static buildMatrix(s,a,c,d,f){Pe.clearMatrix(f),Pe.embedBasicPatterns(c,f),Pe.embedTypeInfo(a,d,f),Pe.maybeEmbedVersionInfo(c,f),Pe.embedDataBits(s,d,f)}static embedBasicPatterns(s,a){Pe.embedPositionDetectionPatternsAndSeparators(a),Pe.embedDarkDotAtLeftBottomCorner(a),Pe.maybeEmbedPositionAdjustmentPatterns(s,a),Pe.embedTimingPatterns(a)}static embedTypeInfo(s,a,c){const d=new B;Pe.makeTypeInfoBits(s,a,d);for(let f=0,m=d.getSize();f<m;++f){const w=d.get(d.getSize()-1-f),A=Pe.TYPE_INFO_COORDINATES[f],b=A[0],T=A[1];if(c.setBoolean(b,T,w),f<8){const M=c.getWidth()-f-1,L=8;c.setBoolean(M,L,w)}else{const L=c.getHeight()-7+(f-8);c.setBoolean(8,L,w)}}}static maybeEmbedVersionInfo(s,a){if(s.getVersionNumber()<7)return;const c=new B;Pe.makeVersionInfoBits(s,c);let d=6*3-1;for(let f=0;f<6;++f)for(let m=0;m<3;++m){const w=c.get(d);d--,a.setBoolean(f,a.getHeight()-11+m,w),a.setBoolean(a.getHeight()-11+m,f,w)}}static embedDataBits(s,a,c){let d=0,f=-1,m=c.getWidth()-1,w=c.getHeight()-1;for(;m>0;){for(m===6&&(m-=1);w>=0&&w<c.getHeight();){for(let A=0;A<2;++A){const b=m-A;if(!Pe.isEmpty(c.get(b,w)))continue;let T;d<s.getSize()?(T=s.get(d),++d):T=!1,a!==255&&sn.getDataMaskBit(a,b,w)&&(T=!T),c.setBoolean(b,w,T)}w+=f}f=-f,w+=f,m-=2}if(d!==s.getSize())throw new Et("Not all bits consumed: "+d+"/"+s.getSize())}static findMSBSet(s){return 32-k.numberOfLeadingZeros(s)}static calculateBCHCode(s,a){if(a===0)throw new y("0 polynomial");const c=Pe.findMSBSet(a);for(s<<=c-1;Pe.findMSBSet(s)>=c;)s^=a<<Pe.findMSBSet(s)-c;return s}static makeTypeInfoBits(s,a,c){if(!lc.isValidMaskPattern(a))throw new Et("Invalid mask pattern");const d=s.getBits()<<3|a;c.appendBits(d,5);const f=Pe.calculateBCHCode(d,Pe.TYPE_INFO_POLY);c.appendBits(f,10);const m=new B;if(m.appendBits(Pe.TYPE_INFO_MASK_PATTERN,15),c.xor(m),c.getSize()!==15)throw new Et("should not happen but we got: "+c.getSize())}static makeVersionInfoBits(s,a){a.appendBits(s.getVersionNumber(),6);const c=Pe.calculateBCHCode(s.getVersionNumber(),Pe.VERSION_INFO_POLY);if(a.appendBits(c,12),a.getSize()!==18)throw new Et("should not happen but we got: "+a.getSize())}static isEmpty(s){return s===255}static embedTimingPatterns(s){for(let a=8;a<s.getWidth()-8;++a){const c=(a+1)%2;Pe.isEmpty(s.get(a,6))&&s.setNumber(a,6,c),Pe.isEmpty(s.get(6,a))&&s.setNumber(6,a,c)}}static embedDarkDotAtLeftBottomCorner(s){if(s.get(8,s.getHeight()-8)===0)throw new Et;s.setNumber(8,s.getHeight()-8,1)}static embedHorizontalSeparationPattern(s,a,c){for(let d=0;d<8;++d){if(!Pe.isEmpty(c.get(s+d,a)))throw new Et;c.setNumber(s+d,a,0)}}static embedVerticalSeparationPattern(s,a,c){for(let d=0;d<7;++d){if(!Pe.isEmpty(c.get(s,a+d)))throw new Et;c.setNumber(s,a+d,0)}}static embedPositionAdjustmentPattern(s,a,c){for(let d=0;d<5;++d){const f=Pe.POSITION_ADJUSTMENT_PATTERN[d];for(let m=0;m<5;++m)c.setNumber(s+m,a+d,f[m])}}static embedPositionDetectionPattern(s,a,c){for(let d=0;d<7;++d){const f=Pe.POSITION_DETECTION_PATTERN[d];for(let m=0;m<7;++m)c.setNumber(s+m,a+d,f[m])}}static embedPositionDetectionPatternsAndSeparators(s){const a=Pe.POSITION_DETECTION_PATTERN[0].length;Pe.embedPositionDetectionPattern(0,0,s),Pe.embedPositionDetectionPattern(s.getWidth()-a,0,s),Pe.embedPositionDetectionPattern(0,s.getWidth()-a,s);const c=8;Pe.embedHorizontalSeparationPattern(0,c-1,s),Pe.embedHorizontalSeparationPattern(s.getWidth()-c,c-1,s),Pe.embedHorizontalSeparationPattern(0,s.getWidth()-c,s);const d=7;Pe.embedVerticalSeparationPattern(d,0,s),Pe.embedVerticalSeparationPattern(s.getHeight()-d-1,0,s),Pe.embedVerticalSeparationPattern(d,s.getHeight()-d,s)}static maybeEmbedPositionAdjustmentPatterns(s,a){if(s.getVersionNumber()<2)return;const c=s.getVersionNumber()-1,d=Pe.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[c];for(let f=0,m=d.length;f!==m;f++){const w=d[f];if(w>=0)for(let A=0;A!==m;A++){const b=d[A];b>=0&&Pe.isEmpty(a.get(b,w))&&Pe.embedPositionAdjustmentPattern(b-2,w-2,a)}}}}Pe.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),Pe.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),Pe.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),Pe.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),Pe.VERSION_INFO_POLY=7973,Pe.TYPE_INFO_POLY=1335,Pe.TYPE_INFO_MASK_PATTERN=21522;class uR{constructor(s,a){this.dataBytes=s,this.errorCorrectionBytes=a}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Ot{constructor(){}static calculateMaskPenalty(s){return sn.applyMaskPenaltyRule1(s)+sn.applyMaskPenaltyRule2(s)+sn.applyMaskPenaltyRule3(s)+sn.applyMaskPenaltyRule4(s)}static encode(s,a,c=null){let d=Ot.DEFAULT_BYTE_MODE_ENCODING;const f=c!==null&&c.get(_n.CHARACTER_SET)!==void 0;f&&(d=c.get(_n.CHARACTER_SET).toString());const m=this.chooseMode(s,d),w=new B;if(m===Re.BYTE&&(f||Ot.DEFAULT_BYTE_MODE_ENCODING!==d)){const fe=W.getCharacterSetECIByName(d);fe!==void 0&&this.appendECI(fe,w)}this.appendModeInfo(m,w);const A=new B;this.appendBytes(s,m,A,d);let b;if(c!==null&&c.get(_n.QR_VERSION)!==void 0){const fe=Number.parseInt(c.get(_n.QR_VERSION).toString(),10);b=Ne.getVersionForNumber(fe);const ae=this.calculateBitsNeeded(m,w,A,b);if(!this.willFit(ae,b,a))throw new Et("Data too big for requested version")}else b=this.recommendVersion(a,m,w,A);const T=new B;T.appendBitArray(w);const M=m===Re.BYTE?A.getSizeInBytes():s.length;this.appendLengthInfo(M,b,m,T),T.appendBitArray(A);const L=b.getECBlocksForLevel(a),V=b.getTotalCodewords()-L.getTotalECCodewords();this.terminateBits(V,T);const G=this.interleaveWithECBytes(T,b.getTotalCodewords(),V,L.getNumBlocks()),X=new lc;X.setECLevel(a),X.setMode(m),X.setVersion(b);const K=b.getDimensionForVersion(),J=new Gm(K,K),de=this.chooseMaskPattern(G,a,b,J);return X.setMaskPattern(de),Pe.buildMatrix(G,a,b,de,J),X.setMatrix(J),X}static recommendVersion(s,a,c,d){const f=this.calculateBitsNeeded(a,c,d,Ne.getVersionForNumber(1)),m=this.chooseVersion(f,s),w=this.calculateBitsNeeded(a,c,d,m);return this.chooseVersion(w,s)}static calculateBitsNeeded(s,a,c,d){return a.getSize()+s.getCharacterCountBits(d)+c.getSize()}static getAlphanumericCode(s){return s<Ot.ALPHANUMERIC_TABLE.length?Ot.ALPHANUMERIC_TABLE[s]:-1}static chooseMode(s,a=null){if(W.SJIS.getName()===a&&this.isOnlyDoubleByteKanji(s))return Re.KANJI;let c=!1,d=!1;for(let f=0,m=s.length;f<m;++f){const w=s.charAt(f);if(Ot.isDigit(w))c=!0;else if(this.getAlphanumericCode(w.charCodeAt(0))!==-1)d=!0;else return Re.BYTE}return d?Re.ALPHANUMERIC:c?Re.NUMERIC:Re.BYTE}static isOnlyDoubleByteKanji(s){let a;try{a=te.encode(s,W.SJIS)}catch{return!1}const c=a.length;if(c%2!==0)return!1;for(let d=0;d<c;d+=2){const f=a[d]&255;if((f<129||f>159)&&(f<224||f>235))return!1}return!0}static chooseMaskPattern(s,a,c,d){let f=Number.MAX_SAFE_INTEGER,m=-1;for(let w=0;w<lc.NUM_MASK_PATTERNS;w++){Pe.buildMatrix(s,a,c,w,d);let A=this.calculateMaskPenalty(d);A<f&&(f=A,m=w)}return m}static chooseVersion(s,a){for(let c=1;c<=40;c++){const d=Ne.getVersionForNumber(c);if(Ot.willFit(s,d,a))return d}throw new Et("Data too big")}static willFit(s,a,c){const d=a.getTotalCodewords(),m=a.getECBlocksForLevel(c).getTotalECCodewords(),w=d-m,A=(s+7)/8;return w>=A}static terminateBits(s,a){const c=s*8;if(a.getSize()>c)throw new Et("data bits cannot fit in the QR Code"+a.getSize()+" > "+c);for(let m=0;m<4&&a.getSize()<c;++m)a.appendBit(!1);const d=a.getSize()&7;if(d>0)for(let m=d;m<8;m++)a.appendBit(!1);const f=s-a.getSizeInBytes();for(let m=0;m<f;++m)a.appendBits(m&1?17:236,8);if(a.getSize()!==c)throw new Et("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(s,a,c,d,f,m){if(d>=c)throw new Et("Block ID too large");const w=s%c,A=c-w,b=Math.floor(s/c),T=b+1,M=Math.floor(a/c),L=M+1,V=b-M,G=T-L;if(V!==G)throw new Et("EC bytes mismatch");if(c!==A+w)throw new Et("RS blocks mismatch");if(s!==(M+V)*A+(L+G)*w)throw new Et("Total bytes mismatch");d<A?(f[0]=M,m[0]=V):(f[0]=L,m[0]=G)}static interleaveWithECBytes(s,a,c,d){if(s.getSizeInBytes()!==c)throw new Et("Number of bits and data bytes does not match");let f=0,m=0,w=0;const A=new Array;for(let T=0;T<d;++T){const M=new Int32Array(1),L=new Int32Array(1);Ot.getNumDataBytesAndNumECBytesForBlockID(a,c,d,T,M,L);const V=M[0],G=new Uint8Array(V);s.toBytes(8*f,G,0,V);const X=Ot.generateECBytes(G,L[0]);A.push(new uR(G,X)),m=Math.max(m,V),w=Math.max(w,X.length),f+=M[0]}if(c!==f)throw new Et("Data bytes does not match offset");const b=new B;for(let T=0;T<m;++T)for(const M of A){const L=M.getDataBytes();T<L.length&&b.appendBits(L[T],8)}for(let T=0;T<w;++T)for(const M of A){const L=M.getErrorCorrectionBytes();T<L.length&&b.appendBits(L[T],8)}if(a!==b.getSizeInBytes())throw new Et("Interleaving error: "+a+" and "+b.getSizeInBytes()+" differ.");return b}static generateECBytes(s,a){const c=s.length,d=new Int32Array(c+a);for(let m=0;m<c;m++)d[m]=s[m]&255;new IA(Te.QR_CODE_FIELD_256).encode(d,a);const f=new Uint8Array(a);for(let m=0;m<a;m++)f[m]=d[c+m];return f}static appendModeInfo(s,a){a.appendBits(s.getBits(),4)}static appendLengthInfo(s,a,c,d){const f=c.getCharacterCountBits(a);if(s>=1<<f)throw new Et(s+" is bigger than "+((1<<f)-1));d.appendBits(s,f)}static appendBytes(s,a,c,d){switch(a){case Re.NUMERIC:Ot.appendNumericBytes(s,c);break;case Re.ALPHANUMERIC:Ot.appendAlphanumericBytes(s,c);break;case Re.BYTE:Ot.append8BitBytes(s,c,d);break;case Re.KANJI:Ot.appendKanjiBytes(s,c);break;default:throw new Et("Invalid mode: "+a)}}static getDigit(s){return s.charCodeAt(0)-48}static isDigit(s){const a=Ot.getDigit(s);return a>=0&&a<=9}static appendNumericBytes(s,a){const c=s.length;let d=0;for(;d<c;){const f=Ot.getDigit(s.charAt(d));if(d+2<c){const m=Ot.getDigit(s.charAt(d+1)),w=Ot.getDigit(s.charAt(d+2));a.appendBits(f*100+m*10+w,10),d+=3}else if(d+1<c){const m=Ot.getDigit(s.charAt(d+1));a.appendBits(f*10+m,7),d+=2}else a.appendBits(f,4),d++}}static appendAlphanumericBytes(s,a){const c=s.length;let d=0;for(;d<c;){const f=Ot.getAlphanumericCode(s.charCodeAt(d));if(f===-1)throw new Et;if(d+1<c){const m=Ot.getAlphanumericCode(s.charCodeAt(d+1));if(m===-1)throw new Et;a.appendBits(f*45+m,11),d+=2}else a.appendBits(f,6),d++}}static append8BitBytes(s,a,c){let d;try{d=te.encode(s,c)}catch(f){throw new Et(f)}for(let f=0,m=d.length;f!==m;f++){const w=d[f];a.appendBits(w,8)}}static appendKanjiBytes(s,a){let c;try{c=te.encode(s,W.SJIS)}catch(f){throw new Et(f)}const d=c.length;for(let f=0;f<d;f+=2){const m=c[f]&255,w=c[f+1]&255,A=m<<8&4294967295|w;let b=-1;if(A>=33088&&A<=40956?b=A-33088:A>=57408&&A<=60351&&(b=A-49472),b===-1)throw new Et("Invalid byte sequence");const T=(b>>8)*192+(b&255);a.appendBits(T,13)}}static appendECI(s,a){a.appendBits(Re.ECI.getBits(),4),a.appendBits(s.getValue(),8)}}Ot.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Ot.DEFAULT_BYTE_MODE_ENCODING=W.UTF8.getName();class cc{write(s,a,c,d=null){if(s.length===0)throw new y("Found empty contents");if(a<0||c<0)throw new y("Requested dimensions are too small: "+a+"x"+c);let f=Nt.L,m=cc.QUIET_ZONE_SIZE;d!==null&&(d.get(_n.ERROR_CORRECTION)!==void 0&&(f=Nt.fromString(d.get(_n.ERROR_CORRECTION).toString())),d.get(_n.MARGIN)!==void 0&&(m=Number.parseInt(d.get(_n.MARGIN).toString(),10)));const w=Ot.encode(s,f,d);return this.renderResult(w,a,c,m)}writeToDom(s,a,c,d,f=null){typeof s=="string"&&(s=document.querySelector(s));const m=this.write(a,c,d,f);s&&s.appendChild(m)}renderResult(s,a,c,d){const f=s.getMatrix();if(f===null)throw new rt;const m=f.getWidth(),w=f.getHeight(),A=m+d*2,b=w+d*2,T=Math.max(a,A),M=Math.max(c,b),L=Math.min(Math.floor(T/A),Math.floor(M/b)),V=Math.floor((T-m*L)/2),G=Math.floor((M-w*L)/2),X=this.createSVGElement(T,M);for(let K=0,J=G;K<w;K++,J+=L)for(let de=0,fe=V;de<m;de++,fe+=L)if(f.get(de,K)===1){const ae=this.createSvgRectElement(fe,J,L,L);X.appendChild(ae)}return X}createSVGElement(s,a){const c=document.createElementNS(cc.SVG_NS,"svg");return c.setAttributeNS(null,"height",s.toString()),c.setAttributeNS(null,"width",a.toString()),c}createSvgRectElement(s,a,c,d){const f=document.createElementNS(cc.SVG_NS,"rect");return f.setAttributeNS(null,"x",s.toString()),f.setAttributeNS(null,"y",a.toString()),f.setAttributeNS(null,"height",c.toString()),f.setAttributeNS(null,"width",d.toString()),f.setAttributeNS(null,"fill","#000000"),f}}cc.QUIET_ZONE_SIZE=4,cc.SVG_NS="http://www.w3.org/2000/svg";class wh{encode(s,a,c,d,f){if(s.length===0)throw new y("Found empty contents");if(a!==xe.QR_CODE)throw new y("Can only encode QR_CODE, but got "+a);if(c<0||d<0)throw new y(`Requested dimensions are too small: ${c}x${d}`);let m=Nt.L,w=wh.QUIET_ZONE_SIZE;f!==null&&(f.get(_n.ERROR_CORRECTION)!==void 0&&(m=Nt.fromString(f.get(_n.ERROR_CORRECTION).toString())),f.get(_n.MARGIN)!==void 0&&(w=Number.parseInt(f.get(_n.MARGIN).toString(),10)));const A=Ot.encode(s,m,f);return wh.renderResult(A,c,d,w)}static renderResult(s,a,c,d){const f=s.getMatrix();if(f===null)throw new rt;const m=f.getWidth(),w=f.getHeight(),A=m+d*2,b=w+d*2,T=Math.max(a,A),M=Math.max(c,b),L=Math.min(Math.floor(T/A),Math.floor(M/b)),V=Math.floor((T-m*L)/2),G=Math.floor((M-w*L)/2),X=new ce(T,M);for(let K=0,J=G;K<w;K++,J+=L)for(let de=0,fe=V;de<m;de++,fe+=L)f.get(de,K)===1&&X.setRegion(fe,J,L,L);return X}}wh.QUIET_ZONE_SIZE=4;class hR{encode(s,a,c,d,f){let m;switch(a){case xe.QR_CODE:m=new wh;break;default:throw new y("No encoder available for format "+a)}return m.encode(s,a,c,d,f)}}class Us extends ie{constructor(s,a,c,d,f,m,w,A){if(super(m,w),this.yuvData=s,this.dataWidth=a,this.dataHeight=c,this.left=d,this.top=f,d+m>a||f+w>c)throw new y("Crop rectangle does not fit within image data.");A&&this.reverseHorizontal(m,w)}getRow(s,a){if(s<0||s>=this.getHeight())throw new y("Requested row is outside the image: "+s);const c=this.getWidth();(a==null||a.length<c)&&(a=new Uint8ClampedArray(c));const d=(s+this.top)*this.dataWidth+this.left;return I.arraycopy(this.yuvData,d,a,0,c),a}getMatrix(){const s=this.getWidth(),a=this.getHeight();if(s===this.dataWidth&&a===this.dataHeight)return this.yuvData;const c=s*a,d=new Uint8ClampedArray(c);let f=this.top*this.dataWidth+this.left;if(s===this.dataWidth)return I.arraycopy(this.yuvData,f,d,0,c),d;for(let m=0;m<a;m++){const w=m*s;I.arraycopy(this.yuvData,f,d,w,s),f+=this.dataWidth}return d}isCropSupported(){return!0}crop(s,a,c,d){return new Us(this.yuvData,this.dataWidth,this.dataHeight,this.left+s,this.top+a,c,d,!1)}renderThumbnail(){const s=this.getWidth()/Us.THUMBNAIL_SCALE_FACTOR,a=this.getHeight()/Us.THUMBNAIL_SCALE_FACTOR,c=new Int32Array(s*a),d=this.yuvData;let f=this.top*this.dataWidth+this.left;for(let m=0;m<a;m++){const w=m*s;for(let A=0;A<s;A++){const b=d[f+A*Us.THUMBNAIL_SCALE_FACTOR]&255;c[w+A]=4278190080|b*65793}f+=this.dataWidth*Us.THUMBNAIL_SCALE_FACTOR}return c}getThumbnailWidth(){return this.getWidth()/Us.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Us.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(s,a){const c=this.yuvData;for(let d=0,f=this.top*this.dataWidth+this.left;d<a;d++,f+=this.dataWidth){const m=f+s/2;for(let w=f,A=f+s-1;w<m;w++,A--){const b=c[w];c[w]=c[A],c[A]=b}}}invert(){return new ge(this)}}Us.THUMBNAIL_SCALE_FACTOR=2;class NA extends ie{constructor(s,a,c,d,f,m,w){if(super(a,c),this.dataWidth=d,this.dataHeight=f,this.left=m,this.top=w,s.BYTES_PER_ELEMENT===4){const A=a*c,b=new Uint8ClampedArray(A);for(let T=0;T<A;T++){const M=s[T],L=M>>16&255,V=M>>7&510,G=M&255;b[T]=(L+V+G)/4&255}this.luminances=b}else this.luminances=s;if(d===void 0&&(this.dataWidth=a),f===void 0&&(this.dataHeight=c),m===void 0&&(this.left=0),w===void 0&&(this.top=0),this.left+a>this.dataWidth||this.top+c>this.dataHeight)throw new y("Crop rectangle does not fit within image data.")}getRow(s,a){if(s<0||s>=this.getHeight())throw new y("Requested row is outside the image: "+s);const c=this.getWidth();(a==null||a.length<c)&&(a=new Uint8ClampedArray(c));const d=(s+this.top)*this.dataWidth+this.left;return I.arraycopy(this.luminances,d,a,0,c),a}getMatrix(){const s=this.getWidth(),a=this.getHeight();if(s===this.dataWidth&&a===this.dataHeight)return this.luminances;const c=s*a,d=new Uint8ClampedArray(c);let f=this.top*this.dataWidth+this.left;if(s===this.dataWidth)return I.arraycopy(this.luminances,f,d,0,c),d;for(let m=0;m<a;m++){const w=m*s;I.arraycopy(this.luminances,f,d,w,s),f+=this.dataWidth}return d}isCropSupported(){return!0}crop(s,a,c,d){return new NA(this.luminances,c,d,this.dataWidth,this.dataHeight,this.left+s,this.top+a)}invert(){return new ge(this)}}class CS extends W{static forName(s){return this.getCharacterSetECIByName(s)}}class RA{}RA.ISO_8859_1=W.ISO8859_1;class SS{isCompact(){return this.compact}setCompact(s){this.compact=s}getSize(){return this.size}setSize(s){this.size=s}getLayers(){return this.layers}setLayers(s){this.layers=s}getCodeWords(){return this.codeWords}setCodeWords(s){this.codeWords=s}getMatrix(){return this.matrix}setMatrix(s){this.matrix=s}}class _S{static singletonList(s){return[s]}static min(s,a){return s.sort(a)[0]}}class dR{constructor(s){this.previous=s}getPrevious(){return this.previous}}class yh extends dR{constructor(s,a,c){super(s),this.value=a,this.bitCount=c}appendTo(s,a){s.appendBits(this.value,this.bitCount)}add(s,a){return new yh(this,s,a)}addBinaryShift(s,a){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new yh(this,s,a)}toString(){let s=this.value&(1<<this.bitCount)-1;return s|=1<<this.bitCount,"<"+k.toBinaryString(s|1<<this.bitCount).substring(1)+">"}}class kA extends yh{constructor(s,a,c){super(s,0,0),this.binaryShiftStart=a,this.binaryShiftByteCount=c}appendTo(s,a){for(let c=0;c<this.binaryShiftByteCount;c++)(c===0||c===31&&this.binaryShiftByteCount<=62)&&(s.appendBits(31,5),this.binaryShiftByteCount>62?s.appendBits(this.binaryShiftByteCount-31,16):c===0?s.appendBits(Math.min(this.binaryShiftByteCount,31),5):s.appendBits(this.binaryShiftByteCount-31,5)),s.appendBits(a[this.binaryShiftStart+c],8)}addBinaryShift(s,a){return new kA(this,s,a)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function fR(D,s,a){return new kA(D,s,a)}function I0(D,s,a){return new yh(D,s,a)}const gR=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Ra=0,Xm=1,Br=2,TS=3,js=4,pR=new yh(null,0,0),PA=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,655360+928+30]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,655360+928+30]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,917504+14336+928+30]),Int32Array.from([(5<<16)+29,(5<<16)+28,655360+928+30,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,655360+992+28,655360+992+30,655360+992+29,0])];function mR(D){for(let s of D)N.fill(s,-1);return D[Ra][js]=0,D[Xm][js]=0,D[Xm][Ra]=28,D[TS][js]=0,D[Br][js]=0,D[Br][Ra]=15,D}const IS=mR(N.createInt32Array(6,6));class zs{constructor(s,a,c,d){this.token=s,this.mode=a,this.binaryShiftByteCount=c,this.bitCount=d}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(s,a){let c=this.bitCount,d=this.token;if(s!==this.mode){let m=PA[this.mode][s];d=I0(d,m&65535,m>>16),c+=m>>16}let f=s===Br?4:5;return d=I0(d,a,f),new zs(d,s,0,c+f)}shiftAndAppend(s,a){let c=this.token,d=this.mode===Br?4:5;return c=I0(c,IS[this.mode][s],d),c=I0(c,a,5),new zs(c,this.mode,0,this.bitCount+d+5)}addBinaryShiftChar(s){let a=this.token,c=this.mode,d=this.bitCount;if(this.mode===js||this.mode===Br){let w=PA[c][Ra];a=I0(a,w&65535,w>>16),d+=w>>16,c=Ra}let f=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,m=new zs(a,c,this.binaryShiftByteCount+1,d+f);return m.binaryShiftByteCount===2047+31&&(m=m.endBinaryShift(s+1)),m}endBinaryShift(s){if(this.binaryShiftByteCount===0)return this;let a=this.token;return a=fR(a,s-this.binaryShiftByteCount,this.binaryShiftByteCount),new zs(a,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(s){let a=this.bitCount+(PA[this.mode][s.mode]>>16);return this.binaryShiftByteCount<s.binaryShiftByteCount?a+=zs.calculateBinaryShiftCost(s)-zs.calculateBinaryShiftCost(this):this.binaryShiftByteCount>s.binaryShiftByteCount&&s.binaryShiftByteCount>0&&(a+=10),a<=s.bitCount}toBitArray(s){let a=[];for(let d=this.endBinaryShift(s.length).token;d!==null;d=d.getPrevious())a.unshift(d);let c=new B;for(const d of a)d.appendTo(c,s);return c}toString(){return ee.format("%s bits=%d bytes=%d",gR[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(s){return s.binaryShiftByteCount>62?21:s.binaryShiftByteCount>31?20:s.binaryShiftByteCount>0?10:0}}zs.INITIAL_STATE=new zs(pR,Ra,0,0);function xR(D){const s=ee.getCharCode(" "),a=ee.getCharCode("."),c=ee.getCharCode(",");D[Ra][s]=1;const d=ee.getCharCode("Z"),f=ee.getCharCode("A");for(let L=f;L<=d;L++)D[Ra][L]=L-f+2;D[Xm][s]=1;const m=ee.getCharCode("z"),w=ee.getCharCode("a");for(let L=w;L<=m;L++)D[Xm][L]=L-w+2;D[Br][s]=1;const A=ee.getCharCode("9"),b=ee.getCharCode("0");for(let L=b;L<=A;L++)D[Br][L]=L-b+2;D[Br][c]=12,D[Br][a]=13;const T=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let L=0;L<T.length;L++)D[TS][ee.getCharCode(T[L])]=L;const M=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let L=0;L<M.length;L++)ee.getCharCode(M[L])>0&&(D[js][ee.getCharCode(M[L])]=L);return D}const DA=xR(N.createInt32Array(5,256));class N0{constructor(s){this.text=s}encode(){const s=ee.getCharCode(" "),a=ee.getCharCode(`
`);let c=_S.singletonList(zs.INITIAL_STATE);for(let f=0;f<this.text.length;f++){let m,w=f+1<this.text.length?this.text[f+1]:0;switch(this.text[f]){case ee.getCharCode("\r"):m=w===a?2:0;break;case ee.getCharCode("."):m=w===s?3:0;break;case ee.getCharCode(","):m=w===s?4:0;break;case ee.getCharCode(":"):m=w===s?5:0;break;default:m=0}m>0?(c=N0.updateStateListForPair(c,f,m),f++):c=this.updateStateListForChar(c,f)}return _S.min(c,(f,m)=>f.getBitCount()-m.getBitCount()).toBitArray(this.text)}updateStateListForChar(s,a){const c=[];for(let d of s)this.updateStateForChar(d,a,c);return N0.simplifyStates(c)}updateStateForChar(s,a,c){let d=this.text[a]&255,f=DA[s.getMode()][d]>0,m=null;for(let w=0;w<=js;w++){let A=DA[w][d];if(A>0){if(m==null&&(m=s.endBinaryShift(a)),!f||w===s.getMode()||w===Br){const b=m.latchAndAppend(w,A);c.push(b)}if(!f&&IS[s.getMode()][w]>=0){const b=m.shiftAndAppend(w,A);c.push(b)}}}if(s.getBinaryShiftByteCount()>0||DA[s.getMode()][d]===0){let w=s.addBinaryShiftChar(a);c.push(w)}}static updateStateListForPair(s,a,c){const d=[];for(let f of s)this.updateStateForPair(f,a,c,d);return this.simplifyStates(d)}static updateStateForPair(s,a,c,d){let f=s.endBinaryShift(a);if(d.push(f.latchAndAppend(js,c)),s.getMode()!==js&&d.push(f.shiftAndAppend(js,c)),c===3||c===4){let m=f.latchAndAppend(Br,16-c).latchAndAppend(Br,1);d.push(m)}if(s.getBinaryShiftByteCount()>0){let m=s.addBinaryShiftChar(a).addBinaryShiftChar(a+1);d.push(m)}}static simplifyStates(s){let a=[];for(const c of s){let d=!0;for(const f of a){if(f.isBetterThanOrEqualTo(c)){d=!1;break}c.isBetterThanOrEqualTo(f)&&(a=a.filter(m=>m!==f))}d&&a.push(c)}return a}}class ot{constructor(){}static encodeBytes(s){return ot.encode(s,ot.DEFAULT_EC_PERCENT,ot.DEFAULT_AZTEC_LAYERS)}static encode(s,a,c){let d=new N0(s).encode(),f=k.truncDivision(d.getSize()*a,100)+11,m=d.getSize()+f,w,A,b,T,M;if(c!==ot.DEFAULT_AZTEC_LAYERS){if(w=c<0,A=Math.abs(c),A>(w?ot.MAX_NB_BITS_COMPACT:ot.MAX_NB_BITS))throw new y(ee.format("Illegal value %s for layers",c));b=ot.totalBitsInLayer(A,w),T=ot.WORD_SIZE[A];let ae=b-b%T;if(M=ot.stuffBits(d,T),M.getSize()+f>ae)throw new y("Data to large for user specified layer");if(w&&M.getSize()>T*64)throw new y("Data to large for user specified layer")}else{T=0,M=null;for(let ae=0;;ae++){if(ae>ot.MAX_NB_BITS)throw new y("Data too large for an Aztec code");if(w=ae<=3,A=w?ae+1:ae,b=ot.totalBitsInLayer(A,w),m>b)continue;(M==null||T!==ot.WORD_SIZE[A])&&(T=ot.WORD_SIZE[A],M=ot.stuffBits(d,T));let qe=b-b%T;if(!(w&&M.getSize()>T*64)&&M.getSize()+f<=qe)break}}let L=ot.generateCheckWords(M,b,T),V=M.getSize()/T,G=ot.generateModeMessage(w,A,V),X=(w?11:14)+A*4,K=new Int32Array(X),J;if(w){J=X;for(let ae=0;ae<K.length;ae++)K[ae]=ae}else{J=X+1+2*k.truncDivision(k.truncDivision(X,2)-1,15);let ae=k.truncDivision(X,2),qe=k.truncDivision(J,2);for(let je=0;je<ae;je++){let Ui=je+k.truncDivision(je,15);K[ae-je-1]=qe-Ui-1,K[ae+je]=qe+Ui+1}}let de=new ce(J);for(let ae=0,qe=0;ae<A;ae++){let je=(A-ae)*4+(w?9:12);for(let Ui=0;Ui<je;Ui++){let cs=Ui*2;for(let ji=0;ji<2;ji++)L.get(qe+cs+ji)&&de.set(K[ae*2+ji],K[ae*2+Ui]),L.get(qe+je*2+cs+ji)&&de.set(K[ae*2+Ui],K[X-1-ae*2-ji]),L.get(qe+je*4+cs+ji)&&de.set(K[X-1-ae*2-ji],K[X-1-ae*2-Ui]),L.get(qe+je*6+cs+ji)&&de.set(K[X-1-ae*2-Ui],K[ae*2+ji])}qe+=je*8}if(ot.drawModeMessage(de,w,J,G),w)ot.drawBullsEye(de,k.truncDivision(J,2),5);else{ot.drawBullsEye(de,k.truncDivision(J,2),7);for(let ae=0,qe=0;ae<k.truncDivision(X,2)-1;ae+=15,qe+=16)for(let je=k.truncDivision(J,2)&1;je<J;je+=2)de.set(k.truncDivision(J,2)-qe,je),de.set(k.truncDivision(J,2)+qe,je),de.set(je,k.truncDivision(J,2)-qe),de.set(je,k.truncDivision(J,2)+qe)}let fe=new SS;return fe.setCompact(w),fe.setSize(J),fe.setLayers(A),fe.setCodeWords(V),fe.setMatrix(de),fe}static drawBullsEye(s,a,c){for(let d=0;d<c;d+=2)for(let f=a-d;f<=a+d;f++)s.set(f,a-d),s.set(f,a+d),s.set(a-d,f),s.set(a+d,f);s.set(a-c,a-c),s.set(a-c+1,a-c),s.set(a-c,a-c+1),s.set(a+c,a-c),s.set(a+c,a-c+1),s.set(a+c,a+c-1)}static generateModeMessage(s,a,c){let d=new B;return s?(d.appendBits(a-1,2),d.appendBits(c-1,6),d=ot.generateCheckWords(d,28,4)):(d.appendBits(a-1,5),d.appendBits(c-1,11),d=ot.generateCheckWords(d,40,4)),d}static drawModeMessage(s,a,c,d){let f=k.truncDivision(c,2);if(a)for(let m=0;m<7;m++){let w=f-3+m;d.get(m)&&s.set(w,f-5),d.get(m+7)&&s.set(f+5,w),d.get(20-m)&&s.set(w,f+5),d.get(27-m)&&s.set(f-5,w)}else for(let m=0;m<10;m++){let w=f-5+m+k.truncDivision(m,5);d.get(m)&&s.set(w,f-7),d.get(m+10)&&s.set(f+7,w),d.get(29-m)&&s.set(w,f+7),d.get(39-m)&&s.set(f-7,w)}}static generateCheckWords(s,a,c){let d=s.getSize()/c,f=new IA(ot.getGF(c)),m=k.truncDivision(a,c),w=ot.bitsToWords(s,c,m);f.encode(w,m-d);let A=a%c,b=new B;b.appendBits(0,A);for(const T of Array.from(w))b.appendBits(T,c);return b}static bitsToWords(s,a,c){let d=new Int32Array(c),f,m;for(f=0,m=s.getSize()/a;f<m;f++){let w=0;for(let A=0;A<a;A++)w|=s.get(f*a+A)?1<<a-A-1:0;d[f]=w}return d}static getGF(s){switch(s){case 4:return Te.AZTEC_PARAM;case 6:return Te.AZTEC_DATA_6;case 8:return Te.AZTEC_DATA_8;case 10:return Te.AZTEC_DATA_10;case 12:return Te.AZTEC_DATA_12;default:throw new y("Unsupported word size "+s)}}static stuffBits(s,a){let c=new B,d=s.getSize(),f=(1<<a)-2;for(let m=0;m<d;m+=a){let w=0;for(let A=0;A<a;A++)(m+A>=d||s.get(m+A))&&(w|=1<<a-1-A);(w&f)===f?(c.appendBits(w&f,a),m--):w&f?c.appendBits(w,a):(c.appendBits(w|1,a),m--)}return c}static totalBitsInLayer(s,a){return((a?88:112)+16*s)*s}}ot.DEFAULT_EC_PERCENT=33,ot.DEFAULT_AZTEC_LAYERS=0,ot.MAX_NB_BITS=32,ot.MAX_NB_BITS_COMPACT=4,ot.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Ym{encode(s,a,c,d){return this.encodeWithHints(s,a,c,d,null)}encodeWithHints(s,a,c,d,f){let m=RA.ISO_8859_1,w=ot.DEFAULT_EC_PERCENT,A=ot.DEFAULT_AZTEC_LAYERS;return f!=null&&(f.has(_n.CHARACTER_SET)&&(m=CS.forName(f.get(_n.CHARACTER_SET).toString())),f.has(_n.ERROR_CORRECTION)&&(w=k.parseInt(f.get(_n.ERROR_CORRECTION).toString())),f.has(_n.AZTEC_LAYERS)&&(A=k.parseInt(f.get(_n.AZTEC_LAYERS).toString()))),Ym.encodeLayers(s,a,c,d,m,w,A)}static encodeLayers(s,a,c,d,f,m,w){if(a!==xe.AZTEC)throw new y("Can only encode AZTEC, but got "+a);let A=ot.encode(ee.getBytes(s,f),m,w);return Ym.renderResult(A,c,d)}static renderResult(s,a,c){let d=s.getMatrix();if(d==null)throw new rt;let f=d.getWidth(),m=d.getHeight(),w=Math.max(a,f),A=Math.max(c,m),b=Math.min(w/f,A/m),T=(w-f*b)/2,M=(A-m*b)/2,L=new ce(w,A);for(let V=0,G=M;V<m;V++,G+=b)for(let X=0,K=T;X<f;X++,K+=b)d.get(X,V)&&L.setRegion(K,G,b,b);return L}}t.AbstractExpandedDecoder=wA,t.ArgumentException=x,t.ArithmeticException=Cn,t.AztecCode=SS,t.AztecCodeReader=oi,t.AztecCodeWriter=Ym,t.AztecDecoder=ut,t.AztecDetector=hn,t.AztecDetectorResult=Ca,t.AztecEncoder=ot,t.AztecHighLevelEncoder=N0,t.AztecPoint=et,t.BarcodeFormat=xe,t.Binarizer=R,t.BinaryBitmap=v,t.BitArray=B,t.BitMatrix=ce,t.BitSource=bA,t.BrowserAztecCodeReader=mA,t.BrowserBarcodeReader=$N,t.BrowserCodeReader=me,t.BrowserDatamatrixCodeReader=qN,t.BrowserMultiFormatReader=aR,t.BrowserPDF417Reader=lR,t.BrowserQRCodeReader=cR,t.BrowserQRCodeSvgWriter=cc,t.CharacterSetECI=W,t.ChecksumException=C,t.Code128Reader=pe,t.Code39Reader=dn,t.DataMatrixDecodedBitStreamParser=_a,t.DataMatrixReader=Ta,t.DecodeHintType=H,t.DecoderResult=yn,t.DefaultGridSampler=Je,t.DetectorResult=os,t.EAN13Reader=as,t.EncodeHintType=_n,t.Exception=p,t.FormatException=F,t.GenericGF=Te,t.GenericGFPoly=De,t.GlobalHistogramBinarizer=oe,t.GridSampler=Ls,t.GridSamplerInstance=ke,t.HTMLCanvasElementLuminanceSource=ye,t.HybridBinarizer=ne,t.ITFReader=ft,t.IllegalArgumentException=y,t.IllegalStateException=rt,t.InvertedLuminanceSource=ge,t.LuminanceSource=ie,t.MathUtils=$e,t.MultiFormatOneDReader=mh,t.MultiFormatReader=ES,t.MultiFormatWriter=hR,t.NotFoundException=$,t.OneDReader=nn,t.PDF417DecodedBitStreamParser=Q,t.PDF417DecoderErrorCorrection=xS,t.PDF417Reader=Yn,t.PDF417ResultMetadata=yS,t.PerspectiveTransform=vi,t.PlanarYUVLuminanceSource=Us,t.QRCodeByteMatrix=Gm,t.QRCodeDataMask=Or,t.QRCodeDecodedBitStreamParser=Yt,t.QRCodeDecoderErrorCorrectionLevel=Nt,t.QRCodeDecoderFormatInformation=ai,t.QRCodeEncoder=Ot,t.QRCodeEncoderQRCode=lc,t.QRCodeMaskUtil=sn,t.QRCodeMatrixUtil=Pe,t.QRCodeMode=Re,t.QRCodeReader=Ia,t.QRCodeVersion=Ne,t.QRCodeWriter=wh,t.RGBLuminanceSource=NA,t.RSS14Reader=rn,t.RSSExpandedReader=se,t.ReaderException=Wm,t.ReedSolomonDecoder=tn,t.ReedSolomonEncoder=IA,t.ReedSolomonException=Qe,t.Result=Le,t.ResultMetadataType=st,t.ResultPoint=Se,t.StringUtils=ee,t.UnsupportedOperationException=Z,t.VideoInputDevice=Me,t.WhiteRectangleDetector=Di,t.WriterException=Et,t.ZXingArrays=N,t.ZXingCharset=CS,t.ZXingInteger=k,t.ZXingStandardCharsets=RA,t.ZXingStringBuilder=le,t.ZXingStringEncoding=te,t.ZXingSystem=I,t.createAbstractExpandedDecoder=pS,Object.defineProperty(t,"__esModule",{value:!0})})})(GE,GE.exports);var Bt=GE.exports;const eL=YE(Bt),tL=bR({__proto__:null,default:eL},[Bt]);var P_=function(){function n(e,t,i){if(this.formatMap=new Map([[Ee.QR_CODE,Bt.BarcodeFormat.QR_CODE],[Ee.AZTEC,Bt.BarcodeFormat.AZTEC],[Ee.CODABAR,Bt.BarcodeFormat.CODABAR],[Ee.CODE_39,Bt.BarcodeFormat.CODE_39],[Ee.CODE_93,Bt.BarcodeFormat.CODE_93],[Ee.CODE_128,Bt.BarcodeFormat.CODE_128],[Ee.DATA_MATRIX,Bt.BarcodeFormat.DATA_MATRIX],[Ee.MAXICODE,Bt.BarcodeFormat.MAXICODE],[Ee.ITF,Bt.BarcodeFormat.ITF],[Ee.EAN_13,Bt.BarcodeFormat.EAN_13],[Ee.EAN_8,Bt.BarcodeFormat.EAN_8],[Ee.PDF_417,Bt.BarcodeFormat.PDF_417],[Ee.RSS_14,Bt.BarcodeFormat.RSS_14],[Ee.RSS_EXPANDED,Bt.BarcodeFormat.RSS_EXPANDED],[Ee.UPC_A,Bt.BarcodeFormat.UPC_A],[Ee.UPC_E,Bt.BarcodeFormat.UPC_E],[Ee.UPC_EAN_EXTENSION,Bt.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!tL)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=t,this.logger=i;var r=this.createZXingFormats(e),o=new Map;o.set(Bt.DecodeHintType.POSSIBLE_FORMATS,r),o.set(Bt.DecodeHintType.TRY_HARDER,!1),this.hints=o}return n.prototype.decodeAsync=function(e){var t=this;return new Promise(function(i,r){try{i(t.decode(e))}catch(o){r(o)}})},n.prototype.decode=function(e){var t=new Bt.MultiFormatReader(this.verbose,this.hints),i=new Bt.HTMLCanvasElementLuminanceSource(e),r=new Bt.BinaryBitmap(new Bt.HybridBinarizer(i)),o=t.decode(r);return{text:o.text,format:zN.create(this.toHtml5QrcodeSupportedFormats(o.format)),debugData:this.createDebugData()}},n.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(t,i,r){e.set(t,i)}),e},n.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},n.prototype.createZXingFormats=function(e){for(var t=[],i=0,r=e;i<r.length;i++){var o=r[i];this.formatMap.has(o)?t.push(this.formatMap.get(o)):this.logger.logError("".concat(o," is not supported by")+"ZXingHtml5QrcodeShim")}return t},n.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},n}(),nL=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(l){l(o)})}return new(t||(t=Promise))(function(o,l){function h(x){try{p(i.next(x))}catch(y){l(y)}}function g(x){try{p(i.throw(x))}catch(y){l(y)}}function p(x){x.done?o(x.value):r(x.value).then(h,g)}p((i=i.apply(n,e||[])).next())})},iL=globalThis&&globalThis.__generator||function(n,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,r,o,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(p){return function(x){return g([p,x])}}function g(p){if(i)throw new TypeError("Generator is already executing.");for(;l&&(l=0,p[0]&&(t=0)),t;)try{if(i=1,r&&(o=p[0]&2?r.return:p[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,p[1])).done)return o;switch(r=0,o&&(p=[p[0]&2,o.value]),p[0]){case 0:case 1:o=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,r=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!o||p[1]>o[0]&&p[1]<o[3])){t.label=p[1];break}if(p[0]===6&&t.label<o[1]){t.label=o[1],o=p;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(p);break}o[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(x){p=[6,x],r=0}finally{i=o=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},D_=function(){function n(e,t,i){if(this.formatMap=new Map([[Ee.QR_CODE,"qr_code"],[Ee.AZTEC,"aztec"],[Ee.CODABAR,"codabar"],[Ee.CODE_39,"code_39"],[Ee.CODE_93,"code_93"],[Ee.CODE_128,"code_128"],[Ee.DATA_MATRIX,"data_matrix"],[Ee.ITF,"itf"],[Ee.EAN_13,"ean_13"],[Ee.EAN_8,"ean_8"],[Ee.PDF_417,"pdf417"],[Ee.UPC_A,"upc_a"],[Ee.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!n.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=t,this.logger=i;var r=this.createBarcodeDetectorFormats(e);if(this.detector=new BarcodeDetector(r),!this.detector)throw"BarcodeDetector detector not supported"}return n.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var e=new BarcodeDetector({formats:["qr_code"]});return typeof e<"u"},n.prototype.decodeAsync=function(e){return nL(this,void 0,void 0,function(){var t,i;return iL(this,function(r){switch(r.label){case 0:return[4,this.detector.detect(e)];case 1:if(t=r.sent(),!t||t.length===0)throw"No barcode or QR code detected.";return i=this.selectLargestBarcode(t),[2,{text:i.rawValue,format:zN.create(this.toHtml5QrcodeSupportedFormats(i.format)),debugData:this.createDebugData()}]}})})},n.prototype.selectLargestBarcode=function(e){for(var t=null,i=0,r=0,o=e;r<o.length;r++){var l=o[r],h=l.boundingBox.width*l.boundingBox.height;h>i&&(i=h,t=l)}if(!t)throw"No largest barcode found";return t},n.prototype.createBarcodeDetectorFormats=function(e){for(var t=[],i=0,r=e;i<r.length;i++){var o=r[i];this.formatMap.has(o)?t.push(this.formatMap.get(o)):this.logger.warn("".concat(o," is not supported by")+"BarcodeDetectorDelegate")}return{formats:t}},n.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},n.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(t,i,r){e.set(t,i)}),e},n.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},n}(),M_=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(l){l(o)})}return new(t||(t=Promise))(function(o,l){function h(x){try{p(i.next(x))}catch(y){l(y)}}function g(x){try{p(i.throw(x))}catch(y){l(y)}}function p(x){x.done?o(x.value):r(x.value).then(h,g)}p((i=i.apply(n,e||[])).next())})},O_=globalThis&&globalThis.__generator||function(n,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,r,o,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(p){return function(x){return g([p,x])}}function g(p){if(i)throw new TypeError("Generator is already executing.");for(;l&&(l=0,p[0]&&(t=0)),t;)try{if(i=1,r&&(o=p[0]&2?r.return:p[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,p[1])).done)return o;switch(r=0,o&&(p=[p[0]&2,o.value]),p[0]){case 0:case 1:o=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,r=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!o||p[1]>o[0]&&p[1]<o[3])){t.label=p[1];break}if(p[0]===6&&t.label<o[1]){t.label=o[1],o=p;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(p);break}o[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(x){p=[6,x],r=0}finally{i=o=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},rL=function(){function n(e,t,i,r){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=i,t&&D_.isSupported()?(this.primaryDecoder=new D_(e,i,r),this.secondaryDecoder=new P_(e,i,r)):this.primaryDecoder=new P_(e,i,r)}return n.prototype.decodeAsync=function(e){return M_(this,void 0,void 0,function(){var t;return O_(this,function(i){switch(i.label){case 0:t=performance.now(),i.label=1;case 1:return i.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(e)];case 2:return[2,i.sent()];case 3:return this.possiblyLogPerformance(t),[7];case 4:return[2]}})})},n.prototype.decodeRobustlyAsync=function(e){return M_(this,void 0,void 0,function(){var t,i;return O_(this,function(r){switch(r.label){case 0:t=performance.now(),r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,r.sent()];case 3:if(i=r.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw i;case 4:return this.possiblyLogPerformance(t),[7];case 5:return[2]}})})},n.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},n.prototype.possiblyLogPerformance=function(e){if(this.verbose){var t=performance.now()-e;this.executionResults.push(t),this.executions++,this.possiblyFlushPerformanceReport()}},n.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var e=0,t=0,i=this.executionResults;t<i.length;t++){var r=i[t];e+=r}var o=e/this.executionResults.length;console.log("".concat(o," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},n}(),cS=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),q2=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(l){l(o)})}return new(t||(t=Promise))(function(o,l){function h(x){try{p(i.next(x))}catch(y){l(y)}}function g(x){try{p(i.throw(x))}catch(y){l(y)}}function p(x){x.done?o(x.value):r(x.value).then(h,g)}p((i=i.apply(n,e||[])).next())})},Z2=globalThis&&globalThis.__generator||function(n,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,r,o,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(p){return function(x){return g([p,x])}}function g(p){if(i)throw new TypeError("Generator is already executing.");for(;l&&(l=0,p[0]&&(t=0)),t;)try{if(i=1,r&&(o=p[0]&2?r.return:p[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,p[1])).done)return o;switch(r=0,o&&(p=[p[0]&2,o.value]),p[0]){case 0:case 1:o=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,r=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!o||p[1]>o[0]&&p[1]<o[3])){t.label=p[1];break}if(p[0]===6&&t.label<o[1]){t.label=o[1],o=p;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(p);break}o[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(x){p=[6,x],r=0}finally{i=o=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},VN=function(){function n(e,t){this.name=e,this.track=t}return n.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},n.prototype.apply=function(e){var t={};t[this.name]=e;var i={advanced:[t]};return this.track.applyConstraints(i)},n.prototype.value=function(){var e=this.track.getSettings();if(this.name in e){var t=e[this.name];return t}return null},n}(),sL=function(n){cS(e,n);function e(t,i){return n.call(this,t,i)||this}return e.prototype.min=function(){return this.getCapabilities().min},e.prototype.max=function(){return this.getCapabilities().max},e.prototype.step=function(){return this.getCapabilities().step},e.prototype.apply=function(t){var i={};i[this.name]=t;var r={advanced:[i]};return this.track.applyConstraints(r)},e.prototype.getCapabilities=function(){this.failIfNotSupported();var t=this.track.getCapabilities(),i=t[this.name];return{min:i.min,max:i.max,step:i.step}},e.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},e}(VN),oL=function(n){cS(e,n);function e(t){return n.call(this,"zoom",t)||this}return e}(sL),aL=function(n){cS(e,n);function e(t){return n.call(this,"torch",t)||this}return e}(VN),lL=function(){function n(e){this.track=e}return n.prototype.zoomFeature=function(){return new oL(this.track)},n.prototype.torchFeature=function(){return new aL(this.track)},n}(),cL=function(){function n(e,t,i){this.isClosed=!1,this.parentElement=e,this.mediaStream=t,this.callbacks=i,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}return n.prototype.createVideoElement=function(e){var t=document.createElement("video");return t.style.width="".concat(e,"px"),t.style.display="block",t.muted=!0,t.setAttribute("muted","true"),t.playsInline=!0,t},n.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var t=function(){var i=e.surface.clientWidth,r=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(i,r),e.surface.removeEventListener("playing",t)};this.surface.addEventListener("playing",t),this.surface.srcObject=this.mediaStream,this.surface.play()},n.create=function(e,t,i,r){return q2(this,void 0,void 0,function(){var o,l;return Z2(this,function(h){switch(h.label){case 0:return o=new n(e,t,r),i.aspectRatio?(l={aspectRatio:i.aspectRatio},[4,o.getFirstTrackOrFail().applyConstraints(l)]):[3,2];case 1:h.sent(),h.label=2;case 2:return o.setupSurface(),[2,o]}})})},n.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},n.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},n.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},n.prototype.resume=function(e){this.failIfClosed();var t=this,i=function(){setTimeout(e,200),t.surface.removeEventListener("playing",i)};this.surface.addEventListener("playing",i),this.surface.play()},n.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},n.prototype.getSurface=function(){return this.failIfClosed(),this.surface},n.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},n.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},n.prototype.applyVideoConstraints=function(e){return q2(this,void 0,void 0,function(){return Z2(this,function(t){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]})})},n.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise(function(t,i){var r=e.mediaStream.getVideoTracks(),o=r.length,l=0;e.mediaStream.getVideoTracks().forEach(function(h){e.mediaStream.removeTrack(h),h.stop(),++l,l>=o&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),t())})})},n.prototype.getCapabilities=function(){return new lL(this.getFirstTrackOrFail())},n}(),uL=function(){function n(e){this.mediaStream=e}return n.prototype.render=function(e,t,i){return q2(this,void 0,void 0,function(){return Z2(this,function(r){return[2,cL.create(e,this.mediaStream,t,i)]})})},n.create=function(e){return q2(this,void 0,void 0,function(){var t,i;return Z2(this,function(r){switch(r.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return t={audio:!1,video:e},[4,navigator.mediaDevices.getUserMedia(t)];case 1:return i=r.sent(),[2,new n(i)]}})})},n}(),L_=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(l){l(o)})}return new(t||(t=Promise))(function(o,l){function h(x){try{p(i.next(x))}catch(y){l(y)}}function g(x){try{p(i.throw(x))}catch(y){l(y)}}function p(x){x.done?o(x.value):r(x.value).then(h,g)}p((i=i.apply(n,e||[])).next())})},B_=globalThis&&globalThis.__generator||function(n,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,r,o,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(p){return function(x){return g([p,x])}}function g(p){if(i)throw new TypeError("Generator is already executing.");for(;l&&(l=0,p[0]&&(t=0)),t;)try{if(i=1,r&&(o=p[0]&2?r.return:p[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,p[1])).done)return o;switch(r=0,o&&(p=[p[0]&2,o.value]),p[0]){case 0:case 1:o=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,r=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!o||p[1]>o[0]&&p[1]<o[3])){t.label=p[1];break}if(p[0]===6&&t.label<o[1]){t.label=o[1],o=p;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(p);break}o[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(x){p=[6,x],r=0}finally{i=o=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},hL=function(){function n(){}return n.failIfNotSupported=function(){return L_(this,void 0,void 0,function(){return B_(this,function(e){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new n]})})},n.prototype.create=function(e){return L_(this,void 0,void 0,function(){return B_(this,function(t){return[2,uL.create(e)]})})},n}(),dL=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(l){l(o)})}return new(t||(t=Promise))(function(o,l){function h(x){try{p(i.next(x))}catch(y){l(y)}}function g(x){try{p(i.throw(x))}catch(y){l(y)}}function p(x){x.done?o(x.value):r(x.value).then(h,g)}p((i=i.apply(n,e||[])).next())})},fL=globalThis&&globalThis.__generator||function(n,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,r,o,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(p){return function(x){return g([p,x])}}function g(p){if(i)throw new TypeError("Generator is already executing.");for(;l&&(l=0,p[0]&&(t=0)),t;)try{if(i=1,r&&(o=p[0]&2?r.return:p[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,p[1])).done)return o;switch(r=0,o&&(p=[p[0]&2,o.value]),p[0]){case 0:case 1:o=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,r=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!o||p[1]>o[0]&&p[1]<o[3])){t.label=p[1];break}if(p[0]===6&&t.label<o[1]){t.label=o[1],o=p;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(p);break}o[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(x){p=[6,x],r=0}finally{i=o=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},gL=function(){function n(){}return n.retrieve=function(){if(navigator.mediaDevices)return n.getCamerasFromMediaDevices();var e=MediaStreamTrack;return MediaStreamTrack&&e.getSources?n.getCamerasFromMediaStreamTrack():n.rejectWithError()},n.rejectWithError=function(){var e=Xh.unableToQuerySupportedDevices();return n.isHttpsOrLocalhost()||(e=Xh.insecureContextCameraQueryError()),Promise.reject(e)},n.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var e=location.host.split(":")[0];return e==="127.0.0.1"||e==="localhost"},n.getCamerasFromMediaDevices=function(){return dL(this,void 0,void 0,function(){var e,t,i,r,o,l,h;return fL(this,function(g){switch(g.label){case 0:return e=function(p){for(var x=p.getVideoTracks(),y=0,v=x;y<v.length;y++){var C=v[y];C.enabled=!1,C.stop(),p.removeTrack(C)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return t=g.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(i=g.sent(),r=[],o=0,l=i;o<l.length;o++)h=l[o],h.kind==="videoinput"&&r.push({id:h.deviceId,label:h.label});return e(t),[2,r]}})})},n.getCamerasFromMediaStreamTrack=function(){return new Promise(function(e,t){var i=function(o){for(var l=[],h=0,g=o;h<g.length;h++){var p=g[h];p.kind==="video"&&l.push({id:p.id,label:p.label})}e(l)},r=MediaStreamTrack;r.getSources(i)})},n}(),cn;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.NOT_STARTED=1]="NOT_STARTED",n[n.SCANNING=2]="SCANNING",n[n.PAUSED=3]="PAUSED"})(cn||(cn={}));var pL=function(){function n(){this.state=cn.NOT_STARTED,this.onGoingTransactionNewState=cn.UNKNOWN}return n.prototype.directTransition=function(e){this.failIfTransitionOngoing(),this.validateTransition(e),this.state=e},n.prototype.startTransition=function(e){return this.failIfTransitionOngoing(),this.validateTransition(e),this.onGoingTransactionNewState=e,this},n.prototype.execute=function(){if(this.onGoingTransactionNewState===cn.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=cn.UNKNOWN,this.directTransition(e)},n.prototype.cancel=function(){if(this.onGoingTransactionNewState===cn.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=cn.UNKNOWN},n.prototype.getState=function(){return this.state},n.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==cn.UNKNOWN)throw"Cannot transition to a new state, already under transition"},n.prototype.validateTransition=function(e){switch(this.state){case cn.UNKNOWN:throw"Transition from unknown is not allowed";case cn.NOT_STARTED:this.failIfNewStateIs(e,[cn.PAUSED]);break;case cn.SCANNING:break;case cn.PAUSED:break}},n.prototype.failIfNewStateIs=function(e,t){for(var i=0,r=t;i<r.length;i++){var o=r[i];if(e===o)throw"Cannot transition from ".concat(this.state," to ").concat(e)}},n}(),mL=function(){function n(e){this.stateManager=e}return n.prototype.startTransition=function(e){return this.stateManager.startTransition(e)},n.prototype.directTransition=function(e){this.stateManager.directTransition(e)},n.prototype.getState=function(){return this.stateManager.getState()},n.prototype.canScanFile=function(){return this.stateManager.getState()===cn.NOT_STARTED},n.prototype.isScanning=function(){return this.stateManager.getState()!==cn.NOT_STARTED},n.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===cn.SCANNING},n.prototype.isPaused=function(){return this.stateManager.getState()===cn.PAUSED},n}(),xL=function(){function n(){}return n.create=function(){return new mL(new pL)},n}(),wL=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),rr=function(n){wL(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.DEFAULT_WIDTH=300,e.DEFAULT_WIDTH_OFFSET=2,e.FILE_SCAN_MIN_HEIGHT=300,e.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,e.MIN_QR_BOX_SIZE=50,e.SHADED_LEFT=1,e.SHADED_RIGHT=2,e.SHADED_TOP=3,e.SHADED_BOTTOM=4,e.SHADED_REGION_ELEMENT_ID="qr-shaded-region",e.VERBOSE=!1,e.BORDER_SHADER_DEFAULT_COLOR="#ffffff",e.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",e}(ZO),yL=function(){function n(e,t){this.logger=t,this.fps=rr.SCAN_DEFAULT_FPS,e?(e.fps&&(this.fps=e.fps),this.disableFlip=e.disableFlip===!0,this.qrbox=e.qrbox,this.aspectRatio=e.aspectRatio,this.videoConstraints=e.videoConstraints):this.disableFlip=rr.DEFAULT_DISABLE_FLIP}return n.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?HN.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},n.prototype.isShadedBoxEnabled=function(){return!So(this.qrbox)},n.create=function(e,t){return new n(e,t)},n}(),AL=function(){function n(e,t){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.elementId=e,this.verbose=!1;var i;typeof t=="boolean"?this.verbose=t===!0:t&&(i=t,this.verbose=i.verbose===!0,i.experimentalFeatures),this.logger=new JO(this.verbose),this.qrcode=new rL(this.getSupportedFormats(t),this.getUseBarCodeDetectorIfSupported(i),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=xL.create()}return n.prototype.start=function(e,t,i,r){var o=this;if(!e)throw"cameraIdOrConfig is required";if(!i||typeof i!="function")throw"qrCodeSuccessCallback is required and should be a function.";var l;r?l=r:l=this.verbose?this.logger.log:function(){};var h=yL.create(t,this.logger);this.clearElement();var g=!1;h.videoConstraints&&(h.isMediaStreamConstraintsValid()?g=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var p=g,x=document.getElementById(this.elementId);x.clientWidth?x.clientWidth:rr.DEFAULT_WIDTH,x.style.position="relative",this.shouldScan=!0,this.element=x;var y=this,v=this.stateManagerProxy.startTransition(cn.SCANNING);return new Promise(function(C,R){var I=p?h.videoConstraints:y.createVideoConstraints(e);if(!I){v.cancel(),R("videoConstraints should be defined");return}var O={};(!p||h.aspectRatio)&&(O.aspectRatio=h.aspectRatio);var _={onRenderSurfaceReady:function(N,k){y.setupUi(N,k,h),y.isScanning=!0,y.foreverScan(h,i,l)}};hL.failIfNotSupported().then(function(N){N.create(I).then(function(k){return k.render(o.element,O,_).then(function(B){y.renderedCamera=B,v.execute(),C(null)}).catch(function(B){v.cancel(),R(B)})}).catch(function(k){v.cancel(),R(Xh.errorGettingUserMedia(k))})}).catch(function(N){v.cancel(),R(Xh.cameraStreamingNotSupported())})})},n.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(cn.PAUSED),this.showPausedState(),(So(e)||e!==!0)&&(e=!1),e&&this.renderedCamera&&this.renderedCamera.pause()},n.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this,t=function(){e.stateManagerProxy.directTransition(cn.SCANNING),e.hidePausedState()};if(!this.renderedCamera.isPaused()){t();return}this.renderedCamera.resume(function(){t()})},n.prototype.getState=function(){return this.stateManagerProxy.getState()},n.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var t=this.stateManagerProxy.startTransition(cn.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var i=function(){if(e.element){var o=document.getElementById(rr.SHADED_REGION_ELEMENT_ID);o&&e.element.removeChild(o)}},r=this;return this.renderedCamera.close().then(function(){return r.renderedCamera=null,r.element&&(r.element.removeChild(r.canvasElement),r.canvasElement=null),i(),r.qrRegion&&(r.qrRegion=null),r.context&&(r.context=null),t.execute(),r.hidePausedState(),r.isScanning=!1,Promise.resolve()})},n.prototype.scanFile=function(e,t){return this.scanFileV2(e,t).then(function(i){return i.decodedText})},n.prototype.scanFileV2=function(e,t){var i=this;if(!e||!(e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(So(t)&&(t=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(r,o){i.possiblyCloseLastScanImageFile(),i.clearElement(),i.lastScanImageFile=URL.createObjectURL(e);var l=new Image;l.onload=function(){var h=l.width,g=l.height,p=document.getElementById(i.elementId),x=p.clientWidth?p.clientWidth:rr.DEFAULT_WIDTH,y=Math.max(p.clientHeight?p.clientHeight:g,rr.FILE_SCAN_MIN_HEIGHT),v=i.computeCanvasDrawConfig(h,g,x,y);if(t){var C=i.createCanvasElement(x,y,"qr-canvas-visible");C.style.display="inline-block",p.appendChild(C);var R=C.getContext("2d");if(!R)throw"Unable to get 2d context from canvas";R.canvas.width=x,R.canvas.height=y,R.drawImage(l,0,0,h,g,v.x,v.y,v.width,v.height)}var I=rr.FILE_SCAN_HIDDEN_CANVAS_PADDING,O=Math.max(l.width,v.width),_=Math.max(l.height,v.height),N=O+2*I,k=_+2*I,B=i.createCanvasElement(N,k);p.appendChild(B);var z=B.getContext("2d");if(!z)throw"Unable to get 2d context from canvas";z.canvas.width=N,z.canvas.height=k,z.drawImage(l,0,0,h,g,I,I,O,_);try{i.qrcode.decodeRobustlyAsync(B).then(function(H){r(k_.createFromQrcodeResult(H))}).catch(o)}catch(H){o("QR code parse error, error = ".concat(H))}},l.onerror=o,l.onabort=o,l.onstalled=o,l.onsuspend=o,l.src=URL.createObjectURL(e)})},n.prototype.clear=function(){this.clearElement()},n.getCameras=function(){return gL.retrieve()},n.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},n.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},n.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},n.prototype.applyVideoConstraints=function(e){if(e){if(!HN.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(e)},n.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},n.prototype.getSupportedFormats=function(e){var t=[Ee.QR_CODE,Ee.AZTEC,Ee.CODABAR,Ee.CODE_39,Ee.CODE_93,Ee.CODE_128,Ee.DATA_MATRIX,Ee.MAXICODE,Ee.ITF,Ee.EAN_13,Ee.EAN_8,Ee.PDF_417,Ee.RSS_14,Ee.RSS_EXPANDED,Ee.UPC_A,Ee.UPC_E,Ee.UPC_EAN_EXTENSION];if(!e||typeof e=="boolean"||!e.formatsToSupport)return t;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(e.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var i=[],r=0,o=e.formatsToSupport;r<o.length;r++){var l=o[r];qO(l)?i.push(l):this.logger.warn("Invalid format: ".concat(l," passed in config, ignoring."))}if(i.length===0)throw"None of formatsToSupport match supported values.";return i},n.prototype.getUseBarCodeDetectorIfSupported=function(e){if(So(e))return!0;if(!So(e.useBarCodeDetectorIfSupported))return e.useBarCodeDetectorIfSupported!==!1;if(So(e.experimentalFeatures))return!0;var t=e.experimentalFeatures;return So(t.useBarCodeDetectorIfSupported)?!0:t.useBarCodeDetectorIfSupported!==!1},n.prototype.validateQrboxSize=function(e,t,i){var r=this,o=i.qrbox;this.validateQrboxConfig(o);var l=this.toQrdimensions(e,t,o),h=function(p){if(p<rr.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(rr.MIN_QR_BOX_SIZE,"px.")},g=function(p){return p>e&&(r.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),p=e),p};h(l.width),h(l.height),l.width=g(l.width)},n.prototype.validateQrboxConfig=function(e){if(typeof e!="number"&&typeof e!="function"&&(e.width===void 0||e.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},n.prototype.toQrdimensions=function(e,t,i){if(typeof i=="number")return{width:i,height:i};if(typeof i=="function")try{return i(e,t)}catch(r){throw new Error("qrbox config was passed as a function but it failed with unknown error"+r)}return i},n.prototype.setupUi=function(e,t,i){i.isShadedBoxEnabled()&&this.validateQrboxSize(e,t,i);var r=So(i.qrbox)?{width:e,height:t}:i.qrbox;this.validateQrboxConfig(r);var o=this.toQrdimensions(e,t,r);o.height>t&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var l=i.isShadedBoxEnabled()&&o.height<=t,h={x:0,y:0,width:e,height:t},g=l?this.getShadedRegionBounds(e,t,o):h,p=this.createCanvasElement(g.width,g.height),x={willReadFrequently:!0},y=p.getContext("2d",x);y.canvas.width=g.width,y.canvas.height=g.height,this.element.append(p),l&&this.possiblyInsertShadingElement(this.element,e,t,o),this.createScannerPausedUiElement(this.element),this.qrRegion=g,this.context=y,this.canvasElement=p},n.prototype.createScannerPausedUiElement=function(e){var t=document.createElement("div");t.innerText=Xh.scannerPaused(),t.style.display="none",t.style.position="absolute",t.style.top="0px",t.style.zIndex="1",t.style.background="rgba(9, 9, 9, 0.46)",t.style.color="#FFECEC",t.style.textAlign="center",t.style.width="100%",e.appendChild(t),this.scannerPausedUiElement=t},n.prototype.scanContext=function(e,t){var i=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(r){return e(r.text,k_.createFromQrcodeResult(r)),i.possiblyUpdateShaders(!0),!0}).catch(function(r){i.possiblyUpdateShaders(!1);var o=Xh.codeParseError(r);return t(o,QO.createFrom(o)),!1})},n.prototype.foreverScan=function(e,t,i){var r=this;if(this.shouldScan&&this.renderedCamera){var o=this.renderedCamera.getSurface(),l=o.videoWidth/o.clientWidth,h=o.videoHeight/o.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var g=this.qrRegion.width*l,p=this.qrRegion.height*h,x=this.qrRegion.x*l,y=this.qrRegion.y*h;this.context.drawImage(o,x,y,g,p,0,0,this.qrRegion.width,this.qrRegion.height);var v=function(){r.foreverScanTimeout=setTimeout(function(){r.foreverScan(e,t,i)},r.getTimeoutFps(e.fps))};this.scanContext(t,i).then(function(C){!C&&e.disableFlip!==!0?(r.context.translate(r.context.canvas.width,0),r.context.scale(-1,1),r.scanContext(t,i).finally(function(){v()})):v()}).catch(function(C){r.logger.logError("Error happend while scanning context",C),v()})}},n.prototype.createVideoConstraints=function(e){if(typeof e=="string")return{deviceId:{exact:e}};if(typeof e=="object"){var t="facingMode",i="deviceId",r={user:!0,environment:!0},o="exact",l=function(R){if(R in r)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(R,"'")},h=Object.keys(e);if(h.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(h.length," keys");var g=Object.keys(e)[0];if(g!==t&&g!==i)throw"Only '".concat(t,"' and '").concat(i,"' ")+" are supported for 'cameraIdOrConfig'";if(g===t){var p=e.facingMode;if(typeof p=="string"){if(l(p))return{facingMode:p}}else if(typeof p=="object")if(o in p){if(l(p["".concat(o)]))return{facingMode:{exact:p["".concat(o)]}}}else throw"'facingMode' should be string or object with"+" ".concat(o," as key.");else{var x=typeof p;throw"Invalid type of 'facingMode' = ".concat(x)}}else{var y=e.deviceId;if(typeof y=="string")return{deviceId:y};if(typeof y=="object"){if(o in y)return{deviceId:{exact:y["".concat(o)]}};throw"'deviceId' should be string or object with"+" ".concat(o," as key.")}else{var v=typeof y;throw"Invalid type of 'deviceId' = ".concat(v)}}}var C=typeof e;throw"Invalid type of 'cameraIdOrConfig' = ".concat(C)},n.prototype.computeCanvasDrawConfig=function(e,t,i,r){if(e<=i&&t<=r){var o=(i-e)/2,l=(r-t)/2;return{x:o,y:l,width:e,height:t}}else{var h=e,g=t;return e>i&&(t=i/e*t,e=i),t>r&&(e=r/t*e,t=r),this.logger.log("Image downsampled from "+"".concat(h,"X").concat(g)+" to ".concat(e,"X").concat(t,".")),this.computeCanvasDrawConfig(e,t,i,r)}},n.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")},n.prototype.possiblyUpdateShaders=function(e){this.qrMatch!==e&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(t){t.style.backgroundColor=e?rr.BORDER_SHADER_MATCH_COLOR:rr.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=e)},n.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},n.prototype.createCanvasElement=function(e,t,i){var r=e,o=t,l=document.createElement("canvas");return l.style.width="".concat(r,"px"),l.style.height="".concat(o,"px"),l.style.display="none",l.id=So(i)?"qr-canvas":i,l},n.prototype.getShadedRegionBounds=function(e,t,i){if(i.width>e||i.height>t)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-i.width)/2,y:(t-i.height)/2,width:i.width,height:i.height}},n.prototype.possiblyInsertShadingElement=function(e,t,i,r){if(!(t-r.width<1||i-r.height<1)){var o=document.createElement("div");o.style.position="absolute";var l=(t-r.width)/2,h=(i-r.height)/2;if(o.style.borderLeft="".concat(l,"px solid rgba(0, 0, 0, 0.48)"),o.style.borderRight="".concat(l,"px solid rgba(0, 0, 0, 0.48)"),o.style.borderTop="".concat(h,"px solid rgba(0, 0, 0, 0.48)"),o.style.borderBottom="".concat(h,"px solid rgba(0, 0, 0, 0.48)"),o.style.boxSizing="border-box",o.style.top="0px",o.style.bottom="0px",o.style.left="0px",o.style.right="0px",o.id="".concat(rr.SHADED_REGION_ELEMENT_ID),t-r.width<11||i-r.height<11)this.hasBorderShaders=!1;else{var g=5,p=40;this.insertShaderBorders(o,p,g,-g,null,0,!0),this.insertShaderBorders(o,p,g,-g,null,0,!1),this.insertShaderBorders(o,p,g,null,-g,0,!0),this.insertShaderBorders(o,p,g,null,-g,0,!1),this.insertShaderBorders(o,g,p+g,-g,null,-g,!0),this.insertShaderBorders(o,g,p+g,null,-g,-g,!0),this.insertShaderBorders(o,g,p+g,-g,null,-g,!1),this.insertShaderBorders(o,g,p+g,null,-g,-g,!1),this.hasBorderShaders=!0}e.append(o)}},n.prototype.insertShaderBorders=function(e,t,i,r,o,l,h){var g=document.createElement("div");g.style.position="absolute",g.style.backgroundColor=rr.BORDER_SHADER_DEFAULT_COLOR,g.style.width="".concat(t,"px"),g.style.height="".concat(i,"px"),r!==null&&(g.style.top="".concat(r,"px")),o!==null&&(g.style.bottom="".concat(o,"px")),h?g.style.left="".concat(l,"px"):g.style.right="".concat(l,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(g),e.appendChild(g)},n.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},n.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},n.prototype.getTimeoutFps=function(e){return 1e3/e},n}();globalThis&&globalThis.__awaiter;globalThis&&globalThis.__generator;globalThis&&globalThis.__awaiter;globalThis&&globalThis.__generator;var F_;(function(n){n[n.STATUS_DEFAULT=0]="STATUS_DEFAULT",n[n.STATUS_SUCCESS=1]="STATUS_SUCCESS",n[n.STATUS_WARNING=2]="STATUS_WARNING",n[n.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(F_||(F_={}));es.workerSrc=`//unpkg.com/pdfjs-dist@${JC}/build/pdf.worker.min.mjs`;const U_={CONOSCENZA:"Esplorazionepreliminare.",ROMANTICA:"Tensioneattrattiva evulnerabilitemotiva.",LAVORATIVA:"Collaborazioneformale, efficienzaprioritaria.",AMICALE:"Supportoreciproco, tempononstrutturato.",FAMILIARE:"Legamediappartenenza eobblighiimpliciti.",CONVIVENZA:"Condivisionedispaziriservati."},j_=["CONOSCENZA","ROMANTICA","LAVORATIVA","AMICALE","FAMILIARE","CONVIVENZA"],vL={"Camilla Costato":{instagram:"ca.lcutta",url:"https://www.instagram.com/ca.lcutta/"},"Francesco Zanchetta":{instagram:"zjncoo",url:"https://www.instagram.com/zjncoo/"},"Camilla Vicario":{instagram:"camiivicario",url:"https://www.instagram.com/camiivicario/"},"Davide Benetton":{instagram:"davidebenetton_",url:"https://www.instagram.com/davidebenetton_/"},"Sofia Splendore":{instagram:"sofia.splendore",url:"https://www.instagram.com/sofia.splendore/"}},XE=({gsr0:n,gsr1:e,compatibility:t})=>{const i=ma.useRef(null);return re.useEffect(()=>{const r=i.current;if(!r)return;const o=r.getContext("2d"),l=r.width,h=r.height,g=(n+e)/2,p=t,x=1+Math.floor(g/1e3*12);let y=x+1;y===x&&(y+=1);const v=p/100*Math.PI;o.clearRect(0,0,l,h),o.beginPath(),o.strokeStyle="#000000",o.lineWidth=2;const C=l/2,R=h/2,I=Math.min(l,h)/2-10,O=1e3;for(let _=0;_<=O;_++){const N=_/O*2*Math.PI,k=C+I*Math.sin(x*N+v),B=R-I*Math.sin(y*N);_===0?o.moveTo(k,B):o.lineTo(k,B)}o.stroke()},[n,e,t]),U.jsx("canvas",{ref:i,width:256,height:256,className:"w-full h-full"})},bL=n=>{if(!n)return"";let e=parseInt(n);const t={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};let i="",r;for(r in t)for(;e>=t[r];)i+=r,e-=t[r];return i},WN=n=>{if(!n)return"";const e=["il","lo","la","i","gli","le","l","un","uno","una","di","a","da","in","con","su","per","tra","fra","del","dello","della","dei","degli","delle","al","allo","alla","ai","agli","alle","dal","dallo","dalla","dai","dagli","dalle","nel","nello","nella","nei","negli","nelle","sul","sullo","sulla","sui","sugli","sulle","e","o","ma","che","se","come","quando","non","pi","gi","mai","sempre","un'","quest'","quell'","all'","dall'","nell'","sull'"];let t=n;return e.forEach(i=>{const r=new RegExp(`\\b(${i})\\s+`,"gi");t=t.replace(r,"$1")}),t=t.replace(/\s+([.,;:!?])/g,"$1"),t=t.replace(/([.!?])\s+/g,`$1
`),t},EL=({contractData:n,partyA:e,partyB:t})=>U.jsxs("div",{id:"share-story-template",className:"absolute bg-white flex flex-col items-center justify-between p-16 font-bergen-mono text-black border-[20px] border-white",style:{width:"1080px",height:"1920px",zIndex:-9999,left:"-9999px",top:"-9999px",pointerEvents:"none"},children:[U.jsxs("div",{className:"w-full flex justify-between items-start pt-16 mb-2 px-4",children:[U.jsxs("div",{className:"text-left flex flex-col justify-center",children:[U.jsx("span",{className:"text-xl uppercase tracking-widest text-gray-400",children:"Verifica parte della macchina"}),U.jsx("span",{className:"text-4xl font-bold uppercase tracking-widest mt-2",children:"EyeDeal"})]}),U.jsx("img",{src:"/logo_alua.png",alt:"ALUA",className:"w-[460px] h-auto object-contain object-right flex-shrink-0"})]}),U.jsxs("div",{className:"flex-1 w-full flex flex-col items-start justify-start gap-4",children:[U.jsxs("div",{className:"w-full flex justify-between items-center px-4 border-b-[4px] border-black pb-12 mt-16",children:[U.jsxs("div",{className:"text-left w-1/2 pr-4",children:[U.jsx("span",{className:"block text-2xl uppercase tracking-widest text-gray-400 mb-2",children:"Contraente A"}),U.jsx("span",{className:"block text-5xl font-bold uppercase break-words leading-tight",children:e})]}),U.jsxs("div",{className:"text-right w-1/2 pl-4",children:[U.jsx("span",{className:"block text-2xl uppercase tracking-widest text-gray-400 mb-2",children:"Contraente B"}),U.jsx("span",{className:"block text-5xl font-bold uppercase break-words leading-tight",children:t})]})]}),U.jsxs("div",{className:"w-full flex justify-between items-end mt-8 px-4",children:[U.jsxs("div",{className:"flex flex-col items-start space-y-16",children:[U.jsxs("div",{children:[U.jsx("span",{className:"block text-3xl uppercase tracking-widest text-gray-500 mb-4",children:"Grado di Compatibilit"}),U.jsxs("span",{className:"block text-[150px] font-bergen-mono leading-none tracking-tighter",children:[n.compatibility,"%"]})]}),U.jsxs("div",{children:[U.jsx("span",{className:"block text-3xl uppercase tracking-widest text-gray-400 mb-4",children:"Fascia Rischio"}),U.jsx("span",{className:"block text-9xl font-bold text-black font-bergen-mono leading-none",children:bL(n.riskBand)})]})]}),U.jsx("div",{className:"w-[500px] h-[500px] relative border border-gray-100 rounded-full bg-white p-0 flex-shrink-0",children:U.jsx(XE,{gsr0:n.avgScl.a,gsr1:n.avgScl.b,compatibility:n.compatibility})})]}),n.phrase&&U.jsx("div",{className:"text-left px-4 w-full mt-auto mb-4",children:U.jsxs("span",{className:"font-bergen-mono text-[40px] uppercase font-bold leading-tight block text-black whitespace-pre-line",children:['"',WN(n.phrase),'"']})})]}),U.jsxs("div",{className:"w-full text-left border-t-[4px] border-black pt-8 mt-4 flex flex-col gap-4 px-4 pb-16",children:[U.jsx("span",{className:"text-3xl uppercase tracking-widest text-gray-400 font-medium whitespace-normal leading-relaxed",children:"Analisi generativa basata su parametri biometrici reali: Conduttanza Cutanea (GSR) e Capacit Elettrica."}),U.jsxs("span",{className:"text-3xl uppercase tracking-[0.2em] text-gray-300",children:["Protocollo Verificato  ",n.date]}),U.jsx("span",{className:"text-3xl uppercase tracking-[0.2em] text-gray-300 mt-2",children:" ALUA Systems 2025"})]})]}),CL=({onClose:n,onScanSuccess:e})=>{const[t,i]=re.useState(null);return re.useEffect(()=>{const r=new AL("reader"),o={fps:10,qrbox:{width:250,height:250}};return r.start({facingMode:"environment"},o,(l,h)=>{console.log("Scan Success:",l),r.stop().then(()=>{e(l)}).catch(g=>console.error("Error stopping scanner",g))},l=>{}).catch(l=>{console.error("Error starting scanner",l),i("Impossibile accedere alla fotocamera. Verifica i permessi.")}),()=>{r.isScanning&&r.stop().catch(l=>console.error("Error stopping scanner on cleanup",l))}},[e]),U.jsx("div",{className:"fixed inset-0 z-[60] bg-black bg-opacity-90 flex flex-col items-center justify-center p-4",children:U.jsxs("div",{className:"w-full max-w-md bg-white rounded-lg overflow-hidden relative",children:[U.jsx("button",{onClick:n,className:"absolute top-2 right-2 p-2 z-10 bg-white rounded-full",children:U.jsx(Wh,{size:24,className:"text-black"})}),U.jsx("div",{id:"reader",className:"w-full h-auto min-h-[300px] bg-black"}),U.jsxs("div",{className:"p-4 text-center font-bergen-mono",children:[U.jsx("p",{className:"text-sm uppercase tracking-widest text-gray-500 mb-2",children:"Inquadra il Data Matrix"}),t&&U.jsx("p",{className:"text-red-500 text-xs font-bold",children:t})]})]})})},SL=({member:n,onClose:e})=>n?U.jsx("div",{className:"fixed inset-0 z-[70] bg-black/80 flex items-center justify-center p-6 animate-in fade-in duration-300",children:U.jsxs("div",{className:"bg-white w-full max-w-sm p-8 border-2 border-black shadow-2xl relative flex flex-col items-center text-center font-bergen-mono",children:[U.jsx("button",{onClick:e,className:"absolute top-2 right-2 p-2 hover:bg-gray-100 transition-colors",children:U.jsx(Wh,{size:24})}),U.jsx("div",{className:"w-24 h-24 bg-black rounded-full flex items-center justify-center mb-6",children:U.jsx(t4,{size:48,className:"text-white"})}),U.jsx("h3",{className:"text-xs uppercase tracking-widest text-gray-500 mb-2",children:"Contatto Identificato"}),U.jsx("h2",{className:"text-2xl font-bold uppercase mb-4 font-neue-haas",children:n.name}),U.jsx("div",{className:"w-full h-px bg-gray-200 my-4"}),U.jsxs("a",{href:n.data.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-xl font-bold hover:text-purple-600 transition-colors",children:[U.jsxs("span",{children:["@",n.data.instagram]}),U.jsx(QP,{size:20,className:"-rotate-45"})]})]})}):null,_L=()=>{const[n,e]=re.useState(!0),[t,i]=re.useState(!1),[r,o]=re.useState(!1),[l,h]=re.useState("LOGIN"),[g,p]=re.useState("MONITORING"),[x,y]=re.useState(!1),[v,C]=re.useState(!1),[R,I]=re.useState(!1),[O,_]=re.useState(!1),[N,k]=re.useState(!1),[B,z]=re.useState(!1),[H,F]=re.useState(!1),[Y,W]=re.useState(null),[Z,te]=re.useState(null),ee=re.useRef(null),[le,ce]=re.useState(new Date),[$,oe]=re.useState(!1),[ne,ie]=re.useState(!1),[ge,ye]=re.useState(""),[Me,we]=re.useState(""),[me,Le]=re.useState({id:"UNK-00",date:"00.00.0000",machineId:"ALUA-M-V1",sessionToken:"---",compatibility:0,riskBand:1,cost:"0,00",weakLink:null,clausesText:"Dati non disponibili.",avgScl:{a:0,b:0},relTypes:[]}),[dt,xe]=re.useState({}),[He,st]=re.useState(!1),[yn,bt]=re.useState(!1),[De,Cn]=re.useState(null);re.useEffect(()=>{const Je=setTimeout(()=>{i(!0),o(!0),setTimeout(()=>{e(!1)},300)},1e3);return()=>clearTimeout(Je)},[]),re.useEffect(()=>{const Je=setInterval(()=>ce(new Date),1e3),ke=new URLSearchParams(window.location.search),et={};for(const[nr,fn]of ke.entries())et[nr]=fn;xe(et);const hn=ke.get("id")||"UNK-00",oi=ke.get("date")||Di,mA=parseInt(ke.get("comp")||"50"),nn=parseInt(ke.get("bad")||"-1"),pe=parseInt(ke.get("fascia")||"1"),dn=ke.get("cost")||"0,00",ft=ke.get("phrase")||"",Ut=parseFloat(ke.get("avg0")||"0"),ic=parseFloat(ke.get("avg1")||"0"),rc=(ke.get("types")||"").split(",").filter(nr=>nr);let hh="Clausola Default: Relazione indefinita.",tt=[];if(rc.length>0)tt=rc,hh=rc.map(nr=>U_[nr]||nr).join(" ");else{const nr=(ke.get("btn0")||"").split(",").filter(Dr=>Dr).map(Number),fn=(ke.get("btn1")||"").split(",").filter(Dr=>Dr).map(Number);if(nr.length>0||fn.length>0){const Dr=nr.map(ls=>j_[ls]).filter(ls=>ls),fh=fn.map(ls=>j_[ls]).filter(ls=>ls),Oi=Array.from(new Set([...Dr,...fh]));Oi.length>0&&(tt=Oi,hh=Oi.map(ls=>U_[ls]||"").join(" "))}}Le({id:hn,date:oi,machineId:ke.get("mid")||"ALUA-M-V1",sessionToken:Math.random().toString(36).substr(2,9).toUpperCase(),compatibility:mA,riskBand:pe,cost:dn,weakLink:nn,clausesText:hh,phrase:ft,avgScl:{a:Ut,b:ic},relTypes:tt});const as=ke.get("partyA_name"),dh=ke.get("partyB_name"),v0=localStorage.getItem("alua_partyA"),Mi=localStorage.getItem("alua_partyB");return ke.get("comp")||st(!0),as&&dh?(ye(as),we(dh),localStorage.setItem("alua_partyA",as),localStorage.setItem("alua_partyB",dh),h("DASHBOARD")):v0&&Mi&&(ye(v0),we(Mi),h("DASHBOARD")),()=>clearInterval(Je)},[]),re.useEffect(()=>(v||N?(document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%"):(document.body.style.overflow="",document.body.style.position="",document.body.style.width=""),()=>{document.body.style.overflow="",document.body.style.position="",document.body.style.width=""}),[v,N]),re.useEffect(()=>{if(N&&ee.current){const Je=()=>{var et;const ke=(et=ee.current)==null?void 0:et.clientWidth;ke&&te(ke-32)};return Je(),window.addEventListener("resize",Je),()=>window.removeEventListener("resize",Je)}},[N]),re.useEffect(()=>{const Je=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,ke=localStorage.getItem("alua_install_prompt_seen");if(!Je&&!ke){const et=setTimeout(()=>oe(!0),2e3);return()=>clearTimeout(et)}},[]);const Te=()=>{ne&&localStorage.setItem("alua_install_prompt_seen","true"),oe(!1)},Qe=Je=>{Je.preventDefault(),ge&&Me&&(localStorage.setItem("alua_partyA",ge),localStorage.setItem("alua_partyB",Me),navigator.vibrate&&navigator.vibrate(50),h("DASHBOARD"))},rt=()=>{localStorage.removeItem("alua_partyA"),localStorage.removeItem("alua_partyB"),ye(""),we(""),h("LOGIN"),p("MONITORING")},tn=()=>{y(!0),navigator.vibrate&&navigator.vibrate(200),setTimeout(()=>{p("REPORTED"),y(!1),navigator.vibrate&&navigator.vibrate([50,50,50])},800)},Xe=()=>{p("MONITORING")},ut=Je=>{console.log("Scanned:",Je);const ke=vL[Je];ke?(Cn({name:Je,data:ke}),bt(!1)):(alert(`Codice scansionato: ${Je}
Nessun membro associato trovato.`),bt(!1))},$e=()=>{I(!0),_(!1),setTimeout(()=>{C(!1),I(!1)},500)},Os=()=>{z(!0),F(!1),setTimeout(()=>{k(!1),z(!1)},500)},Se=re.useCallback(({numPages:Je})=>{W(Je)},[]),os=le.toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"}),Ca=new Date(le);Ca.setFullYear(Ca.getFullYear()+2);const Di=Ca.toLocaleDateString("it-IT",{day:"2-digit",month:"2-digit",year:"2-digit"}),Ls=()=>me.weakLink===0?"NOTA CRITICA: Instabilit rilevata in CONTRAENTE A.":me.weakLink===1?"NOTA CRITICA: Instabilit rilevata in CONTRAENTE B.":null,vi=async()=>{try{window.navigator&&window.navigator.vibrate&&window.navigator.vibrate(50);const Je=document.getElementById("share-story-template");if(!Je)return;const ke=await window.html2canvas(Je,{scale:2,useCORS:!0,backgroundColor:"#ffffff",width:1080,height:1920,windowWidth:1080,windowHeight:1920,scrollX:0,scrollY:0,onclone:et=>{const hn=et.getElementById("share-story-template");hn&&(hn.style.display="flex",hn.style.visibility="visible",hn.style.left="0px",hn.style.top="0px")}});ke.toBlob(async et=>{if(!et)return;const hn=new File([et],`ALUA_Story_${me.id}.png`,{type:"image/png"});if(navigator.share)try{await navigator.share({files:[hn],title:"ALUA Protocol",text:`Protocollo ${me.id} completato.`})}catch(oi){console.log("Condivisione annullata o fallita",oi)}else{const oi=document.createElement("a");oi.download=`ALUA_Story_${me.id}.png`,oi.href=ke.toDataURL(),oi.click()}},"image/png")}catch(Je){console.error("Errore generazione story:",Je),alert("Errore nella generazione dell'immagine.")}};return n?U.jsxs("div",{className:`fixed inset-0 z-[200] bg-white flex items-center justify-center ${t?"opacity-0":"opacity-100"}`,style:{transition:"opacity 300ms ease-out",height:"100dvh"},children:[U.jsx("img",{src:"/logo_alua.svg",alt:"ALUA",className:"h-16 md:h-20 w-auto"}),U.jsx("div",{className:"absolute bottom-8 w-full text-center font-bergen-mono",children:U.jsxs("p",{className:"text-[10px] text-gray-400 uppercase tracking-widest flex items-center justify-center gap-1",children:[U.jsx("span",{className:"text-sm font-bold",children:""})," ALUA SYSTEMS"]})})]}):l==="LOGIN"?U.jsxs("div",{className:`min-h-[100dvh] w-full flex flex-col items-center justify-center bg-white p-8 font-bergen-mono text-black ${r?"opacity-100":"opacity-0"}`,style:{transition:"opacity 300ms ease-out"},children:[U.jsx("style",{children:`
            @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
          `}),U.jsxs("div",{className:"w-full max-w-md space-y-12 animate-in fade-in duration-700 flex flex-col items-start",children:[U.jsx("div",{className:"mb-2 w-full border-b-2 border-black pb-4",children:U.jsx("a",{href:"https://zjncoo.github.io/ALUA.IT/",target:"_blank",rel:"noopener noreferrer",children:U.jsx("img",{src:"/logo_alua.svg",alt:"ALUA",className:"h-16 w-auto hover:opacity-70 transition-opacity"})})}),U.jsx("p",{className:"text-xs uppercase tracking-widest text-gray-500 text-left font-bergen-mono",children:"Protocollo Verifica Identit"}),U.jsxs("div",{className:"w-full border-2 border-gray-200 p-6 space-y-4 mt-8",children:[U.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 pb-2 mb-4",children:[U.jsx("span",{className:"text-xs uppercase tracking-widest font-bergen-mono text-gray-500",children:"Dati Polizza"}),U.jsx("div",{className:"w-2 h-2 bg-black"})]}),U.jsxs("div",{className:"grid grid-cols-2 gap-8 font-bergen-mono",children:[U.jsxs("div",{children:[U.jsx("span",{className:"block text-xs uppercase text-gray-500 mb-1",children:"PRATICA N."}),U.jsx("span",{className:"text-sm font-bold",children:me.id})]}),U.jsxs("div",{children:[U.jsx("span",{className:"block text-xs uppercase text-gray-500 mb-1",children:"% AFFINIT"}),U.jsxs("span",{className:"text-sm font-bold",children:[me.compatibility,"%"]})]})]})]}),U.jsxs("form",{onSubmit:Qe,className:"space-y-8 w-full font-bergen-mono",children:[U.jsxs("div",{className:"space-y-6",children:[U.jsxs("div",{className:"relative group",children:[U.jsx("label",{className:"text-xs uppercase font-bold tracking-widest mb-2 block text-black",children:"Contraente A"}),U.jsx("input",{type:"text",value:ge,onChange:Je=>ye(Je.target.value.toUpperCase()),placeholder:"INSERISCI NOME...",className:"w-full bg-transparent border-2 border-black p-4 text-lg focus:outline-none focus:bg-gray-50 transition-colors uppercase placeholder:text-gray-400",required:!0})]}),U.jsxs("div",{className:"relative group",children:[U.jsx("label",{className:"text-xs uppercase font-bold tracking-widest mb-2 block text-black",children:"Contraente B"}),U.jsx("input",{type:"text",value:Me,onChange:Je=>we(Je.target.value.toUpperCase()),placeholder:"INSERISCI NOME...",className:"w-full bg-transparent border-2 border-black p-4 text-lg focus:outline-none focus:bg-gray-50 transition-colors uppercase placeholder:text-gray-400",required:!0})]})]}),U.jsxs("button",{type:"submit",className:"w-full bg-black text-white py-6 mt-12 flex items-center justify-between px-6 hover:bg-gray-900 transition-all active:scale-[0.99] border-2 border-black",children:[U.jsx("span",{className:"text-sm font-bold tracking-widest uppercase font-neue-haas",children:"Inizializza Sessione"}),U.jsx("span",{className:"text-xl",children:""})]})]}),U.jsxs("div",{className:"w-full text-center pt-8 border-t-2 border-green-500/0",children:[" ",U.jsxs("p",{className:"text-[10px] text-gray-400 uppercase tracking-widest flex items-center justify-center gap-1",children:[U.jsx("span",{className:"text-sm font-bold",children:""})," 2025 ALUA SYSTEMS"]}),U.jsx("a",{href:"https://creativecommons.org/licenses/by-nc-nd/4.0/deed.it",target:"_blank",rel:"noopener noreferrer",className:"text-[9px] text-gray-400 hover:text-black transition-colors underline",children:"CC BY-NC-ND (Attribuzione - Non Commerciale - Non Opere Derivate)"})]})]}),$&&U.jsx("div",{className:"fixed bottom-0 left-0 w-full z-[100] px-4 pb-6 pt-2 animate-in slide-in-from-bottom duration-500",children:U.jsxs("div",{className:"bg-white border-2 border-black p-6 shadow-2xl flex flex-col gap-4 relative",children:[U.jsx("button",{onClick:Te,className:"absolute top-2 right-2 p-2 hover:bg-gray-100 rounded-full",children:U.jsx(Wh,{size:20})}),U.jsxs("div",{className:"flex items-center gap-4 border-b border-gray-100 pb-4",children:[U.jsx("div",{className:"w-12 h-12 bg-black flex items-center justify-center text-white",children:U.jsx("img",{src:"/logo_alua.svg",alt:"App Icon",className:"w-8 h-8 invert"})}),U.jsxs("div",{children:[U.jsxs("h3",{className:"font-bold text-sm uppercase tracking-widest font-neue-haas leading-tight",children:["Installa",U.jsx("br",{}),U.jsx("span",{className:"text-base",children:"ALUA Systems"})]}),U.jsx("p",{className:"text-xs text-gray-500 font-bergen-mono mt-1",children:"Per la migliore esperienza"})]})]}),U.jsxs("div",{className:"space-y-3 text-xs font-bergen-mono uppercase tracking-wide text-gray-600",children:[U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx("span",{className:"font-bold text-black",children:"1."}),U.jsxs("span",{children:["Tocca l'icona ",U.jsx(cv,{size:14,className:"inline mx-1 align-text-bottom"})," nella barra in basso"]})]}),U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx("span",{className:"font-bold text-black",children:"2."}),U.jsxs("span",{children:["Scorri e seleziona ",U.jsx("span",{className:"font-bold text-black border-b border-black",children:"Aggiungi alla Home"})]})]})]}),U.jsxs("div",{className:"flex items-center gap-2 mt-2 cursor-pointer",onClick:()=>ie(!ne),children:[U.jsx("div",{className:`w-4 h-4 border border-black flex items-center justify-center ${ne?"bg-black":"bg-white"}`,children:ne&&U.jsx(av,{size:10,className:"text-white"})}),U.jsx("span",{className:"text-[10px] uppercase font-bergen-mono text-gray-500 select-none",children:"Non mostrare pi questo messaggio"})]}),U.jsx("button",{onClick:Te,className:"w-full bg-black text-white py-3 mt-0 text-xs uppercase tracking-widest font-bold font-neue-haas hover:bg-gray-900",children:"Ho Capito"})]})})]}):U.jsxs("div",{className:`min-h-[100dvh] w-full flex flex-col bg-white font-bergen-mono text-black overflow-hidden relative ${r?"opacity-100":"opacity-0"}`,style:{transition:"opacity 300ms ease-out"},children:[U.jsxs("header",{className:"px-8 py-8 flex justify-between items-start bg-white border-b-2 border-black z-20 sticky top-0",children:[U.jsxs("div",{className:"flex flex-col items-start font-bergen-mono",children:[U.jsx("span",{className:"text-xs block",children:Di}),U.jsx("span",{className:"text-xs text-gray-400 block",children:os}),U.jsx("div",{className:"flex items-center space-x-3 mt-2",children:U.jsx("div",{className:`w-3 h-3 rounded-full ${g==="MONITORING"?"animate-pulse-slow":""}`,style:{backgroundColor:g==="MONITORING"?"#342152":"#ef4444"}})})]}),U.jsx("a",{href:"https://zjncoo.github.io/ALUA.IT/",target:"_blank",rel:"noopener noreferrer",children:U.jsx("img",{src:"/logo_alua.svg",alt:"ALUA",className:"h-10 w-auto hover:opacity-70 transition-opacity"})})]}),U.jsxs("main",{className:"flex-1 flex flex-col relative z-10 overflow-y-auto p-8",children:[me.phrase&&U.jsxs("div",{className:"flex flex-col items-start justify-start gap-4 mb-8 w-full animate-in fade-in slide-in-from-top-4 duration-700",children:[U.jsx("div",{className:"w-48 h-48 relative",children:U.jsx(XE,{gsr0:me.avgScl.a,gsr1:me.avgScl.b,compatibility:me.compatibility})}),U.jsx("div",{className:"text-left max-w-lg",children:U.jsx("span",{className:"font-bergen-mono text-[16pt] font-bold uppercase leading-tight block text-black whitespace-pre-line",children:WN(me.phrase)})})]}),U.jsxs("div",{className:"border-2 border-black p-8 mb-8 space-y-8 bg-white",children:[U.jsxs("div",{className:"flex justify-between items-start border-b border-gray-200 pb-6",children:[U.jsxs("div",{children:[U.jsx("span",{className:"text-xs uppercase tracking-widest text-gray-500 block mb-2 font-bergen-mono",children:"Rif. Contratto"}),U.jsx("span",{className:"font-bergen-mono text-lg tracking-wider font-bold",children:me.id})]}),U.jsx("button",{onClick:vi,className:"text-black hover:opacity-70 transition-opacity",children:U.jsx(cv,{size:24,strokeWidth:1.5})})]}),U.jsxs("button",{onClick:()=>{C(!0),requestAnimationFrame(()=>{_(!0)})},className:"bg-white hover:bg-gray-50 transition-colors py-3 text-xs uppercase tracking-widest border-b border-black font-bergen-mono flex items-center gap-2",children:[U.jsx(lv,{size:16}),"Contratto Digitale"]}),U.jsxs("div",{className:"grid grid-cols-2 gap-8 font-bergen-mono",children:[U.jsx("div",{children:U.jsxs("div",{className:"flex flex-col",children:[U.jsx("span",{className:"text-xs uppercase tracking-widest text-gray-500 mb-2 flex items-center gap-2",children:"Contraente A"}),U.jsx("span",{className:"text-xl font-bold uppercase",children:ge})]})}),U.jsx("div",{children:U.jsxs("div",{className:"flex flex-col",children:[U.jsx("span",{className:"text-xs uppercase tracking-widest text-gray-500 mb-2 flex items-center gap-2",children:"Contraente B"}),U.jsx("span",{className:"text-xl font-bold uppercase",children:Me})]})})]}),Ls()&&U.jsxs("div",{className:"w-full bg-gray-100 border-2 border-black p-4 mb-6 flex items-center justify-center gap-3",children:[U.jsx(F3,{size:16,className:"text-black"}),U.jsx("span",{className:"text-xs font-bold uppercase tracking-widest text-black",children:Ls()})]}),U.jsxs("div",{className:"pt-6 border-t border-gray-100 flex items-end justify-between",children:[U.jsxs("div",{children:[U.jsx("span",{className:"text-xs uppercase tracking-widest text-gray-400 block pb-2",children:"AFFINIT INTERPERSONALE"}),U.jsxs("span",{className:"text-6xl font-bold font-bergen-mono",children:[me.compatibility,"%"]})]}),U.jsxs("div",{className:"text-right",children:[U.jsx("span",{className:"text-[10px] uppercase tracking-widest text-gray-400 block pb-1",children:"FASCIA DI RISCHIO"}),U.jsx("span",{className:"text-2xl font-bold",children:me.riskBand})]})]})]}),U.jsxs("div",{className:`flex-1 flex flex-col items-center justify-center py-12 transition-colors duration-700 ${g==="REPORTED"?"bg-gray-50":""} border-2 border-black`,children:[U.jsx("div",{className:"mb-12 text-center px-8 h-24 flex items-center justify-center w-full",children:g==="MONITORING"?U.jsxs("div",{className:"text-sm uppercase tracking-[0.15em] text-gray-500 leading-loose font-bergen-mono",children:["Premi per segnalare",U.jsx("br",{}),U.jsx("span",{className:"text-black font-bold font-neue-haas",children:"violazione contrattuale"})]}):U.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500 bg-white border-2 border-black p-4 w-full max-w-md shadow-lg mb-8",children:U.jsxs("div",{className:"flex items-center gap-3 text-black",children:[U.jsx(av,{size:16}),U.jsx("span",{className:"text-sm font-bold uppercase tracking-widest font-neue-haas",children:"Segnalazione Registrata"})]})})}),U.jsxs("div",{className:"relative group w-64 h-64 flex items-center justify-center",children:[U.jsx("div",{className:"absolute -inset-4 border border-black rounded-full pointer-events-none"}),U.jsxs("button",{onClick:tn,disabled:g==="REPORTED",className:`
                  w-full h-full rounded-full transition-all duration-200 ease-out outline-none
                  flex flex-col items-center justify-center relative overflow-hidden
                  ${g==="REPORTED"?"cursor-not-allowed":"cursor-pointer active:scale-[0.95] hover:shadow-xl"}
                  border-4 border-white/20 shadow-lg
                `,style:{background:g==="MONITORING"?"#C3000C":"#f3f4f6",color:g==="MONITORING"?"white":"#9ca3af"},children:[g==="MONITORING"&&U.jsx("img",{src:"/logo_alua.svg",alt:"ALUA",className:"w-32 h-auto opacity-100",style:{filter:"brightness(0) invert(1)"}}),g==="REPORTED"&&U.jsx("span",{className:"font-neue-haas text-lg tracking-[0.1em] font-bold",children:"SEGNALATO"})]})]}),g==="REPORTED"&&U.jsx("button",{onClick:Xe,className:"mt-8 px-6 py-3 border-2 border-black bg-white text-black hover:bg-black hover:text-white transition-all text-xs uppercase tracking-widest font-bold font-neue-haas animate-in fade-in slide-in-from-bottom-4 duration-500",children:"Invia Nuova Segnalazione"})]}),U.jsx("div",{className:"w-full flex justify-center py-6 bg-white border-t-2 border-dashed border-gray-300",children:U.jsxs("button",{onClick:()=>bt(!0),className:"flex items-center gap-3 px-6 py-4 bg-black text-white uppercase tracking-widest font-bold font-neue-haas text-xs hover:bg-gray-800 transition-all border-2 border-black",children:[U.jsx(t4,{size:18}),U.jsx("span",{children:"Scansiona Contatto"})]})})]}),U.jsxs("footer",{className:"px-8 py-6 border-t-2 border-black bg-white text-black flex flex-col font-bergen-mono z-20",children:[U.jsx("div",{className:"w-full flex flex-col items-center gap-4 mb-6",children:U.jsx("button",{onClick:rt,className:"text-xs uppercase tracking-widest text-gray-400 hover:text-red-600 transition-colors cursor-pointer border-b border-gray-300 hover:border-red-600 pb-1",children:"Reset Sessione"})}),U.jsxs("div",{className:"w-[calc(100%+4rem)] -mx-8 text-center py-4 border-t-2 border-black px-8",children:[U.jsx("p",{className:"text-[10px] text-gray-400 uppercase tracking-widest mb-1",children:"Certificato Digitalmente da ALUA Systems"}),U.jsxs("p",{className:"text-[10px] text-gray-300 font-mono",children:["ID: ",me.id,"  Stipulato il ",me.date]})]}),U.jsxs("div",{className:"w-[calc(100%+4rem)] -mx-8 py-4 border-t-2 border-black text-[9px] leading-relaxed text-gray-400 normal-case text-left font-sans px-8",children:[U.jsx("p",{className:"font-bold text-black mb-2",children:"Alua S.p.A."}),U.jsxs("p",{className:"leading-tight",children:["Sede Legale: Via Cordusio 7, 20123 Milano - assicurazioni@pec.alua.it - tel +39 045 8172117 - fax +39 045 8172630",U.jsx("br",{}),"Capitale sociale i.v. Euro 69.000.000,00 - Registro delle Imprese di Milano, CF 01947090273 - P.IVA 03740811205 - R.E.A. 207330 - Societ autorizzata all'esercizio delle assicurazioni con D.M. 05/02/27 N.18331, G.U. 05/02/2027 - Societ iscritta all'Albo imprese di Assicurazione e riassicurazione Sez. I al n.1.00082, soggetta all'attivit di direzione e coordinamento di Alua S.p.A. e facente parte del Gruppo Assicurativo iscritto all'Albo delle societ capogruppo al n.046 - www.alua.it"]})]}),U.jsxs("div",{className:"w-[calc(100%+4rem)] -mx-8 text-center pb-4 px-8",children:[U.jsxs("p",{className:"text-[10px] text-gray-400 uppercase tracking-widest flex items-center justify-center gap-1",children:[U.jsx("span",{className:"text-sm font-bold",children:""})," 2025 ALUA SYSTEMS"]}),U.jsx("a",{href:"https://creativecommons.org/licenses/by-nc-nd/4.0/deed.it",target:"_blank",rel:"noopener noreferrer",className:"text-[9px] text-gray-400 hover:text-black transition-colors underline",children:"CC BY-NC-ND (Attribuzione - Non Commerciale - Non Opere Derivate)"})]})]}),v&&U.jsxs("div",{className:`fixed inset-0 z-50 bg-white flex flex-col font-bergen-mono overflow-hidden ${R?"translate-y-full":O?"translate-y-0":"translate-y-full"}`,style:{transition:"transform 500ms cubic-bezier(0.4, 0, 0.2, 1)"},children:[U.jsxs("div",{className:"z-10 p-6 border-b-2 border-black flex justify-between items-center bg-white shadow-sm",children:[U.jsxs("div",{className:"flex flex-col",children:[U.jsx("span",{className:"text-[10px] uppercase tracking-widest text-gray-500",children:"Contratto Digitale"}),U.jsxs("span",{className:"text-xl font-bold tracking-tight font-neue-haas",children:["CONTRATTO ",me.id]})]}),U.jsx("button",{onClick:$e,className:"w-12 h-12 flex items-center justify-center hover:bg-gray-100 transition-colors",children:U.jsx(Wh,{size:20})})]}),U.jsxs("div",{className:"flex-1 overflow-y-auto p-8 pb-12 space-y-12 bg-white",style:{WebkitOverflowScrolling:"touch"},children:[U.jsxs("button",{onClick:()=>{k(!0),requestAnimationFrame(()=>{F(!0)})},className:"w-full bg-white text-black py-4 flex items-center justify-center gap-3 px-6 hover:bg-black hover:text-white transition-all border-2 border-black group cursor-pointer",children:[U.jsx(lv,{size:18}),U.jsx("span",{className:"text-sm font-bold tracking-widest uppercase font-neue-haas group-hover:underline decoration-white underline-offset-4",children:"VISUALIZZA CONTRATTO COMPLETO"})]}),Ls()&&U.jsxs("div",{className:"w-full bg-gray-100 border-2 border-black p-4 mb-0 flex items-center justify-center gap-3",children:[U.jsx(F3,{size:16,className:"text-black"}),U.jsx("span",{className:"text-xs font-bold uppercase tracking-widest text-black",children:Ls()})]}),U.jsxs("div",{className:"grid grid-cols-2 border-2 border-black bg-white",children:[U.jsxs("div",{className:"py-6 px-4 flex flex-col items-center justify-center border-r-2 border-black",children:[U.jsx("span",{className:"text-[10px] uppercase tracking-widest text-gray-500 block mb-2",children:"Fascia di Rischio"}),U.jsx("span",{className:"text-4xl font-bold font-bergen-mono",children:me.riskBand})]}),U.jsxs("div",{className:"py-6 px-4 flex flex-col items-center justify-center",children:[U.jsx("span",{className:"text-[10px] uppercase tracking-widest text-gray-500 block mb-2",children:"Premio Annuo"}),U.jsx("span",{className:"text-4xl font-bold font-bergen-mono",children:me.cost})]})]}),U.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[U.jsxs("div",{className:"flex items-center gap-2 mb-2 w-full",children:[U.jsx("div",{className:"w-2 h-2 bg-black"}),U.jsx("span",{className:"text-sm font-bold uppercase tracking-widest font-neue-haas",children:"Risonanza Emotiva (Lissajous)"})]}),U.jsx("div",{className:"w-48 h-48 relative bg-white",children:U.jsx(XE,{gsr0:me.avgScl.a,gsr1:me.avgScl.b,compatibility:me.compatibility})}),U.jsx("p",{className:"text-[10px] uppercase tracking-widest text-gray-400 text-center max-w-xs",children:"Visualizzazione generativa basata sui valori SCL medi e sulla compatibilit rilevata."})]}),U.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[U.jsx("div",{className:"w-2 h-2 bg-black"}),U.jsx("span",{className:"text-sm font-bold uppercase tracking-widest font-neue-haas",children:"Clausole Concordate"})]}),me.relTypes&&me.relTypes.length>0&&U.jsx("div",{className:"flex flex-wrap gap-2 mb-3 px-6",children:me.relTypes.map((Je,ke)=>U.jsx("span",{className:"bg-black text-white text-[10px] font-bold uppercase px-2 py-1 tracking-widest",children:Je},ke))}),U.jsxs("div",{className:"pt-12 mt-8 text-center border-t-2 border-black",children:[U.jsx("p",{className:"text-[10px] text-gray-400 uppercase tracking-widest mb-1",children:"Certificato Digitalmente da ALUA Systems"}),U.jsxs("p",{className:"text-[10px] text-gray-300 font-mono",children:["ID: ",me.id,"  Stipulato il ",me.date]})]})]})]}),N&&U.jsxs("div",{className:`fixed inset-0 z-50 bg-white flex flex-col font-bergen-mono overflow-hidden ${B?"translate-y-full":H?"translate-y-0":"translate-y-full"}`,style:{transition:"transform 500ms cubic-bezier(0.4, 0, 0.2, 1)"},children:[U.jsxs("div",{className:"z-10 p-4 md:p-6 border-b-2 border-black flex justify-between items-center bg-white shadow-sm",children:[U.jsxs("div",{className:"flex flex-col",children:[U.jsx("span",{className:"text-[10px] uppercase tracking-widest text-gray-500",children:"Documento Ufficiale"}),U.jsx("span",{className:"text-base md:text-xl font-bold tracking-tight font-neue-haas leading-tight",children:"ALUA - CONDIZIONI GENERALI"})]}),U.jsx("button",{onClick:Os,className:"w-10 h-10 md:w-12 md:h-12 flex items-center justify-center hover:bg-gray-100 transition-colors flex-shrink-0",children:U.jsx(Wh,{size:20})})]}),U.jsxs("div",{className:"z-10 px-4 py-2 border-b border-gray-200 flex items-center justify-between bg-gray-50",children:[U.jsx("span",{className:"text-[10px] uppercase tracking-widest text-gray-500",children:"Pizzica per zoomare"}),Y&&U.jsxs("span",{className:"text-[10px] uppercase tracking-widest text-gray-500",children:[Y," ",Y===1?"pagina":"pagine"]})]}),U.jsx("div",{ref:ee,className:"flex-1 overflow-auto bg-gray-200",style:{WebkitOverflowScrolling:"touch"},children:U.jsx(XO,{initialScale:1,minScale:.5,maxScale:3,centerOnInit:!1,wheel:{disabled:!0},pinch:{step:5},doubleClick:{mode:"reset"},panning:{disabled:!1},children:U.jsx(KO,{wrapperStyle:{width:"100%",height:"100%",overflow:"auto"},contentStyle:{width:"100%"},children:U.jsx("div",{className:"p-4",children:U.jsx(SM,{file:"/contratto.pdf",onLoadSuccess:Se,loading:U.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[U.jsx("div",{className:"w-8 h-8 border-2 border-black border-t-transparent rounded-full animate-spin mb-4"}),U.jsx("span",{className:"text-xs uppercase tracking-widest text-gray-500",children:"Caricamento PDF..."})]}),error:U.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[U.jsx(lv,{size:48,className:"text-gray-400 mb-4"}),U.jsx("p",{className:"text-sm text-gray-600 mb-6 font-bergen-mono uppercase tracking-widest",children:"Errore nel caricamento del PDF."}),U.jsx("a",{href:"/contratto.pdf",target:"_blank",rel:"noopener noreferrer",className:"bg-black text-white py-3 px-6 text-xs font-bold tracking-widest uppercase font-neue-haas hover:bg-gray-900 transition-colors",children:"Apri PDF in Nuova Scheda"})]}),children:Y&&Z&&Array.from(new Array(Y),(Je,ke)=>U.jsx("div",{className:"mb-4 bg-white shadow-lg mx-auto",style:{width:"fit-content"},children:U.jsx(LM,{pageNumber:ke+1,width:Z,renderTextLayer:!0,renderAnnotationLayer:!0,devicePixelRatio:window.devicePixelRatio||2,className:"mx-auto"},`page_${ke+1}`)},`page_container_${ke+1}`))})})})})})]}),He&&U.jsx("div",{className:"fixed top-0 left-0 w-full bg-red-600 text-white z-[100] p-4 text-center font-bold uppercase tracking-widest text-xs animate-pulse",children:" ATTENZIONE: NESSUN DATO DAL QR (USA DEFAULT)"}),$&&U.jsx("div",{className:"fixed bottom-0 left-0 w-full z-[100] px-4 pb-6 pt-2 animate-in slide-in-from-bottom duration-500",children:U.jsxs("div",{className:"bg-white border-2 border-black p-6 shadow-2xl flex flex-col gap-4 relative",children:[U.jsx("button",{onClick:Te,className:"absolute top-2 right-2 p-2 hover:bg-gray-100 rounded-full",children:U.jsx(Wh,{size:20})}),U.jsxs("div",{className:"flex items-center gap-4 border-b border-gray-100 pb-4",children:[U.jsx("div",{className:"w-12 h-12 bg-black flex items-center justify-center text-white",children:U.jsx("img",{src:"/logo_alua.svg",alt:"App Icon",className:"w-8 h-8 invert"})}),U.jsxs("div",{children:[U.jsx("h3",{className:"font-bold text-sm uppercase tracking-widest font-neue-haas",children:"Installa Applicazione"}),U.jsx("p",{className:"text-xs text-gray-500 font-bergen-mono",children:"Per la migliore esperienza ALUA"})]})]}),U.jsxs("div",{className:"space-y-3 text-xs font-bergen-mono uppercase tracking-wide text-gray-600",children:[U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx("span",{className:"font-bold text-black",children:"1."}),U.jsxs("span",{children:["Tocca l'icona ",U.jsx(cv,{size:14,className:"inline mx-1 align-text-bottom"})," nella barra in basso"]})]}),U.jsxs("div",{className:"flex items-center gap-3",children:[U.jsx("span",{className:"font-bold text-black",children:"2."}),U.jsxs("span",{children:["Scorri e seleziona ",U.jsx("span",{className:"font-bold text-black border-b border-black",children:"Aggiungi alla Home"})]})]})]}),U.jsxs("div",{className:"flex items-center gap-2 mt-2 cursor-pointer",onClick:()=>ie(!ne),children:[U.jsx("div",{className:`w-4 h-4 border border-black flex items-center justify-center ${ne?"bg-black":"bg-white"}`,children:ne&&U.jsx(av,{size:10,className:"text-white"})}),U.jsx("span",{className:"text-[10px] uppercase font-bergen-mono text-gray-500 select-none",children:"Non mostrare pi questo messaggio"})]}),U.jsx("button",{onClick:Te,className:"w-full bg-black text-white py-3 mt-0 text-xs uppercase tracking-widest font-bold font-neue-haas hover:bg-gray-900",children:"Ho Capito"})]})}),U.jsx(EL,{contractData:me,partyA:ge,partyB:Me}),yn&&U.jsx(CL,{onClose:()=>bt(!1),onScanSuccess:ut}),De&&U.jsx(SL,{member:De,onClose:()=>Cn(null)})]})};vv.createRoot(document.getElementById("root")).render(U.jsx(ma.StrictMode,{children:U.jsx(_L,{})}));
